(function(){var JSON;JSON||(JSON={}),function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("util/json2",[],function(){return JSON}),function(){var e=function(){function u(n,r){var i=typeof n[r];return i==t||i==e&&!!n[r]||i=="unknown"}function a(t,n){return typeof t[n]==e&&!!t[n]}function f(e,t){return typeof e[t]!=n}function l(e){return function(t,n){var r=n.length;while(r--)if(!e(t,n[r]))return!1;return!0}}function d(e){return e&&c(e,o)&&p(e,s)}function m(e){window.alert("Rangy not supported in your browser. Reason: "+e),v.initialized=!0,v.supported=!1}function g(e){var t="Rangy warning: "+e;v.config.alertOnWarn?window.alert(t):typeof window.console!=n&&typeof window.console.log!=n&&window.console.log(t)}function w(){if(v.initialized)return;var e,t=!1,n=!1;u(document,"createRange")&&(e=document.createRange(),c(e,i)&&p(e,r)&&(t=!0),e.detach());var s=a(document,"body")?document.body:document.getElementsByTagName("body")[0];s&&u(s,"createTextRange")&&(e=s.createTextRange(),d(e)&&(n=!0)),!t&&!n&&m("Neither Range nor TextRange are implemented"),v.initialized=!0,v.features={implementsDomRange:t,implementsTextRange:n};var o=b.concat(y);for(var f=0,l=o.length;f<l;++f)try{o[f](v)}catch(h){a(window,"console")&&u(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",h)}}function S(e){e=e||window,w();for(var t=0,n=E.length;t<n;++t)E[t](e)}function x(e){this.name=e,this.initialized=!1,this.supported=!1}var e="object",t="function",n="undefined",r=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"],i=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],s=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],o=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint","getBoundingClientRect"],c=l(u),h=l(a),p=l(f),v={version:"1.2.1",initialized:!1,supported:!0,util:{isHostMethod:u,isHostObject:a,isHostProperty:f,areHostMethods:c,areHostObjects:h,areHostProperties:p,isTextRange:d},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!0}};v.fail=m,v.warn=g,{}.hasOwnProperty?v.util.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}:m("hasOwnProperty not supported");var y=[],b=[];v.init=w,v.addInitListener=function(e){v.initialized?e(v):y.push(e)};var E=[];v.addCreateMissingNativeApiListener=function(e){E.push(e)},v.createMissingNativeApi=S,x.prototype.fail=function(e){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+e)},x.prototype.warn=function(e){v.warn("Module "+this.name+": "+e)},x.prototype.createError=function(e){return new Error("Error in Rangy "+this.name+" module: "+e)},v.createModule=function(e,t){var n=new x(e);v.modules[e]=n,b.push(function(e){t(e,n),n.initialized=!0,n.supported=!0})},v.requireModules=function(e){for(var t=0,n=e.length,r,i;t<n;++t){i=e[t],r=v.modules[i];if(!r||!(r instanceof x))throw new Error("Module '"+i+"' not found");if(!r.supported)throw new Error("Module '"+i+"' not supported")}};var T=!1,N=function(e){T||(T=!0,v.initialized||w())};if(typeof window==n){m("No window found");return}if(typeof document==n){m("No document found");return}return u(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",N,!1),u(window,"addEventListener")?window.addEventListener("load",N,!1):u(window,"attachEvent")?window.attachEvent("onload",N):m("Window does not have required addEventListener or attachEvent method"),v}();e.createModule("DomUtil",function(e,t){function u(e){var t;return typeof e.namespaceURI==n||(t=e.namespaceURI)===null||t=="http://www.w3.org/1999/xhtml"}function a(e){var t=e.parentNode;return t.nodeType==1?t:null}function f(e){var t=0;while(e=e.previousSibling)t++;return t}function l(e){var t;return d(e)?e.length:(t=e.childNodes)?t.length:0}function c(e,t){var n=[],r;for(r=e;r;r=r.parentNode)n.push(r);for(r=t;r;r=r.parentNode)if(o(n,r))return r;return null}function h(e,t,n){var r=n?t:t.parentNode;while(r){if(r===e)return!0;r=r.parentNode}return!1}function p(e,t,n){var r,i=n?e:e.parentNode;while(i){r=i.parentNode;if(r===t)return i;i=r}return null}function d(e){var t=e.nodeType;return t==3||t==4||t==8}function v(e,t){var n=t.nextSibling,r=t.parentNode;return n?r.insertBefore(e,n):r.appendChild(e),e}function m(e,t){var n=e.cloneNode(!1);return n.deleteData(0,t),e.deleteData(t,e.length-t),v(n,e),n}function g(e){if(e.nodeType==9)return e;if(typeof e.ownerDocument!=n)return e.ownerDocument;if(typeof e.document!=n)return e.document;if(e.parentNode)return g(e.parentNode);throw new Error("getDocument: no document found for node")}function y(e){var t=g(e);if(typeof t.defaultView!=n)return t.defaultView;if(typeof t.parentWindow!=n)return t.parentWindow;throw new Error("Cannot get a window object for node")}function b(e){if(typeof e.contentDocument!=n)return e.contentDocument;if(typeof e.contentWindow!=n)return e.contentWindow.document;throw new Error("getIframeWindow: No Document object found for iframe element")}function w(e){if(typeof e.contentWindow!=n)return e.contentWindow;if(typeof e.contentDocument!=n)return e.contentDocument.defaultView;throw new Error("getIframeWindow: No Window object found for iframe element")}function E(e){return r.isHostObject(e,"body")?e.body:e.getElementsByTagName("body")[0]}function S(e){var t;while(t=e.parentNode)e=t;return e}function x(e){if(!e)return;return e.previousSibling?e.previousSibling.nextSibling:e.nextSibling?e.nextSibling.previousSibling:e.parentNode?e.parentNode.firstChild:e}function T(e,t,n,r){e=x(e),n=x(n);var i,s,o,u,a;if(e==n)return t===r?0:t<r?-1:1;if(i=p(n,e,!0))return t<=f(i)?-1:1;if(i=p(e,n,!0))return f(i)<r?-1:1;s=c(e,n),o=e===s?s:p(e,s,!0),u=n===s?s:p(n,s,!0);if(o===u)throw new Error("comparePoints got to case 4 and childA and childB are the same!");a=s.firstChild;while(a){if(a===o)return-1;if(a===u)return 1;a=a.nextSibling}throw new Error("Should not be here!")}function N(e){var t=g(e).createDocumentFragment(),n;while(n=e.firstChild)t.appendChild(n);return t}function C(e){if(!e)return"[No node]";if(d(e))return'"'+e.data+'"';if(e.nodeType==1){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">["+e.childNodes.length+"]"}return e.nodeName}function k(e){this.root=e,this._next=e}function L(e){return new k(e)}function A(e,t){this.node=e,this.offset=t}function O(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var n="undefined",r=e.util;r.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),r.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var i=document.createElement("div");r.areHostMethods(i,["insertBefore","appendChild","cloneNode"]||!r.areHostObjects(i,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),r.isHostProperty(i,"innerHTML")||t.fail("Element is missing innerHTML property");var s=document.createTextNode("test");r.areHostMethods(s,["splitText","deleteData","insertData","appendData","cloneNode"]||!r.areHostObjects(i,["previousSibling","nextSibling","childNodes","parentNode"])||!r.areHostProperties(s,["data"]))||t.fail("Incomplete Text Node implementation");var o=function(e,t){var n=e.length;while(n--)if(e[n]===t)return!0;return!1};k.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next,t,n;if(this._current){t=e.firstChild;if(t)this._next=t;else{n=null;while(e!==this.root&&!(n=e.nextSibling))e=e.parentNode;this._next=n}}return this._current},detach:function(){this._current=this._next=this.root=null}},A.prototype={equals:function(e){return this.node===e.node&this.offset==e.offset},inspect:function(){return"[DomPosition("+C(this.node)+":"+this.offset+")]"}},O.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},O.prototype.toString=function(){return this.message},e.dom={arrayContains:o,isHtmlNamespace:u,parentElement:a,getNodeIndex:f,getNodeLength:l,getCommonAncestor:c,isAncestorOf:h,getClosestAncestorIn:p,isCharacterDataNode:d,insertAfter:v,splitDataNode:m,getDocument:g,getWindow:y,getIframeWindow:w,getIframeDocument:b,getBody:E,getRootContainer:S,comparePoints:T,inspectNode:C,fragmentFromNodeChildren:N,createIterator:L,DomPosition:A},e.DOMException=O}),e.createModule("DomRange",function(e,t){function s(e,t){return e.nodeType!=3&&(n.isAncestorOf(e,t.startContainer,!0)||n.isAncestorOf(e,t.endContainer,!0))}function o(e){return n.getDocument(e.startContainer)}function u(e,t,n){var r=e._listeners[t];if(r)for(var i=0,s=r.length;i<s;++i)r[i].call(e,{target:e,args:n})}function a(e){return new r(e.parentNode,n.getNodeIndex(e))}function f(e){return new r(e.parentNode,n.getNodeIndex(e)+1)}function l(e,t,r){var i=e.nodeType==11?e.firstChild:e;return n.isCharacterDataNode(t)?r==t.length?n.insertAfter(e,t):t.parentNode.insertBefore(e,r==0?t:n.splitDataNode(t,r)):r>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[r]),i}function c(e){var t;for(var n,r=o(e.range).createDocumentFragment(),s;n=e.next();){t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(s=e.getSubtreeIterator(),n.appendChild(c(s)),s.detach(!0));if(n.nodeType==10)throw new i("HIERARCHY_REQUEST_ERR");r.appendChild(n)}return r}function h(e,t,r){var i,s;r=r||{stop:!1};for(var o,u;o=e.next();)if(e.isPartiallySelectedSubtree()){if(t(o)===!1){r.stop=!0;return}u=e.getSubtreeIterator(),h(u,t,r),u.detach(!0);if(r.stop)return}else{i=n.createIterator(o);while(s=i.next())if(t(s)===!1){r.stop=!0;return}}}function p(e){var t;while(e.next())e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),p(t),t.detach(!0)):e.remove()}function d(e){for(var t,n=o(e.range).createDocumentFragment(),r;t=e.next();){e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),r=e.getSubtreeIterator(),t.appendChild(d(r)),r.detach(!0)):e.remove();if(t.nodeType==10)throw new i("HIERARCHY_REQUEST_ERR");n.appendChild(t)}return n}function v(e,t,n){var r=!!t&&!!t.length,i,s=!!n;r&&(i=new RegExp("^("+t.join("|")+")$"));var o=[];return h(new g(e,!1),function(e){(!r||i.test(e.nodeType))&&(!s||n(e))&&o.push(e)}),o}function m(e){var t=typeof e.getName=="undefined"?"Range":e.getName();return"["+t+"("+n.inspectNode(e.startContainer)+":"+e.startOffset+", "+n.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function g(e,t){this.range=e,this.clonePartiallySelectedTextNodes=t;if(!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var r=e.commonAncestorContainer;this.sc===this.ec&&n.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===r&&!n.isCharacterDataNode(this.sc)?this.sc.childNodes[this.so]:n.getClosestAncestorIn(this.sc,r,!0),this._last=this.ec===r&&!n.isCharacterDataNode(this.ec)?this.ec.childNodes[this.eo-1]:n.getClosestAncestorIn(this.ec,r,!0))}}function y(e){this.code=this[e],this.codeName=e,this.message="RangeException: "+this.codeName}function b(e,t,n){this.nodes=v(e,t,n),this._next=this.nodes[0],this._position=0}function N(e){return function(t,r){var i,s=r?t:t.parentNode;while(s){i=s.nodeType;if(n.arrayContains(e,i))return s;s=s.parentNode}return null}}function O(e,t){if(A(e,t))throw new y("INVALID_NODE_TYPE_ERR")}function M(e){if(!e.startContainer)throw new i("INVALID_STATE_ERR")}function _(e,t){if(!n.arrayContains(t,e.nodeType))throw new y("INVALID_NODE_TYPE_ERR")}function D(e,t){if(t<0||t>(n.isCharacterDataNode(e)?e.length:e.childNodes.length))throw new i("INDEX_SIZE_ERR")}function P(e,t){if(k(e,!0)!==k(t,!0))throw new i("WRONG_DOCUMENT_ERR")}function H(e){if(L(e,!0))throw new i("NO_MODIFICATION_ALLOWED_ERR")}function B(e,t){if(!e)throw new i(t)}function j(e){return!n.arrayContains(E,e.nodeType)&&!k(e,!0)}function F(e,t){return t<=(n.isCharacterDataNode(e)?e.length:e.childNodes.length)}function I(e){M(e);if(j(e.startContainer)||j(e.endContainer)||!F(e.startContainer,e.startOffset)||!F(e.endContainer,e.endOffset))throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function Z(){}function et(e){e.START_TO_START=X,e.START_TO_END=V,e.END_TO_END=$,e.END_TO_START=J,e.NODE_BEFORE=K,e.NODE_AFTER=Q,e.NODE_BEFORE_AND_AFTER=G,e.NODE_INSIDE=Y}function tt(e){et(e),et(e.prototype)}function nt(e,t){return function(){I(this);var r=this.startContainer,i=this.startOffset,s=this.commonAncestorContainer,o=new g(this,!0),u,a;r!==s&&(u=n.getClosestAncestorIn(r,s,!0),a=f(u),r=a.node,i=a.offset),h(o,H),o.reset();var l=e(o);return o.detach(),t(this,r,i,r,i),l}}function rt(t,r,i){function o(e,t){return function(n){M(this),_(n,w),_(C(n),E);var r=(e?a:f)(n);(t?u:l)(this,r.node,r.offset)}}function u(e,t,i){var s=e.endContainer,o=e.endOffset;if(t!==e.startContainer||i!==this.startOffset){if(C(t)!=C(s)||n.comparePoints(t,i,s,o)==1)s=t,o=i;r(e,t,i,s,o)}}function l(e,t,i){var s=e.startContainer,o=e.startOffset;if(t!==e.endContainer||i!==this.endOffset){if(C(t)!=C(s)||n.comparePoints(t,i,s,o)==-1)s=t,o=i;r(e,s,o,t,i)}}function c(e,t,n){(t!==e.startContainer||n!==this.startOffset||t!==e.endContainer||n!==this.endOffset)&&r(e,t,n,t,n)}t.prototype=new Z,e.util.extend(t.prototype,{setStart:function(e,t){M(this),O(e,!0),D(e,t),u(this,e,t)},setEnd:function(e,t){M(this),O(e,!0),D(e,t),l(this,e,t)},setStartBefore:o(!0,!0),setStartAfter:o(!1,!0),setEndBefore:o(!0,!1),setEndAfter:o(!1,!1),collapse:function(e){I(this),e?r(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):r(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){M(this),O(e,!0),r(this,e,0,e,n.getNodeLength(e))},selectNode:function(e){M(this),O(e,!1),_(e,w);var t=a(e),n=f(e);r(this,t.node,t.offset,n.node,n.offset)},extractContents:nt(d,r),deleteContents:nt(p,r),canSurroundContents:function(){I(this),H(this.startContainer),H(this.endContainer);var e=new g(this,!0),t=e._first&&s(e._first,this)||e._last&&s(e._last,this);return e.detach(),!t},detach:function(){i(this)},splitBoundaries:function(){I(this);var e=this.startContainer,t=this.startOffset,i=this.endContainer,s=this.endOffset,o=e===i;n.isCharacterDataNode(i)&&s>0&&s<i.length&&n.splitDataNode(i,s),n.isCharacterDataNode(e)&&t>0&&t<e.length&&(e=n.splitDataNode(e,t),o?(s-=t,i=e):i==e.parentNode&&s>=n.getNodeIndex(e)&&s++,t=0),r(this,e,t,i,s)},normalizeBoundaries:function(){I(this);var e=this.startContainer,t=this.startOffset,i=this.endContainer,s=this.endOffset,o=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(i=e,s=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},u=function(r){var o=r.previousSibling;if(o&&o.nodeType==r.nodeType){e=r;var u=r.length;t=o.length,r.insertData(0,o.data),o.parentNode.removeChild(o);if(e==i)s+=t,i=e;else if(i==r.parentNode){var a=n.getNodeIndex(r);s==a?(i=r,s=u):s>a&&s--}}},a=!0;if(n.isCharacterDataNode(i))i.length==s&&o(i);else{if(s>0){var f=i.childNodes[s-1];f&&n.isCharacterDataNode(f)&&o(f)}a=!this.collapsed}if(a){if(n.isCharacterDataNode(e))t==0&&u(e);else if(t<e.childNodes.length){var l=e.childNodes[t];l&&n.isCharacterDataNode(l)&&u(l)}}else e=i,t=s;r(this,e,t,i,s)},collapseToPoint:function(e,t){M(this),O(e,!0),D(e,t),c(this,e,t)}}),tt(t)}function it(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:n.getCommonAncestor(e.startContainer,e.endContainer)}function st(e,t,n,r,i){var s=e.startContainer!==t||e.startOffset!==n,o=e.endContainer!==r||e.endOffset!==i;e.startContainer=t,e.startOffset=n,e.endContainer=r,e.endOffset=i,it(e),u(e,"boundarychange",{startMoved:s,endMoved:o})}function ot(e){M(e),e.startContainer=e.startOffset=e.endContainer=e.endOffset=null,e.collapsed=e.commonAncestorContainer=null,u(e,"detach",null),e._listeners=null}function ut(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this._listeners={boundarychange:[],detach:[]},it(this)}e.requireModules(["DomUtil"]);var n=e.dom,r=n.DomPosition,i=e.DOMException;g.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,n.isCharacterDataNode(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e=this._current,t,r;!n.isCharacterDataNode(e)||e!==this.sc&&e!==this.ec?e.parentNode&&e.parentNode.removeChild(e):(t=e===this.sc?this.so:0,r=e===this.ec?this.eo:e.length,t!=r&&e.deleteData(t,r-t))},isPartiallySelectedSubtree:function(){var e=this._current;return s(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse();else{e=new ut(o(this.range));var t=this._current,r=t,i=0,s=t,u=n.getNodeLength(t);n.isAncestorOf(t,this.sc,!0)&&(r=this.sc,i=this.so),n.isAncestorOf(t,this.ec,!0)&&(s=this.ec,u=this.eo),st(e,r,i,s,u)}return new g(e,this.clonePartiallySelectedTextNodes)},detach:function(e){e&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},y.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},y.prototype.toString=function(){return this.message},b.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){return this._current=this._next,this._next=this.nodes[++this._position],this._current},detach:function(){this._current=this._next=this.nodes=null}};var w=[1,3,4,5,7,8,10],E=[2,9,11],S=[5,6,10,12],x=[1,3,4,5,7,8,10,11],T=[1,3,4,5,7,8],C=n.getRootContainer,k=N([9,11]),L=N(S),A=N([6,10,12]),q=document.createElement("style"),R=!1;try{q.innerHTML="<b>x</b>",R=q.firstChild.nodeType==3}catch(U){}e.features.htmlParsingConforms=R;var z=R?function(e){var t=this.startContainer,r=n.getDocument(t);if(!t)throw new i("INVALID_STATE_ERR");var s=null;return t.nodeType==1?s=t:n.isCharacterDataNode(t)&&(s=n.parentElement(t)),s===null||s.nodeName=="HTML"&&n.isHtmlNamespace(n.getDocument(s).documentElement)&&n.isHtmlNamespace(s)?s=r.createElement("body"):s=s.cloneNode(!1),s.innerHTML=e,n.fragmentFromNodeChildren(s)}:function(e){M(this);var t=o(this),r=t.createElement("body");return r.innerHTML=e,n.fragmentFromNodeChildren(r)},W=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],X=0,V=1,$=2,J=3,K=0,Q=1,G=2,Y=3;Z.prototype={attachListener:function(e,t){this._listeners[e].push(t)},compareBoundaryPoints:function(e,t){I(this),P(this.startContainer,t.startContainer);var r,i,s,o,u=e==J||e==X?"start":"end",a=e==V||e==X?"start":"end";return r=this[u+"Container"],i=this[u+"Offset"],s=t[a+"Container"],o=t[a+"Offset"],n.comparePoints(r,i,s,o)},insertNode:function(e){I(this),_(e,x),H(this.startContainer);if(n.isAncestorOf(e,this.startContainer,!0))throw new i("HIERARCHY_REQUEST_ERR");var t=l(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){I(this);var e,t;if(this.collapsed)return o(this).createDocumentFragment();if(this.startContainer===this.endContainer&&n.isCharacterDataNode(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=o(this).createDocumentFragment(),t.appendChild(e),t;var r=new g(this,!0);return e=c(r),r.detach(),e},canSurroundContents:function(){I(this),H(this.startContainer),H(this.endContainer);var e=new g(this,!0),t=e._first&&s(e._first,this)||e._last&&s(e._last,this);return e.detach(),!t},surroundContents:function(e){_(e,T);if(!this.canSurroundContents())throw new y("BAD_BOUNDARYPOINTS_ERR");var t=this.extractContents();if(e.hasChildNodes())while(e.lastChild)e.removeChild(e.lastChild);l(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){I(this);var e=new ut(o(this)),t=W.length,n;while(t--)n=W[t],e[n]=this[n];return e},toString:function(){I(this);var e=this.startContainer;if(e===this.endContainer&&n.isCharacterDataNode(e))return e.nodeType==3||e.nodeType==4?e.data.slice(this.startOffset,this.endOffset):"";var t=[],r=new g(this,!0);return h(r,function(e){(e.nodeType==3||e.nodeType==4)&&t.push(e.data)}),r.detach(),t.join("")},compareNode:function(e){I(this);var t=e.parentNode,r=n.getNodeIndex(e);if(!t)throw new i("NOT_FOUND_ERR");var s=this.comparePoint(t,r),o=this.comparePoint(t,r+1);return s<0?o>0?G:K:o>0?Q:Y},comparePoint:function(e,t){return I(this),B(e,"HIERARCHY_REQUEST_ERR"),P(e,this.startContainer),n.comparePoints(e,t,this.startContainer,this.startOffset)<0?-1:n.comparePoints(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:z,toHtml:function(){I(this);var e=o(this).createElement("div");return e.appendChild(this.cloneContents()),e.innerHTML},intersectsNode:function(e,t){I(this),B(e,"NOT_FOUND_ERR");if(n.getDocument(e)!==o(this))return!1;var r=e.parentNode,i=n.getNodeIndex(e);B(r,"NOT_FOUND_ERR");var s=n.comparePoints(r,i,this.endContainer,this.endOffset),u=n.comparePoints(r,i+1,this.startContainer,this.startOffset);return t?s<=0&&u>=0:s<0&&u>0},isPointInRange:function(e,t){return I(this),B(e,"HIERARCHY_REQUEST_ERR"),P(e,this.startContainer),n.comparePoints(e,t,this.startContainer,this.startOffset)>=0&&n.comparePoints(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e,t){I(this);if(o(e)!=o(this))throw new i("WRONG_DOCUMENT_ERR");var r=n.comparePoints(this.startContainer,this.startOffset,e.endContainer,e.endOffset),s=n.comparePoints(this.endContainer,this.endOffset,e.startContainer,e.startOffset);return t?r<=0&&s>=0:r<0&&s>0},intersection:function(e){if(this.intersectsRange(e)){var t=n.comparePoints(this.startContainer,this.startOffset,e.startContainer,e.startOffset),r=n.comparePoints(this.endContainer,this.endOffset,e.endContainer,e.endOffset),i=this.cloneRange();return t==-1&&i.setStart(e.startContainer,e.startOffset),r==1&&i.setEnd(e.endContainer,e.endOffset),i}return null},union:function(e){if(this.intersectsRange(e,!0)){var t=this.cloneRange();return n.comparePoints(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1&&t.setStart(e.startContainer,e.startOffset),n.comparePoints(e.endContainer,e.endOffset,this.endContainer,this.endOffset)==1&&t.setEnd(e.endContainer,e.endOffset),t}throw new y("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==Y},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,n.getNodeLength(e))<=0},containsRange:function(e){return this.intersection(e).equals(e)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var r=n.pop();t.setEnd(r,r.length);var i=this.containsRange(t);return t.detach(),i}return this.containsNodeContents(e)},createNodeIterator:function(e,t){return I(this),new b(this,e,t)},getNodes:function(e,t){return I(this),v(this,e,t)},getDocument:function(){return o(this)},collapseBefore:function(e){M(this),this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){M(this),this.setStartAfter(e),this.collapse(!0)},getName:function(){return"DomRange"},equals:function(e){return ut.rangesEqual(this,e)},inspect:function(){return m(this)}},rt(ut,st,ot),e.rangePrototype=Z.prototype,ut.rangeProperties=W,ut.RangeIterator=g,ut.copyComparisonConstants=tt,ut.createPrototypeRange=rt,ut.inspect=m,ut.getRangeDocument=o,ut.rangesEqual=function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset},e.DomRange=ut,e.RangeException=y}),e.createModule("WrappedRange",function(e,t){function o(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var i=n.parentElement();n=e.duplicate(),n.collapse(!1);var s=n.parentElement(),o=i==s?i:r.getCommonAncestor(i,s);return o==t?o:r.getCommonAncestor(t,o)}function u(e){return e.compareEndPoints("StartToEnd",e)==0}function a(e,t,n,s){var o=e.duplicate();o.collapse(n);var u=o.parentElement();r.isAncestorOf(t,u,!0)||(u=t);if(!u.canHaveHTML)return new i(u.parentNode,r.getNodeIndex(u));var a=r.getDocument(u).createElement("span");a.parentNode&&a.parentNode.removeChild(a);var f,l=n?"StartToStart":"StartToEnd",c,h,p,d;do u.insertBefore(a,a.previousSibling),o.moveToElementText(a);while((f=o.compareEndPoints(l,e))>0&&a.previousSibling);d=a.nextSibling;if(f==-1&&d&&r.isCharacterDataNode(d)){o.setEndPoint(n?"EndToStart":"EndToEnd",e);var v;if(/[\r\n]/.test(d.data)){var m=o.duplicate(),g=m.text.replace(/\r\n/g,"\r").length;v=m.moveStart("character",g);while((f=m.compareEndPoints("StartToEnd",m))==-1)v++,m.moveStart("character",1)}else{var y=o.text.replace(/\u00a0/g," "),b=d.data.replace(/\u00a0/g," ");if(b.indexOf(y)!==0){while(y.length>0&&b.indexOf(y)!==0)y=y.substr(1);v=y.length}else v=o.text.length}p=new i(d,v)}else c=(s||!n)&&a.previousSibling,h=(s||n)&&a.nextSibling,h&&r.isCharacterDataNode(h)?p=new i(h,0):c&&r.isCharacterDataNode(c)?p=new i(c,c.length):p=new i(u,r.getNodeIndex(a));return a.parentNode.removeChild(a),p}function f(e,t){var n,i,s=e.offset,o=r.getDocument(e.node),u,a,f=o.body.createTextRange(),l=r.isCharacterDataNode(e.node);l?(n=e.node,i=n.parentNode):(a=e.node.childNodes,n=s<a.length?a[s]:null,i=e.node),u=o.createElement("span"),u.innerHTML="&#feff;",n?i.insertBefore(u,n):i.appendChild(u);try{f.moveToElementText(u),f.collapse(!t)}catch(c){}return i.removeChild(u),l&&f[t?"moveStart":"moveEnd"]("character",s),f}e.requireModules(["DomUtil","DomRange"]);var n,r=e.dom,i=r.DomPosition,s=e.DomRange;if(e.features.implementsDomRange&&(!e.features.implementsTextRange||!e.config.preferTextRange))(function(){function u(e){var t=i.length,n;while(t--)n=i[t],e[n]=e.nativeRange[n]}function a(e,t,n,r,i){var s=e.startContainer!==t||e.startOffset!=n,o=e.endContainer!==r||e.endOffset!=i;if(s||o)e.setEnd(r,i),e.setStart(t,n)}function f(e){e.nativeRange.detach(),e.detached=!0;var t=i.length,n;while(t--)n=i[t],e[n]=null}var t,i=s.rangeProperties,o,l;n=function(e){if(!e)throw new Error("Range must be specified");this.nativeRange=e,u(this)},s.createPrototypeRange(n,a,f),t=n.prototype,t.selectNode=function(e){this.nativeRange.selectNode(e),u(this)},t.deleteContents=function(){this.nativeRange.deleteContents(),u(this)},t.extractContents=function(){var e=this.nativeRange.extractContents();return u(this),e},t.cloneContents=function(){return this.nativeRange.cloneContents()},t.surroundContents=function(e){this.nativeRange.surroundContents(e),u(this)},t.collapse=function(e){this.nativeRange.collapse(e),u(this)},t.cloneRange=function(){return new n(this.nativeRange.cloneRange())},t.refresh=function(){u(this)},t.toString=function(){return this.nativeRange.toString()};var c=document.createTextNode("test");r.getBody(document).appendChild(c);var h=document.createRange();h.setStart(c,0),h.setEnd(c,0);try{h.setStart(c,1),o=!0,t.setStart=function(e,t){this.nativeRange.setStart(e,t),u(this)},t.setEnd=function(e,t){this.nativeRange.setEnd(e,t),u(this)},l=function(e){return function(t){this.nativeRange[e](t),u(this)}}}catch(p){o=!1,t.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}u(this)},t.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}u(this)},l=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(r){this.nativeRange[t](n),this.nativeRange[e](n)}u(this)}}}t.setStartBefore=l("setStartBefore","setEndBefore"),t.setStartAfter=l("setStartAfter","setEndAfter"),t.setEndBefore=l("setEndBefore","setStartBefore"),t.setEndAfter=l("setEndAfter","setStartAfter"),h.selectNodeContents(c),h.startContainer==c&&h.endContainer==c&&h.startOffset==0&&h.endOffset==c.length?t.selectNodeContents=function(e){this.nativeRange.selectNodeContents(e),u(this)}:t.selectNodeContents=function(e){this.setStart(e,0),this.setEnd(e,s.getEndOffset(e))},h.selectNodeContents(c),h.setEnd(c,3);var d=document.createRange();d.selectNodeContents(c),d.setEnd(c,4),d.setStart(c,2),h.compareBoundaryPoints(h.START_TO_END,d)==-1&h.compareBoundaryPoints(h.END_TO_START,d)==1?t.compareBoundaryPoints=function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:t.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)},e.util.isHostMethod(h,"createContextualFragment")&&(t.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),r.getBody(document).removeChild(c),h.detach(),d.detach()})(),e.createNativeRange=function(e){return e=e||document,e.createRange()};else if(e.features.implementsTextRange){n=function(e){this.textRange=e,this.refresh()},n.prototype=new s(document),n.prototype.refresh=function(){var e,t,n=o(this.textRange);u(this.textRange)?t=e=a(this.textRange,n,!0,!0):(e=a(this.textRange,n,!0,!1),t=a(this.textRange,n,!1,!1)),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},s.copyComparisonConstants(n);var l=function(){return this}();typeof l.Range=="undefined"&&(l.Range=n),e.createNativeRange=
function(e){return e=e||document,e.body.createTextRange()}}e.features.implementsTextRange&&(n.rangeToTextRange=function(e){if(e.collapsed){var t=f(new i(e.startContainer,e.startOffset),!0);return t}var n=f(new i(e.startContainer,e.startOffset),!0),s=f(new i(e.endContainer,e.endOffset),!1),o=r.getDocument(e.startContainer).body.createTextRange();return o.setEndPoint("StartToStart",n),o.setEndPoint("EndToEnd",s),o}),n.prototype.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createRange=function(t){return t=t||document,new n(e.createNativeRange(t))},e.createRangyRange=function(e){return e=e||document,new s(e)},e.createIframeRange=function(t){return e.createRange(r.getIframeDocument(t))},e.createIframeRangyRange=function(t){return e.createRangyRange(r.getIframeDocument(t))},e.addCreateMissingNativeApiListener(function(t){var n=t.document;typeof n.createRange=="undefined"&&(n.createRange=function(){return e.createRange(this)}),n=t=null})}),e.createModule("WrappedSelection",function(e,t){function p(e){return(e||window).getSelection()}function d(e){return(e||window).document.selection}function L(e,t,n){var r=n?"end":"start",i=n?"start":"end";e.anchorNode=t[r+"Container"],e.anchorOffset=t[r+"Offset"],e.focusNode=t[i+"Container"],e.focusOffset=t[i+"Offset"]}function A(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function O(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function M(t){var n;return t instanceof o?(n=t._selectionNativeRange,n||(n=e.createNativeRange(i.getDocument(t.startContainer)),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset),t._selectionNativeRange=n,t.attachListener("detach",function(){this._selectionNativeRange=null}))):t instanceof u?n=t.nativeRange:e.features.implementsDomRange&&t instanceof i.getWindow(t.startContainer).Range&&(n=t),n}function _(e){if(!e.length||e[0].nodeType!=1)return!1;for(var t=1,n=e.length;t<n;++t)if(!i.isAncestorOf(e[0],e[t]))return!1;return!0}function D(e){var t=e.getNodes();if(!_(t))throw new Error("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return t[0]}function P(e){return!!e&&typeof e.text!="undefined"}function H(e,t){var n=new u(t);e._ranges=[n],L(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function B(t){t._ranges.length=0;if(t.docSelection.type=="None")O(t);else{var n=t.docSelection.createRange();if(P(n))H(t,n);else{t.rangeCount=n.length;var r,s=i.getDocument(n.item(0));for(var o=0;o<t.rangeCount;++o)r=e.createRange(s),r.selectNode(n.item(o)),t._ranges.push(r);t.isCollapsed=t.rangeCount==1&&t._ranges[0].collapsed,L(t,t._ranges[t.rangeCount-1],!1)}}}function j(e,t){var n=e.docSelection.createRange(),r=D(t),s=i.getDocument(n.item(0)),o=i.getBody(s).createControlRange();for(var u=0,a=n.length;u<a;++u)o.add(n.item(u));try{o.add(r)}catch(f){throw new Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}o.select(),B(e)}function I(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function R(e,t){var n=i.getDocument(t[0].startContainer),r=i.getBody(n).createControlRange();for(var s=0,o;s<rangeCount;++s){o=D(t[s]);try{r.add(o)}catch(u){throw new Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select(),B(e)}function V(e,t){if(e.anchorNode&&i.getDocument(e.anchorNode)!==i.getDocument(t))throw new a("WRONG_DOCUMENT_ERR")}function $(e){var t=[],n=new f(e.anchorNode,e.anchorOffset),r=new f(e.focusNode,e.focusOffset),i=typeof e.getName=="function"?e.getName():"Selection";if(typeof e.rangeCount!="undefined")for(var s=0,u=e.rangeCount;s<u;++s)t[s]=o.inspect(e.getRangeAt(s));return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+r.inspect()+"]"}e.requireModules(["DomUtil","DomRange","WrappedRange"]),e.config.checkSelectionRanges=!0;var n="boolean",r="_rangySelection",i=e.dom,s=e.util,o=e.DomRange,u=e.WrappedRange,a=e.DOMException,f=i.DomPosition,l,c,h="Control",v=e.util.isHostMethod(window,"getSelection"),m=e.util.isHostObject(document,"selection"),g=m&&(!v||e.config.preferTextRange);g?(l=d,e.isSelectionValid=function(e){var t=(e||window).document,n=t.selection;return n.type!="None"||i.getDocument(n.createRange().parentElement())==t}):v?(l=p,e.isSelectionValid=function(){return!0}):t.fail("Neither document.selection or window.getSelection() detected."),e.getNativeSelection=l;var y=l(),b=e.createNativeRange(document),w=i.getBody(document),E=s.areHostObjects(y,["anchorNode","focusNode"]&&s.areHostProperties(y,["anchorOffset","focusOffset"]));e.features.selectionHasAnchorAndFocus=E;var S=s.isHostMethod(y,"extend");e.features.selectionHasExtend=S;var x=typeof y.rangeCount=="number";e.features.selectionHasRangeCount=x;var T=!1,N=!0;s.areHostMethods(y,["addRange","getRangeAt","removeAllRanges"])&&typeof y.rangeCount=="number"&&e.features.implementsDomRange&&function(){var e=document.createElement("iframe");w.appendChild(e);var t=i.getIframeDocument(e);t.open(),t.write("<html><head></head><body>12</body></html>"),t.close();var n=i.getIframeWindow(e).getSelection(),r=t.documentElement,s=r.lastChild,o=s.firstChild,u=t.createRange();u.setStart(o,1),u.collapse(!0),n.addRange(u),N=n.rangeCount==1,n.removeAllRanges();var a=u.cloneRange();u.setStart(o,0),a.setEnd(o,2),n.addRange(u),n.addRange(a),T=n.rangeCount==2,u.detach(),a.detach(),w.removeChild(e)}(),e.features.selectionSupportsMultipleRanges=T,e.features.collapsedNonEditableSelectionsSupported=N;var C=!1,k;w&&s.isHostMethod(w,"createControlRange")&&(k=w.createControlRange(),s.areHostProperties(k,["item","add"])&&(C=!0)),e.features.implementsControlRange=C,E?c=function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:c=function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:!1};var F;s.isHostMethod(y,"getRangeAt")?F=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:E&&(F=function(t){var n=i.getDocument(t.anchorNode),r=e.createRange(n);return r.setStart(t.anchorNode,t.anchorOffset),r.setEnd(t.focusNode,t.focusOffset),r.collapsed!==this.isCollapsed&&(r.setStart(t.focusNode,t.focusOffset),r.setEnd(t.anchorNode,t.anchorOffset)),r}),e.getSelection=function(e){e=e||window;var t=e[r],n=l(e),i=m?d(e):null;return t?(t.nativeSelection=n,t.docSelection=i,t.refresh(e)):(t=new I(n,i,e),e[r]=t),t},e.getIframeSelection=function(t){return e.getSelection(i.getIframeWindow(t))};var q=I.prototype;if(!g&&E&&s.areHostMethods(y,["removeAllRanges","addRange"])){q.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),O(this)};var U=function(t,n){var r=o.getRangeDocument(n),i=e.createRange(r);i.collapseToPoint(n.endContainer,n.endOffset),t.nativeSelection.addRange(M(i)),t.nativeSelection.extend(n.startContainer,n.startOffset),t.refresh()};x?q.addRange=function(t,n){if(C&&m&&this.docSelection.type==h)j(this,t);else if(n&&S)U(this,t);else{var r;T?r=this.rangeCount:(this.removeAllRanges(),r=0),this.nativeSelection.addRange(M(t)),this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==r+1){if(e.config.checkSelectionRanges){var i=F(this.nativeSelection,this.rangeCount-1);i&&!o.rangesEqual(i,t)&&(t=new u(i))}this._ranges[this.rangeCount-1]=t,L(this,t,X(this.nativeSelection)),this.isCollapsed=c(this)}else this.refresh()}}:q.addRange=function(e,t){t&&S?U(this,e):(this.nativeSelection.addRange(M(e)),this.refresh())},q.setRanges=function(e){if(C&&e.length>1)R(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(s.isHostMethod(y,"empty")&&s.isHostMethod(b,"select")&&C&&g))return t.fail("No means of selecting a Range or TextRange was found"),!1;q.removeAllRanges=function(){try{var e=jQuery.browser.msie&&jQuery.browser.version<8&&typeof document.documentMode=="undefined";e||this.docSelection.empty(),this.docSelection.type!="None"&&e&&this.docSelection.empty()}catch(t){}O(this)},q.addRange=function(e){if(this.docSelection.type==h)j(this,e);else try{u.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,L(this,e,!1)}catch(t){}},q.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?R(this,e):t&&this.addRange(e[0])}}q.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new a("INDEX_SIZE_ERR");return this._ranges[e]};var z;if(g)z=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=i.getBody(t.win.document).createTextRange(),n.collapse(!0)),t.docSelection.type==h?B(t):P(n)?H(t,n):O(t)};else if(s.isHostMethod(y,"getRangeAt")&&typeof y.rangeCount=="number")z=function(t){if(C&&m&&t.docSelection.type==h)B(t);else{t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount;if(t.rangeCount){for(var n=0,r=t.rangeCount;n<r;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));L(t,t._ranges[t.rangeCount-1],X(t.nativeSelection)),t.isCollapsed=c(t)}else O(t)}};else{if(!E||typeof y.isCollapsed!=n||typeof b.collapsed!=n||!e.features.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;z=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=F(n,0),e._ranges=[t],e.rangeCount=1,A(e),e.isCollapsed=c(e)):O(e)}}q.refresh=function(e){var t=e?this._ranges.slice(0):null;z(this);if(e){var n=t.length;if(n!=this._ranges.length)return!1;while(n--)if(!o.rangesEqual(t[n],this._ranges[n]))return!1;return!0}};var W=function(e,t){var n=e.getAllRanges(),r=!1;e.removeAllRanges();for(var i=0,s=n.length;i<s;++i)r||t!==n[i]?e.addRange(n[i]):r=!0;e.rangeCount||O(e)};C?q.removeRange=function(e){if(this.docSelection.type==h){var t=this.docSelection.createRange(),n=D(e),r=i.getDocument(t.item(0)),s=i.getBody(r).createControlRange(),o,u=!1;for(var a=0,f=t.length;a<f;++a)o=t.item(a),o!==n||u?s.add(t.item(a)):u=!0;s.select(),B(this)}else W(this,e)}:q.removeRange=function(e){W(this,e)};var X;!g&&E&&e.features.implementsDomRange?(X=function(e){var t=!1;return e.anchorNode&&(t=i.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)==1),t},q.isBackwards=function(){return X(this)}):X=q.isBackwards=function(){return!1},q.toString=function(){var e=[];for(var t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},q.collapse=function(t,n){V(this,t);var r=e.createRange(i.getDocument(t));r.collapseToPoint(t,n),this.removeAllRanges(),this.addRange(r),this.isCollapsed=!0},q.collapseToStart=function(){if(!this.rangeCount)throw new a("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},q.collapseToEnd=function(){if(!this.rangeCount)throw new a("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},q.selectAllChildren=function(t){V(this,t);var n=e.createRange(i.getDocument(t));n.selectNodeContents(t),this.removeAllRanges(),this.addRange(n)},q.deleteFromDocument=function(){if(C&&m&&this.docSelection.type==h){var e=this.docSelection.createRange(),t;while(e.length)t=e.item(0),e.remove(t),t.parentNode.removeChild(t);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();this.removeAllRanges();for(var r=0,i=n.length;r<i;++r)n[r].deleteContents();this.addRange(n[i-1])}},q.getAllRanges=function(){return this._ranges.slice(0)},q.setSingleRange=function(e){this.setRanges([e])},q.containsNode=function(e,t){for(var n=0,r=this._ranges.length;n<r;++n)if(this._ranges[n].containsNode(e,t))return!0;return!1},q.toHtml=function(){var e="";if(this.rangeCount){var t=o.getRangeDocument(this._ranges[0]).createElement("div");for(var n=0,r=this._ranges.length;n<r;++n)t.appendChild(this._ranges[n].cloneContents());e=t.innerHTML}return e},q.getName=function(){return"WrappedSelection"},q.inspect=function(){return $(this)},q.detach=function(){this.win[r]=null,this.win=this.anchorNode=this.focusNode=null},I.inspect=$,e.Selection=I,e.selectionPrototype=q,e.addCreateMissingNativeApiListener(function(t){typeof t.getSelection=="undefined"&&(t.getSelection=function(){return e.getSelection(this)}),t=null})}),window.rangy=e}(),define("vendor/rangy-core",function(){}),define("aloha/rangy-core",["jquery","vendor/rangy-core"],function(e){return window.rangy}),define("util/class",[],function(){var e=!1,t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;return this.Class=function(){},Class.extend=function(){function u(){!e&&this._constructor&&this._constructor.apply(this,arguments)}var n=this.prototype;e=!0;var r=new this;e=!1;for(var i=0;i<arguments.length;i++){var s=arguments[i];for(var o in s)r[o]=typeof s[o]=="function"&&typeof n[o]=="function"&&t.test(s[o])?function(e,t){return function(){var r=this._super;this._super=n[e];var i=t.apply(this,arguments);return this._super=r,i}}(o,s[o]):s[o]}return u.prototype=r,u.constructor=u,u.extend=arguments.callee,u},this.Class}),window.GENTICS=window.GENTICS||{},window.GENTICS.Utils=window.GENTICS.Utils||{},define("util/lang",[],function(){}),function(e){var t=e.alohaQuery||e.jQuery,n=t,r=e.GENTICS,i=e.Class,s=e.console;r.Utils.applyProperties=function(e,t){var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r.Utils.uniqeString4=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},r.Utils.guid=function(){var e=r.Utils.uniqeString4;return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}(window),define("aloha/ecma5shims",[],function(){function r(e){var t=null;if(e)do t=e;while(null!=(e=e.parentNode));return t}function i(e,t){return(e.contains(t)&&16)+(t.contains(e)&&8)+(e.sourceIndex>=0&&t.sourceIndex>=0?(e.sourceIndex<t.sourceIndex&&4)+(e.sourceIndex>t.sourceIndex&&2):1)}function s(e){return null!=e.sourceIndex?e:e.parentNode.insertBefore(document.createComment(""),e)}var e,t={bind:function(e){var t=this.obj||this,n=Function.prototype.bind,r=Array.prototype.slice.call(arguments,1);return n?n.apply(t,arguments):function(){return t.apply(e,arguments.length===0?r:r.concat(Array.prototype.slice.call(arguments)))}},trim:function(){var e=this.obj||this,t=String.prototype.trim;return t?t.call(e):e.replace(/^\s+/,"").replace(/\s+$/,"")},indexOf:function(e,t){var n=this.obj||this,r=Array.prototype.indexOf;if(r)return r.call(n,e,t);t===undefined&&(t=0),t<0&&(t+=n.length),t<0&&(t=0);var i;for(i=n.length;t<i;t++)if(undefined!==n[t]&&n[t]===e)return t;return-1},forEach:function(e,t){var n=this.obj||this,r=Array.prototype.forEach;if(r)return r.call(n,e,t);var i,s;for(i=0,s=n.length;i<s;i++)undefined!==n[i]&&e.call(t,n[i],i,n)},map:function(t,n,r){var i=this.obj||this,s=Array.prototype.map,o=typeof arguments[arguments.length-1]=="boolean"?Array.prototype.pop.call(arguments):!1,u=[];if(s)u=s.call(i,t,n);else{var a=[],f,l;for(f=0,l=i.length;f<l;f++)undefined!==i[f]&&(a[f]=t.call(n,i[f],f,i));u=a}return o?e(u):u},filter:function(t,n,r){var i=this.obj||this,s=Array.prototype.filter,o=typeof arguments[arguments.length-1]=="boolean"?Array.prototype.pop.call(arguments):!1,u=[];if(s)u=s.call(i,t,n);else{var a=[],f,l,c;for(l=0,c=i.length;l<c;l++)undefined!==i[l]&&t.call(n,f=i[l],l,i)&&a.push(f);u=a}return o?e(u):u},every:function(e,t){var n=this.obj||this,r=Array.prototype.every;if(r)return r.call(n,e,t);var i,s;for(i=0,s=n.length;i<s;i++)if(undefined!==n[i]&&!e.call(t,n[i],i,n))return!1;return!0},some:function(e,t){var n=this.obj||this,r=Array.prototype.some;if(r)return r.call(n,e,t);var i,s;for(i=0,s=n.length;i<s;i++)if(undefined!==n[i]&&e.call(t,n[i],i,n))return!0;return!1},hasAttribute:function(e){var t=this.obj||this,n=t.hasAttribute;return n?t.hasAttribute(e):!!t.getAttribute(e)}};e=function(e){var n=function(){};n.prototype=t;var r=new n;return r.obj=e,r};var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return typeof window.Node!="undefined"?e.Node=window.Node:e.Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32},e.compareDocumentPosition=function(e,t){if(document.documentElement.compareDocumentPosition)return e.compareDocumentPosition(t);if(!document.documentElement.contains)throw"neither compareDocumentPosition nor contains is supported by this browser.";if(e==t)return 0;if(r(e)!=r(t))return 1;if(null!=e.sourceIndex&&null!=t.sourceIndex)return i(e,t);if(e==document)return 20;if(t==document)return 10;var n=s(e),o=s(t),u=i(n,o);return e!=n&&n.parentNode.removeChild(n),t!=o&&o.parentNode.removeChild(o),u},e.getComputedStyle=function(e,t){return window.getComputedStyle?window.getComputedStyle(e,t):e.currentStyle?e.currentStyle:null},e}),window.GENTICS=window.GENTICS||{},window.GENTICS.Utils=window.GENTICS.Utils||{},define("util/dom",["jquery","util/class","aloha/ecma5shims"],function(e,t,n){var r=window.GENTICS,i={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32},s={P:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,LI:!0},o=t.extend({wordRegex:/[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,nonWordRegex:/[^\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0525\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971\u0972\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D3D\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8B\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCB\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA65F\uA662-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B\uA78C\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA2D\uFA30-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,mergeableTags:["b","code","del","em","i","ins","strong","sub","sup","#text"],nonWordBoundaryTags:["a","b","code","del","em","i","ins","span","strong","sub","sup","#text"],nonEmptyTags:["br"],tags:{flow:["a","abbr","address","area","article","aside","audio","b","bdi","bdo","blockquote","br","button","canvas","cite","code","command","datalist","del","details","dfn","div","dl","em","embed","fieldset","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","menu","meter","nav","noscript","object","ol","output","p","pre","progress","q","ruby","s","samp","script","section","select","small","span","strong","style","sub","sup","svg","table","textarea","time","u","ul","var","video","wbr","#text"],phrasing:["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","command","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","samp","script","select","small","span","strong","sub","sup","svg","textarea","time","u","var","video","wbr","#text"]},children:{a:"phrasing",abbr:"phrasing",address:"flow",area:"empty",article:"flow",aside:"flow",audio:"source",b:"phrasing",base:"empty",bdo:"phrasing",blockquote:"phrasing",body:"flow",br:"empty",button:"phrasing",canvas:"phrasing",caption:"flow",cite:"phrasing",code:"phrasing",col:"empty",colgroup:"col",command:"empty",datalist:["phrasing","option"],dd:"flow",del:"phrasing",div:"flow",details:["summary","flow"],dfn:"flow",dl:["dt","dd"],dt:"phrasing",em:"phrasing",embed:"empty",fieldset:["legend","flow"],figcaption:"flow",figure:["figcaption","flow"],footer:"flow",form:"flow",h1:"phrasing",h2:"phrasing",h3:"phrasing",h4:"phrasing",h5:"phrasing",h6:"phrasing",header:"flow",hgroup:["h1","h2","h3","h4","h5","h6"],hr:"empty",i:"phrasing",iframe:"#text",img:"empty",input:"empty",ins:"phrasing",kbd:"phrasing",keygen:"empty",label:"phrasing",legend:"phrasing",li:"flow",link:"empty",map:"area",mark:"phrasing",menu:["li","flow"],meta:"empty",meter:"phrasing",nav:"flow",noscript:"phrasing",object:"param",ol:"li",optgroup:"option",option:"#text",output:"phrasing",p:"phrasing",param:"empty",pre:"phrasing",progress:"phrasing",q:"phrasing",rp:"phrasing",rt:"phrasing",ruby:["phrasing","rt","rp"],s:"phrasing",samp:"pharsing",script:"#script",section:"flow",select:["option","optgroup"],small:"phrasing",source:"empty",span:"phrasing",strong:"phrasing",style:"phrasing",sub:"phrasing",summary:"phrasing",sup:"phrasing",table:["caption","colgroup","thead","tbody","tfoot","tr"],tbody:"tr",td:"flow",textarea:"#text",tfoot:"tr",th:"phrasing",thead:"tr",time:"phrasing",title:"#text",tr:["th","td"],track:"empty",u:"phrasing",ul:"li","var":"phrasing",video:"source",wbr:"empty"},blockLevelElements:["p","h1","h2","h3","h4","h5","h6","blockquote","div","pre"],listElements:["li","ol","ul"],split:function(t,n,r){var i=e(t.startContainer),s=t.startOffset,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;r&&(i=e(t.endContainer),s=t.endOffset),n.length<1&&(n=e(document.body)),o=!t.isCollapsed()&&!r,a=i.parents().get(),a.unshift(i.get(0)),e.each(a,function(e,t){var r=n.filter(function(){return this==t}).length;if(r)return e>0&&(u=a.slice(0,e)),!1});if(!u)return!0;u=u.reverse();for(h=0,p=u.length;h<p;++h){d=u[h];if(h===p-1)d.nodeType===3?(c=document.createTextNode(d.data.substring(s,d.data.length)),d.data=d.data.substring(0,s)):(v=e(d),m=v.contents(),g=v.clone(!1).empty(),c=g.append(m.slice(s,m.length)).get(0)),o&&t.endContainer===d&&(t.endContainer=c,t.endOffset-=s,t.clearCaches()),l?l.prepend(c):e(d).after(c);else{g=e(d).clone(!1).empty(),f?l.prepend(g):f=g,l=g;for(;;){y=u[h+1].nextSibling;if(!y)break;l.append(y)}if(o&&t.endContainer===d){t.endContainer=g.get(0),b=u[h+1],w=0;for(;;){b=b.previousSibling;if(!b)break;w++}t.endOffset-=w,t.clearCaches()}}}return e(u[0]).after(f),e([u[0],f?f.get(0):c])},allowsNesting:function(t,n){if(!t||!t.nodeName||!n||!n.nodeName)return!1;var r=t.nodeName.toLowerCase(),i=n.nodeName.toLowerCase();return this.children[r]?this.children[r]==i?!0:e.isArray(this.children[r])&&e.inArray(i,this.children[r])>=0?!0:e.isArray(this.tags[this.children[r]])&&e.inArray(i,this.tags[this.children[r]])>=0?!0:!1:!1},addMarkup:function(t,n,r){t.startContainer.nodeType===3&&t.startOffset>0&&t.startOffset<t.startContainer.data.length&&this.split(t,e(t.startContainer).parent(),!1),t.endContainer.nodeType===3&&t.endOffset>0&&t.endOffset<t.endContainer.data.length&&this.split(t,e(t.endContainer).parent(),!0);var i=t.getRangeTree();this.recursiveAddMarkup(i,n,t,r),this.doCleanup({merge:!0,removeempty:!0},t)},recursiveAddMarkup:function(t,n,i,s){var o,u,a;for(o=0,a=t.length;o<a;++o)t[o].type=="full"&&this.allowsNesting(n.get(0),t[o].domobj)?(s||t[o].domobj.nodeName!=n.get(0).nodeName)&&(t[o].domobj.nodeType!==3||e.trim(t[o].domobj.data).length!==0)&&(e(t[o].domobj).wrap(n),!s&&t[o].domobj.nodeType!==3&&(u=new r.Utils.RangeObject,u.startContainer=u.endContainer=t[o].domobj.parentNode,u.startOffset=0,u.endOffset=u.endContainer.childNodes.length,this.removeMarkup(u,n,e(t[o].domobj.parentNode)))):(s||t[o].domobj&&t[o].domobj.nodeName!==n.get(0).nodeName)&&t[o].children&&t[o].children.length>0&&this.recursiveAddMarkup(t[o].children,n)},findHighestElement:function(e,t,n){t=t.toLowerCase();var r,i=e,s=n?function(){return n.filter(function(){return i==this}).length}:function(){return!1};while(!s()&&i)i.nodeName.toLowerCase()===t&&(r=i),i=i.parentNode;return r},removeMarkup:function(t,n,r){var i=n.get(0).nodeName,s=this.findHighestElement(t.startContainer,i,r),o=this.findHighestElement(t.endContainer,i,r),u=!1,a,f,l;s&&t.startOffset>0&&(this.split(t,e(s).parent(),!1),u=!0),o&&(t.endContainer.nodeType===3&&t.endOffset<t.endContainer.data.length&&(this.split(t,e(o).parent(),!0),u=!0),t.endContainer.nodeType===1&&t.endOffset<t.endContainer.childNodes.length&&(this.split(t,e(o).parent(),!0),u=!0)),u&&t.correctRange(),a=this.findHighestElement(t.getCommonAncestorContainer(),i,r),f=a?a.parentNode:t.getCommonAncestorContainer(),f&&(l=t.getRangeTree(f),this.recursiveRemoveMarkup(l,n),this.doCleanup({merge:!0,removeempty:!0},t,f))},recursiveRemoveMarkup:function(t,n){var r,i,s;for(r=0,i=t.length;r<i;++r)t[r].type=="full"&&t[r].domobj.nodeName==n.get(0).nodeName&&(s=e(t[r].domobj).contents(),s.length>0?s.first().unwrap():e(t[r].domobj).remove()),t[r].children&&this.recursiveRemoveMarkup(t[r].children,n)},doCleanup:function(t,n,i){var s=this,o,u,a,f,l;return typeof t=="undefined"&&(t={}),typeof t.merge=="undefined"&&(t.merge=!1),typeof t.removeempty=="undefined"&&(t.removeempty=!1),typeof i=="undefined"&&n&&(i=n.getCommonAncestorContainer()),o=!1,u=!1,a=e(i),f=n.startOffset,l=n.endOffset,a.contents().each(function(){var i,c;try{c=this.nodeType,i=s.getIndexInParent(this)}catch(h){return}switch(c){case 1:if(o&&o.nodeName==this.nodeName)n.startContainer===a&&f>i&&(n.startOffset-=1,u=!0),n.endContainer===a&&l>i&&(n.endOffset-=1
,u=!0),e(o).append(e(this).contents()),u|=s.doCleanup(t,n,o),e(this).remove();else{u|=s.doCleanup(t,n,this);var p=!1;t.removeempty&&(r.Utils.Dom.isBlockLevelElement(this)&&this.childNodes.length===0&&(p=!0),e.inArray(this.nodeName.toLowerCase(),s.mergeableTags)>=0&&e(this).text().length===0&&this.childNodes.length===0&&(p=!0)),p?(n.startContainer===this.parentNode&&f>i&&(n.startOffset=n.startOffset-1,u=!0),n.endContainer===this.parentNode&&l>i&&(n.endOffset=n.endOffset-1,u=!0),e(this).remove()):e.inArray(this.nodeName.toLowerCase(),s.mergeableTags)>=0?o=this:o=!1}break;case 3:if(o&&o.nodeType===3&&t.merge)n.startContainer===this?(n.startContainer=o,n.startOffset+=o.nodeValue.length,u=!0):n.startContainer===o.parentNode&&n.startOffset===s.getIndexInParent(o)+1&&(n.startContainer=o,n.startOffset=o.nodeValue.length,u=!0),n.endContainer===this?(n.endContainer=o,n.endOffset+=o.nodeValue.length,u=!0):n.endContainer===o.parentNode&&n.endOffset===s.getIndexInParent(o)+1&&(n.endContainer=o,n.endOffset=o.nodeValue.length,u=!0),o.data+=this.data;else if(this.nodeValue!==""||!t.removeempty){o=this;break}n.startContainer===this.parentNode&&n.startOffset>i&&(n.startOffset=n.startOffset-1,u=!0),n.endContainer===this.parentNode&&n.endOffset>i&&(n.endOffset=n.endOffset-1,u=!0),e(this).remove();if(o&&(!o.nextSibling||o.nextSibling.nodeType!==3)){var d;for(d=o.data.length-1;d>=0&&o.data.length>1;d--)o.data.charAt(d)==="​"&&(o.deleteData(d,1),n.startContainer===o&&n.startOffset>d&&(n.startOffset--,u=!0),n.endContainer===o&&n.endOffset>d&&(n.endOffset--,u=!0))}}}),u&&n.clearCaches(),u},getIndexInParent:function(e){if(!e)return!1;var t=0,n=e.previousSibling;while(n)t++,n=n.previousSibling;return t},isBlockLevelElement:function(t){return t?t.nodeType===1&&e.inArray(t.nodeName.toLowerCase(),this.blockLevelElements)>=0?!0:!1:!1},isLineBreakElement:function(e){return e?e.nodeType===1&&e.nodeName.toLowerCase()=="br":!1},isListElement:function(t){return t?t.nodeType===1&&e.inArray(t.nodeName.toLowerCase(),this.listElements)>=0:!1},isSplitObject:function(e){return e.nodeType===1&&s.hasOwnProperty(e.nodeName)},searchAdjacentTextNode:function(t,n,r,i){if(!t||t.nodeType!==1||n<0||n>t.childNodes.length)return!1;typeof i=="undefined"&&(i={blocklevel:!0,list:!0,linebreak:!0}),typeof i.blocklevel=="undefined"&&(i.blocklevel=!0),typeof i.list=="undefined"&&(i.list=!0),typeof i.linebreak=="undefined"&&(i.linebreak=!0),typeof r=="undefined"&&(r=!0);var s,o=t;r&&n>0&&(s=t.childNodes[n-1]),!r&&n<t.childNodes.length&&(s=t.childNodes[n]);while(o){if(!s){if(i.blocklevel&&this.isBlockLevelElement(o))return!1;if(i.list&&this.isListElement(o))return!1;s=r?o.previousSibling:o.nextSibling,o=o.parentNode;continue}if(s.nodeType===3&&e.trim(s.data).length>0)return s;if(i.blocklevel&&this.isBlockLevelElement(s))return!1;if(i.linebreak&&this.isLineBreakElement(s))return!1;if(i.list&&this.isListElement(s))return!1;s.nodeType===3?s=r?s.previousSibling:s.nextSibling:(o=s,s=r?s.lastChild:s.firstChild)}},insertIntoDOM:function(t,n,r,i,s){var o=n.getContainerParents(r,i),u=this,a,f,l,c,h;r||(r=e(document.body)),o.length===0?a=r.get(0):e.each(o,function(e,n){if(u.allowsNesting(n,t.get(0)))return a=n,!1}),typeof a=="undefined"&&r.length>0&&(a=r.get(0));if(!this.allowsNesting(a,t.get(0))&&!s)return!1;if(typeof a!="undefined")return c=this.split(n,e(a),i),c===!0?(f=n.startContainer,l=n.startOffset,i&&(f=n.endContainer,l=n.endOffset),l===0?(h=e(f).contents(),h.length>0?h.eq(0).before(t):e(f).append(t),!0):(e(f).contents().eq(l-1).after(t),!0)):c?(c.eq(0).after(t),!0):!1;return!1},removeFromDOM:function(t,n,r){if(r){var i=this.getIndexInParent(t),s=e(t).contents().length,o=t.parentNode;n.startContainer==o&&n.startOffset>i?n.startOffset+=s-1:n.startContainer==t&&(n.startContainer=o,n.startOffset=i+n.startOffset),n.endContainer==o&&n.endOffset>i?n.endOffset+=s-1:n.endContainer==t&&(n.endContainer=o,n.endOffset=i+n.endOffset),e(t).contents().unwrap(),this.doCleanup({merge:!0},n,o)}},removeRange:function(t){if(!t)return!1;if(t.isCollapsed())return!1;t.startContainer.nodeType==3&&t.startOffset>0&&t.startOffset<t.startContainer.data.length&&this.split(t,e(t.startContainer).parent(),!1),t.endContainer.nodeType==3&&t.endOffset>0&&t.endOffset<t.endContainer.data.length&&this.split(t,e(t.endContainer).parent(),!0);var n=t.getRangeTree();t.endContainer=t.startContainer,t.endOffset=t.startOffset,this.recursiveRemoveRange(n,t),this.doCleanup({merge:!0},t),t.clearCaches()},recursiveRemoveRange:function(t,n){var r;for(r=0;r<t.length;++r)t[r].type=="full"?(e(n.startContainer).parents().andSelf().filter(t[r].domobj).length>0&&(n.startContainer=n.endContainer=t[r].domobj.parentNode,n.startOffset=n.endOffset=this.getIndexInParent(t[r].domobj)),e(t[r].domobj).remove()):t[r].type=="partial"&&t[r].children&&this.recursiveRemoveRange(t[r].children,n)},extendToWord:function(e,t){var n=this.searchWordBoundary(e.startContainer,e.startOffset,!0),r=this.searchWordBoundary(e.endContainer,e.endOffset,!1);if(!t){if(e.startContainer==n.container&&e.startOffset==n.offset)return;if(e.endContainer==r.container&&e.endOffset==r.offset)return}e.startContainer=n.container,e.startOffset=n.offset,e.endContainer=r.container,e.endOffset=r.offset,e.correctRange(),e.clearCaches()},isWordBoundaryElement:function(t){return!t||!t.nodeName?!1:e.inArray(t.nodeName.toLowerCase(),this.nonWordBoundaryTags)==-1},searchWordBoundary:function(e,t,n){typeof n=="undefined"&&(n=!0);var r=!1,i,s,o;while(!r)if(e.nodeType===3)if(!n)i=e.data.substring(t).search(this.nonWordRegex),i!=-1?(t+=i,r=!0):(t=this.getIndexInParent(e)+1,e=e.parentNode);else{i=e.data.substring(0,t).search(this.nonWordRegex),s=i;while(s!=-1)i=s,s=e.data.substring(i+1,t).search(this.nonWordRegex),s!=-1&&(s=s+i+1);i!=-1?(t=i+1,r=!0):(t=this.getIndexInParent(e),e=e.parentNode)}else e.nodeType===1&&(n?t>0?this.isWordBoundaryElement(e.childNodes[t-1])?r=!0:(e=e.childNodes[t-1],t=e.nodeType===3?e.data.length:e.childNodes.length):this.isWordBoundaryElement(e)?r=!0:(t=this.getIndexInParent(e),e=e.parentNode):t<e.childNodes.length?this.isWordBoundaryElement(e.childNodes[t])?r=!0:(e=e.childNodes[t],t=0):this.isWordBoundaryElement(e)?r=!0:(t=this.getIndexInParent(e)+1,e=e.parentNode));return e.nodeType!==3&&(o=this.searchAdjacentTextNode(e,t,!n),o&&(e=o,t=n?0:e.data.length)),{container:e,offset:t}},isEmpty:function(t){if(!t)return!0;if(e.inArray(t.nodeName.toLowerCase(),this.nonEmptyTags)!=-1)return!1;if(t.nodeType===3)return t.data.search(/\S/)==-1;var n,r;for(n=0,r=t.childNodes.length;n<r;++n)if(!this.isEmpty(t.childNodes[n]))return!1;return!0},setCursorAfter:function(e){var t=new r.Utils.RangeObject,n=this.getIndexInParent(e),i,s;return e.nodeType==3?(i=e,s=i.nodeValue.length):e.nextSibling&&e.nextSibling.nodeType==3?(i=e.nextSibling,s=0):(i=e.parentNode,s=this.getIndexInParent(e)+1),t.startContainer=t.endContainer=i,t.startOffset=t.endOffset=s,t.select(),t},selectDomNode:function(e){var t=new r.Utils.RangeObject;t.startContainer=t.endContainer=e.parentNode,t.startOffset=this.getIndexInParent(e),t.endOffset=t.startOffset+1,t.select()},setCursorInto:function(e){var t=new r.Utils.RangeObject;t.startContainer=t.endContainer=e,t.startOffset=t.endOffset=0,t.select()},isEditingHost:function(e){return e&&e.nodeType==1&&(e.contentEditable=="true"||e.parentNode&&e.parentNode.nodeType==9&&e.parentNode.designMode=="on")},isEditable:function(e){return e&&!this.isEditingHost(e)&&(e.nodeType!=1||e.contentEditable!="false")&&(this.isEditingHost(e.parentNode)||this.isEditable(e.parentNode))},getEditingHostOf:function(e){if(this.isEditingHost(e))return e;if(this.isEditable(e)){var t=e.parentNode;while(!this.isEditingHost(t))t=t.parentNode;return t}return null},inSameEditingHost:function(e,t){return this.getEditingHostOf(e)&&this.getEditingHostOf(e)==this.getEditingHostOf(t)},isBlockNode:function(e){return e&&(e.nodeType==n.Node.ELEMENT_NODE&&n(["inline","inline-block","inline-table","none"]).indexOf(n.getComputedStyle(e).display)==-1||e.nodeType==n.Node.DOCUMENT_NODE||e.nodeType==n.Node.DOCUMENT_FRAGMENT_NODE)},getFirstVisibleChild:function(t,r){if(!t)return null;if(t.nodeType==n.Node.TEXT_NODE&&this.isEmpty(t)||t.nodeType==n.Node.ELEMENT_NODE&&t.offsetHeight==0&&e.inArray(t.nodeName.toLowerCase(),this.nonEmptyTags)===-1)return null;if(t.nodeType==n.Node.TEXT_NODE||t.nodeType==n.Node.ELEMENT_NODE&&t.childNodes.length==0||!e(t).contentEditable())return r?t:null;var i;for(i=0;i<t.childNodes.length;++i){var s=this.getFirstVisibleChild(t.childNodes[i],!0);if(s!=null)return s}return null},getLastVisibleChild:function(t,r){if(!t)return null;if(t.nodeType==n.Node.TEXT_NODE&&this.isEmpty(t)||t.nodeType==n.Node.ELEMENT_NODE&&t.offsetHeight==0&&e.inArray(t.nodeName.toLowerCase(),this.nonEmptyTags)===-1)return null;if(t.nodeType==n.Node.TEXT_NODE||t.nodeType==n.Node.ELEMENT_NODE&&t.childNodes.length==0||!e(t).contentEditable())return r?t:null;var i;for(i=t.childNodes.length-1;i>=0;--i){var s=this.getLastVisibleChild(t.childNodes[i],!0);if(s!=null)return s}return null}});return r.Utils.Dom=new o,r.Utils.Dom}),define("aloha/pluginmanager",["jquery","util/class"],function(e,t){var n=window.Aloha;return new(t.extend({plugins:{},init:function(e,t){var r=this,i=n&&n.settings?n.settings.plugins||{}:{},s,o,u;for(u in i)i.hasOwnProperty(u)&&(o=this.plugins[u]||!1,o&&(o.settings=i[u]||{}));if(!t.length)for(u in this.plugins)this.plugins.hasOwnProperty(u)&&t.push(u);for(s=0;s<t.length;++s)u=t[s],o=this.plugins[u]||!1,o&&(o.settings=o.settings||{},typeof o.settings.enabled=="undefined"&&(o.settings.enabled=!0),o.settings.enabled&&o.checkDependencies()&&o.init());e()},register:function(e){if(!e.name)throw new Error("Plugin does not have an name.");if(this.plugins[e.name])throw new Error('Already registered the plugin "'+e.name+'"!');this.plugins[e.name]=e},makeClean:function(e){var t,r;for(r in this.plugins)this.plugins.hasOwnProperty(r)&&(n.Log.isDebugEnabled()&&n.Log.debug(this,"Passing contents of HTML Element with id { "+e.attr("id")+" } for cleaning to plugin { "+r+" }"),this.plugins[r].makeClean(e))},toString:function(){return"pluginmanager"}}))}),define("aloha/core",["jquery","aloha/pluginmanager"],function(e,t){var n=window.Aloha;return e.extend(!0,n,{version:"${version}",editables:[],activeEditable:null,settings:{},defaults:{},ui:{},OSName:"Unknown",stage:"loadingAloha",loadedPlugins:[],_pluginBaseUrlByName:{},init:function(){n.stage="initAloha",n.initAloha(function(){n.stage="initPlugins",n.initPlugins(function(){n.stage="initGui",n.initGui(function(){n.stage="alohaReady",n.trigger("aloha-ready")})})})},getLoadedPlugins:function(){return this.loadedPlugins},isPluginLoaded:function(t){var n=!1;return e.each(this.loadedPlugins,function(){t.toString()===this.toString()&&(n=!0)}),n},initAloha:function(t){var r=e("html");(e.browser.webkit&&parseInt(e.browser.version,10)<20||e.browser.mozilla&&parseFloat(e.browser.version)<1.9||e.browser.msie&&e.browser.version<7||e.browser.opera&&e.browser.version<11)&&window.console&&window.console.log&&window.console.log("Your browser is not supported."),e("html").mousedown(function(t){n.activeEditable&&!e(".aloha-dialog").is(":visible")&&!n.eventHandled&&(n.activeEditable.blur(),n.activeEditable=null)}).mouseup(function(e){n.eventHandled=!1}),e.browser.webkit?r.addClass("aloha-webkit"):e.browser.opera?r.addClass("aloha-opera"):e.browser.msie?r.addClass("aloha-ie"+parseInt(e.browser.version,10)):e.browser.mozilla&&r.addClass("aloha-mozilla"),n.settings.base=n.getAlohaUrl(),n.Log.init(),n.settings.errorhandling&&(window.onerror=function(e,t,r){return n.Log.error(n,"Error message: "+e+"\nURL: "+t+"\nLine Number: "+r),!0}),navigator.appVersion.indexOf("Win")!=-1&&(n.OSName="Win"),navigator.appVersion.indexOf("Mac")!=-1&&(n.OSName="Mac"),navigator.appVersion.indexOf("X11")!=-1&&(n.OSName="Unix"),navigator.appVersion.indexOf("Linux")!=-1&&(n.OSName="Linux"),t()},initPlugins:function(e){t.init(e,this.getLoadedPlugins())},initGui:function(e){var t,r;n.RepositoryManager.init();for(t=0,r=n.editables.length;t<r;t++)n.editables[t].ready||n.editables[t].init();e()},activateEditable:function(e){var t;for(t=0;t<n.editables.length;t++)n.editables[t]!=e&&n.editables[t].isActive&&n.editables[t].blur();n.activeEditable=e},getActiveEditable:function(){return n.activeEditable},deactivateEditable:function(){if(typeof n.activeEditable=="undefined"||n.activeEditable===null)return;n.activeEditable.blur(),n.activeEditable=null},getEditableById:function(t){var r,i;e("#"+t).get(0).nodeName.toLowerCase()==="textarea"&&(t+="-aloha");for(r=0,i=n.editables.length;r<i;r++)if(n.editables[r].getId()==t)return n.editables[r];return null},isEditable:function(e){var t,r;for(t=0,r=n.editables.length;t<r;t++)if(n.editables[t].originalObj.get(0)===e)return!0;return!1},getEditableHost:function(e){var t,r,i,s=n.editables.length;if(!e)return;return t=e.parents().andSelf().each(function(){for(r=0;r<s;r++)if(n.editables[r].originalObj.get(0)===this)return i=n.editables[r],!1}),i},log:function(e,t,r){typeof n.Log!="undefined"&&n.Log.log(e,t,r)},registerEditable:function(e){n.editables.push(e)},unregisterEditable:function(t){var r=e.inArray(t,n.editables);r!=-1&&n.editables.splice(r,1)},toString:function(){return"Aloha"},isModified:function(){var e;for(e=0;e<n.editables.length;e++)if(n.editables[e].isModified&&n.editables[e].isModified())return!0;return!1},getAlohaUrl:function(e){return n.settings.baseUrl},getPluginUrl:function(e){var t;return e&&(t=n.settings._pluginBaseUrlByName[e],t&&(t.match("^(/|http[s]?:).*")||(t=n.getAlohaUrl()+"/"+t))),t},disableObjectResizing:function(){try{var e;try{e=document.queryCommandSupported("enableObjectResizing")}catch(t){e=!1,n.Log.log("enableObjectResizing is not supported.")}e&&(document.execCommand("enableObjectResizing",!1,!1),n.Log.log("enableObjectResizing disabled."))}catch(r){n.Log.error(r,"Could not disable enableObjectResizing")}}}),n}),define("aloha/console",["aloha/core","util/class","jquery"],function(e,t,n){var r=t.extend({init:function(){if(typeof e.settings.logLevels=="undefined"||!e.settings.logLevels)e.settings.logLevels={error:!0,warn:!0};if(typeof e.settings.logHistory=="undefined"||!e.settings.logHistory)e.settings.logHistory={};e.settings.logHistory.maxEntries||(e.settings.logHistory.maxEntries=100),e.settings.logHistory.highWaterMark||(e.settings.logHistory.highWaterMark=90),e.settings.logHistory.levels||(e.settings.logHistory.levels={error:!0,warn:!0}),this.flushLogHistory(),e.trigger("aloha-logger-ready")},logHistory:[],highWaterMarkReached:!1,log:function(t,n,r){typeof n=="undefined"&&(r=t),typeof n!="string"&&n&&n.toString&&(n=n.toString()),typeof r=="undefined"&&(r=n,n=undefined);if(typeof t=="undefined"||!t)t="log";t=t.toLowerCase();if(typeof e.settings.logLevels=="undefined")return;if(!e.settings.logLevels[t])return;n=n||"Unkown Aloha Component",this.addToLogHistory({level:t,component:n,message:r,date:new Date});var i=window.console;switch(t){case"error":window.console&&i.error&&(!n&&!r?i.error("Error occured without message and component"):i.error(n+": "+r));break;case"warn":window.console&&i.warn&&i.warn(n+": "+r);break;case"info":window.console&&i.info&&i.info(n+": "+r);break;case"debug":window.console&&i.log&&i.log(n+" ["+t+"]: "+r);break;default:window.console&&i.log&&i.log(n+" ["+t+"]: "+r)}},error:function(e,t){this.log("error",e,t)},warn:function(e,t){this.log("warn",e,t)},info:function(e,t){this.log("info",e,t)},debug:function(e,t){this.log("debug",e,t)},deprecated:function(t,n){this.log("warn",t,n);if(e.settings.logLevels.deprecated)throw new Error(n)},isLogLevelEnabled:function(t){return e.settings&&e.settings.logLevels&&e.settings.logLevels[t]},isErrorEnabled:function(){return this.isLogLevelEnabled("error")},isWarnEnabled:function(){return this.isLogLevelEnabled("warn")},isInfoEnabled:function(){return this.isLogLevelEnabled("info")},isDebugEnabled:function(){return this.isLogLevelEnabled("debug")},addToLogHistory:function(t){e.settings.logHistory||this.init();if(e.settings.logHistory.maxEntries<=0||!e.settings.logHistory.levels[t.level])return;this.logHistory.push(t),this.highWaterMarkReached||this.logHistory.length>=e.settings.logHistory.maxEntries*e.settings.logHistory.highWaterMark/100&&(e.trigger("aloha-log-full"),this.highWaterMarkReached=!0);while(this.logHistory.length>e.settings.logHistory.maxEntries)this.logHistory.shift()},getLogHistory:function(){return this.logHistory},flushLogHistory:function(){this.logHistory=[],this.highWaterMarkReached=!1}});return r=new r,e.Log=e.Console=r,r}),window.GENTICS=window.GENTICS||{},window.GENTICS.Utils=window.GENTICS.Utils||{},define("util/range",["jquery","util/dom","util/class","aloha/console","aloha/rangy-core"],function(e,t,n,r,i){function u(e,t){var n=[],r;1===e.nodeType?r=e:r=e.parentNode;for(;;){if(!r||r===t||9===r.nodeType)break;1===r.nodeType&&n.push(r),r=r.parentNode}return n}var s=window.GENTICS,o=window.Aloha;return s.Utils.RangeObject=n.extend({_constructor:function(e){typeof e=="object"?(typeof e.startContainer!="undefined"&&(this.startContainer=e.startContainer),typeof e.startOffset!="undefined"&&(this.startOffset=e.startOffset),typeof e.endContainer!="undefined"&&(this.endContainer=e.endContainer),typeof e.endOffset!="undefined"&&(this.endOffset=e.endOffset)):e===!0&&this.initializeFromUserSelection()},startContainer:undefined,startOffset:undefined,endContainer:undefined,endOffset:undefined,deleteContents:function(){t.removeRange(this)},log:function(e){r.deprecated("Utils.RangeObject",'log() is deprecated. use console.log() from module "aloha/console" instead: '+e)},isCollapsed:function(){return!this.endContainer||this.startContainer===this.endContainer&&this.startOffset===this.endOffset},getCommonAncestorContainer:function(){return this.commonAncestorContainer?this.commonAncestorContainer:(this.updateCommonAncestorContainer(),this.commonAncestorContainer)},getContainerParents:function(t,n){var r=n?this.endContainer:this.startContainer;return r?e(u(r,t?t[0]:null)):!1},getStartContainerParents:function(e){return this.getContainerParents(e,!1)},getEndContainerParents:function(e){return this.getContainerParents(e,!0)},updateCommonAncestorContainer:function(e){if(!e){var t=this.getStartContainerParents(),n=this.getEndContainerParents(),i;if(!(t.length>0&&n.length>0))return r.warn("aloha/range","could not find commonAncestorContainer"),!1;for(i=0;i<t.length;i++)if(n.index(t[i])!=-1){this.commonAncestorContainer=t[i];break}}else this.commonAncestorContainer=e;return r.debug(e?"commonAncestorContainer was set successfully":"commonAncestorContainer was calculated successfully"),!0},getCollapsedIERange:function(e,t){var n=document.body.createTextRange(),r,i,s,o;return o=this.searchElementToLeft(e,t),o.element?(r=document.body.createTextRange(),r.moveToElementText(o.element),n.setEndPoint("StartToEnd",r),o.characters!==0?n.moveStart("character",o.characters):(n.moveStart("character",1),n.moveStart("character",-1))):(i=this.searchElementToRight(e,t),s=e.nodeType==3?e.parentNode:e,r=document.body.createTextRange(),r.moveToElementText(s),n.setEndPoint("StartToStart",r),o.characters!==0&&n.moveStart("character",o.characters)),n.collapse(),n},select:function(){var e,t,n,s,o;if(typeof this.startContainer=="undefined"||typeof this.endContainer=="undefined")return r.warn("can not select an empty range"),!1;s=i.createRange(),s.setStart(this.startContainer,this.startOffset),s.setEnd(this.endContainer,this.endOffset),o=i.getSelection(),o.setSingleRange(s)},searchElementToLeft:function(e,t){var n,r=0;e.nodeType===3?(r=t,n=e.previousSibling):t>0&&(n=e.childNodes[t-1]);while(n&&n.nodeType===3)r+=n.data.length,n=n.previousSibling;return{element:n,characters:r}},searchElementToRight:function(e,t){var n,r=0;e.nodeType===3?(r=e.data.length-t,n=e.nextSibling):t<e.childNodes.length&&(n=e.childNodes[t]);while(n&&n.nodeType===3)r+=n.data.length,n=n.nextSibling;return{element:n,characters:r}},update:function(e){r.debug("now updating rangeObject"),this.initializeFromUserSelection(e),this.updateCommonAncestorContainer()},initializeFromUserSelection:function(e){var t=i.getSelection(),n;if(!t)return!1;if(!t.rangeCount)return!1;n=t.getRangeAt(0);if(!n)return!1;this.startContainer=n.startContainer,this.endContainer=n.endContainer,this.startOffset=n.startOffset,this.endOffset=n.endOffset,this.correctRange();return},correctRange:function(){var t,n,r,i,u;this.clearCaches();if(this.isCollapsed()){if(this.startContainer.nodeType===1){if(this.startOffset>0&&this.startContainer.childNodes[this.startOffset-1].nodeType===3){this.startContainer=this.startContainer.childNodes[this.startOffset-1],this.startOffset=this.startContainer.data.length,this.endContainer=this.startContainer,this.endOffset=this.startOffset;return}if(this.startOffset>0&&this.startContainer.childNodes[this.startOffset-1].nodeType===1){t=s.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!0);if(t){this.startContainer=this.endContainer=t,this.startOffset=this.endOffset=t.data.length;return}t=s.Utils.Dom.searchAdjacentTextNode(this.startContainer,this.startOffset,!1);if(t){this.startContainer=this.endContainer=t,this.startOffset=this.endOffset=0;return}}if(this.startOffset<this.startContainer.childNodes.length&&this.startContainer.childNodes[this.startOffset].nodeType===3){this.startContainer=this.startContainer.childNodes[this.startOffset],this.startOffset=0,this.endContainer=this.startContainer,this.endOffset=0;return}}this.startContainer.nodeType===3&&this.startOffset===0&&(t=s.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,s.Utils.Dom.getIndexInParent(this.startContainer),!0),t&&e(t).closest(o.activeEditable.obj).length>0&&(this.startContainer=this.endContainer=t,this.startOffset=this.endOffset=t.data.length))}else{if(this.startContainer.nodeType===1)if(this.startOffset<this.startContainer.childNodes.length&&this.startContainer.childNodes[this.startOffset].nodeType===3)this.startContainer=this.startContainer.childNodes[this.startOffset],this.startOffset=0;else if(this.startOffset<this.startContainer.childNodes.length&&this.startContainer.childNodes[this.startOffset].nodeType===1){n=!1,r=this.startContainer.childNodes[this.startOffset];while(n===!1&&r.childNodes&&r.childNodes.length>0)r=r.childNodes[0],r.nodeType===3&&(n=r);n!==!1&&(this.startContainer=n,this.startOffset=0)}this.startContainer.nodeType===3&&this.startOffset===this.startContainer.data.length&&(t=s.Utils.Dom.searchAdjacentTextNode(this.startContainer.parentNode,s.Utils.Dom.getIndexInParent(this.startContainer)+1,!1),t&&(this.startContainer=t,this.startOffset=0));if(this.endContainer.nodeType===3&&this.endOffset===0)if(this.endContainer.previousSibling&&this.endContainer.previousSibling.nodeType===3)this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.data.length;else if(this.endContainer.previousSibling&&this.endContainer.previousSibling.nodeType===1&&this.endContainer.parentNode){i=this.endContainer.parentNode;for(u=0;u<i.childNodes.length;++u)if(i.childNodes[u]==this.endContainer){this.endOffset=u;break}this.endContainer=i}this.endContainer.nodeType==1&&this.endOffset===0&&this.endContainer.previousSibling&&(this.endContainer.previousSibling.nodeType===3?(this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.data.length):this.endContainer.previousSibling.nodeType===1&&this.endContainer.previousSibling.childNodes&&this.endContainer.previousSibling.childNodes.length>0&&(this.endContainer=this.endContainer.previousSibling,this.endOffset=this.endContainer.childNodes.length));if(this.endContainer.nodeType==1)if(this.endOffset>0&&this.endContainer.childNodes[this.endOffset-1].nodeType===3)this.endContainer=this.endContainer.childNodes[this.endOffset-1],this.endOffset=this.endContainer.data.length;else if(this.endOffset>0&&this.endContainer.childNodes[this.endOffset-1].nodeType===1){n=!1,r=this.endContainer.childNodes[this.endOffset-1];while(n===!1&&r.childNodes&&r.childNodes.length>0)r=r.childNodes[r.childNodes.length-1],r.nodeType===3&&(n=r);n!==!1&&(this.endContainer=n,this.endOffset=this.endContainer.data.length)}}},clearCaches:function(){this.commonAncestorContainer=undefined},getRangeTree:function(e){return typeof e=="undefined"&&(e=this.getCommonAncestorContainer()),this.inselection=!1,this.recursiveGetRangeTree(e)},recursiveGetRangeTree:function(t){var n=e(t),r=0,i=this,o=[];return n.contents().each(function(e){var n="none",u=!1,a=!1,f=!1,l=!1,c=!1,h=!1,p;i.isCollapsed()&&t===i.startContainer&&i.startOffset===e&&(o[r]=new s.Utils.RangeTree,o[r].type="collapsed",o[r].domobj=undefined,i.inselection=!1,f=!0,r++);if(!i.inselection&&!f)switch(this.nodeType){case 3:this===i.startContainer&&(i.inselection=!0,n=i.startOffset>0?"partial":"full",u=i.startOffset,a=this.length);break;case 1:this===i.startContainer&&i.startOffset===0&&(i.inselection=!0,n="full"),t===i.startContainer&&i.startOffset===e&&(i.inselection=!0,n="full")}if(i.inselection&&!f){n=="none"&&(n="full");switch(this.nodeType){case 3:this===i.endContainer&&(i.inselection=!1,i.endOffset<this.length&&(n="partial"),u===!1&&(u=0),a=i.endOffset);break;case 1:this===i.endContainer&&i.endOffset===0&&(i.inselection=!1)}t===i.endContainer&&i.endOffset<=e&&(i.inselection=!1,n="none")}o[r]=new s.Utils.RangeTree,o[r].domobj=this,o[r].type=n,n=="partial"&&(o[r].startOffset=u,o[r].endOffset=a),o[r].children=i.recursiveGetRangeTree(this);if(o[r].children.length>0){for(p=0;p<o[r].children.length;++p)switch(o[r].children[p].type){case"none":l=!0;break;case"full":h=!0;break;case"partial":c=!0}c||h&&l?o[r].type="partial":h&&!c&&!l&&(o[r].type="full")}r++}),this.isCollapsed()&&t===this.startContainer&&this.startOffset==t.childNodes.length&&(o[r]=new s.Utils.RangeTree,o[r].type="collapsed",o[r].domobj=undefined),o},findMarkup:function(e,t,n){var r=n?this.endContainer:this.startContainer,i,s,o;t=t?t[0]:null;if(!r)return;i=u(r,t);for(s=0,o=i.length;s<o;s++)if(e.apply(i[s]))return i[s];return!1},getText:function(){return this.isCollapsed()?"":this.recursiveGetText(this.getRangeTree())},recursiveGetText:function(t){if(!t)return"";var n=this,r="";return e.each(t,function(){this.type=="full"?r+=e(this.domobj).text():this.type=="partial"&&this.domobj.nodeType===3?r+=e(this.domobj).text().substring(this.startOffset,this.endOffset):this.type=="partial"&&this.domobj.nodeType===1&&this.children&&(r+=n.recursiveGetText(this.children))}),r}}),s.Utils.RangeTree=n.extend({domobj:{},type:null,children:[]}),s.Utils.RangeObject}),define("util/arrays",[],function(){function e(e,t){var n;if(t){e.sort(t);for(n=1;n<e.length;n++)0===t(e[n],e[n-1])&&e.splice(n--,1)}else{e.sort();for(n=1;n<e.length;n++)e[n]==e[n-1]&&e.splice(n--,1)}return e}function t(e,t,n){var r,i=e.length;if(i!==t.length)return!1;if(n){for(r=0;r<i;r++)if(!n(e[r],t[r]))return!1}else for(r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}function n(e,t){var n,r,i=[];for(n=0,r=e.length;n<r;n++)i.push(t(e[n]));return i}function r(e,t){return e.map(t)}function i(e,t){var n,r,i,s=[];for(n=0,r=e.length;n<r;n++)i=e[n],t(i)&&s.push(i);return s}function s(e,t){var n,r;for(n=0,r=e.length;n<r;n++)if(t===e[n])return n;return-1}function o(e,t,n){var r,i;for(r=0,i=e.length;r<i;r++)t=n(t,e[r]);return t}function u(e,t){return e==null?null:t(e)}return{filter:i,indexOf:s,reduce:o,applyNotNull:u,sortUnique:e,equal:t,map:Array.prototype.map?r:n}}),define("util/strings",["jquery"],function(e){function n(e){var n=e.split(t);return n.length&&n[0]===""&&n.shift(),n.length&&n[n.length-1]===""&&n.pop(),n}function r(e){return e.replace(/[\-]([a-z])/gi,function(e,t){return t.toUpperCase()})}function i(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}var t=/\s+/;return{words:n,dashesToCamelCase:r,camelCaseToDashes:i}}),define("PubSub",[],function(){function r(n){return t[n]&&e[t[n].channel]}function i(n,r){if(!e[n])return 0;r?typeof r!="object"&&(r={data:r}):r={},r.channel=n;var i=e[n].slice(),s;for(s=0;s<i.length;++s)t[i[s]].callback(r);return s}var e={},t={},n=0,s={sub:function(r,i){if(typeof i!="function")return-1;var s=e[r];return s||(s=e[r]=[]),s.push(++n),t[n]={channel:r,callback:i},n},unsub:function(e){if(-1===e||!t[e])return!1;var n=r(e);delete t[e];var i=n.length;while(i)if(n[--i]===e)return n.splice(i,1),!0;return!1},pub:function(e,t){var n=e.split("."),r,s=n.length,o="",u=0;for(r=0;r<s;++r)o+=(0===r?"":".")+n[r],u+=i(o,t);return u}};return s}),define("aloha/engine",["aloha/core","aloha/ecma5shims","jquery"],function(e,t,n){function r(e,t){var n=e.hasAttribute;return n?e.hasAttribute(t):typeof e.attributes[t]!="undefined"}function a(e){return e===null||!e||e===i}function f(e,n){return typeof n=="string"&&(n=[n]),typeof n=="object"&&(n=t(n).map(function(e){return e.toUpperCase()})),e&&e.nodeType==1&&a(e.namespaceURI)&&(typeof n=="undefined"||t(n).indexOf(e.tagName)!=-1)}function l(e){return e&&e.nodeType==1&&a(e.namespaceURI)}function c(e,t){return e&&e.nodeType==1&&a(e.namespaceURI)&&t.toUpperCase()===e.nodeName}function h(e,t){var n,r;t=t.toUpperCase();for(n=0,r=e.length;n<r;n++)if(e[n].toUpperCase()===t)return!0;return!1}function p(e,t){return e&&e.nodeType==1&&a(e.namespaceURI)&&h(t,e.nodeName)}function d(e,t){return e&&e.nodeType==1&&a(e.namespaceURI)&&t[e.nodeName]}function v(e){var t,n=0;if(!e)return 0;if(!e.style)return 0;if(typeof e.style.length!="undefined")return e.style.length;for(t in e.style)e.style[t]&&e.style[t]!==0&&e.style[t]!=="false"&&n++;return n}function m(e){if(!e)return null;var t=[],n,r=e.length;n=r>>>0;while(n--)t[n]=e[n];return t}function g(e){while(e&&!e.nextSibling)e=e.parentNode;return e?e.nextSibling:null}function y(e){return e.hasChildNodes()?e.firstChild:g(e)}function b(e){if(e.previousSibling){e=e.previousSibling;while(e.hasChildNodes())e=e.lastChild;return e}return e.parentNode&&e.parentNode.nodeType==t.Node.ELEMENT_NODE?e.parentNode:null}function w(e,n){return e&&n&&Boolean(t.compareDocumentPosition(e,n)&t.Node.DOCUMENT_POSITION_CONTAINED_BY)}function E(e,t){return(e||t)&&(e==t||w(e,t))}function S(e,n){return n&&e&&Boolean(t.compareDocumentPosition(n,e)&t.Node.DOCUMENT_POSITION_CONTAINED_BY)}function x(e,n){return Boolean(t.compareDocumentPosition(e,n)&t.Node.DOCUMENT_POSITION_FOLLOWING)}function T(e,n){return Boolean(t.compareDocumentPosition(e,n)&t.Node.DOCUMENT_POSITION_PRECEDING)}function N(e){var t=[];while(e.parentNode)t.unshift(e.parentNode),e=e.parentNode;return t}function C(e){var t=[],n=g(e);while(null!=(e=y(e))&&e!=n)t.push(e);return t}function k(e){var t={fontFamily:"font-family",fontSize:"font-size",fontStyle:"font-style",fontWeight:"font-weight",textDecoration:"text-decoration"};return typeof t[e]!="undefined"?t[e]:e}function L(e){return{"xx-small":1,small:2,medium:3,large:4,"x-large":5,"xx-large":6,"xxx-large":7}[e]}function A(e){return{1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[e]}function O(e){return e.dir=="ltr"?"ltr":e.dir=="rtl"?"rtl":l(e.parentNode)?O(e.parentNode):"ltr"}function M(e){var t=0;while(e.previousSibling)t++,e=e.previousSibling;return t}function _(e){switch(e.nodeType){case t.Node.PROCESSING_INSTRUCTION_NODE:case t.Node.DOCUMENT_TYPE_NODE:return 0;case t.Node.TEXT_NODE:case t.Node.COMMENT_NODE:return e.length;default:return e.childNodes.length}}function D(e,n,r,i){if(e==r){if(n==i)return"equal";if(n<i)return"before";if(n>i)return"after"}var s=t.compareDocumentPosition(r,e);if(s&t.Node.DOCUMENT_POSITION_FOLLOWING){var o=D(r,i,e,n);if(o=="before")return"after";if(o=="after")return"before"}if(s&t.Node.DOCUMENT_POSITION_CONTAINS){var u=r;while(u.parentNode!=e)u=u.parentNode;if(M(u)<n)return"after"}return"before"}function P(e){var t=e;while(t.parentNode!=null)t=t.parentNode;return t}function H(e,t){var n=D(e,0,t.startContainer,t.startOffset);if(n!=="after")return!1;var r=D(e,_(e),t.endContainer,t.endOffset);return r!=="before"?!1:P(e)==P(t.startContainer)}function B(e,t){typeof t=="undefined"&&(t=function(){return!0});var n=e.startContainer;n.hasChildNodes()&&e.startOffset<n.childNodes.length?n=n.childNodes[e.startOffset]:e.startOffset==_(n)?n=g(n):n=y(n);var r=e.endContainer;r.hasChildNodes()&&e.endOffset<r.childNodes.length?r=r.childNodes[e.endOffset]:r=g(r);var i=[];while(x(n,r)){if(H(n,e)&&t(n)){i.push(n),n=g(n);continue}n=y(n)}return i}function j(e,t){typeof t=="undefined"&&(t=function(){return!0});var n=e.startContainer;n.hasChildNodes()&&e.startOffset<n.childNodes.length?n=n.childNodes[e.startOffset]:e.startOffset==_(n)?n=g(n):n=y(n);var r=e.endContainer;r.hasChildNodes()&&e.endOffset<r.childNodes.length?r=r.childNodes[e.endOffset]:r=g(r);var i=[];while(x(n,r))H(n,e)&&t(n)&&i.push(n),n=y(n);return i}function F(e){if(e.toLowerCase(
)=="currentcolor")return null;var n=document.createElement("span");document.body.appendChild(n),n.style.color="black";var r=document.createElement("span");n.appendChild(r),r.style.color=e,e=t.getComputedStyle(r).color;if(e=="rgb(0, 0, 0)"){n.color="white",e=t.getComputedStyle(r).color;if(e!="rgb(0, 0, 0)")return null}return document.body.removeChild(n),/^rgba\([0-9]+, [0-9]+, [0-9]+, 1\)$/.test(e)?e.replace("rgba","rgb").replace(", 1)",")"):e=="transparent"?"rgba(0, 0, 0, 0)":e}function I(e){e=e.toLowerCase();if(t(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"]).indexOf(e)!=-1)return e;e=F(e);var n=/^rgb\(([0-9]+), ([0-9]+), ([0-9]+)\)$/.exec(e);return n?"#"+parseInt(n[1],10).toString(16).replace(/^.$/,"0$&")+parseInt(n[2],10).toString(16).replace(/^.$/,"0$&")+parseInt(n[3],10).toString(16).replace(/^.$/,"0$&"):null}function $(e){e=t(e).trim();if(/^[\-+]?[0-9]+(\.[0-9]+)?([eE][\-+]?[0-9]+)?$/.test(e)){var n;e[0]=="+"?(e=e.slice(1),n="relative-plus"):e[0]=="-"?(e=e.slice(1),n="relative-minus"):n="absolute";var r=parseInt(e,10);n=="relative-plus"&&(r+=3),n=="relative-minus"&&(r=3-r),r<1&&(r=1),r>7&&(r=7),e={1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[r]}return e}function J(e){e=$(e);if(n.inArray(e,["xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large"])==-1&&!/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc|px)$/.test(e))return null;var r=document.createElement("font");document.body.appendChild(r),e=="xxx-large"?r.size=7:r.style.fontSize=e;var i=parseInt(t.getComputedStyle(r).fontSize,10);document.body.removeChild(r);var s=1;while(s<7){r=document.createElement("font"),r.size=s,document.body.appendChild(r);var o=parseInt(t.getComputedStyle(r).fontSize,10);r.size=1+s;var u=parseInt(t.getComputedStyle(r).fontSize,10);document.body.removeChild(r);var a=(u+o)/2;if(i<a)return String(s);s++}return"7"}function K(e,t,n,r){var i;V==0&&typeof n!="undefined"?o=n:V==0&&(o=null,o=n);if(!u.hasOwnProperty(e))throw"NOT_SUPPORTED_ERR";if(t!="enabled"&&!u[e].hasOwnProperty(t))throw"INVALID_ACCESS_ERR";V++;try{i=r()}catch(s){throw V--,s}return V--,i}function Q(e,t){return e=e.toLowerCase(),K(e,"action",t,function(e){return function(){return n.inArray(e,["copy","cut","paste","selectall","stylewithcss","usecss"])!=-1||t!==null}}(e))}function G(e){var t=new window.GENTICS.Utils.RangeObject;t.startContainer=e.startContainer,t.startOffset=e.startOffset,t.endContainer=e.endContainer,t.endOffset=e.endOffset,t.select()}function Y(e,t,n,r){var i=e.toLowerCase(),s=t,o=n;if(arguments.length==1||arguments.length>=4&&typeof s=="undefined")s=!1;if(arguments.length<=2||arguments.length>=4&&typeof o=="undefined")o="";return K(i,"action",r,function(e,t,n){return function(){return Q(e)?(u[e].action(n,r),G(r),!0):!1}}(i,s,o))}function Z(e,t){return e=e.toLowerCase(),K(e,"indeterm",t,function(e){return function(){return Q(e,t)?u[e].indeterm(t):!1}}(e))}function et(e,t){return e=e.toLowerCase(),K(e,"state",t,function(e){return function(){return Q(e,t)?typeof q(e,t)!="undefined"?q(e,t):u[e].state(t):!1}}(e))}function tt(e){return e=e.toLowerCase(),u.hasOwnProperty(e)}function nt(e,t){return e=e.toLowerCase(),K(e,"value",t,function(){return Q(e,t)?e=="fontsize"&&z("fontsize",t)!==undefined?J(z("fontsize",t)):typeof z(e,t)!="undefined"?z(e,t):u[e].value(t):""})}function it(e){return d(e,rt)}function ot(e){return e&&(e.nodeType==t.Node.ELEMENT_NODE&&!st[t.getComputedStyle(e).display]||e.nodeType==t.Node.DOCUMENT_NODE||e.nodeType==t.Node.DOCUMENT_FRAGMENT_NODE)}function ut(e){return e&&!ot(e)}function at(e){return e&&e.nodeType==t.Node.ELEMENT_NODE&&(e.contentEditable=="true"||e.parentNode&&e.parentNode.nodeType==t.Node.DOCUMENT_NODE&&e.parentNode.designMode=="on")}function ft(e){return e&&!at(e)&&(e.nodeType!=t.Node.ELEMENT_NODE||e.contentEditable!="false"||n(e).hasClass("aloha-table-wrapper"))&&(at(e.parentNode)||ft(e.parentNode))}function lt(e){var t;for(t=0;t<e.childNodes.length;t++)if(ft(e.childNodes[t])||lt(e.childNodes[t]))return!0;return!1}function ct(e){if(at(e))return e;if(ft(e)){var t=e.parentNode;while(!at(t))t=t.parentNode;return t}return null}function ht(e,t){return ct(e)&&ct(e)==ct(t)}function pt(e){if(!c(e,"br"))return!1;var r=e.parentNode;while(t.getComputedStyle(r).display=="inline")r=r.parentNode;var i={height:r.style.height,maxHeight:r.style.maxHeight,minHeight:r.style.minHeight};r.style.height="auto",r.style.maxHeight="none",n.browser.msie&&n.browser.version<8||(r.style.minHeight="0");var s=document.createTextNode("​"),o=r.offsetHeight;if(o==0)throw"isCollapsedLineBreak: original height is zero, bug?";e.parentNode.insertBefore(s,e.nextSibling);var u=r.offsetHeight;return s.parentNode.removeChild(s),r.style.height=i.height,r.style.maxHeight=i.maxHeight,n.browser.msie&&n.browser.version<8||(r.style.minHeight=i.minHeight),o<u-5}function dt(e){if(!c(e,"br"))return!1;if(c(e.parentNode,"li")&&e.parentNode.childNodes.length==1)return!1;var r=e.parentNode;while(t.getComputedStyle(r).display=="inline")r=r.parentNode;var i={height:r.style.height,maxHeight:r.style.maxHeight,minHeight:r.style.minHeight,contentEditable:r.contentEditable};r.style.height="auto",r.style.maxHeight="none",r.style.minHeight="0",n.browser.msie&&n.browser.version<=7&&(r.contentEditable="false");var s=r.offsetHeight;if(s==0)throw"isExtraneousLineBreak: original height is zero, bug?";var o=e.style.display;e.style.display="none";var u=r.offsetHeight;return r.style.height=i.height,r.style.maxHeight=i.maxHeight,r.style.minHeight=i.minHeight,n.browser.msie&&n.browser.version<=7&&(r.contentEditable=i.contentEditable),e.style.display=o,s==u}function vt(e){return e&&e.nodeType==t.Node.TEXT_NODE&&(e.data==""||/^[\t\n\r ]+$/.test(e.data)&&e.parentNode&&e.parentNode.nodeType==t.Node.ELEMENT_NODE&&n.inArray(t.getComputedStyle(e.parentNode).whiteSpace,["normal","nowrap"])!=-1||/^[\t\r ]+$/.test(e.data)&&e.parentNode&&e.parentNode.nodeType==t.Node.ELEMENT_NODE&&t.getComputedStyle(e.parentNode).whiteSpace=="pre-line"||/^[\t\n\r ]+$/.test(e.data)&&e.parentNode&&e.parentNode.nodeType==t.Node.DOCUMENT_FRAGMENT_NODE)}function mt(e,r){if(!ft(e)&&!at(e))return;if(!e||e.nodeType!==t.Node.TEXT_NODE)return;if(n.inArray(t.getComputedStyle(e.parentNode).whiteSpace,["pre","pre-wrap"])!=-1)return;if(!/[\t\n\r ]{2,}/.test(e.data))return;var i="",s=r.startContainer==e,o=r.endContainer==e,u=!1,a;for(a=0;a<e.data.length;++a)/[\t\n\r ]/.test(e.data.substr(a,1))?u?(s&&i.length<r.startOffset&&r.startOffset--,o&&i.length<r.endOffset&&r.endOffset--):(i+=" ",u=!0):(i+=e.data.substr(a,1),u=!1);e.data=i}function gt(e){if(!vt(e))return!1;if(e.data=="")return!0;var n=e.parentNode;if(!n)return!0;if(t(N(e)).some(function(e){return e.nodeType==t.Node.ELEMENT_NODE&&t.getComputedStyle(e).display=="none"}))return!0;while(!ot(n)&&n.parentNode)n=n.parentNode;var r=e;while(r!=n){r=b(r);if(ot(r)||c(r,"br"))return!0;if(r.nodeType==t.Node.TEXT_NODE&&!vt(r)||c(r,"img"))break}r=e;var i=g(n);while(r!=i){r=y(r);if(ot(r)||c(r,"br"))return!0;if(r&&r.nodeType==t.Node.TEXT_NODE&&!vt(r)||c(r,"img"))break}return!1}function yt(e){var n;if(!e)return!1;if(t(N(e).concat(e)).filter(function(e){return e.nodeType==t.Node.ELEMENT_NODE},!0).some(function(e){return t.getComputedStyle(e).display=="none"}))return!1;if(ot(e)||e.nodeType==t.Node.TEXT_NODE&&!gt(e)||c(e,"img")||c(e,"br")&&!dt(e))return!0;for(n=0;n<e.childNodes.length;n++)if(yt(e.childNodes[n]))return!0;return!1}function bt(e){return e&&!yt(e)}function wt(e){var n;if(pt(e)&&!dt(e))return!0;if(!ut(e)||e.nodeType!=t.Node.ELEMENT_NODE)return!1;var r=!1;for(n=0;n<e.childNodes.length;n++){if(!bt(e.childNodes[n])&&!wt(e.childNodes[n]))return!1;wt(e.childNodes[n])&&(r=!0)}return r}function Et(){var r;if(o)r=o;else{if(!e.getSelection().rangeCount)return null;r=e.getSelection().getRangeAt(0)}if(n.inArray(r.startContainer.nodeType,[t.Node.TEXT_NODE,t.Node.ELEMENT_NODE])==-1||n.inArray(r.endContainer.nodeType,[t.Node.TEXT_NODE,t.Node.ELEMENT_NODE])==-1||!r.startContainer.ownerDocument||!r.endContainer.ownerDocument||!S(r.startContainer,r.startContainer.ownerDocument)||!S(r.endContainer,r.endContainer.ownerDocument))throw"Invalid active range; test bug?";return r}function St(n,r,i,s){i==-1&&(i=r.childNodes.length);var o=n.parentNode,u=M(n),a,f=[s];for(a=0;a<e.getSelection().rangeCount;a++)f.push(e.getSelection().getRangeAt(a));var l=[];t(f).forEach(function(e){l.push([e.startContainer,e.startOffset]),l.push([e.endContainer,e.endOffset])}),t(l).forEach(function(e){e[0]==r&&e[1]>i&&e[1]++,e[0]==o&&(e[1]==u||e[1]==u+1)&&(e[0]=r,e[1]+=i-u),e[0]==o&&e[1]>u+1&&e[1]--}),r.childNodes.length==i?r.appendChild(n):r.insertBefore(n,r.childNodes[i]);var c=null;if(l[0][1]>l[0][0].childNodes.length&&l[1][1]>l[1][0].childNodes.length)s.setStart(n,0),s.setEnd(n,0);else{s.setStart(l[0][0],l[0][1]),s.setEnd(l[1][0],l[1][1]),e.getSelection().removeAllRanges();for(a=1;a<f.length;a++)c=e.createRange(),c.setStart(l[2*a][0],l[2*a][1]),c.setEnd(l[2*a+1][0],l[2*a+1][1]),e.getSelection().addRange(c);c&&(s=c)}}function xt(e,t){n.browser.msie&&n.browser.version>=7&&typeof e.attributes[n.expando]!="undefined"&&n(e).removeAttr(n.expando);var r=e.attributes,i;for(i=0;i<r.length;i++){var s=r[i];if(typeof s.specified=="undefined"||s.specified)typeof t.setAttributeNS=="function"?t.setAttributeNS(s.namespaceURI,s.name,s.value):t.setAttribute(s.name,s.value)}}function Tt(e,t,n){if(c(e,t))return e;if(!e.parentNode)return e;var r=e.ownerDocument.createElement(t);e.parentNode.insertBefore(r,e),xt(e,r);while(e.childNodes.length)St(e.firstChild,r,r.childNodes.length,n);return e.parentNode.removeChild(e),n.startContainer===e&&(n.startContainer=r),n.endContainer===e&&(n.endContainer=r),r}function Nt(e){var t=e.previousSibling;if(!t)return;while(t.hasChildNodes())t=t.lastChild;while(bt(t)&&!dt(t)&&t!=e.parentNode)t=b(t);ft(t)&&dt(t)&&t.parentNode.removeChild(t)}function Ct(e){var t=e;while(t.hasChildNodes())t=t.lastChild;while(bt(t)&&!dt(t)&&t!=e)t=b(t);ft(t)&&dt(t)&&t.parentNode.removeChild(t)}function kt(e){Nt(e),Ct(e)}function Lt(e,t,n,r){var i;typeof t=="undefined"&&(t=function(){return!1}),typeof n=="undefined"&&(n=function(){return null});if(!e.length||!ft(e[0]))return null;ut(e[e.length-1])&&!c(e[e.length-1],"br")&&c(e[e.length-1].nextSibling,"br")&&e.push(e[e.length-1].nextSibling);var s;ft(e[0].previousSibling)&&t(e[0].previousSibling)?s=e[0].previousSibling:ft(e[e.length-1].nextSibling)&&t(e[e.length-1].nextSibling)?s=e[e.length-1].nextSibling:s=n();if(!s)return null;if(!s.parentNode){e[0].parentNode.insertBefore(s,e[0]);var u=r.startContainer,a=r.startOffset,f=r.endContainer,l=r.endOffset;u==s.parentNode&&a>=M(s)&&r.setStart(u,a+1),f==s.parentNode&&l>=M(s)&&r.setEnd(f,l+1),o&&o!==r&&(u=o.startContainer,a=o.startOffset,f=o.endContainer,l=o.endOffset,u==s.parentNode&&a>=M(s)&&o.setStart(u,a+1),f==s.parentNode&&l>=M(s)&&o.setEnd(f,l+1))}var h=e[0].parentNode;if(x(s,e[0])){!ut(s)&&ut(s.lastChild)&&ut(e[0])&&!c(s.lastChild,"BR")&&s.appendChild(s.ownerDocument.createElement("br"));for(i=0;i<e.length;i++)St(e[i],s,-1,r)}else{!ut(s)&&ut(s.firstChild)&&ut(e[e.length-1])&&!c(e[e.length-1],"BR")&&s.insertBefore(s.ownerDocument.createElement("br"),s.firstChild);for(i=e.length-1;i>=0;i--)St(e[i],s,0,r)}ft(h)&&!h.hasChildNodes()&&h.parentNode.removeChild(h);if(ft(s.nextSibling)&&t(s.nextSibling)){!ut(s)&&ut(s.lastChild)&&ut(s.nextSibling.firstChild)&&!c(s.lastChild,"BR")&&s.appendChild(s.ownerDocument.createElement("br"));while(s.nextSibling.hasChildNodes())St(s.nextSibling.firstChild,s,-1,r);s.parentNode.removeChild(s.nextSibling)}return kt(s),s}function Bt(e){return d(e,At)}function jt(e,r){if((Ot[r]||p(r,["colgroup","table","tbody","tfoot","thead","tr"]))&&typeof e=="object"&&e.nodeType==t.Node.TEXT_NODE&&!/^[ \t\n\f\r]*$/.test(e.data))return!1;if(!Mt[r]&&!p(r,["script","style","plaintext","xmp"])||typeof e=="object"&&e.nodeType==t.Node.TEXT_NODE){if(typeof e!="object"||e.nodeType!=t.Node.DOCUMENT_NODE&&e.nodeType!=t.Node.DOCUMENT_FRAGMENT_NODE&&e.nodeType!=t.Node.DOCUMENT_TYPE_NODE){l(e)&&(e=e.tagName.toLowerCase());if(typeof e!="string")return!0;if(l(r)){var i=r;while(i){if(e=="a"&&c(i,"a"))return!1;if(rt[e.toUpperCase()]&&Bt(i))return!1;if(/^h[1-6]$/.test(e)&&l(i)&&/^H[1-6]$/.test(i.tagName))return!1;i=i.parentNode}r=r.tagName.toLowerCase()}if(typeof r!="object"||r.nodeType!=t.Node.ELEMENT_NODE&&r.nodeType!=t.Node.DOCUMENT_FRAGMENT_NODE){if(typeof r!="string")return!1;switch(r){case"colgroup":return e=="col";case"table":return n.inArray(e,["caption","col","colgroup","tbody","td","tfoot","th","thead","tr"])!=-1;case"tbody":case"thead":case"tfoot":return n.inArray(e,["td","th","tr"])!=-1;case"tr":return n.inArray(e,["td","th"])!=-1;case"dl":return n.inArray(e,["dt","dd"])!=-1;case"dir":case"ol":case"ul":return n.inArray(e,["dir","li","ol","ul"])!=-1;case"hgroup":return/^h[1-6]$/.test(e)}if(n.inArray(e,["body","caption","col","colgroup","frame","frameset","head","html","tbody","td","tfoot","th","thead","tr"])!=-1)return!1;if(n.inArray(e,["dd","dt"])!=-1&&r!="dl")return!1;if(e=="li"&&r!="ol"&&r!="ul")return!1;var s=Ht[r.toUpperCase()];if(s){var o=s[e.toUpperCase()];if(o)return!1}return!0}return!0}return!1}return!1}function Ft(e,n){return n.collapsed?!1:H(e,n)?!0:e==n.startContainer&&e.nodeType==t.Node.TEXT_NODE&&_(e)!=n.startOffset?!0:e==n.endContainer&&e.nodeType==t.Node.TEXT_NODE&&n.endOffset!=0?!0:e.hasChildNodes()&&t(e.childNodes).every(function(e){return Ft(e,n)})&&(!S(n.startContainer,e)||n.startContainer.nodeType!=t.Node.TEXT_NODE||n.startOffset==0)&&(!S(n.endContainer,e)||n.endContainer.nodeType!=t.Node.TEXT_NODE||n.endOffset==_(n.endContainer))?!0:!1}function It(e,t){typeof t=="undefined"&&(t=function(){return!0});var n=e.startContainer;while(Ft(n.parentNode,e))n=n.parentNode;var r=g(e.endContainer),i=[];while(x(n,r)){if(Ft(n,e)&&t(n)){i.push(n),n=g(n);continue}n=y(n)}return i}function qt(e,t){typeof t=="undefined"&&(t=function(){return!0});var n=e.startContainer;while(Ft(n.parentNode,e))n=n.parentNode;var r=g(e.endContainer),i=[];while(x(n,r))Ft(n,e)&&t(n)&&i.push(n),n=y(n);return i}function Rt(e){if(!l(e))return!1;if(n.inArray(e.tagName,["B","EM","I","S","SPAN","STRIKE","STRONG","SUB","SUP","U"])!=-1){if(e.attributes.length==0)return!0;if(e.attributes.length==1&&r(e,"style"))return!0}if(e.tagName=="FONT"||e.tagName=="A"){var t=e.attributes.length;r(e,"style")&&t--,e.tagName=="FONT"&&(r(e,"color")&&t--,r(e,"face")&&t--,r(e,"size")&&t--),e.tagName=="A"&&r(e,"href")&&t--;if(t==0)return!0}return!1}function Ut(e){return l(e)?n.inArray(e.tagName,["A","B","EM","FONT","I","S","SPAN","STRIKE","STRONG","SUB","SUP","U"])==-1?!1:e.attributes.length==0?!0:e.attributes.length>1?!1:r(e,"style")&&v(e)==0?!0:e.tagName=="A"&&r(e,"href")?!0:e.tagName=="FONT"&&(r(e,"color")||r(e,"face")||r(e,"size"))?!0:e.tagName!="B"&&e.tagName!="STRONG"||!r(e,"style")||v(e)!=1||e.style.fontWeight==""?e.tagName!="I"&&e.tagName!="EM"||!r(e,"style")||v(e)!=1||e.style.fontStyle==""?e.tagName!="A"&&e.tagName!="FONT"&&e.tagName!="SPAN"||!r(e,"style")||v(e)!=1||e.style.textDecoration!=""?n.inArray(e.tagName,["A","FONT","S","SPAN","STRIKE","U"])==-1||!r(e,"style")||v(e)!=1||e.style.textDecoration!="line-through"&&e.style.textDecoration!="underline"&&e.style.textDecoration!="overline"&&e.style.textDecoration!="none"?!1:!0:!0:!0:!0:!1}function zt(e,t,n){return t===null&&n===null?!0:typeof t=="string"&&typeof n=="string"&&t==n&&!u[e].hasOwnProperty("equivalentValues")?!0:typeof t=="string"&&typeof n=="string"&&u[e].hasOwnProperty("equivalentValues")&&u[e].equivalentValues(t,n)?!0:!1}function Wt(e,n,r){if(zt(e,n,r))return!0;if(e!="fontsize"||typeof n!="string"||typeof r!="string")return!1;var i=Wt;if(i.sizeMap===undefined){i.sizeMap={};var s=document.createElement("font");document.body.appendChild(s),t(["xx-small","small","medium","large","x-large","xx-large","xxx-large"]).forEach(function(e){s.size=L(e),i.sizeMap[e]=t.getComputedStyle(s).fontSize}),document.body.removeChild(s)}return n===i.sizeMap[r]||r===i.sizeMap[n]}function Xt(e,n){if(e.nodeType==t.Node.ELEMENT_NODE||!!e.parentNode&&e.parentNode.nodeType==t.Node.ELEMENT_NODE){if(e.nodeType!=t.Node.ELEMENT_NODE)return Xt(e.parentNode,n);if(n=="createlink"||n=="unlink"){while(e&&(!l(e)||e.tagName!="A"||!r(e,"href")))e=e.parentNode;return e?e.getAttribute("href"):null}if(n=="backcolor"||n=="hilitecolor"){while((t.getComputedStyle(e).backgroundColor=="rgba(0, 0, 0, 0)"||t.getComputedStyle(e).backgroundColor===""||t.getComputedStyle(e).backgroundColor=="transparent")&&e.parentNode&&e.parentNode.nodeType==t.Node.ELEMENT_NODE)e=e.parentNode;return t.getComputedStyle(e).backgroundColor=="rgba(0, 0, 0, 0)"||t.getComputedStyle(e).backgroundColor===""||t.getComputedStyle(e).backgroundColor=="transparent"?"rgb(255, 255, 255)":t.getComputedStyle(e).backgroundColor}if(n=="subscript"||n=="superscript"){var i=!1,s=!1;while(ut(e)){var o=t.getComputedStyle(e).verticalAlign;c(e,"sub")?i=!0:c(e,"sup")&&(s=!0),e=e.parentNode}return i&&s?"mixed":i?"subscript":s?"superscript":null}if(n=="strikethrough"){do{if(t.getComputedStyle(e).textDecoration.indexOf("line-through")!=-1)return"line-through";e=e.parentNode}while(e&&e.nodeType==t.Node.ELEMENT_NODE);return null}if(n=="underline"){do{if(t.getComputedStyle(e).textDecoration.indexOf("underline")!=-1)return"underline";e=e.parentNode}while(e&&e.nodeType==t.Node.ELEMENT_NODE);return null}if(!u[n].hasOwnProperty("relevantCssProperty"))throw"Bug: no relevantCssProperty for "+n+" in getEffectiveCommandValue";return t.getComputedStyle(e)[u[n].relevantCssProperty].toString()}return null}function Vt(e,n){if(n!="backcolor"&&n!="hilitecolor"||t.getComputedStyle(e).display=="inline"){if(n=="createlink"||n=="unlink")return l(e)&&e.tagName=="A"&&r(e,"href")?e.getAttribute("href"):null;if(n=="subscript"||n=="superscript")return c(e,"sup")?"superscript":c(e,"sub")?"subscript":null;if(n=="strikethrough"&&e.style.textDecoration!="")return e.style.textDecoration.indexOf("line-through")!=-1?"line-through":null;if(n=="strikethrough"&&p(e,["S","STRIKE"]))return"line-through";if(n=="underline"&&e.style.textDecoration!="")return e.style.textDecoration.indexOf("underline")!=-1?"underline":null;if(n=="underline"&&c(e,"U"))return"underline";var i=u[n].relevantCssProperty;if(i===null)return null;if(e.style[i]!="")return e.style[i];if(a(e.namespaceURI)&&e.tagName=="FONT"){if(i=="color"&&r(e,"color"))return e.color;if(i=="fontFamily"&&r(e,"face"))return e.face;if(i=="fontSize"&&r(e,"size")){var s=parseInt(e.size,10);return s<1&&(s=1),s>7&&(s=7),{1:"xx-small",2:"small",3:"medium",4:"large",5:"x-large",6:"xx-large",7:"xxx-large"}[s]}}return i!="fontWeight"||e.tagName!="B"&&e.tagName!="STRONG"?i!="fontStyle"||e.tagName!="I"&&e.tagName!="EM"?null:"italic":"bold"}return null}function $t(e,t,n,r){var i=e;while(Rt(i)&&i.childNodes.length==1&&Rt(i.firstChild)&&(!Ut(i)||!zt(t,Vt(i,t),n)))i=i.firstChild;if(i==e||!Ut(i)||!zt(t,Vt(i,t),n)||!Wt(t,Xt(i,t),n))return;while(i.hasChildNodes())St(i.firstChild,i.parentNode,M(i),r);e.parentNode.insertBefore(i,e.nextSibling),St(e,i,-1,r)}function Kt(e){var t=[],r=n.makeArray(e),i,s,o,u,a,f;for(i=0;i<r.length;i++){o=r[i];for(s=0;s<Jt.length;s++){u=Jt[s],a=o,a.nodeType!=1&&(a=a.parentNode),f=null;while(a&&a.nodeType==1&&(f=Vt(a,u))===null)a=a.parentNode;t.push([o,u,f])}}return t}function Qt(e,t,n){if(!ft(e))return[];if(Vt(e,t)===null)return[];if(Ut(e)){var r=Array.prototype.slice.call(m(e.childNodes)),i;for(i=0;i<r.length;i++)St(r[i],e.parentNode,M(e),n);return e.parentNode.removeChild(e),r}return t=="strikethrough"&&e.style.textDecoration.indexOf("line-through")!=-1&&(e.style.textDecoration=="line-through"?e.style.textDecoration="":e.style.textDecoration=e.style.textDecoration.replace("line-through",""),e.getAttribute("style")==""&&e.removeAttribute("style")),t=="underline"&&e.style.textDecoration.indexOf("underline")!=-1&&(e.style.textDecoration=="underline"?e.style.textDecoration="":e.style.textDecoration=e.style.textDecoration.replace("underline",""),e.getAttribute("style")==""&&e.removeAttribute("style")),u[t].relevantCssProperty!==null&&(e.style[u[t].relevantCssProperty]="",e.getAttribute("style")==""&&e.removeAttribute("style")),a(e.namespaceURI)&&e.tagName=="FONT"&&(t=="forecolor"&&e.removeAttribute("color"),t=="fontname"&&e.removeAttribute("face"),t=="fontsize"&&e.removeAttribute("size")),c(e,"A")&&(t=="createlink"||t=="unlink")&&e.removeAttribute("href"),Vt(e,t)===null?[]:[Tt(e,"span",n)]}function Gt(e,r,i,o){var a=[],f,l;if(!e.parentNode)return;if(i===null)return;jt(e,"span")&&($t(e.previousSibling,r,i,o),$t(e.nextSibling,r,i,o),Lt([e],function(e){return Ut(e)&&zt(r,Vt(e,r),i)&&Wt(r,Xt(e,r),i)},function(){return null},o));if(Wt(r,Xt(e,r),i))return;if(!jt(e,"span")){for(f=0;f<e.childNodes.length;f++){if(e.childNodes[f].nodeType==t.Node.ELEMENT_NODE){l=Vt(e.childNodes[f],r);if(l!==null&&!zt(r,i,l))continue}a.push(e.childNodes[f])}for(f=0;f<a.length;f++)Gt(a[f],r,i,o);return}if(Wt(r,Xt(e,r),i))return;var h=null;s||(r=="bold"&&(i=="bold"||i=="700")&&(h=e.ownerDocument.createElement("b")),r=="italic"&&i=="italic"&&(h=e.ownerDocument.createElement("i")),r=="strikethrough"&&i=="line-through"&&(h=e.ownerDocument.createElement("s")),r=="underline"&&i=="underline"&&(h=e.ownerDocument.createElement("u")),r=="forecolor"&&I(i)&&(h=e.ownerDocument.createElement("span"),n(h).css("color",I(i))),r=="fontname"&&(h=e.ownerDocument.createElement("font"),h.face=i));if(r=="createlink"||r=="unlink"){h=e.ownerDocument.createElement("a"),h.setAttribute("href",i);var p=e.parentNode;while(p)c(p,"A")&&(p=Tt(p,"span",o)),p=p.parentNode}r=="fontsize"&&n.inArray(i,["xx-small","small","medium","large","x-large","xx-large","xxx-large"])!=-1&&(!s||i=="xxx-large")&&(h=e.ownerDocument.createElement("font"),h.size=L(i)),(r=="subscript"||r=="superscript")&&i=="subscript"&&(h=e.ownerDocument.createElement("sub")),(r=="subscript"||r=="superscript")&&i=="superscript"&&(h=e.ownerDocument.createElement("sup")),h||(h=e.ownerDocument.createElement("span")),e.parentNode.insertBefore(h,e);var d=u[r].relevantCssProperty;d!==null&&!Wt(r,Xt(h,r),i)&&(h.style[d]=i),r=="strikethrough"&&i=="line-through"&&Xt(h,"strikethrough")!="line-through"&&(h.style.textDecoration="line-through"),r=="underline"&&i=="underline"&&Xt(h,"underline")!="underline"&&(h.style.textDecoration="underline"),St(e,h,h.childNodes.length,o);if(e.nodeType==t.Node.ELEMENT_NODE&&!zt(r,Xt(e,r),i)){St(e,h.parentNode,M(h),o),h.parentNode.removeChild(h),a=[];for(f=0;f<e.childNodes.length;f++){if(e.childNodes[f].nodeType==t.Node.ELEMENT_NODE){l=Vt(e.childNodes[f],r);if(l!==null&&!zt(r,i,l))continue}a.push(e.childNodes[f])}for(f=0;f<a.length;f++)Gt(a[f],r,i,o)}}function Yt(e,n,r,i){if(!e.parentNode||e.parentNode.nodeType!=t.Node.ELEMENT_NODE)return;if(Wt(n,Xt(e,n),r))return;var s=e.parentNode,o=[];while(ft(s)&&s.nodeType==t.Node.ELEMENT_NODE&&!Wt(n,Xt(s,n),r))o.push(s),s=s.parentNode;if(!o.length)return;var u=Vt(o[o.length-1],n);if(u===null&&u!=r)return;if(r!==null&&!Wt(n,Xt(o[o.length-1].parentNode,n),r))return;while(o.length){s=o.pop(),Vt(s,n)!==null&&(u=Vt(s,n));var a=Array.prototype.slice.call(m(s.childNodes));Vt(s,n)!==null&&Qt(s,n,i);var f;for(f=0;f<a.length;f++){var l=a[f];if(l==e)continue;if(l.nodeType==t.Node.ELEMENT_NODE&&Vt(l,n)!==null&&!zt(n,u,Vt(l,n)))continue;if(l==o[o.length-1])continue;Gt(l,n,u,i)}}}function Zt(e,n){t(e).forEach(function(e){var r=e[0],i=e[1],s=e[2],o=r;if(!o||o.nodeType!=t.Node.ELEMENT_NODE)o=o.parentNode;while(o&&o.nodeType==t.Node.ELEMENT_NODE&&Vt(o,i)===null)o=o.parentNode;s===null&&o&&o.nodeType==t.Node.ELEMENT_NODE?Yt(r,i,null,n):(o&&o.nodeType==t.Node.ELEMENT_NODE&&!zt(i,Vt(o,i),s)||(!o||o.nodeType!=t.Node.ELEMENT_NODE)&&s!==null)&&Gt(r,i,s,n)})}function en(n,r,i){i=i||Et();if(!t(qt(i)).filter(function(e){return e.nodeType==t.Node.TEXT_NODE},!0).some(ft)){u[n].hasOwnProperty("inlineCommandActivatedValues")&&R(n,t(u[n].inlineCommandActivatedValues).indexOf(r)!=-1,i),n=="subscript"&&U("superscript",i),n=="superscript"&&U("subscript",i),r===null?X(n,i):u[n].hasOwnProperty("value")&&W(n,r,i);return}if(ft(i.startContainer)&&i.startContainer.nodeType==t.Node.TEXT_NODE&&i.startOffset!=0&&i.startOffset!=_(i.startContainer)){var s=i.startContainer.splitText(i.startOffset),o=e.createRange();if(i.startContainer==i.endContainer){var a=i.endOffset-i.startOffset;o.setEnd(s,a),i.setEnd(s,a)}o.setStart(s,0),e.getSelection().removeAllRanges(),e.getSelection().addRange(o),i.setStart(s,0)}if(ft(i.endContainer)&&i.endContainer.nodeType==t.Node.TEXT_NODE&&i.endOffset!=0&&i.endOffset!=_(i.endContainer)){var f=i,l=[f.startContainer,f.startOffset],c=[f.endContainer,f.endOffset];f.endContainer.splitText(f.endOffset),f.setStart(l[0],l[1]),f.setEnd(c[0],c[1]),e.getSelection().removeAllRanges(),e.getSelection().addRange(f)}t(qt(Et(),function(e){return ft(e)&&e.nodeType==t.Node.ELEMENT_NODE})).forEach(function(e){Qt(e,n,i)}),t(qt(i,ft)).forEach(function(e){Yt(e,n,r,i),Gt(e,n,r,i)})}function tn(e,n){var r;if(e.nodeType===t.Node.TEXT_NODE&&n<e.length)for(r=n;r<e.length;r++)if(e.data.charAt(r)!=="	"&&e.data.charAt(r)!=="\r"&&e.data.charAt(r)!=="\n"||e.data.charCodeAt(r)===160)return!1;if(e.nextSibling&&e.nextSibling.className&&e.nextSibling.className.indexOf("aloha-table-wrapper")>=0)return e.nextSibling;if(e.parentNode&&e.parentNode.nextSibling&&e.parentNode.nextSibling.className&&e.parentNode.nextSibling.className.indexOf("aloha-table-wrapper")>=0)return e.parentNode.nextSibling;if(e.parentNode&&e.parentNode.nextSibling&&vt(e.parentNode.nextSibling)&&e.parentNode.nextSibling.nextSibling&&e.parentNode.nextSibling.nextSibling.className&&e.parentNode.nextSibling.nextSibling.className.indexOf("aloha-table-wrapper")>=0)return e.parentNode.nextSibling.nextSibling}function nn(e,n){var r;if(e.nodeType===t.Node.TEXT_NODE&&n>0)for(r=n-1;r>=0;r--)if(e.data.charAt(r)!=="	"&&e.data.charAt(r)!=="\r"&&e.data.charAt(r)!=="\n"||e.data.charCodeAt(r)===160)return!1;return e.previousSibling&&e.previousSibling.className&&e.previousSibling.className.indexOf("aloha-table-wrapper")>=0?e.previousSibling:e.parentNode&&e.parentNode.previousSibling&&e.parentNode.previousSibling.className&&e.parentNode.previousSibling.className.indexOf("aloha-table-wrapper")>=0?e.parentNode.previousSibling:e.parentNode&&e.parentNode.previousSibling&&vt(e.parentNode.previousSibling)&&e.parentNode.previousSibling.previousSibling&&e.parentNode.previousSibling.previousSibling.className&&e.parentNode.previousSibling.previousSibling.className.indexOf("aloha-table-wrapper")>=0?e.parentNode.previousSibling.previousSibling:!1}function rn(e,t){return!e.parentNode&&t==0||0<=t-1&&t-1<e.childNodes.length&&yt(e.childNodes[t-1])&&(ot(e.childNodes[t-1])||c(e.childNodes[t-1],"br"))}function sn(e,t){return!e.parentNode&&t==_(e)||t<e.childNodes.length&&yt(e.childNodes[t])&&ot(e.childNodes[t])}function on(e,t){return rn(e,t)||sn(e,t)}function un(e){var t=0;while(!on(e,t)){if(0<=t-1&&t-1<e.childNodes.length&&yt(e.childNodes[t-1]))return!1;t==0||!e.hasChildNodes()?(t=M(e),e=e.parentNode):(e=e.childNodes[t-1],t=_(e))}return!0}function an(e){var t=_(e);while(!on(e,t)){if(t<e.childNodes.length&&yt(e.childNodes[t]))return!1;t==_(e)||!e.hasChildNodes()?(t=1+M(e),e=e.parentNode):(e=e.childNodes[t],t=0)}return!0}function fn(e,t){var r,i=e[0].parentNode;if(!ft(i)||!i.parentNode)return;n.inArray(i.firstChild,e)!=-1&&Nt(i);var s=n.inArray(i.firstChild,e)!=-1,o=n.inArray(i.lastChild,e)!=-1,u=s&&un(i),a=o&&an(i);if(!s&&o){for(r=e.length-1;r>=0;r--)St(e[r],i.parentNode,1+M(i),t);a&&!an(e[e.length-1])&&e[e.length-1].parentNode.insertBefore(document.createElement("br"),e[e.length-1].nextSibling),Ct(i);return}if(!s){var f=i.cloneNode(!1);i.removeAttribute("id"),i.parentNode.insertBefore(f,i);while(e[0].previousSibling)St(i.firstChild,f,f.childNodes.length,t)}for(r=0;r<e.length;r++)St(e[r],i.parentNode,M(i),t);u&&!un(e[0])&&e[0].parentNode.insertBefore(document.createElement("br"),e[0]),ut(e[e.length-1])&&!c(e[e.length-1],"br")&&c(i.firstChild,"br")&&!ut(i)&&i.removeChild(i.firstChild),i.hasChildNodes()?Nt(i):(i.parentNode===t.startContainer&&i.parentNode===t.endContainer&&t.startContainer===t.endContainer&&t.startOffset===t.endOffset&&i.parentNode.childNodes.length===t.startOffset&&(t.startOffset=i.parentNode.childNodes.length-1,t.endOffset=t.startOffset),i.parentNode.removeChild(i),a&&!an(e[e.length-1])&&e[e.length-1].parentNode.insertBefore(document.createElement("br"),e[e.length-1].nextSibling)),!e[e.length-1].nextSibling&&e[e.length-1].parentNode&&Ct(e[e.length-1].parentNode)}function ln(e){if(!l(e))return!1;if(e.tagName=="BLOCKQUOTE")return!0;if(e.tagName!="DIV")return!1;if(typeof e.style.length!="undefined"){var t;for(t=0;t<e.style.length;t++)if(/^(-[a-z]+-)?margin/.test(e.style[t]))return!0}else{var n;for(n in e.style)if(/^(-[a-z]+-)?margin/.test(n)&&e.style[n]&&e.style[n]!==0)return!0}return!1}function cn(e){if(!ln(e))return!1;if(e.tagName!="BLOCKQUOTE"&&e.tagName!="DIV")return!1;var t;for(t=0;t<e.attributes.length;t++)if(!a(e.attributes[t].namespaceURI)||n.inArray(e.attributes[t].name,["style","class","dir"])==-1)return!1;if(typeof e.style.length!="undefined"){for(t=0;t<e.style.length;t++)if(!/^(-[a-z]+-)?(margin|border|padding)/.test(e.style[t]))return!1}else{var r;for(r in e.style)if(!/^(-[a-z]+-)?(margin|border|padding)/.test(r)&&e.style[r]&&e.style[r]!==0&&e.style[r]!=="false")return!1}return!0}function hn(e){return p(e,["address","div","h1","h2","h3","h4","h5","h6","listing","p","pre","xmp"])}function pn(e){return hn(e)||p(e,["li","dt","dd"])}function vn(e){return c(e,"br")&&e.parentNode.lastChild===e}function mn(){return document.createElement("br")}function gn(e){if(!e)return;if(c(e.lastChild,"br"))return;if(t(e.childNodes).some(yt))return;n.browser.msie?n.browser.msie&&n.browser.version<=7&&p(e,["p","h1","h2","h3","h4","h5","h6","pre","blockquote"])&&(e.firstChild||e.appendChild(document.createTextNode("​"))):e.appendChild(mn())}function yn(e,r){var i;if(!ft(e))return;if(t(N(e)).every(function(t){return!ht(e,t)||!jt(e,t)})&&!f(e,dn)){if(p(e,["dd","dt"])){Lt([e],function(e){return c(e,"dl")&&!e.attributes.length},function(){return document.createElement("dl")},r);return}if(!it(e))return;e=Tt(e,dn,r),gn(e),yn(e,r);var s=C(e);for(i=0;i<s.length;i++)yn(s[i],r);return}var o=Kt([e]),u,a;while(!jt(e,e.parentNode)){for(i=e.parentNode.childNodes.length-1;i>=0;--i)e.parentNode.childNodes[i].nodeType==3&&e.parentNode.childNodes[i].data.length==0&&(e.parentNode.removeChild(e.parentNode.childNodes[i]),r.startContainer==e.parentNode&&r.startOffset>i&&r.startOffset--,r.endContainer==e.parentNode&&r.endOffset>i&&r.endOffset--);if(e.parentNode.childNodes.length==1){u=r.startOffset,a=r.endOffset,r.startContainer===e.parentNode&&r.startOffset>M(e)&&(u=r.startOffset+(n(e).contents().length-1)),r.endContainer===e.parentNode&&r.endOffset>M(e)&&(a=r.endOffset+(n(e).contents().length-1)),n(e).contents().unwrap(),r.startOffset=u,r.endOffset=a;break}var l=e.parentNode;fn([e],r);if(l===e.parentNode){u=r.startOffset,a=r.endOffset,r.startContainer===e.parentNode&&r.startOffset>
M(e)&&(u=r.startOffset+(n(e).contents().length-1)),r.endContainer===e.parentNode&&r.endOffset>M(e)&&(a=r.endOffset+(n(e).contents().length-1)),n(e).contents().unwrap(),r.startOffset=u,r.endOffset=a;break}}Zt(o,r)}function bn(e,n){function i(e){return p(e,["OL","UL"])}if(!c(e,"LI")||!ft(e)||!ft(e.parentNode))return;var r=null;while(t(e.childNodes).some(i)){var s=e.lastChild;p(s,["OL","UL"])||!r&&s.nodeType==t.Node.TEXT_NODE&&/^[ \t\n\f\r]*$/.test(s.data)?(r=null,St(s,e.parentNode,1+M(e),n)):(r||(r=e.ownerDocument.createElement("li"),e.parentNode.insertBefore(r,e.nextSibling)),St(s,r,0,n))}}function wn(e,t){if(!p(e,["OL","UL"])||!ft(e))return;var r=n(e);r.children("ol,ul").each(function(e,n){c(n.previousSibling,"LI")&&St(n,n.previousSibling,n.previousSibling.childNodes.length,t)})}function En(n){var r=n.startContainer,i=n.startOffset,s=n.endContainer,o=n.endOffset,u=t(N(r).concat(r)).filter(function(e){return c(e,"li")}).slice(-1);u.length&&(i=M(u[0]),r=u[0].parentNode);if(!rn(r,i))do i==0?(i=M(r),r=r.parentNode):i--;while(!on(r,i));while(i==0&&r.parentNode)i=M(r),r=r.parentNode;u=t(N(s).concat(s)).filter(function(e){return c(e,"li")}).slice(-1),u.length&&(o=1+M(u[0]),s=u[0].parentNode);if(!sn(s,o))do o==_(s)?(o=1+M(s),s=s.parentNode):o++;while(!on(s,o));while(o==_(s)&&s.parentNode)o=1+M(s),s=s.parentNode;var a=e.createRange();return a.setStart(r,i),a.setEnd(s,o),a}function Sn(){var e=En(Et()),n=B(e,function(e){return ft(e)&&!ln(e)&&(p(e,["ol","ul"])||p(e.parentNode,["ol","ul"])||jt(e,"li"))});if(!n.length)return"none";if(t(n).every(function(e){return c(e,"ol")||c(e.parentNode,"ol")||c(e.parentNode,"li")&&c(e.parentNode.parentNode,"ol")})&&!t(n).some(function(e){return c(e,"ul")||e.querySelector&&e.querySelector("ul")}))return"ol";if(t(n).every(function(e){return c(e,"ul")||c(e.parentNode,"ul")||c(e.parentNode,"li")&&c(e.parentNode.parentNode,"ul")})&&!t(n).some(function(e){return c(e,"ol")||e.querySelector&&e.querySelector("ol")}))return"ul";var r=t(n).some(function(e){return c(e,"ol")||c(e.parentNode,"ol")||e.querySelector&&e.querySelector("ol")||c(e.parentNode,"li")&&c(e.parentNode.parentNode,"ol")}),i=t(n).some(function(e){return c(e,"ul")||c(e.parentNode,"ul")||e.querySelector&&e.querySelector("ul")||c(e.parentNode,"li")&&c(e.parentNode.parentNode,"ul")});return r&&i?"mixed":r?"mixed ol":i?"mixed ul":"none"}function xn(e){while(e&&e.nodeType!=t.Node.ELEMENT_NODE||e.nodeType==t.Node.ELEMENT_NODE&&n.inArray(t.getComputedStyle(e).display,["inline","none"])!=-1)e=e.parentNode;if(!e||e.nodeType!=t.Node.ELEMENT_NODE)return"left";var r=t.getComputedStyle(e).textAlign.replace(/^-(moz|webkit)-/,"").replace(/^auto$/,"start");return r=="start"?O(e)=="ltr"?"left":"right":r=="end"?O(e)=="ltr"?"right":"left":n.inArray(r,["center","justify","left","right"])!=-1?r:"left"}function Tn(e){var n=[];return z("createlink",e)!==undefined&&n.push(["createlink",z("createlink",e)]),t(["bold","italic","strikethrough","subscript","superscript","underline"]).forEach(function(t){q(t,e)!==undefined&&n.push([t,q(t,e)])}),t(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(t){z(t,e)!==undefined&&n.push([t,z(t,e)])}),n}function Nn(e){var n=[],r=t(qt(e)).filter(function(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE})[0];return r?(n.push(["createlink",u.createlink.value(e)]),t(["bold","italic","strikethrough","subscript","superscript","underline"]).forEach(function(e){t(u[e].inlineCommandActivatedValues).indexOf(Xt(r,e))!=-1?n.push([e,!0]):n.push([e,!1])}),t(["fontname","fontsize","forecolor","hilitecolor"]).forEach(function(t){n.push([t,u[t].value(e)])}),n.push(["fontsize",Xt(r,"fontsize")]),n):n}function Cn(e,n){function u(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE}var r,i,s,o=t(qt(n)).filter(function(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE})[0];if(o)for(r=0;r<e.length;r++){i=e[r][0],s=e[r][1];if(typeof s=="boolean"&&et(i,n)!=s)Y(i);else if(typeof s=="string"&&i!="fontsize"&&!zt(i,nt(i,n),s))Y(i,!1,s,n);else{if(typeof s!="string"||i!="fontsize"||!(z("fontsize",n)!==undefined&&z("fontsize",n)!==s||z("fontsize",n)===undefined&&!Wt(i,Xt(o,"fontsize"),s)))continue;Y("fontsize",!1,s,n)}o=t(qt(n)).filter(u)[0]||o}else for(r=0;r<e.length;r++)i=e[r][0],s=e[r][1],typeof s=="boolean"&&R(i,s,n),typeof s=="string"&&W(i,s,n)}function kn(e,t,n){if(e==0)return"";if(e==1&&!t&&!n)return" ";if(e==1)return" ";var r="",i;t?i="  ":i="  ";while(e>3)r+=i,e-=2;return e==3?r+=!t&&!n?"   ":t&&!n?"   ":!t&&n?"   ":t&&n?"   ":"impossible":r+=!t&&!n?"  ":t&&!n?"  ":!t&&n?"  ":t&&n?"  ":"impossible",r}function Ln(e,r){if(!ft(e)&&!at(e))return;var i=e,s=r;for(;;)if(0<=s-1&&ht(i,i.childNodes[s-1]))i=i.childNodes[s-1],s=_(i);else if(s==0&&!un(i)&&ht(i,i.parentNode))s=M(i),i=i.parentNode;else{if(i.nodeType!=t.Node.TEXT_NODE||n.inArray(t.getComputedStyle(i.parentNode).whiteSpace,["pre","pre-wrap"])!=-1||s==0||!/[ \xa0]/.test(i.data[s-1]))break;s--}var o=i,u=s,a=0,f=!1;for(;;)if(u<o.childNodes.length&&ht(o,o.childNodes[u]))o=o.childNodes[u],u=0;else if(u==_(o)&&!an(o)&&ht(o,o.parentNode))u=1+M(o),o=o.parentNode;else{if(o.nodeType!=t.Node.TEXT_NODE||n.inArray(t.getComputedStyle(o.parentNode).whiteSpace,["pre","pre-wrap"])!=-1||u==_(o)||!/[ \xa0]/.test(o.data[u]))break;if(f&&" "==o.data[u]){o.deleteData(u,1);continue}f=" "==o.data[u],u++,a++}var l=kn(a,s==0&&un(i),u==_(o)&&an(o));while(D(i,s,o,u)=="before")if(s<i.childNodes.length)i=i.childNodes[s],s=0;else if(i.nodeType!=t.Node.TEXT_NODE||s==_(i))s=1+M(i),i=i.parentNode;else{var c=l[0];l=l.slice(1),c!=i.data[s]&&(i.insertData(s,c),i.deleteData(s+1,1)),s++}}function An(n,r,i,s,o){var u,a={},f;arguments.length<3?u=n:(u=e.createRange(),u.setStart(n,r),u.setEnd(i,s)),arguments.length==2&&(a=r),arguments.length==5&&(a=o);var l=null!=a.blockMerging?!!a.blockMerging:!0,h=null!=a.stripWrappers?!!a.stripWrappers:!0;if(!u)return;var d=u.startContainer,v=u.startOffset,g=u.endContainer,y=u.endOffset,b;while(d.hasChildNodes()){if(v==_(d)&&ht(d,d.parentNode)&&ut(d)){v=1+M(d),d=d.parentNode;continue}if(v==_(d))break;b=d.childNodes[v];if(ot(b)||b.nodeType==t.Node.ELEMENT_NODE&&!b.hasChildNodes()||b.nodeType!=t.Node.ELEMENT_NODE&&b.nodeType!=t.Node.TEXT_NODE)break;d=b,v=0}while(g.hasChildNodes()){if(y==0&&ht(g,g.parentNode)&&ut(g)){y=M(g),g=g.parentNode;continue}if(y==0)break;b=g.childNodes[y-1];if(ot(b)||b.nodeType==t.Node.ELEMENT_NODE&&!b.hasChildNodes()||b.nodeType!=t.Node.ELEMENT_NODE&&b.nodeType!=t.Node.TEXT_NODE)break;g=b,y=_(b)}if(D(g,y,d,v)!=="after"){u.setEnd(u.startContainer,u.startOffset);return}g.nodeType==t.Node.TEXT_NODE&&y==_(g)&&d!=g&&(y=1+M(g),g=g.parentNode),u.setStart(d,v),u.setEnd(g,y);var E=u.startContainer;while(ht(E,E.parentNode)&&ut(E))E=E.parentNode;if(!ot(E)&&!at(E)||!jt("span",E)||p(E,["td","th"]))E=null;var x=u.endContainer;while(ht(x,x.parentNode)&&ut(x))x=x.parentNode;if(!ot(x)&&!at(x)||!jt("span",x)||p(x,["td","th"]))x=null;var T=Nn(u),N;if(d==g&&ft(d)&&d.nodeType==t.Node.TEXT_NODE){N=d.parentNode,d.deleteData(v,y-v),v>0&&d.data.substr(v-1,1)===" "&&v<d.data.length&&d.data.substr(v,1)===" "&&d.replaceData(v-1,1," "),Ln(d,v),u.setStart(u.startContainer,u.startOffset),u.setEnd(u.startContainer,u.startOffset),Cn(T,u),(ft(N)||at(N))&&!ut(N)&&gn(N);return}ft(d)&&d.nodeType==t.Node.TEXT_NODE&&d.deleteData(v,_(d)-v);var C=B(u,function(e){return ft(e)&&!p(e,["thead","tbody","tfoot","tr","th","td"])});for(f=0;f<C.length;f++){var k=C[f];N=k.parentNode,N.removeChild(k);if(h||!w(N,d)&&N!=d)while(ft(N)&&ut(N)&&_(N)==0){var L=N.parentNode;L.removeChild(N),N=L}(ft(N)||at(N))&&!ut(N)&&gn(N)}ft(g)&&g.nodeType==t.Node.TEXT_NODE&&g.deleteData(0,y),Ln(u.startContainer,u.startOffset),Ln(u.endContainer,u.endOffset);if(!l||!E||!x||!ht(E,x)||E==x){u.setEnd(u.startContainer,u.startOffset),Cn(T,u);return}E.children.length==1&&wt(E.firstChild)&&E.removeChild(E.firstChild),x.children.length==1&&wt(x.firstChild)&&x.removeChild(x.firstChild);var A;if(w(E,x)){b=x;while(b.parentNode!=E)b=b.parentNode;u.setStart(E,M(b)),u.setEnd(E,M(b));if(!x.hasChildNodes()){while(ft(x)&&x.parentNode.childNodes.length==1&&x.parentNode!=E)N=x,N.removeChild(x),x=N;ft(x)&&!ut(x)&&ut(x.previousSibling)&&ut(x.nextSibling)&&x.parentNode.insertBefore(document.createElement("br"),x.nextSibling),ft(x)&&x.parentNode.removeChild(x),Cn(T,u);return}if(!ut(x.firstChild)){Cn(T,u);return}var O=[];O.push(x.firstChild);while(!c(O[O.length-1],"br")&&ut(O[O.length-1].nextSibling))O.push(O[O.length-1].nextSibling);A=Kt(O);while(O[0].parentNode!=E)fn(O,u);ft(O[0].previousSibling)&&c(O[0].previousSibling,"br")&&O[0].parentNode.removeChild(O[0].previousSibling)}else if(S(E,x)){u.setStart(E,_(E)),u.setEnd(E,_(E)),b=E;while(b.parentNode!=x)b=b.parentNode;ut(b.nextSibling)&&c(E.lastChild,"br")&&E.removeChild(E.lastChild);var P=[];b.nextSibling&&!c(b.nextSibling,"br")&&!ot(b.nextSibling)&&P.push(b.nextSibling),P.length&&P[P.length-1].nextSibling&&!c(P[P.length-1].nextSibling,"br")&&!ot(P[P.length-1].nextSibling)&&P.push(P[P.length-1].nextSibling),A=Kt(P),t(P).forEach(function(e){St(e,E,-1,u)}),c(b.nextSibling,"br")&&b.parentNode.removeChild(b.nextSibling)}else{u.setStart(E,_(E)),u.setEnd(E,_(E)),ut(x.firstChild)&&c(E.lastChild,"br")&&E.removeChild(E.lastChild),A=Kt([].slice.call(m(x.childNodes)));while(x.hasChildNodes())St(x.firstChild,E,-1,u);while(!x.hasChildNodes())N=x.parentNode,N.removeChild(x),x=N}Zt(A,u),gn(E),Cn(T,u)}function On(e,t){e.hasChildNodes()?fn([].slice.call(m(e.childNodes)),t):e.parentNode.removeChild(e)}function Mn(e,t){e&&n(e).find("ul,ol,li").each(function(){n(this).contents().each(function(){if(vt(this)){var e=M(this);t.startContainer===this.parentNode&&t.startOffset>e?t.startOffset--:t.startContainer===this&&(t.startContainer=this.parentNode,t.startOffset=e),t.endContainer===this.parentNode&&t.endOffset>e?t.endOffset--:t.endContainer===this&&(t.endContainer=this.parentNode,t.endOffset=e),n(this).remove()}})})}function _n(e,t){if(!e.length)return;var n=e[0];if(p(n.parentNode,["OL","UL"])){var r=n.parentNode.tagName;Lt(e,function(e){return f(e,r)},function(){return n.ownerDocument.createElement(r)},t);return}var i=Lt(e,function(e){return cn(e)},function(){return n.ownerDocument.createElement("blockquote")},t);yn(i,t)}function Dn(e,n){if(!ft(e))return;if(cn(e)){On(e,n);return}if(ln(e)){e.removeAttribute("class"),e.removeAttribute("dir"),e.style.margin="",e.style.padding="",e.style.border="",e.getAttribute("style")==""&&e.removeAttribute("style"),Tt(e,"div",n);return}var r=e.parentNode,i=[];while(ft(r)&&r.nodeType==t.Node.ELEMENT_NODE&&!cn(r)&&!p(r,["ol","ul"]))i.push(r),r=r.parentNode;if(!ft(r)||!cn(r)){r=e.parentNode,i=[];while(ft(r)&&r.nodeType==t.Node.ELEMENT_NODE&&!ln(r)&&!p(r,["ol","ul"]))i.push(r),r=r.parentNode}if(p(e,["OL","UL"])&&(!ft(r)||!ln(r))){e.removeAttribute("reversed"),e.removeAttribute("start"),e.removeAttribute("type");var s=[].slice.call(m(e.childNodes));if(e.attributes.length&&!p(e.parentNode,["OL","UL"]))Tt(e,"div",n);else{var o=Kt([].slice.call(m(e.childNodes)));On(e,n),Zt(o,n)}var u;for(u=0;u<s.length;u++)yn(s[u],n);return}if(!ft(r)||!ln(r))return;i.push(r);var a=r;while(i.length){r=i.pop();var f=e.parentNode==r?e:i[i.length-1];ut(f)&&!c(f,"BR")&&c(f.nextSibling,"BR")&&f.parentNode.removeChild(f.nextSibling);var l=[].slice.call(m(r.childNodes),0,M(f)),h=[].slice.call(m(r.childNodes),1+M(f));_n(l,n),_n(h,n)}Dn(a,n)}function Pn(e,n){function h(){return document.createElement("li")}function d(e){return p(e,["ol","ul"])}function v(e){return function(t){return f(t,e)}}function g(e){return function(){return document.createElement(e)}}function y(e,t,n){return function(){if(!ft(t[0].parentNode)||!cn(t[0].parentNode)||!ft(t[0].parentNode.previousSibling)||!f(t[0].parentNode.previousSibling,e))return document.createElement(e);var r=t[0].parentNode.previousSibling;return bn(r.lastChild,n),(!ft(r.lastChild)||!f(r.lastChild,e))&&r.appendChild(document.createElement(e)),r.lastChild}}var r=Sn()==e?"disable":"enable";e=e.toUpperCase();var i=e=="OL"?"UL":"OL",s=[];(function(){var e;for(e=n.endContainer;e!=n.commonAncestorContainer;e=e.parentNode)c(e,"li")&&s.unshift(e);for(e=n.startContainer;e;e=e.parentNode)c(e,"li")&&s.unshift(e)})(),t(s).forEach(function(e){bn(e,n)});var o=En(n);r=="enable"&&t(j(o,function(e){return ft(e)&&f(e,i)})).forEach(function(t){if(ft(t.previousSibling)&&f(t.previousSibling,e)||ft(t.nextSibling)&&f(t.nextSibling,e)){var r=[].slice.call(m(t.childNodes)),i=Kt(r);fn(r,n),Lt(r,function(t){return f(t,e)},function(){return null},n),Zt(i,n)}else Tt(t,e,n)});var u=B(o,function(e){return ft(e)&&!ln(e)&&(p(e,["OL","UL"])||p(e.parentNode,["OL","UL"])||jt(e,"li"))});r=="enable"&&(u=t(u).filter(function(e){return!p(e,["ol","ul"])||p(e.parentNode,["ol","ul"])}));var a,l;if(r=="disable")while(u.length){a=[],a.push(u.shift());if(f(a[0],e)){Dn(a[0],n);continue}while(u.length&&u[0]==a[a.length-1].nextSibling&&!f(u[0],e))a.push(u.shift());l=Kt(a),fn(a,n);var b;for(b=0;b<a.length;b++)yn(a[b],n);Zt(l,n)}else while(u.length){a=[];while(!a.length||u.length&&u[0]==a[a.length-1].nextSibling)if(p(u[0],["p","div"]))a.push(Tt(u[0],"li",n)),u.shift();else if(p(u[0],["li","ol","ul"]))a.push(u.shift());else{var w=[];while(!w.length||u.length&&u[0]==w[w.length-1].nextSibling&&ut(u[0])&&ut(w[w.length-1])&&!c(w[w.length-1],"br"))w.push(u.shift());a.push(Lt(w,undefined,h,n))}if(f(a[0].parentNode,e)||t(a).every(d))continue;if(f(a[0].parentNode,i)){l=Kt(a),fn(a,n),Lt(a,v(e),g(e),n),Zt(l,n);continue}yn(Lt(a,v(e),y(e,a,n),n),n)}}function Hn(e,n){function l(e){return function(n){return c(n,"div")&&t(n.attributes).every(function(t){return t.name=="align"&&t.value.toLowerCase()==e||t.name=="style"&&v(n)==1&&n.style.textAlign==e})}}function h(e){return function(){var t=document.createElement("div");return t.setAttribute("style","text-align: "+e),t}}var i=En(n),s=j(i,function(e){return e.nodeType==t.Node.ELEMENT_NODE&&ft(e)&&(r(e,"align")||e.style.textAlign!=""||c(e,"center"))}),u;for(u=0;u<s.length;u++){var a=s[u];a.removeAttribute("align"),a.style.textAlign="",a.getAttribute("style")==""&&a.removeAttribute("style"),p(a,["div","span","center"])&&!a.attributes.length&&On(a,n),c(a,"center")&&a.attributes.length&&Tt(a,"div",n)}i=En(o);var f=[];f=B(i,function(t){return ft(t)&&jt(t,"div")&&xn(t)!=e});while(f.length){var d=[];d.push(f.shift());while(f.length&&f[0]==d[d.length-1].nextSibling)d.push(f.shift());Lt(d,l(e),h(e),n)}}function Bn(e,n){var r;if(!e.collapsed)return;r=e.startOffset;if(n){if(e.startContainer&&e.startContainer.nodeType===t.Node.TEXT_NODE)while(r<e.startContainer.data.length&&e.startContainer.data.charAt(r)==="​")r++}else if(e.startContainer&&e.startContainer.nodeType===t.Node.TEXT_NODE)while(r>0&&e.startContainer.data.charAt(r-1)==="​")r--;r!==e.startOffset&&(e.setStart(e.startContainer,r),e.setEnd(e.startContainer,r))}var i="http://www.w3.org/1999/xhtml",s=!1,o=null,u={},q,R,U,z,W,X,V=0,rt={ADDRESS:!0,ARTICLE:!0,ASIDE:!0,BLOCKQUOTE:!0,CAPTION:!0,CENTER:!0,COL:!0,COLGROUP:!0,DD:!0,DETAILS:!0,DIR:!0,DIV:!0,DL:!0,DT:!0,FIELDSET:!0,FIGCAPTION:!0,FIGURE:!0,FOOTER:!0,FORM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,HEADER:!0,HGROUP:!0,HR:!0,LI:!0,LISTING:!0,MENU:!0,NAV:!0,OL:!0,P:!0,PLAINTEXT:!0,PRE:!0,SECTION:!0,SUMMARY:!0,TABLE:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0,UL:!0,XMP:!0},st={inline:!0,"inline-block":!0,"inline-table":!0,none:!0};(function(){function r(r){if(!n||n.startContainer!=r.startContainer||n.endContainer!=r.endContainer||n.startOffset!=r.startOffset||n.endOffset!=r.endOffset)e={},t={},n=r.cloneRange()}var e={},t={},n=null;q=function(t,n){return r(n),e[t]},R=function(t,n,i){r(i),e[t]=n},U=function(t,n){r(n),delete e[t]},z=function(e,n){return r(n),t[e]},W=function(e,n,i){r(i),t[e]=n,e=="backcolor"?t.hilitecolor=n:e=="hilitecolor"&&(t.backcolor=n)},X=function(e,n){r(n),delete t[e],e=="backcolor"?delete t.hilitecolor:e=="hilitecolor"&&delete t.backcolor}})();var At={A:!0,ABBR:!0,B:!0,BDI:!0,BDO:!0,CITE:!0,CODE:!0,DFN:!0,EM:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,I:!0,KBD:!0,MARK:!0,P:!0,PRE:!0,Q:!0,RP:!0,RT:!0,RUBY:!0,S:!0,SAMP:!0,SMALL:!0,SPAN:!0,STRONG:!0,SUB:!0,SUP:!0,U:!0,VAR:!0,ACRONYM:!0,LISTING:!0,STRIKE:!0,XMP:!0,BIG:!0,BLINK:!0,FONT:!0,MARQUEE:!0,NOBR:!0,TT:!0},Ot={colgroup:!0,table:!0,tbody:!0,tfoot:!0,thead:!0,tr:!0},Mt={script:!0,style:!0,plaintext:!0,xmp:!0},_t=n.extend({H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0},rt),Dt={CAPTION:!0,COL:!0,COLGROUP:!0,TBODY:!0,TD:!0,TFOOT:!0,TH:!0,THEAD:!0,TR:!0},Pt={DD:!0,DT:!0},Ht={A:n.extend({A:!0},rt),DD:Pt,DT:Pt,LI:{LI:!0},NOBR:n.extend({NOBR:!0},rt),H1:_t,H2:_t,H3:_t,H4:_t,H5:_t,H6:_t,TD:Dt,TH:Dt,ABBR:rt,B:rt,BDI:rt,BDO:rt,CITE:rt,CODE:rt,DFN:rt,EM:rt,I:rt,KBD:rt,MARK:rt,P:rt,PRE:rt,Q:rt,RP:rt,RT:rt,RUBY:rt,S:rt,SAMP:rt,SMALL:rt,SPAN:rt,STRONG:rt,SUB:rt,SUP:rt,U:rt,VAR:rt,ACRONYM:rt,LISTING:rt,STRIKE:rt,XMP:rt,BIG:rt,BLINK:rt,FONT:rt,MARQUEE:rt,TT:rt},Jt=["subscript","bold","fontname","fontsize","forecolor","hilitecolor","italic","strikethrough","underline"];u.backcolor={action:function(e,t){/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e);if(!/^(rgba?|hsla?)\(.*\)$/.test(e)&&!I(e)&&e.toLowerCase()!="transparent")return;en("backcolor",e,t)},standardInlineValueCommand:!0,relevantCssProperty:"backgroundColor",equivalentValues:function(e,t){return F(e)===F(t)}},u.bold={action:function(e,t){et("bold",t)?en("bold","normal",t):en("bold","bold",t)},inlineCommandActivatedValues:["bold","600","700","800","900"],relevantCssProperty:"fontWeight",equivalentValues:function(e,t){return e==t||e=="bold"&&t=="700"||e=="700"&&t=="bold"||e=="normal"&&t=="400"||e=="400"&&t=="normal"}},u.createlink={action:function(e,n){if(e==="")return;t(qt(Et())).forEach(function(n){t(N(n)).forEach(function(t){ft(t)&&c(t,"a")&&r(t,"href")&&t.setAttribute("href",e)})}),en("createlink",e,n)},standardInlineValueCommand:!0},u.fontname={action:function(e,t){en("fontname",e,t)},standardInlineValueCommand:!0,relevantCssProperty:"fontFamily"},u.fontsize={action:function(e,t){if(e==="")return;e=$(e);if(n.inArray(e,["xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large"])==-1&&!/^[0-9]+(\.[0-9]+)?(cm|mm|in|pt|pc)$/.test(e))return;en("fontsize",e,t)},indeterm:function(){return t(qt(Et(),function(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE})).map(function(e){return Xt(e,"fontsize")},!0).filter(function(e,n,r){return t(r.slice(0,n)).indexOf(e)==-1}).length>=2},value:function(e){var n=qt(e,function(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE})[0];n===undefined&&(n=e.startContainer);var r=Xt(n,"fontsize");return J(r)},relevantCssProperty:"fontSize"},u.forecolor={action:function(e,t){/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e);if(!/^(rgba?|hsla?)\(.*\)$/.test(e)&&!I(e)&&e.toLowerCase()!="transparent")return;en("forecolor",e,t)},standardInlineValueCommand:!0,relevantCssProperty:"color",equivalentValues:function(e,t){return F(e)===F(t)}},u.hilitecolor={action:function(e,t){/^([0-9a-fA-F]{3}){1,2}$/.test(e)&&(e="#"+e);if(!/^(rgba?|hsla?)\(.*\)$/.test(e)&&!I(e)&&e.toLowerCase()!="transparent")return;en("hilitecolor",e,t)},indeterm:function(){return t(qt(Et(),function(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE})).map(function(e){return Xt(e,"hilitecolor")},!0).filter(function(e,n,r){return t(r.slice(0,n)).indexOf(e)==-1}).length>=2},standardInlineValueCommand:!0,relevantCssProperty:"backgroundColor",equivalentValues:function(e,t){return F(e)===F(t)}},u.italic={action:function(e,t){et("italic",t)?en("italic","normal",t):en("italic","italic",t)},inlineCommandActivatedValues:["italic","oblique"],relevantCssProperty:"fontStyle"},u.removeformat={action:function(e,n){function o(e){return ft(e)&&p(e,["abbr","acronym","b","bdi","bdo","big","blink","cite","code","dfn","em","font","i","ins","kbd","mark","nobr","q","s","samp","small","span","strike","strong","sub","sup","tt","u","var"])}var r,i,s,u=qt(Et(),o);t(u).forEach(function(e){while(e.hasChildNodes())St(e.firstChild,e.parentNode,M(e),Et());e.parentNode.removeChild(e)}),ft(Et().startContainer)&&Et().startContainer.nodeType==t.Node.TEXT_NODE&&Et().startOffset!=0&&Et().startOffset!=_(Et().startContainer)&&(Et().startContainer==Et().endContainer?(r=Et().endOffset-Et().startOffset,s=Et().startContainer.splitText(Et().startOffset),Et().setStart(s,0),Et().setEnd(s,r)):Et().setStart(Et().startContainer.splitText(Et().startOffset),0)),ft(Et().endContainer)&&Et().endContainer.nodeType==t.Node.TEXT_NODE&&Et().endOffset!=0&&Et().endOffset!=_(Et().endContainer)&&(i=[Et().startContainer,Et().startOffset],r=[Et().endContainer,Et().endOffset],Et().setEnd(document.documentElement,0),r[0].splitText(r[1]),Et().setStart(i[0],i[1]),Et().setEnd(r[0],r[1])),t(qt(Et(),ft)).forEach(function(e){while(o(e.parentNode)&&ht(e.parentNode,e))fn([e],Et())}),t(["subscript","bold","fontname","fontsize","forecolor","hilitecolor","italic","strikethrough","underline"]).forEach(function(e){en(e,null,n)})}},u.strikethrough={action:function(e,t){et("strikethrough",t)?en("strikethrough",null,t):en("strikethrough","line-through",t)},inlineCommandActivatedValues:["line-through"]},u.subscript={action:function(e,t){var n=et("subscript",t);en("subscript",null,t),n||en("subscript","subscript",t)},indeterm:function(){var e=qt(Et(),function(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE});return t(e).some(function(e){return Xt(e,"subscript")=="subscript"})&&t(e).some(function(e){return Xt(e,"subscript")!="subscript"})||t(e).some(function(e){return Xt(e,"subscript")=="mixed"})},inlineCommandActivatedValues:["subscript"]},u.superscript={action:function(e,t){var n=et("superscript",t);en("superscript",null,t),n||en("superscript","superscript",t)},indeterm:function(){var e=qt(Et(),function(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE});return t(e).some(function(e){return Xt(e,"superscript")=="superscript"})&&t(e).some(function(e){return Xt(e,"superscript")!="superscript"})||t(e).some(function(e){return Xt(e,"superscript")=="mixed"})},inlineCommandActivatedValues:["superscript"]},u.underline={action:function(e,t){et("underline",t)?en("underline",null,t):en("underline","underline",t)},inlineCommandActivatedValues:["underline"]},u.unlink={action:function(){var e=Et(),t=[],n;for(n=e.startContainer;n;n=n.parentNode)c(n,"A")&&r(n,"href")&&t.unshift(n);for(n=e.startContainer;n!=g(e.endContainer);n=y(n))c(n,"A")&&r(n,"href")&&(H(n,e)||w(n,e.endContainer)||n==e.endContainer)&&t.push(n);var i;for(i=0;i<t.length;i++)Qt(t[i],"unlink",e)},standardInlineValueCommand:!0};var dn="p";u["delete"]={action:function(r,i){var s;n.browser.msie&&n.browser.version<=7&&Bn(i,!1);if(!i.collapsed){An(i);return}Ln(i.startContainer,i.startOffset);var o=i.startContainer,u=i.startOffset,a=!1,f=!1;for(;;){u>0&&(a=c(o.childNodes[u-1],"br")||!1,f=c(o.childNodes[u-1],"hr")||!1);if(u==0&&ft(o.previousSibling)&&bt(o.previousSibling)){o.parentNode.removeChild(o.previousSibling);continue}if(0<=u-1&&u-1<o.childNodes.length&&ft(o.childNodes[u-1])&&(bt(o.childNodes[u-1])||a||f)){o.removeChild(o.childNodes[u-1]),u--;if(a||f){i.setStart(o,u),i.setEnd(o,u);return}continue}if(u==0&&ut(o)||bt(o)){u=M(o),o=o.parentNode;continue}if(0<=u-1&&u-1<o.childNodes.length&&ft(o.childNodes[u-1])&&c(o.childNodes[u-1],"a")){On(o.childNodes[u-1],i);return}if(0<=u-1&&u-1<o.childNodes.length&&!ot(o.childNodes[u-1])&&!p(o.childNodes[u-1],["br","img"])){o=o.childNodes[u-1],u=_(o);continue}var l=!0;if(l)break}var h=nn(o,u);if(h){h.parentNode.removeChild(h);return}if(o.nodeType==t.Node.TEXT_NODE&&u!=0){i.setStart(o,u-1),i.setEnd(o,u-1),An(o,u-1,o,u);return}if(o.nodeType==t.Node.TEXT_NODE&&u==0&&n.browser.msie){u=1,i.setStart(o,u),i.setEnd(o,u),i.startOffset=0,An(i);return}if(ut(o))return;if(0<=u-1&&u-1<o.childNodes.length&&p(o.childNodes[u-1],["br","hr","img"])){i.setStart(o,u),i.setEnd(o,u),An(i);return}if(p(o,["li","dt","dd"])&&o==o.parentNode.firstChild&&u==0){var d=[],v;for(v=o.parentNode;v;v=v.parentNode)c(v,"li")&&d.unshift(v);for(s=0;s<d.length;s++)bn(d[s],i);var m=Kt([o]);fn([o],i),Zt(m,i),p(o,["dd","dt"])&&t(N(o)).every(function(e){return!ht(o,e)||!jt(o,e)})&&(o=Tt(o,dn,i)),yn(o,i);for(s=0;s<d.length;s++)wn(d[s].parentNode,i);return}var g=o,y=u;for(;;)if(y==0)y=M(g),g=g.parentNode;else{if(!(0<=y-1&&y-1<g.childNodes.length&&ft(g.childNodes[y-1])&&bt(g.childNodes[y-1])))break;g.removeChild(g.childNodes[y-1]),y--}if(u==0&&t(N(o).concat(o)).filter(function(e){return ft(e)&&ht(e,o)&&ln(e)}).length){var b=e.createRange();b.setStart(o,0),b.setEnd(o,0),b=En(b);var w=B(b,function(e){return ft(e)&&!lt(e)});for(s=0;s<w.length;s++)Dn(w[s],i);return}if(c(g.childNodes[y],"table"))return;if(0<=y-1&&y-1<g.childNodes.length&&c(g.childNodes[y-1],"table")){i.setStart(g,y-1),i.setEnd(g,y);return}if(u==0&&(c(g.childNodes[y-1],"hr")||c(g.childNodes[y-1],"br")&&(c(g.childNodes[y-1].previousSibling,"br")||!ut(g.childNodes[y-1].previousSibling)))){i.setStart(o,u),i.setEnd(o,u),An(g,y-1,g,y);return}if(p(g.childNodes[y],["li","dt","dd"])&&ut(g.childNodes[y].firstChild)&&y!=0){var S=g.childNodes[y-1];ut(S.lastChild)&&!c(S.lastChild,"br")&&S.appendChild(document.createElement("br")),ut(S.lastChild)&&S.appendChild(document.createElement("br"))}if(p(g.childNodes[y],["li","dt","dd"])&&p(g.childNodes[y-1],["li","dt","dd"]))g=g.childNodes[y-1],y=_(g),o=g.nextSibling,u=0;else while(0<=y-1&&y-1<g.childNodes.length)ft(g.childNodes[y-1])&&bt(g.childNodes[y-1])?(g.removeChild(g.childNodes[y-1]),y--):(g=g.childNodes[y-1],y=_(g));var x=e.createRange();x.setStart(g,y),x.setEnd(o,u),An(x),E(document.body,i.startContainer)||(x.startContainer.hasChildNodes()||x.startContainer.nodeType==t.Node.TEXT_NODE?(i.setStart(x.startContainer,x.startOffset),i.setEnd(x.startContainer,x.startOffset)):(i.setStart(x.startContainer.parentNode,M(x.startContainer)),i.setEnd(x.startContainer.parentNode,M(x.startContainer))))}};var jn=["address","dd","div","dt","h1","h2","h3","h4","h5","h6","p","pre"];u.formatblock={action:function(e){function u(e){return function(n){return ft(n)&&ht(n,e)&&f(n,jn)&&!t(C(n)).some(it)}}function a(e){return function(t){return f(t,e)&&!t.attributes.length}}function l(){return!1}function h(e){return function(){return document.createElement(e)}}var r;/^<.*>$/.test(e)&&(e=e.slice(1,-1)),e=e.toLowerCase();if(t(jn).indexOf(e)==-1)return;var i=En(Et()),s=B(i,function(e){return ft(e)&&(hn(e)||jt(e,"p")||p(e,["dd","dt"]))&&!t(C(e)).some(it)}),o=Kt(s);for(r=0;r<s.length;r++){var d=s[r];while(t(N(d)).some(u(d)))fn([d],i)}Zt(o,i);while(s.length){var v;if(pn(s[0]))v=[].slice.call(m(s[0].childNodes)),o=Kt(v),On(s[0],i),Zt(o,i),s.shift();else{v=[],v.push(s.shift());while(s.length&&s[0]==v[v.length-1].nextSibling&&!pn(s[0])&&!c(v[v.length-1],"BR"))v.push(s.shift())}yn(Lt(v,n.inArray(e,["div","p"])==-1?a(e):l,h(e),i),i)}},indeterm:function(){var e=En(Et()),n=j(e,function(e){return yt(e)&&ft(e)&&!e.hasChildNodes()});if(!n.length)return!1;var r=null,i;for(i=0;i<n.length;i++){var s=n[i];while(ft(s.parentNode)&&ht(s,s.parentNode)&&!f(s,jn))s=s.parentNode;var o="";ft(s)&&f(s,jn)&&!t(C(s)).some(it)&&(o=s.tagName);if(r===null)r=o;else if(r!=o)return!0}return!1},value:function(){var e=En(Et()),n=j(e,function(e){return yt(e)&&ft(e)&&!e.hasChildNodes()});if(!n.length)return"";var r=n[0];while(ft(r.parentNode)&&ht(r,r.parentNode)&&!f(r,jn))r=r.parentNode;return ft(r)&&f(r,jn)&&!t(C(r)).some(it)?r.tagName.toLowerCase():""}},u.forwarddelete={action:function(e,r){n.browser.msie&&n.browser.version<=7&&Bn(r,!0);if(!r.collapsed){An(r);return}Ln(r.startContainer,r.startOffset);var i=r.startContainer,s=r.startOffset,o=!1,u=!1;for(;;)if(s==_(i)&&ft(i.nextSibling)&&bt(i.nextSibling))i.parentNode.removeChild(i.nextSibling);else if(s<i.childNodes.length&&ft(i.childNodes[s])&&(bt(i.childNodes[s])||o||u)){i.removeChild(i.childNodes[s]);if(o||u){gn(i),r.setStart(i,s),r.setEnd(i,s);return}}else if(s<i.childNodes.length&&wt(i.childNodes[s]))s++;else if(s==_(i)&&ut(i)||bt(i))s=1+M(i),i=i.parentNode;else{if(!(s<i.childNodes.length&&!ot(i.childNodes[s])&&!p(i.childNodes[s],["br","img"])))break;i=i.childNodes[s],s=0}Ln(r.startContainer,r.startOffset);var a=tn(i,s);if(a){a.parentNode.removeChild(a);return}var f;if(i.nodeType==t.Node.TEXT_NODE&&s!=_(i)){r.setStart(i,s),r.setEnd(i,s),f=s+1;while(f!=i.length&&/^[\u0300-\u036f\u0591-\u05bd\u05c1\u05c2]$/.test(i.data[f]))f++;An(i,s,i,f);return}if(ut(i))return;if(s<i.childNodes.length&&p(i.childNodes[s],["br","hr","img"])){r.setStart(i,s),r.setEnd(i,s),An(i,s,i,s+1);return}var l=i;f=s;for(;;)if(f==_(l))f=1+M(l),l=l.parentNode;else{if(!(f<l.childNodes.length&&ft(l.childNodes[f])&&bt(l.childNodes[f])))break;l.removeChild(l.childNodes[f])}if(c(l.childNodes[f-1],"table"))return;if(c(l.childNodes[f],"table")){r.setStart(l,f),r.setEnd(l,f+1);return}if(s==_(i)&&p(l.childNodes[f],["br","hr"])){r.setStart(i,s),r.setEnd(i,s),An(l,f,l,f+1);return}while(f<l.childNodes.length)ft(l.childNodes[f])&&bt(l.childNodes[f])?l.removeChild(l.childNodes[f]):(l=l.childNodes[f],f=0);An(i,s,l,f)}},u.indent={action:function(){var e=[],t;for(t=Et().endContainer;t!=Et().commonAncestorContainer;t=t.parentNode)c(t,"LI")&&e.unshift(t);for(t=Et().startContainer;t!=Et().commonAncestorContainer;t=t.parentNode)c(t,"LI")&&e.unshift(t);for(t=Et().commonAncestorContainer;t;t=t.parentNode)c(t,"LI")&&e.unshift(t);var n;for(n=0;n<e.length;n++)bn(e[n],Et());var r=En(Et()),i=[];i=B(r,function(e){return ft(e)&&(jt(e,"div")||jt(e,"ol"))}),i.length&&c(i[0],"LI")&&p(i[0].parentNode,["OL","UL"])&&c(i[0].previousSibling,"LI")&&bn(i[0].previousSibling,r);while(i.length){var s=[];s.push(i.shift());while(i.length&&i[0]==s[s.length-1].nextSibling)s.push(i.shift());_n(s,r)}}},u.inserthorizontalrule={action:function(n,r){while(r.startOffset==0&&r.startContainer.parentNode)r.setStart(r.startContainer.parentNode,M(r.startContainer));while(r.endOffset==_(r.endContainer)&&r.endContainer.parentNode)r.setEnd(r.endContainer.parentNode,1+M(r.endContainer));An(r,{blockMerging:!1});if(!ft(Et().startContainer)&&!at(Et().startContainer))return;Et().startContainer.nodeType==t.Node.TEXT_NODE&&Et().startOffset==0&&(Et().setStart(Et().startContainer.parentNode,M(Et().startContainer)),Et().collapse(!0)),Et().startContainer.nodeType==t.Node.TEXT_NODE&&Et().startOffset==_(Et().startContainer)&&(Et().setStart(Et().startContainer.parentNode,1+M(Et().startContainer)),Et().collapse(!0));var i=document.createElement("hr");r.insertNode(i),yn(i,r),r.setStart(i.parentNode,1+M(i)),r.setEnd(i.parentNode,1+M(i)),e.getSelection().removeAllRanges(),e.getSelection().addRange(r)}},u.inserthtml={action:function(e,n){An(n);if(!ft(n.startContainer)&&!at(n.startContainer))return;var r=n.createContextualFragment(e),i=r.lastChild;if(!i)return;var s=C(r);ot(n.startContainer)&&t(n.startContainer.childNodes).filter(function(e,t){return ft(e)&&wt(e)&&M(e)>=t.startOffset},!0).forEach(function(e){e.parentNode.removeChild(e)}),n.insertNode(r),ot(n.startContainer)&&gn(n.startContainer),n.setStart(i.parentNode,1+M(i)),n.setEnd(i.parentNode,1+M(i));var o;for(o=0;o<s.length;o++)yn(s[o],n);G(n)}},u.insertimage={action:function(t){if(t==="")return;var n=Et();An(n,{stripWrappers:!1});if(!ft(Et().startContainer)&&!at(Et().startContainer))return;ot(n.startContainer)&&n.startContainer.childNodes.length==1&&c(n.startContainer.firstChild,"br")&&n.startOffset==0&&n.startContainer.removeChild(n.startContainer.firstChild);var r=document.createElement("img");r.setAttribute("src",t),n.insertNode(r),n.setStart(r.parentNode,1+M(r)),n.setEnd(r.parentNode,1+M(r)),e.getSelection().removeAllRanges(),e.getSelection().addRange(n),r.removeAttribute("width"),r.removeAttribute("height")}},u.insertlinebreak={action:function(r,i){An(i,{stripWrappers:!1});if(!ft(i.startContainer)&&!at(i.startContainer))return;if(i.startContainer.nodeType==t.Node.ELEMENT_NODE&&!jt("br",i.startContainer))return;if(i.startContainer.nodeType!=t.Node.ELEMENT_NODE&&!jt("br",i.startContainer.parentNode))return;var s,o;i.startContainer.nodeType==t.Node.TEXT_NODE&&i.startOffset==0&&(s=i.startContainer.parentNode,o=M(i.startContainer),e.getSelection().collapse(s,o),i.setStart(s,o),i.setEnd(s,o)),i.startContainer.nodeType==t.Node.TEXT_NODE&&i.startOffset==_(i.startContainer)&&(s=i.startContainer.parentNode,o=1+M(i.startContainer),e.getSelection().collapse(s,o),i.setStart(s,o),i.setEnd(s,o));var u=document.createElement("br");i.insertNode(u),e.getSelection().collapse(u.parentNode,1+M(u)),i.setStart(u.parentNode,1+M(u)),i.setEnd(u.parentNode,1+M(u)),pt(u)&&(i.insertNode(mn()),e.getSelection().collapse(u.parentNode,1+M(u)),i.setStart(u.parentNode,1+M(u)),i.setEnd(u.parentNode,1+M(u))),n.browser.msie&&n.browser.version<8&&u.parentNode.removeAttribute("style")}},u.insertorderedlist={action:function(e,t){Pn("ol",t)},indeterm:function(){return/^mixed( ol)?$/.test(Sn())},state:function(){return Sn()=="ol"}};var Fn={LI:!0,DT:!0,DD:!0};return u.insertparagraph={action:function(n,r){var i;An(r),Mn(ct(r.startContainer
),r);if(!ft(r.startContainer)&&!at(r.startContainer))return;var s=r.startContainer,o=r.startOffset;s.nodeType==t.Node.TEXT_NODE&&o!=0&&o!=_(s)&&s.splitText(o),s.nodeType==t.Node.TEXT_NODE&&o==_(s)&&(o=1+M(s),s=s.parentNode);if(s.nodeType==t.Node.TEXT_NODE||s.nodeType==t.Node.COMMENT_NODE)o=M(s),s=s.parentNode;e.getSelection().collapse(s,o),r.setStart(s,o),r.setEnd(s,o);var u=s;while(!pn(u)&&ft(u.parentNode)&&ht(s,u.parentNode))u=u.parentNode;if(!ft(u)||!ht(u,s)||!pn(u)){var a=dn,f=En(r),l=B(f,function(e){return jt(e,"p")}).slice(0,1);if(!l.length){if(!jt(a,r.startContainer))return;u=document.createElement(a),r.insertNode(u),u.appendChild(mn()),e.getSelection().collapse(u,0),r.setStart(u,0),r.setEnd(u,0);return}while(l[l.length-1].nextSibling&&jt(l[l.length-1].nextSibling,"p"))l.push(l[l.length-1].nextSibling);u=Lt(l,function(){return!1},function(){return document.createElement(a)},r)}var h,d;if(u.tagName=="ADDRESS"||u.tagName=="LISTING"||u.tagName=="PRE"){var v=document.createElement("br");h=u.offsetHeight,r.insertNode(v),d=u.offsetHeight,e.getSelection().collapse(s,o+1),r.setStart(s,o+1),r.setEnd(s,o+1),h==d&&!S(y(v),u)&&(r.insertNode(mn()),e.getSelection().collapse(s,o+1),r.setEnd(s,o+1));return}if(Fn[u.tagName]&&(!u.hasChildNodes()||u.childNodes.length==1&&c(u.firstChild,"br"))){fn([u],r),p(u,["dd","dt"])&&t(N(u)).every(function(e){return!ht(u,e)||!jt(u,e)})&&(u=Tt(u,dn,r)),yn(u,r);if(c(u,"li")&&c(u.nextSibling,"li")&&p(u.nextSibling.firstChild,["ol","ul"])){var m=u.nextSibling,g=u.nextSibling.childNodes.length;for(i=0;i<g;i++)u.appendChild(m.childNodes[0]);m.parentNode.removeChild(m)}return}var b=e.createRange();b.setStart(r.startContainer,r.startOffset),b.setEnd(u,_(u));while(b.startOffset==0&&b.startContainer!=u)b.setStart(b.startContainer.parentNode,M(b.startContainer));while(b.startOffset==_(b.startContainer)&&b.startContainer!=u)b.setStart(b.startContainer.parentNode,1+M(b.startContainer));var w=B(b),E=!w.length||w.length==1&&c(w[0],"br"),x;/^H[1-6]$/.test(u.tagName)&&E?x=dn:u.tagName=="DT"&&E?x="dd":u.tagName=="DD"&&E?x="dt":x=u.tagName.toLowerCase();var T=document.createElement(x);xt(u,T),T.removeAttribute("id"),u.parentNode.insertBefore(T,u.nextSibling);var k=j(b),L=b.extractContents(),A=C(L);for(i=0;i<A.length;i++)A[i].nodeType==t.Node.ELEMENT_NODE&&t(k).indexOf(A[i])==-1&&A[i].removeAttribute("id");var O=[],D=L.firstChild;if(D)do vt(D)||O.push(D);while(null!=(D=D.nextSibling));if(c(T,"li")&&O.length&&p(O[0],["ul","ol"])){h=T.offsetHeight;var P=mn();T.appendChild(P),d=T.offsetHeight,h!==d&&T.removeChild(P)}T.appendChild(L),gn(u),gn(T),e.getSelection().collapse(T,0),r.setStart(T,0),r.setEnd(T,0)}},u.inserttext={action:function(r,i){var s;An(i,{stripWrappers:!1});if(!ft(i.startContainer)&&!at(i.startContainer))return;if(r.length>1){for(s=0;s<r.length;s++)u.inserttext.action(r[s],i);return}if(r=="")return;if(r=="\n"){u.insertparagraph.action("",i);return}var o=i.startContainer,a=i.startOffset;0<=a-1&&a-1<o.childNodes.length&&o.childNodes[a-1].nodeType==t.Node.TEXT_NODE&&(o=o.childNodes[a-1],a=_(o)),0<=a&&a<o.childNodes.length&&o.childNodes[a].nodeType==t.Node.TEXT_NODE&&(o=o.childNodes[a],a=0);var f=o.nodeType==t.Node.ELEMENT_NODE?o:o.parentNode;r==" "&&f.nodeType==t.Node.ELEMENT_NODE&&n.inArray(t.getComputedStyle(f).whiteSpace,["pre","pre-wrap"])==-1&&(r=" ");var l=Tn(i);if(o.nodeType==t.Node.TEXT_NODE)o.insertData(a,r),e.getSelection().collapse(o,a),i.setStart(o,a),e.getSelection().extend(o,a+1),i.setEnd(o,a+1);else{o.childNodes.length==1&&pt(o.firstChild)&&o.removeChild(o.firstChild);var c=document.createTextNode(r);i.insertNode(c),e.getSelection().collapse(c,0),i.setStart(c,0),e.getSelection().extend(c,1),i.setEnd(c,1)}Cn(l),Ln(i.startContainer,i.startOffset),Ln(i.endContainer,i.endOffset),e.getSelection().collapseToEnd(),i.collapse(!1)}},u.insertunorderedlist={action:function(e,t){Pn("ul",t)},indeterm:function(){return/^mixed( ul)?$/.test(Sn())},state:function(){return Sn()=="ul"}},u.justifycenter={action:function(e,t){Hn("center",t)},indeterm:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return t(e).some(function(e){return xn(e)=="center"})&&t(e).some(function(e){return xn(e)!="center"})},state:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return e.length&&t(e).every(function(e){return xn(e)=="center"})},value:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return e.length?xn(e[0]):"left"}},u.justifyfull={action:function(e,t){Hn("justify",t)},indeterm:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return t(e).some(function(e){return xn(e)=="justify"})&&t(e).some(function(e){return xn(e)!="justify"})},state:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return e.length&&t(e).every(function(e){return xn(e)=="justify"})},value:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return e.length?xn(e[0]):"left"}},u.justifyleft={action:function(e,t){Hn("left",t)},indeterm:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return t(e).some(function(e){return xn(e)=="left"})&&t(e).some(function(e){return xn(e)!="left"})},state:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return e.length&&t(e).every(function(e){return xn(e)=="left"})},value:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return e.length?xn(e[0]):"left"}},u.justifyright={action:function(e,t){Hn("right",t)},indeterm:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return t(e).some(function(e){return xn(e)=="right"})&&t(e).some(function(e){return xn(e)!="right"})},state:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return e.length&&t(e).every(function(e){return xn(e)=="right"})},value:function(){var e=j(En(Et()),function(e){return ft(e)&&yt(e)&&!e.hasChildNodes()});return e.length?xn(e[0]):"left"}},u.outdent={action:function(){var e=[];(function(){var t;for(t=Et().endContainer;t!=Et().commonAncestorContainer;t=t.parentNode)c(t,"li")&&e.unshift(t);for(t=Et().startContainer;t;t=t.parentNode)c(t,"li")&&e.unshift(t)})(),t(e).forEach(function(e){bn(e,Et())});var n=En(Et()),r=B(n,function(e){return ft(e)&&(!t(C(e)).some(ft)||p(e,["ol","ul"])||c(e,"li")&&p(e.parentNode,["ol","ul"]))});while(r.length){while(r.length&&(p(r[0],["OL","UL"])||!p(r[0].parentNode,["OL","UL"])))Dn(r.shift(),n);if(!r.length)break;var i=[];i.push(r.shift());while(r.length&&r[0]==i[i.length-1].nextSibling&&!p(r[0],["OL","UL"]))i.push(r.shift());var s=Kt(i);fn(i,n),t(i).forEach(yn),Zt(s,n)}}},u.selectall={action:function(){var t=document.body;t||(t=document.documentElement),t?e.getSelection().selectAllChildren(t):e.getSelection().removeAllRanges()}},u.stylewithcss={action:function(e){s=String(e).toLowerCase()!="false"},state:function(){return s}},u.usecss={action:function(e){s=String(e).toLowerCase()=="false"}},function(){var e=[],n;for(n in u)u.hasOwnProperty(n)&&e.push(n);t(e).forEach(function(e){null==u[e].relevantCssProperty&&(u[e].relevantCssProperty=null),null!=u[e].inlineCommandActivatedValues&&null==u[e].indeterm&&(u[e].indeterm=function(n){var r=t(qt(n,function(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE})).map(function(t){return Xt(t,e)}),i=t(r).filter(function(n){return t(u[e].inlineCommandActivatedValues).indexOf(n)!=-1});return i.length>=1&&r.length-i.length>=1}),null!=u[e].inlineCommandActivatedValues&&(u[e].state=function(n){var r=qt(n,function(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE});return r.length==0?t(u[e].inlineCommandActivatedValues).indexOf(Xt(n.startContainer,e))!=-1:t(r).every(function(n){return t(u[e].inlineCommandActivatedValues).indexOf(Xt(n,e))!=-1})}),null!=u[e].standardInlineValueCommand&&(u[e].indeterm=function(){var n=t(qt(Et())).filter(function(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE},!0).map(function(t){return Xt(t,e)}),r;for(r=1;r<n.length;r++)if(n[r]!=n[r-1])return!0;return!1},u[e].value=function(n){var r=qt(n,function(e){return ft(e)&&e.nodeType==t.Node.TEXT_NODE})[0];return typeof r=="undefined"&&(r=n.startContainer),Xt(r,e)})})}(),{commands:u,execCommand:Y,queryCommandIndeterm:Z,queryCommandState:et,queryCommandValue:nt,queryCommandEnabled:Q,queryCommandSupported:tt,copyAttributes:xt,createEndBreak:mn,isEndBreak:vn,ensureContainerEditable:gn,isEditingHost:at,isEditable:ft}}),define("aloha/selection",["aloha/core","jquery","util/class","util/range","util/arrays","util/strings","aloha/console","PubSub","aloha/engine","aloha/ecma5shims","aloha/rangy-core"],function(e,t,n,r,i,s,o,u,a,f){function c(e){var t;return e.startContainer!==e.endContainer?!1:e.startContainer.nodeType!=1?!1:(t=e.startContainer.firstChild,!t||!t.nextSibling&&t.nodeName=="BR")}function h(e){return e.startContainer!==e.endContainer?!1:e.startContainer.nodeType!=1?!1:a.isEndBreak(e.startContainer)}function v(e,t){var n=[],r,i,s;1===e.nodeType&&e.nodeName!=="BODY"&&e.nodeName!=="HTML"?n.push(e.cloneNode(!1).outerHTML):n.push("#"+e.nodeType);for(s=0,i=t.length;s<i;s++){r=t[s];if(r.nodeName==="BODY"||r.nodeName==="HTML")break;n.push(r.cloneNode(!1).outerHTML)}return n.join("")}function m(n,r){var s=e.activeEditable?e.activeEditable.obj.parent()[0]:null,o=t(n).parentsUntil(s).get(),u=v(n,o),a=r&&n===r.node&&i.equal(r.parents,o)&&u===r.html;return a?null:{node:n,parents:o,html:u}}function g(e,t){var n=e.startContainer,r=e.endContainer;if(!n||!r){o.warn("aloha/selection","encountered range object without start or end container");return}var i=m(n,p),s=m(r,d);if(!i&&!s)return;p=i,d=s,u.pub("aloha.selection.context-change",{range:e,event:t})}function b(e){var n;if(t.browser.msie&&e.startContainer===e.endContainer&&e.startOffset===e.endOffset&&e.startContainer.nodeType==3&&e.startOffset==e.startContainer.data.length&&e.startContainer.nextSibling){n=e.startContainer.nextSibling;if("OL"===n.nodeName||"UL"===n.nodeName)e.startContainer.data[e.startContainer.data.length-1]==" "?e.startOffset=e.endOffset=e.startOffset-1:e.startContainer.data=e.startContainer.data+" "}}function w(e){return b(e),e}var l=window.GENTICS,p=null,d=null,y=n.extend({_constructor:function(){this.rangeObject={},this.preventSelectionChangedFlag=!1,this.tagHierarchy={textNode:{},abbr:{textNode:!0},b:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0,strong:!0},pre:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0},blockquote:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0,cite:!0,q:!0,code:!0,abbr:!0,p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0},ins:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,u:!0,p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0},ul:{li:!0},ol:{li:!0},li:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,ul:!0,ol:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,del:!0,ins:!0,u:!0,a:!0},tr:{td:!0,th:!0},table:{tr:!0},div:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,ul:!0,ol:!0,table:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,del:!0,ins:!0,u:!0,p:!0,div:!0,pre:!0,blockquote:!0,a:!0},h1:{textNode:!0,b:!0,i:!0,em:!0,sup:!0,sub:!0,br:!0,span:!0,img:!0,a:!0,del:!0,ins:!0,u:!0}},this.tagHierarchy={textNode:this.tagHierarchy.textNode,abbr:this.tagHierarchy.abbr,br:this.tagHierarchy.textNode,img:this.tagHierarchy.textNode,b:this.tagHierarchy.b,strong:this.tagHierarchy.b,code:this.tagHierarchy.b,q:this.tagHierarchy.b,blockquote:this.tagHierarchy.blockquote,cite:this.tagHierarchy.b,i:this.tagHierarchy.b,em:this.tagHierarchy.b,sup:this.tagHierarchy.b,sub:this.tagHierarchy.b,span:this.tagHierarchy.b,del:this.tagHierarchy.del,ins:this.tagHierarchy.ins,u:this.tagHierarchy.b,p:this.tagHierarchy.b,pre:this.tagHierarchy.pre,a:this.tagHierarchy.b,ul:this.tagHierarchy.ul,ol:this.tagHierarchy.ol,li:this.tagHierarchy.li,td:this.tagHierarchy.li,div:this.tagHierarchy.div,h1:this.tagHierarchy.h1,h2:this.tagHierarchy.h1,h3:this.tagHierarchy.h1,h4:this.tagHierarchy.h1,h5:this.tagHierarchy.h1,h6:this.tagHierarchy.h1,table:this.tagHierarchy.table},this.replacingElements={h1:{p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,pre:!0,blockquote:!0}},this.replacingElements={h1:this.replacingElements.h1,h2:this.replacingElements.h1,h3:this.replacingElements.h1,h4:this.replacingElements.h1,h5:this.replacingElements.h1,h6:this.replacingElements.h1,pre:this.replacingElements.h1,p:this.replacingElements.h1,blockquote:this.replacingElements.h1},this.allowedToStealElements={h1:{textNode:!0}},this.allowedToStealElements={h1:this.allowedToStealElements.h1,h2:this.allowedToStealElements.h1,h3:this.allowedToStealElements.h1,h4:this.allowedToStealElements.h1,h5:this.allowedToStealElements.h1,h6:this.allowedToStealElements.h1,p:this.tagHierarchy.b}},SelectionTree:function(){this.domobj={},this.selection=undefined,this.children=[]},onChange:function(t,n,r){this.updateSelectionTimeout&&window.clearTimeout(this.updateSelectionTimeout);var i=this;this.updateSelectionTimeout=window.setTimeout(function(){var s=new e.Selection.SelectionRange(!0);if(!s.startContainer||"HTML"===s.startContainer.nodeName||"BODY"===s.startContainer.nodeName){this.updateSelectionTimeout||i.onChange(t,n,10+(r||5)*2);return}e.Selection._updateSelection(n,s)},r||5)},preventSelectionChanged:function(){this.preventSelectionChangedFlag=!0},isSelectionChangedPrevented:function(){var e=this.preventSelectionChangedFlag;return this.preventSelectionChangedFlag=!1,e},isSelectionEditable:function(){return this.rangeObject.commonAncestorContainer&&t(this.rangeObject.commonAncestorContainer).contentEditable()},isFloatingMenuVisible:function(){var n=t(e.Selection.rangeObject.commonAncestorContainer).attr("data-aloha-floatingmenu-visible");return n!=="undefined"?n==="true"?!0:!1:!1},updateSelection:function(e){return this._updateSelection(e,null)},_updateSelection:function(n,r){if(n&&n.originalEvent&&n.originalEvent.stopSelectionUpdate===!0)return!1;if(typeof r=="undefined")return!1;this.rangeObject=r||new e.Selection.SelectionRange(!0);if(typeof this.rangeObject!="undefined"&&typeof this.rangeObject.startContainer!="undefined"&&this.rangeObject.endContainer!=="undefined")if(this.rangeObject.startContainer.nodeType===3&&!t(this.rangeObject.startContainer.parentNode).contentEditable()||this.rangeObject.endContainer.nodeType===3&&!t(this.rangeObject.endContainer.parentNode).contentEditable())return e.getSelection().removeAllRanges(),!0;return this.rangeObject.update(),this.isSelectionChangedPrevented()?!0:(e.trigger("aloha-selection-changed-before",[this.rangeObject,n]),e.trigger("aloha-selection-changed",[this.rangeObject,n]),g(this.rangeObject,n),e.trigger("aloha-selection-changed-after",[this.rangeObject,n]),!0)},getSelectionTree:function(t){return t?t.commonAncestorContainer?(this.inselection=!1,l.Utils.Dom.doCleanup({merge:!0},t)&&(t.update(),t.select()),this.recursiveGetSelectionTree(t,t.commonAncestorContainer)):(e.Log.error(this,"the rangeObject is missing the commonAncestorContainer"),!1):this.rangeObject.getSelectionTree()},recursiveGetSelectionTree:function(n,r){var i=t(r),s=0,o=this,u=[];return i.contents().each(function(t){var i="none",a=!1,f=!1,l=!1,c,h,p=!1,d=!1,v=!1;n.isCollapsed()&&r===n.startContainer&&n.startOffset==t&&(u[s]=new e.Selection.SelectionTree,u[s].selection="collapsed",u[s].domobj=undefined,o.inselection=!1,l=!0,s++);if(!o.inselection&&!l){var m;try{m=this.nodeType}catch(g){return}switch(m){case 3:this===n.startContainer&&(o.inselection=!0,i=n.startOffset>0?"partial":"full",a=n.startOffset,f=this.length);break;case 1:this===n.startContainer&&n.startOffset===0&&(o.inselection=!0,i="full"),r===n.startContainer&&n.startOffset===t&&(o.inselection=!0,i="full")}}if(o.inselection&&!l){i=="none"&&(i="full");switch(this.nodeType){case 3:this===n.endContainer&&(o.inselection=!1,n.endOffset<this.length&&(i="partial"),a===!1&&(a=0),f=n.endOffset);break;case 1:this===n.endContainer&&n.endOffset===0&&(o.inselection=!1)}r===n.endContainer&&n.endOffset<=t&&(o.inselection=!1,i="none")}u[s]=new e.Selection.SelectionTree,u[s].domobj=this,u[s].selection=i,i=="partial"&&(u[s].startOffset=a,u[s].endOffset=f),u[s].children=o.recursiveGetSelectionTree(n,this),h=u[s].children.length;if(h>0){for(c=0;c<h;++c)switch(u[s].children[c].selection){case"none":p=!0;break;case"full":v=!0;break;case"partial":d=!0}d||v&&p?u[s].selection="partial":v&&!d&&!p&&(u[s].selection="full")}s++}),n.isCollapsed()&&r===n.startContainer&&n.startOffset==r.childNodes.length&&(u[s]=new e.Selection.SelectionTree,u[s].selection="collapsed",u[s].domobj=undefined),u},getRangeObject:function(){return this.rangeObject},isRangeObjectWithinMarkup:function(n,r,i,s,o){var u=r?n.endContainer:n.startContainer,a=this,f=t(u).parents(),l=!1,c=-1;return typeof s!="undefined"&&typeof s!="function"&&e.Log.error(this,"parameter tagComparator is not a function"),typeof s=="undefined"&&(s=function(e,t){return a.standardTextLevelSemanticsComparator(e,t)}),f.length>0&&f.each(function(){if(this===o)return e.Log.debug(a,"reached limit dom obj"),!1;if(s(this,i))return l===!1&&(l=[]),e.Log.debug(a,"reached object equal to markup"),c++,l[c]=this,!0}),l},standardSectionsAndGroupingContentComparator:function(t,n){if(t.nodeType!==1)return e.Log.debug(this,"only element nodes (nodeType == 1) can be compared"),!1;if(!n[0].nodeName)return!1;var r=e.Selection.replacingElements[t.nodeName.toLowerCase()];return r&&r[n[0].nodeName.toLowerCase()]},standardTagNameComparator:function(t,n){return t.nodeType===1?t.nodeName!=n[0].nodeName?!1:!0:(e.Log.debug(this,"only element nodes (nodeType == 1) can be compared"),!1)},standardTextLevelSemanticsComparator:function(t,n){return t.nodeType===1?t.nodeName!=n[0].nodeName?!1:this.standardAttributesComparator(t,n)?!0:!1:(e.Log.debug(this,"only element nodes (nodeType == 1) can be compared"),!1)},standardAttributesComparator:function(e,t){var n=s.words(e&&e.className||""),r=s.words(t.length&&t[0].className||"");return i.sortUnique(n),i.sortUnique(r),i.equal(n,r)},changeMarkup:function(n,r,i){var s=r[0].tagName.toLowerCase(),o,u,l,p=this.isRangeObjectWithinMarkup(n,!1,r,i,u),d=this.isRangeObjectWithinMarkup(n,!0,r,i,u),v,m,g,y,b,w;if(this.replacingElements[s])l=n,n=new this.SelectionRange(n),e.activeEditable?o=e.activeEditable.obj.get(0):o=t("body"),n.update(o),r.isReplacingElement=!0;else if(n.isCollapsed())return e.Log.debug(this,"early returning from applying markup because nothing is currently selected"),!1;e.activeEditable?u=e.activeEditable.obj[0]:u=t("body"),!r.isReplacingElement&&n.startOffset===0&&null!=(g=this.getTextNodeSibling(false,n.commonAncestorContainer.parentNode,n.startContainer))&&(y=this.isRangeObjectWithinMarkup({startContainer:g,startOffset:0},!1,r,i,u)),!r.isReplacingElement&&n.endOffset===n.endContainer.length&&null!=(v=this.getTextNodeSibling(true,n.commonAncestorContainer.parentNode,n.endContainer))&&(m=this.isRangeObjectWithinMarkup({startContainer:v,startOffset:0},!1,r,i,u));if(!r.isReplacingElement&&p&&!d)e.Log.info(this,"markup 2 non-markup"),this.prepareForRemoval(n.getSelectionTree(),r,i),t(p).addClass("preparedForRemoval"),this.insertCroppedMarkups(p,n,!1,i);else if(!r.isReplacingElement&&p&&d)e.Log.info(this,"markup 2 markup"),this.prepareForRemoval(n.getSelectionTree(),r,i),this.splitRelevantMarkupObject(p,d,n,i);else if(!r.isReplacingElement&&(!p&&d||m||y))e.Log.info(this,"non-markup 2 markup OR with next2markup"),y&&m?(b=new e.Selection.SelectionRange(n),b.startContainer=t(y[y.length-1]).textNodes()[0],b.startOffset=0,b.endContainer=t(m[m.length-1]).textNodes().last()[0],b.endOffset=b.endContainer.length,b.update(),this.applyMarkup(b.getSelectionTree(),n,r,i),e.Log.info(this,"double extending previous markup(previous and after selection), actually wrapping it ...")):y&&!m&&!d?(this.extendExistingMarkupWithSelection(y,n,!1,i),e.Log.info(this,"extending previous markup")):y&&!m&&d?(b=new e.Selection.SelectionRange(n),b.startContainer=t(y[y.length-1]).textNodes()[0],b.startOffset=0,b.endContainer=t(d[d.length-1]).textNodes().last()[0],b.endOffset=b.endContainer.length,b.update(),this.applyMarkup(b.getSelectionTree(),n,r,i),e.Log.info(this,"double extending previous markup(previous and relevant at the end), actually wrapping it ...")):!y&&m?(this.extendExistingMarkupWithSelection(m,n,!0,i),e.Log.info(this,"extending following markup backwards")):this.extendExistingMarkupWithSelection(d,n,!0,i);else if(r.isReplacingElement||!p&&!d&&!y&&!m){e.Log.info(this,"non-markup 2 non-markup");if(c(n)){var E=r.clone();h(n)&&E[0].appendChild(a.createEndBreak()),e.activeEditable&&t.browser.mozilla&&e.activeEditable.obj.focus(),a.isEditable(n.startContainer)?(a.copyAttributes(n.startContainer,E[0]),t(n.startContainer).after(E[0]).remove()):a.isEditingHost(n.startContainer)&&(t(n.startContainer).append(E[0]),a.ensureContainerEditable(E[0])),l.startContainer=E[0],l.endContainer=E[0],l.startOffset=0,l.endOffset=0;return}this.applyMarkup(n.getSelectionTree(),n,r,i,{setRangeObject2NewMarkup:!0}),l.startContainer=n.startContainer,l.endContainer=n.endContainer,l.startOffset=n.startOffset,l.endOffset=n.endOffset}r.isReplacingElement&&(l&&l.startContainer.className&&l.startContainer.className.indexOf("preparedForRemoval")>-1&&(w=t(l.startContainer).parents(r[0].tagName).get(0),l.startContainer=w,n.startContainer=w),l&&l.endContainer.className&&l.endContainer.className.indexOf("preparedForRemoval")>-1&&(w=t(l.endContainer).parents(r[0].tagName).get(0),l.endContainer=w,n.endContainer=w)),t(".preparedForRemoval").zap(),r.isReplacingElement?(f.Node.ELEMENT_NODE===l.startContainer.nodeType&&l.startContainer.childNodes&&l.startContainer.childNodes.length<l.startOffset&&(l.startOffset=l.startContainer.childNodes.length,n.startOffset=l.startContainer.childNodes.length),f.Node.ELEMENT_NODE===l.endContainer.nodeType&&l.endContainer.childNodes&&l.endContainer.childNodes.length<l.endOffset&&(l.endOffset=l.endContainer.childNodes.length,n.endOffset=l.endContainer.childNodes.length),n.endContainer=l.endContainer,n.endOffset=l.endOffset,n.startContainer=l.startContainer,n.startOffset=l.startOffset,l.update(),l.select()):(n.update(),n.select())},areMarkupObjectsAsLongAsRangeObject:function(e,n,r){var i,s,o,u,a;if(r.startOffset!==0)return!1;for(i=0,a=e.length;i<a;i++){s=t(e[i]);if(s.textNodes().first()[0]!==r.startContainer)return!1}for(i=0,u=n.length;i<u;i++){s=t(n[i]),o=s.textNodes().last()[0];if(o!==r.endContainer||o.length!=r.endOffset)return!1}return!0},splitRelevantMarkupObject:function(e,n,r,i){t(e).addClass("preparedForRemoval"),t(n).addClass("preparedForRemoval");if(this.areMarkupObjectsAsLongAsRangeObject(e,n,r))return!0;var s=this.intersectRelevantMarkupObjects(e,n);return s?(this.insertCroppedMarkups([s],r,!1,i),this.insertCroppedMarkups([s],r,!0,i)):(this.insertCroppedMarkups(e,r,!1,i),this.insertCroppedMarkups(n,r,!0,i)),!0},intersectRelevantMarkupObjects:function(e,t){var n=!1,r,i,s,o,u,a;if(!e||!t)return n;u=e.length,a=t.length;for(r=0;r<u;r++){i=e[r];for(s=0;s<a;s++)o=t[s],i===o&&(n=i)}return n},extendExistingMarkupWithSelection:function(e,n,r,i){var s,o,u,a,f,l,c,h;r||(s=!0),r&&(o=!0),u=[];for(a=0,f=e.length;a<f;a++)u[a]=new this.SelectionRange,l=e[a],o&&!s&&(u[a].startContainer=n.startContainer,u[a].startOffset=n.startOffset,c=t(l).textNodes(!0),h=c.length-1,u[a].endContainer=c[h],u[a].endOffset=c[h].length,u[a].update(),this.applyMarkup(u[a].getSelectionTree(),n,this.getClonedMarkup4Wrapping(l),i,{setRangeObject2NewMarkup:!0})),!o&&s&&(c=t(l).textNodes(!0),u[a].startContainer=c[0],u[a].startOffset=0,u[a].endContainer=n.endContainer,u[a].endOffset=n.endOffset,u[a].update(),this.applyMarkup(u[a].getSelectionTree(),n,this.getClonedMarkup4Wrapping(l),i,{setRangeObject2NewMarkup:!0}));return!0},getClonedMarkup4Wrapping:function(e){var n=t(e.outerHTML).removeClass("preparedForRemoval").empty();return n.attr("class").length===0&&n.removeAttr("class"),n},insertCroppedMarkups:function(e,n,r,i){var s,o,u,a,f,l,c;r?o=!0:s=!0,a=[];for(f=0;f<e.length;f++){a[f]=new this.SelectionRange,l=e[f];if(s&&!o){c=t(l).textNodes(!0),a[f].startContainer=c[0],a[f].startOffset=0;if(a[f].startContainer===n.startContainer&&a[f].startOffset===n.startOffset)continue;n.startOffset===0?(a[f].endContainer=this.getTextNodeSibling(!1,l,n.startContainer),a[f].endOffset=a[f].endContainer.length):(a[f].endContainer=n.startContainer,a[f].endOffset=n.startOffset),a[f].update(),this.applyMarkup(a[f].getSelectionTree(),n,this.getClonedMarkup4Wrapping(l),i,{setRangeObject2NextSibling:!0})}!s&&o&&(a[f].startContainer=n.endContainer,a[f].startOffset=n.endOffset,u=t(l).textNodes(!0),a[f].endContainer=u[u.length-1],a[f].endOffset=u[u.length-1].length,a[f].update(),this.applyMarkup(a[f].getSelectionTree(),n,this.getClonedMarkup4Wrapping(l),i,{setRangeObject2PreviousSibling:!0}))}return!0},changeMarkupOnSelection:function(e){var t=this.getRangeObject();this.changeMarkup(t,e,this.getStandardTagComparator(e)),l.Utils.Dom.doCleanup({merge:!0},t),t.update(),t.select(),this.rangeObject=t},applyMarkup:function(t,n,r,i,s){var o,u,a,f;s=s||{},this.prepareForRemoval(t,r,i),o=this.optimizeSelectionTree4Markup(t,r,i),f=!0;for(u=0;u<o.length;u++)a=o[u],a.wrappable?this.wrapMarkupAroundSelectionTree(a.elements,n,r,i,s):(e.Log.debug(this,"dive further into non-wrappable object"),this.applyMarkup(a.element.children,n,r,i,s))},getMarkupType:function(n){var r=t(n)[0].nodeName.toLowerCase();n.outerHtml&&e.Log.debug(this,"Node name detected: "+r+" for: "+n.outerHtml());if(r=="#text")return"textNode";if(this.replacingElements[r])return"sectionOrGroupingContent";if(this.tagHierarchy[r])return"textLevelSemantics";e.Log.warn(this,"unknown markup passed to this.getMarkupType(...): "+n.outerHtml())},getStandardTagComparator:function(e){var t=this,n;switch(this.getMarkupType(e)){case"textNode":n=function(e,t){return!1};break;case"sectionOrGroupingContent":n=function(e,n){return t.standardSectionsAndGroupingContentComparator(e,n)};break;default:n=function(e,n){return t.standardTextLevelSemanticsComparator(e,n)}}return n},prepareForRemoval:function(n,r,i){var s=this,o,u;typeof i!="undefined"&&typeof i!="function"&&e.Log.error(this,"parameter tagComparator is not a function"),typeof i=="undefined"&&(i=this.getStandardTagComparator(r));for(o=0;o<n.length;o++)u=n[o],u.domobj&&(u.selection=="full"||u.selection=="partial"&&r.isReplacingElement)&&u.domobj.nodeType===1&&i(u.domobj,r)&&(e.Log.debug(this,"Marking for removal: "+u.domobj.nodeName),t(u.domobj).addClass("preparedForRemoval")),u.selection!="none"&&u.children.length>0&&this.prepareForRemoval(u.children,r,i)},wrapMarkupAroundSelectionTree:function(n,r,i,s,o){var u=[],a=-1,f=!0,l="",c="",h,p,d,v,m,g,y;e.Log.debug(this,"The formatting <"+i[0].tagName+"> will be wrapped around the selection");for(m=0;m<n.length;m++){g=n[m];if(g.domobj&&!this.canTag1WrapTag2(g.domobj.parentNode.tagName.toLowerCase(),i[0].tagName.toLowerCase())){e.Log.info(this,"Skipping the wrapping of <"+i[0].tagName.toLowerCase()+"> because this tag is not allowed inside <"+g.domobj.parentNode.tagName.toLowerCase()+">");continue}if(g.domobj&&g.domobj.nodeType===3&&t.trim(g.domobj.nodeValue).length===0)continue;if(g.domobj&&g.selection=="partial"&&!i.isReplacingElement)if(g.startOffset!==undefined&&g.endOffset===undefined)a++,l+=g.domobj.data.substr(0,g.startOffset),g.domobj.data=g.domobj.data.substr(g.startOffset,g.domobj.data.length-g.startOffset),u[a]=g.domobj;else if(g.endOffset!==undefined&&g.startOffset===undefined)a++,c+=g.domobj.data.substr(g.endOffset,g.domobj.data.length-g.endOffset),g.domobj.data=g.domobj.data.substr(0,g.endOffset),u[a]=g.domobj;else if(g.endOffset!==undefined&&g.startOffset!==undefined){if(g.startOffset==g.endOffset){e.Log.debug(this,"skipping empty selection");continue}a++,l+=g.domobj.data.substr(0,g.startOffset),y=g.domobj.data.substr(g.startOffset,g.endOffset-g.startOffset),c+=g.domobj.data.substr(g.endOffset,g.domobj.data.length-g.endOffset),g.domobj.data=y,u[a]=g.domobj}else e.Log.debug(this,"diving into object"),this.applyMarkup(g.children,r,i,s,o);g.domobj&&(g.selection=="full"||g.selection=="partial"&&i.isReplacingElement)&&(a++,u[a]=g.domobj)}u.length>0&&(u=t(u),t.each(u,function(e,n){t.browser.msie&&n.nodeType==3&&!n.nextSibling&&!n.previousSibling&&n.parentNode&&n.parentNode.nodeName.toLowerCase()=="li"&&(n.data=t.trim(n.data))}),v=u.wrapAll(i).parent(),v.before(l).after(c),o.setRangeObject2NewMarkup&&(d=u.textNodes(),d.index(r.startContainer)!=-1&&(r.startOffset=0),d.index(r.endContainer)!=-1&&(r.endOffset=r.endContainer.length),f=!0),o.setRangeObject2NextSibling&&(h=!0,p=v.textNodes(!0).last()[0],u.index(r.startContainer)!=-1&&(r.startContainer=this.getTextNodeSibling(h,v.parent(),p),r.startOffset=0),u.index(r.endContainer)!=-1&&(r.endContainer=this.getTextNodeSibling(h,v.parent(),p),r.endOffset=r.endOffset-p.length)),o.setRangeObject2PreviousSibling&&(h=!1,p=v.textNodes(!0).first()[0],u.index(r.startContainer)!=-1&&(r.startContainer=this.getTextNodeSibling(h,v.parent(),p),r.startOffset=0),u.index(r.endContainer)!=-1&&(r.endContainer=this.getTextNodeSibling(h,v.parent(),p),r.endOffset=r.endContainer.length)))},getTextNodeSibling:function(e,n,r){var i=t(n).textNodes(!0),s,o;return o=i.index(r),o==-1?!1:(s=o+(e?1:-1),i[s]||!1)},optimizeSelectionTree4Markup:function(e,n,r){var i=[],s=0,o=0,u=this,a,f,l,c;typeof r=="undefined"&&(r=function(e,t){return u.standardTextLevelSemanticsComparator(t)});for(a=0;a<e.length;a++)if(e[a].domobj&&e[a].selection!="none")if(n.isReplacingElement&&r(n[0],t(e[a].domobj)))i[s]!==undefined&&s++,i[s]={},i[s].wrappable=!0,i[s].elements=[],i[s].elements[o]=e[a],s++;else if(this.canMarkupBeApplied2ElementAsWhole([e[a]],n)){i[s]===undefined&&(i[s]={},i[s].wrappable=!0,i[s].elements=[]);if(n.isReplacingElement){c=a;for(f=a-1;f>=0;f--){if(!this.canMarkupBeApplied2ElementAsWhole([e[f]],n)||!this.isMarkupAllowedToStealSelectionTreeElement(e[f],n))break;c=f}l=a;for(f=a+1;f<e.length;f++){if(!this.canMarkupBeApplied2ElementAsWhole([e[f]],n)||!this.isMarkupAllowedToStealSelectionTreeElement(e[f],n))break;l=f}o=0;for(f=c;f<=l;f++)i[s].elements[o]=e[f],i[s].elements[o].selection="full",o++;o=0}else i[s].elements[o]=e[a],o++}else i[s]!==undefined&&s++,i[s]={},i[s].wrappable=!1,i[s].element=e[a],o=0,s++;return i},isMarkupAllowedToStealSelectionTreeElement:function(e,t){if(!e.domobj)return!1;var n=e.domobj.nodeName.toLowerCase(),r=n=="#text"?"textNode":n,i=t[0].nodeName.toLowerCase(),s=this.allowedToStealElements[i];return s&&s[r]},canMarkupBeApplied2ElementAsWhole:function(e,t){var n,r,i,s;t.jquery&&(n=t[0].tagName),t.tagName&&(n=t.tagName),s=!0;for(r=0;r<e.length;r++){i=e[r];if(i.domobj&&(i.selection!="none"||t.isReplacingElement)){if(!this.canTag1WrapTag2(n,i.domobj.nodeName))return!1;if(i.children.length>0&&!this.canMarkupBeApplied2ElementAsWhole(i.children,t))return!1}}return s},canTag1WrapTag2:function(e,t){e=e=="#text"?"textNode":e.toLowerCase(),t=t=="#text"?"textNode":t.toLowerCase();var n=this.tagHierarchy[e];return n?this.tagHierarchy[t]?n[t]:!0:!0},mayInsertTag:function(t){var n;if(typeof this.rangeObject.unmodifiableMarkupAtStart=="object"){for(n=0;n<this.rangeObject.unmodifiableMarkupAtStart.length;++n)if(!this.canTag1WrapTag2(this.rangeObject.unmodifiableMarkupAtStart[n].nodeName,t))return!1;return!0}return e.Log.warn(this,"Unable to determine whether tag "+t+" may be inserted"),!0},toString:function(){return"Aloha.Selection"},SelectionRange:l.Utils.RangeObject.extend({_constructor:function(e){this._super(e),e&&(e.commonAncestorContainer&&(this.commonAncestorContainer=e.commonAncestorContainer),e.selectionTree&&(this.selectionTree=e.selectionTree),e.limitObject&&(this.limitObject=e.limitObject),e.markupEffectiveAtStart&&(this.markupEffectiveAtStart=e.markupEffectiveAtStart),e.unmodifiableMarkupAtStart&&(this.unmodifiableMarkupAtStart=e.unmodifiableMarkupAtStart),e.splitObject&&(this.splitObject=e.splitObject))},commonAncestorContainer:undefined,selectionTree:undefined,markupEffectiveAtStart:[],unmodifiableMarkupAtStart:[],limitObject:undefined,splitObject:undefined,select:function(){this._super(),e.Selection.updateSelection()},update:function(e){this.updatelimitObject(),this.updateMarkupEffectiveAtStart(),this.updateCommonAncestorContainer(e),this.selectionTree=undefined},getSelectionTree:function(){return this.selectionTree||(this.selectionTree=e.Selection.getSelectionTree(this)),this.selectionTree},getSelectedSiblings:function(e){var t=this.getSelectionTree();return this.recursionGetSelectedSiblings(e,t)},recursionGetSelectedSiblings:function(
e,t){var n=!1,r=!1,i;for(i=0;i<t.length;++i)if(t[i].domobj===e)r=!0,n=[];else if(!r&&t[i].children){n=this.recursionGetSelectedSiblings(e,t[i].children);if(n!==!1)break}else if(r&&t[i].domobj&&t[i].selection!="collapsed"&&t[i].selection!="none")n.push(t[i].domobj);else if(r&&t[i].selection=="none")break;return n},updateMarkupEffectiveAtStart:function(){this.markupEffectiveAtStart=[],this.unmodifiableMarkupAtStart=[];var e=this.getStartContainerParents(),t=!1,n,r,i;for(r=0;r<e.length;r++)i=e[r],!t&&i!==this.limitObject?(this.markupEffectiveAtStart[r]=i,!n&&l.Utils.Dom.isSplitObject(i)&&(n=!0,this.splitObject=i)):(t=!0,this.unmodifiableMarkupAtStart.push(i));n||(this.splitObject=!1);return},updatelimitObject:function(){if(e.editables&&e.editables.length>0){var n=this.getStartContainerParents(),r=e.editables,i,s,o,u;for(i=0;i<n.length;i++){s=n[i];for(o=0;o<r.length;o++){u=r[o].obj[0];if(s===u)return this.limitObject=s,!0}}}return this.limitObject=t("body"),!0},toString:function(e){return e?"Aloha.Selection.SelectionRange {start ["+this.startContainer.nodeValue+"] offset "+this.startOffset+", end ["+this.endContainer.nodeValue+"] offset "+this.endOffset+"}":"Aloha.Selection.SelectionRange"}})}),E=n.extend({_constructor:function(e){this._nativeSelection=e,this.ranges=[],this.preventChange=!1},anchorNode:null,anchorOffset:0,focusNode:null,focusOffset:0,isCollapsed:!1,rangeCount:0,collapse:function(e,t){this._nativeSelection.collapse(e,t)},collapseToStart:function(){throw"NOT_IMPLEMENTED"},extend:function(e,t){},modify:function(e,t,n){},collapseToEnd:function(){throw"NOT_IMPLEMENTED"},selectAllChildren:function(e){throw"NOT_IMPLEMENTED"},deleteFromDocument:function(){throw"NOT_IMPLEMENTED"},getRangeAt:function(e){return w(this._nativeSelection.getRangeAt(e))},addRange:function(t){this._nativeSelection.addRange(t),this._nativeSelection._ranges[0]=w(t),e.Selection.updateSelection()},removeRange:function(e){this._nativeSelection.removeRange()},removeAllRanges:function(){this._nativeSelection.removeAllRanges()},refresh:function(e){},toString:function(){return"Aloha.Selection"},getRangeCount:function(){return this._nativeSelection.rangeCount}});e.getSelection=function(e){return e=e!==document||e!==window?window:e,new E(window.rangy.getSelection(e))},e.createRange=function(e){return window.rangy.createRange(e)};var S=new y;return e.Selection=S,S}),define("aloha/block-jump",["aloha/core","jquery","aloha/console"],function(e,t,n){function i(e,n){e.deleteData(0,e.length),""!==n&&(e.nextSibling&&3===e.nextSibling.nodeType?e.nextSibling.insertData(0,n):e.previousSibling&&3===e.previousSibling.nodeType?e.previousSibling.insertData(e.previousSibling.length,n):e.insertData(0,n)),setTimeout(function(){0===e.length&&t(e).remove()},0)}function s(){if(!r)return;var e=r.nodeValue.replace(/\u200b/,"");e===r.nodeValue&&n.warn("Expected to remove the zero width text node fix, but couldn't find it"),i(r,e),r=null}function o(n,i){return s(),r=document.createTextNode("​"),i?t(n).after(r):t(n).before(r),e.bind("aloha-selection-changed",function(t){s(),e.unbind(t)}),r}var r=null;return{removeZeroWidthTextNodeFix:s,insertZeroWidthTextNodeFix:o}}),define("aloha/markup",["aloha/core","util/class","jquery","aloha/ecma5shims","aloha/console","aloha/block-jump"],function(e,t,n,r,i,s){function a(e){return"BR"===e.nodeName}function f(e){return"false"===n(e).attr("contenteditable")}function l(e){return e&&3===e.nodeType}function c(e){return e?l(e)?e.length:e.childNodes.length:0}function h(e){return 0<e.data.replace(/\s+/g,"").length}function p(e){return e?e.nextSibling?l(e.nextSibling)&&!h(e.nextSibling)?p(e.nextSibling):a(e.nextSibling)&&e.nextSibling===e.parentNode.lastChild?p(e.nextSibling):""===e.nextSibling.innerHTML&&!f(e.nextSibling)?p(e.nextSibling):e.nextSibling:e.parentNode?p(e.parentNode):null:null}function d(e){return e?e.previousSibling?l(e.previousSibling)&&!h(e.previousSibling)?d(e.previousSibling):""===e.previousSibling.innerHTML&&!f(e.previousSibling)?d(e.previouSibling):e.previousSibling:e.parentNode?d(e.parentNode):null:null}function v(e,t){return 0===t||t<=e.data.length-e.data.replace(/^\s+/,"").length}function m(e){return e.parent().hasClass("aloha-editable")}function g(e,t){var n=c(e);if(n===t)return!0;var r=l(e);return r&&e.data.replace(/\s+$/,"").length===t?!0:1===n&&!r?a(e.childNodes[0]):!1}function y(e){return n(e).stop(!0).css({opacity:0}).fadeIn(0).delay(100).fadeIn(function(){n(e).css({opacity:1})}),e}function b(e,t){return u?r.compareDocumentPosition(e,t)&16:0<n(e).find(t).length}function w(e){var t=e.startContainer,n=e.endContainer,r=window.$_alohaPlaceholder;return r.is(t)||r.is(n)||b(r[0],t)||b(r[0],n)}function E(e){window.$_alohaPlaceholder&&!w(e)&&(0===window.$_alohaPlaceholder.html().replace(/^(&nbsp;)*$/,"").length&&window.$_alohaPlaceholder.remove(),window.$_alohaPlaceholder=null)}function S(t,r,i){var u=new o.Utils.RangeObject,a=r?d(t):p(t);if(!a||f(a)){var l=n("<div>&nbsp;</div>");r?n(t).before(l):n(t).after(l),u.startContainer=u.endContainer=l[0],u.startOffset=u.endOffset=0,E(u),window.$_alohaPlaceholder=l}else{var h=i.startContainer.nodeType===3&&i.startContainer===i.endContainer&&i.startContainer.nodeValue!==""&&(r?i.startOffset===1:i.endOffset+1===i.endContainer.length)||i.startContainer.nodeType===1&&(!i.startOffset||i.startContainer.childNodes[i.startOffset]&&i.startContainer.childNodes[i.startOffset].nodeType===1);if(h){var v=s.insertZeroWidthTextNodeFix(t,r);u.startContainer=u.endContainer=v,u.startOffset=u.endOffset=r?1:0}else u.startContainer=u.endContainer=a,u.startOffset=u.endOffset=r?c(a):0,r||s.insertZeroWidthTextNodeFix(t,!0);E(u)}u.select(),e.trigger("aloha-block-selected",t),e.Selection.preventSelectionChanged()}var o=window.GENTICS,u=!!(n.browser.msie&&9>parseInt(n.browser.version,10));return e.Markup=t.extend({keyHandlers:{},addKeyHandler:function(e,t){this.keyHandlers[e]||(this.keyHandlers[e]=[]),this.keyHandlers[e].push(t)},removeKeyHandler:function(e){this.keyHandlers[e]&&(this.keyHandlers[e]=null)},insertBreak:function(){var t=e.Selection.rangeObject,r,i,s;t.isCollapsed()||this.removeSelectedMarkup(),s=n("<br/>"),o.Utils.Dom.insertIntoDOM(s,t,e.activeEditable.obj),i=o.Utils.Dom.searchAdjacentTextNode(s.parent().get(0),o.Utils.Dom.getIndexInParent(s.get(0))+1,!1),i&&(r=i.data.search(/\S/),r>0&&(i.data=i.data.substring(r))),t.startContainer=t.endContainer=s.get(0).parentNode,t.startOffset=t.endOffset=o.Utils.Dom.getIndexInParent(s.get(0))+1,t.correctRange(),t.clearCaches(),t.select()},preProcessKeyStrokes:function(t){if(t.type!=="keydown")return!1;var n,r,i;if(this.keyHandlers[t.keyCode]){r=this.keyHandlers[t.keyCode];for(i=0;i<r.length;++i)if(!r[i](t))return!1}if(t.keyCode===37||t.keyCode===39){if(e.getSelection().getRangeCount()){n=e.getSelection().getRangeAt(0);if(this.processCursor(n,t.keyCode))return E(e.Selection.rangeObject),!0}return!1}return t.keyCode===8?(t.preventDefault(),e.execCommand("delete",!1),!1):t.keyCode===46?(e.execCommand("forwarddelete",!1),!1):t.keyCode===13?t.shiftKey?(e.execCommand("insertlinebreak",!1),!1):(e.execCommand("insertparagraph",!1),!1):!0},processCursor:function(t,r){if(!t.collapsed)return!0;s.removeZeroWidthTextNodeFix();var i=t.startContainer,o=e.getSelection();if(!i)return!0;var a,h;if(n.browser.msie&&parseInt(n.browser.version,10)<=7&&l(i))if(r==37){h=t.startOffset;while(h>0&&i.data.charAt(h-1)==="​")h--;h!=t.startOffset&&(t.setStart(t.startContainer,h),t.setEnd(t.startContainer,h),o=e.getSelection(),o.removeAllRanges(),o.addRange(t))}else if(r==39){h=t.startOffset;while(h<i.data.length&&i.data.charAt(h)==="​")h++;h!=t.startOffset&&(t.setStart(t.startContainer,h),t.setEnd(t.startContainer,h),o.removeAllRanges(),o.addRange(t))}if(u&&!n(i).contentEditable()){var y=n(i).parents("[contenteditable=false]"),b=y.length>0;if(b){if(!m(y))return!0;a=y[0]}}var w;if(!a){w=37===r||38===r,h=t.startOffset;if(l(i)){if(w){var E=1===h;if(!E&&!v(i,h))return!0}else if(!g(i,h))return!0}else i=i.childNodes[h===c(i)?h-1:h];a=w?d(i):p(i)}return f(a)?(S(a,w,t),!1):!0},processShiftEnter:function(e){this.insertHTMLBreak(e.getSelectionTree(),e)},processEnter:function(e){e.splitObject?this.splitRangeObject(e):this.insertHTMLBreak(e.getSelectionTree(),e)},insertHTMLCode:function(t){var r=e.Selection.rangeObject;this.insertHTMLBreak(r.getSelectionTree(),r,n(t))},insertHTMLBreak:function(t,r,i){var s,u,a,f,l,c,h,p,d;i=i||n("<br/>");for(s=0,u=t.length;s<u;++s){a=t[s],f=a.domobj?n(a.domobj):undefined;if(a.selection!=="none")if(a.selection=="collapsed")s>0?(l=n(t[s-1].domobj),l.after(i)):(c=n(t[1].domobj),c.before(i)),r.startContainer=r.endContainer=i[0].parentNode,r.startOffset=r.endOffset=o.Utils.Dom.getIndexInParent(i[0])+1,r.correctRange();else if(a.domobj&&a.domobj.nodeType===3){a.domobj.nextSibling&&a.domobj.nextSibling.nodeType==1&&e.Selection.replacingElements[a.domobj.nextSibling.nodeName.toLowerCase()]&&f.after("<br/>");if(this.needEndingBreak()){d=a.domobj;while(d)if(d.nextSibling)d=!1;else{d=d.parentNode;if(o.Utils.Dom.isBlockLevelElement(d)||o.Utils.Dom.isListElement(d))break;d===r.limitObject&&(d=!1)}d&&n(d).append('<br class="aloha-cleanme" />')}f.between(i,a.startOffset),p=0,h=i[0];while(h)h=h.previousSibling,++p;r.startContainer=i[0].parentNode,r.endContainer=i[0].parentNode,r.startOffset=p,r.endOffset=p,r.correctRange()}else a.domobj&&a.domobj.nodeType===1&&(f.parent().find("br.aloha-ephemera").length===0&&(n(r.limitObject).find("br.aloha-ephemera").remove(),n(r.commonAncestorContainer).append(this.getFillUpElement(r.splitObject))),f.after(i),r.startContainer=r.commonAncestorContainer,r.endContainer=r.startContainer,r.startOffset=s+2,r.endOffset=s+2,r.update())}r.select()},needEndingBreak:function(){return!n.browser.msie},getSelectedText:function(){var t=e.Selection.rangeObject;return t.isCollapsed()?!1:this.getFromSelectionTree(t.getSelectionTree(),!0)},getFromSelectionTree:function(e,t){var r="",i,s,o,u;for(i=0,s=e.length;i<s;i++)o=e[i],o.selection=="partial"?o.domobj.nodeType===3?r+=o.domobj.data.substring(o.startOffset,o.endOffset):o.domobj.nodeType===1&&o.children&&(t?r+=this.getFromSelectionTree(o.children,t):(u=n(o.domobj.outerHTML).empty(),u.html(this.getFromSelectionTree(o.children,t)),r+=u.outerHTML())):o.selection=="full"&&(o.domobj.nodeType===3?r+=n(o.domobj).text():o.domobj.nodeType===1&&o.children&&(r+=t?n(o.domobj).text():n(o.domobj).outerHTML()));return r},getSelectedMarkup:function(){var t=e.Selection.rangeObject;return t.isCollapsed()?null:this.getFromSelectionTree(t.getSelectionTree(),!1)},removeSelectedMarkup:function(){var t=e.Selection.rangeObject,n;if(t.isCollapsed())return;n=new e.Selection.SelectionRange,this.removeFromSelectionTree(t.getSelectionTree(),n),n.update(),o.Utils.Dom.doCleanup({merge:!0,removeempty:!0},e.Selection.rangeObject),e.Selection.rangeObject=n,n.correctRange(),n.update(),n.select(),e.Selection.updateSelection()},removeFromSelectionTree:function(e,t){var r,i,s,u,a,f;for(s=0,f=e.length;s<f;s++)u=e[s],u.selection=="partial"?u.domobj.nodeType===3?(i="",u.startOffset>0&&(i+=u.domobj.data.substring(0,u.startOffset)),u.endOffset<u.domobj.data.length&&(i+=u.domobj.data.substring(u.endOffset,u.domobj.data.length)),u.domobj.data=i,t.startContainer||(t.startContainer=t.endContainer=u.domobj,t.startOffset=t.endOffset=u.startOffset)):u.domobj.nodeType===1&&u.children&&(this.removeFromSelectionTree(u.children,t),r?r.nodeName==u.domobj.nodeName&&(n(r).append(n(u.domobj).contents()),n(u.domobj).remove()):r=u.domobj):u.selection=="full"&&(t.startContainer||(a=o.Utils.Dom.searchAdjacentTextNode(u.domobj.parentNode,o.Utils.Dom.getIndexInParent(u.domobj)+1,!1,{blocklevel:!1}),a?(t.startContainer=t.endContainer=a,t.startOffset=t.endOffset=0):(t.startContainer=t.endContainer=u.domobj.parentNode,t.startOffset=t.endOffset=o.Utils.Dom.getIndexInParent(u.domobj)+1)),n(u.domobj).remove())},splitRangeObject:function(t,r){var i=n(t.splitObject),s,u,a;t.update(t.splitObject),s=t.getSelectionTree(),a=this.getSplitFollowUpContainer(t),this.splitRangeObjectHelper(s,t,a),a.hasClass("preparedForRemoval")&&a.removeClass("preparedForRemoval"),u=this.getInsertAfterObject(t,a),n(a).insertAfter(u),t.splitObject.nodeName.toLowerCase()==="li"&&!e.Selection.standardTextLevelSemanticsComparator(t.splitObject,a)&&n(t.splitObject).remove(),t.startContainer=null;var f=a.contents();f.length>0&&f.get(0).nodeType==1&&f.get(0).nodeName.toLowerCase()==="br"&&(t.startContainer=a.get(0)),t.startContainer||(t.startContainer=a.textNodes(!0,!0).first().get(0)),t.startContainer||(t.startContainer=a.textNodes(!1).first().parent().get(0)),t.startContainer?(t.endContainer=t.startContainer,t.startOffset=0,t.endOffset=0):(t.startContainer=t.endContainer=a.parent().get(0),t.startOffset=t.endOffset=o.Utils.Dom.getIndexInParent(a.get(0))),t.update(),t.select()},getInsertAfterObject:function(t,r){var i,s,o;for(s=0;s<t.markupEffectiveAtStart.length;s++){o=t.markupEffectiveAtStart[s],o===t.splitObject&&(i=!0);if(!i)continue;if(e.Selection.canTag1WrapTag2(n(o).parent()[0].nodeName,r[0].nodeName))return o}return!1},getFillUpElement:function(e){return n.browser.msie?!1:n('<br class="aloha-cleanme"/>')},removeElementContentWhitespaceObj:function(e){var t=0,n=[],r,i,s;for(r=0;r<e.length;++r)i=e[r],i.isElementContentWhitespace&&(n[n.length]=r);for(r=0;r<n.length;++r)s=n[r],e.splice(s-t,1),++t},splitRangeObjectHelper:function(t,r,i,s){i||e.Log.warn(this,"no followUpContainer, no inBetweenMarkup, nothing to do...");var u=this.getFillUpElement(r.splitObject),a=n(r.splitObject),f=!1,l,c,h,p,d,v,m;if(t.length>0){d=i.contents(),d.length!==t.length&&this.removeElementContentWhitespaceObj(d);for(c=0,m=t.length;c<m;++c){l=t[c];if(l.selection==="none"&&f===!1||l.domobj&&l.domobj.nodeType===3&&l===t[t.length-1]&&l.startOffset===l.domobj.data.length){i.textNodes().length>1||l.domobj.nodeType===1&&l.children.length===0?d.eq(c).remove():o.Utils.Dom.isSplitObject(i[0])?u?i.html(u):i.empty():(i.empty(),i.addClass("preparedForRemoval"));continue}l.selection!=="none"?(l.domobj&&l.domobj.nodeType===3&&l.startOffset!==undefined&&(h=l.domobj.data,l.startOffset>0?l.domobj.data=h.substr(0,l.startOffset):t.length>1?n(l.domobj).remove():(v=n(l.domobj).parent(),o.Utils.Dom.isSplitObject(v[0])?u?v.html(u):v.empty():v.remove()),h.length-l.startOffset>0?d[c].data=h.substr(l.startOffset,h.length):d.length>1?d.eq(c).remove():o.Utils.Dom.isBlockLevelElement(i[0])?u?i.html(u):i.empty():(i.empty(),i.addClass("preparedForRemoval"))),f=!0,l.children.length>0&&this.splitRangeObjectHelper(l.children,r,d.eq(c),s)):l.selection==="none"&&f===!0&&(p=n(l.domobj).remove())}}else e.Log.error(this,"can not split splitObject due to an empty selection tree");a.find("br.aloha-ephemera:gt(0)").remove(),i.find("br.aloha-ephemera:gt(0)").remove(),a.find(".preparedForRemoval").remove(),i.find(".preparedForRemoval").remove(),a.contents().length===0&&o.Utils.Dom.isSplitObject(a[0])&&u&&a.html(u),i.contents().length===0&&o.Utils.Dom.isSplitObject(i[0])&&u&&i.html(u)},getSplitFollowUpContainer:function(e){var t=e.splitObject.nodeName.toLowerCase(),r,i,s;switch(t){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":s=n(e.splitObject).textNodes(":not(.aloha-cleanme)").last()[0];if(s&&e.startContainer===s&&e.startOffset===s.length)return r=n("<p></p>"),i=n(e.splitObject.outerHTML).contents(),r.append(i),r;break;case"li":if(e.startContainer.nodeName.toLowerCase()==="br"&&n(e.startContainer).hasClass("aloha-ephemera"))return r=n("<p></p>"),i=n(e.splitObject.outerHTML).contents(),r.append(i),r;if(!e.splitObject.nextSibling&&n.trim(n(e.splitObject).text()).length===0)return r=n("<p></p>"),r}return n(e.splitObject.outerHTML)},transformDomObject:function(e,t,r){var i=n(e),s=n("<"+t+">"),o,u=i[0].cloneNode(!1).attributes;if(u)for(o=0;o<u.length;++o)(typeof u[o].specified=="undefined"||u[o].specified)&&s.attr(u[o].nodeName,u[o].nodeValue);return i[0].style&&i[0].style.cssText&&(s[0].style.cssText=i[0].style.cssText),i.contents().appendTo(s),i.replaceWith(s),r&&(r.startContainer==e&&(r.startContainer=s.get(0)),r.endContainer==e&&(r.endContainer=s.get(0))),s},toString:function(){return"Aloha.Markup"}}),e.Markup=new e.Markup,e.Markup}),define("aloha/observable",["jquery"],function(e){var t=e;return{_eventHandlers:null,bind:function(e,t,n){this._eventHandlers=this._eventHandlers||{},this._eventHandlers[e]||(this._eventHandlers[e]=[]),this._eventHandlers[e].push({handler:t,scope:n||window})},unbind:function(e,n){this._eventHandlers=this._eventHandlers||{};if(!this._eventHandlers[e])return;n?this._eventHandlers[e]=t.grep(this._eventHandlers[e],function(e){return e.handler===n?!1:!0}):this._eventHandlers[e]=[]},trigger:function(e){this._eventHandlers=this._eventHandlers||{};if(!this._eventHandlers[e])return;var n=[];t.each(arguments,function(e,t){e>0&&n.push(t)}),t.each(this._eventHandlers[e],function(e,t){t.handler.apply(t.scope,n)})},unbindAll:function(){this._eventHandlers=null}}}),define("aloha/registry",["jquery","aloha/observable","util/class"],function(e,t,n){return n.extend(t,{_entries:null,_ids:null,_constructor:function(){this._entries={},this._ids=[]},register:function(e,t){this._entries[e]=t,this._ids.push(e),this.trigger("register",t,e)},unregister:function(e){var t,n=this._entries[e];delete this._entries[e];for(t in this._ids)if(this._ids.hasOwnProperty(t)&&this._ids[t]===e){this._ids.splice(t,1);break}this.trigger("unregister",n,e)},get:function(e){return this._entries[e]},has:function(e){return this._entries[e]?!0:!1},getEntries:function(){return e.extend({},this._entries)},getIds:function(){return e.extend([],this._ids)}})}),define("aloha/contenthandlermanager",["jquery","aloha/registry","util/class","aloha/console"],function(e,t,n,r){return new(t.extend({createHandler:function(e){if(typeof e.handleContent!="function")throw"ContentHandler has no function handleContent().";var t=n.extend({handleContent:function(e){}},e);return new t},handleContent:function(e,t){var n,i,s=this.getIds();if(typeof t.contenthandler=="undefined"){t.contenthandler=[];for(i in s)s.hasOwnProperty(i)&&t.contenthandler.push(s[i])}for(i in t.contenthandler)if(t.contenthandler.hasOwnProperty(i)){n=this.get(t.contenthandler[i]),n&&(typeof n.handleContent=="function"?e=n.handleContent(e,t):r.error("A valid content handler needs the method handleContent."));if(null===e)break}return e}}))}),define("util/trees",["jquery"],function(e){function t(t,n,r){var i=e.type(t),s,o,u,a,f,l;if("array"===i){o=r?t:[],u=0;for(f=0,a=t.length;f<a;f++)s=n(t[f]),s.length&&(o[u++]=s[0]);u!==o.length&&(o=o.slice(0,u))}else if("object"===i){o=r?t:{};for(l in t)t.hasOwnProperty(l)&&(s=n(t[l]),s.length?o[l]=s[0]:delete o[l])}else o=t;return o}function n(e,n){return t(e,n,!0)}function r(e,t){var n,r,i;if(1===e.nodeType){r=e.firstChild;while(r)n=t(r),i=r.nextSibling,n.length?n[0]!==r&&e.replaceChild(n[0],r):e.removeChild(r),r=i}return e}function i(e,t,n,r){return[n(t(r),e)]}function s(e,t,n,r){return[t(n(r,e))]}function o(e,t,n,r){return t(r)?[]:[n(r,e)]}function u(e,t,n,r){var i=n(r,e);return t(i)?[]:[i]}function a(e,t,n,r){function i(r){return e(i,t,n,r)}return i(r)[0]}function f(e,r,s){return a(i,r,s?n:t,e)}function l(e,r,i){return a(s,r,i?n:t,e)}function c(e,r,i){return a(o,r,i?n:t,e)}function h(e,r,i){return a(u,r,i?n:t,e)}function p(e,t,n){return a(i,t,r,n?e:e.cloneNode(!0))}function d(e,t,n){return a(s,t,r,n?e:e.cloneNode(!0))}function v(e,t,n){return a(o,t,r,n?e:e.cloneNode(!0))}function m(e,t,n){return a(u,t,r,n?e:e.cloneNode(!0))}function g(t){var n=e.type(t);return n!=="object"&&n!=="array"}function y(e,t,n){return[t(n,e)]}function b(e,r,i){function o(e){return g(e)?[r(e)]:y(o,s,e)}var s=i?n:t;return o(e)[0]}function w(e){function n(e){return y(n,t,e)}return n(e)[0]}function E(e){var t=!0,n=[];return b(e,function(e){return n.push(e),e},t),n}return{prewalk:f,postwalk:l,preprune:c,postprune:h,prewalkDom:p,postwalkDom:d,prepruneDom:v,postpruneDom:m,isLeaf:g,leaves:b,clone:w,flatten:E,walk:t,walkInplace:n,walkDomInplace:r}}),define("util/maps",[],function(){function e(e){var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function t(e,t,n){var r=t.length;while(r--)e[t[r]]=n;return e}function n(e,t){var n=t.length,r;while(n--)r=t[n],e[r[0]]=r[1];return e}function r(e){var t=[],n;for(n in e)e.hasOwnProperty(n)&&t.push(n);return t}return{isEmpty:e,fillTuples:n,fillKeys:t,keys:r}}),define("util/browser",["jquery"],function(e){return{ie7:e.browser.msie&&parseInt(e.browser.version,10)<8}}),define("util/dom2",["jquery","util/maps","util/strings","util/browser"],function(e,t,n,r){function o(e,t,n){while(t){var r=t.nextSibling;e.insertBefore(t,n),t=r}}function u(e){var t=[],n=e.cloneNode(!1).outerHTML,r;while(null!=(r=s.exec(n)))t.push(r[1]);return t}function a(t){var n=[],r=u(t),i,s;for(i=0,s=r.length;i<s;i++){var o=r[i],a=e.attr(t,o);null==a?a="":a=a.toString(),n.push([o,a])}return n}function f(e,t){var r={},i,s,o,u,a,f,l;for(f=0,a=e.length;f<a;f++){o=e[f];if(o.className){s=n.words(o.className);for(l=0;l<s.length;l++)u=s[l],t[u]&&(i=r[u],i?i.push(o):r[u]=[o])}}return r}function l(n,i){var s;return r.ie7?s=n.getElementsByTagName("*"):s=e(n).find("."+t.keys(i).join(",.")),f(s,i)}function c(t,n){var r,i={},s;for(r=0,s=n.length;r<s;r++){var o=n[r];i[o]=e.makeArray(t.getElementsByTagName(o))}return i}var i=/\s+/,s=/\s([^<\s=]+)(?:=(?:"[^"]*"|'[^']*'|[^\s]+))?/g;return{moveNextAll:o,attrNames:u,attrs:a,indexByClass:l,indexByName:c,indexByClassHaveList:f}}),define("util/functions",[],function(){function e(e){return e}return{identity:e}}),define("util/misc",[],function(){function e(e,t){var n,r;for(n=0,r=e.length;n<r;n++)if(e[n].test(t))return!0;return!1}return{anyRx:e}}),define("aloha/ephemera",["jquery","aloha/core","aloha/console","util/strings","util/trees","util/arrays","util/maps","util/dom2","util/functions","util/misc","PubSub"],function(e,t,n,r,i,s,o,u,a,f,l){function p(e){var t,r;for(t=0,r=e.length;t<r;t++)-1===e[t].indexOf(h)&&(n.warn('Class "'+e[t]+'" was set to be ephemeral,'+"which hurts peformance."+' Add the common substring "'+h+'" to the class to fix this problem.'),h="")}function d(){var e=Array.prototype.slice.call(arguments);o.fillKeys(c.classMap,e,!0),p(e),l.pub("aloha.ephemera.classes",{ephemera:c,newClasses:e})}function v(){var e=Array.prototype.slice.call(arguments);o.fillKeys(c.attrMap,e,!0),l.pub("aloha.ephemera.attributes",{ephemera:c,newAttributes:e})}function m(e){return e&&(c=e),l.pub("aloha.ephemera",{ephemera:c}),c}function g(t){e(t).addClass("aloha-ephemera")}function y(t,n){t=e(t);var i=t.attr("data-aloha-ephemera-attr");null==i||""===i?i=n:-1===s.indexOf(r.words(i),n)&&(i+=" "+n),t.attr("data-aloha-ephemera-attr",i),t.addClass("aloha-ephemera-attr")}function b(t){e(t).addClass("aloha-ephemera-wrapper")}function w(t){e(t).addClass("aloha-ephemera-filler")}function E(t){var n=e(t),i=n.attr("data-aloha-ephemera-attr"),s,o;n.removeAttr("data-aloha-ephemera-attr");if(typeof i=="string"){o=r.words(i);for(s=0;s<o.length;s++)n.removeAttr(o[s])}}function S(e,t,n,r){var i=n[t];if(i){if(!0===i)return!0;if(-1!==s.indexOf(i,e.nodeName))return!0}return f.anyRx(r,t)}function x(t,n){var r=null,i=u.attrNames(t),s,o,a;for(o=0,a=i.length;o<a;o++)s=i[o],S(t,s,n.attrMap,n.attrRxs)&&(r=r||e(t),r.removeAttr(s))}function T(t,n){var i=t.className;if(i&&-1!==i.indexOf(h)){var o=r.words(i);if(-1!==s.indexOf(o,"aloha-cleanme")||-1!==s.indexOf(o,"aloha-ephemera"))return e.removeData(t),!1;if(-1!==s.indexOf(o,"aloha-ephemera-wrapper")||-1!==s.indexOf(o,"aloha-ephemera-filler"))return u.moveNextAll(t.parentNode,t.firstChild,t.nextSibling),e.removeData(t),!1;-1!==s.indexOf(o,"aloha-ephemera-attr")&&E(t);var a=s.filter(o,function(e){return!n.classMap[e]});a.length!==o.length&&(0===a.length?e(t).removeAttr("class"):t.className=a.join(" "))}return x(t,n),!0}function N(e,t,n){if(1===n.nodeType){if(!T(n,e))return[];n=i.walkDomInplace(n,t)}return n=s.reduce(e.pruneFns,n,s.applyNotNull),n?[n]:[]}function C(e,t){function n(e){return N(t,n,e)}return t=t||c,n(e)[0]}var c={classMap:{"aloha-ephemera-wrapper":!0,"aloha-ephemera-filler":!0,"aloha-ephemera-attr":!0,"aloha-ephemera":!0,"aloha-cleanme":!0},attrMap:{hidefocus:!0,hideFocus:!0,tabindex:!0,tabIndex:!0,contenteditable:["TABLE"],contentEditable:["TABLE"]},attrRxs:[/^(?:nodeIndex|sizcache|sizset|jquery)[\w\d]*$/i],pruneFns:[]},h="aloha-";return{ephemera:m,classes:d,attributes:v,markElement:g,markAttr:y,markWrapper:b,markFiller:w,prune:C,isAttrEphemeral:S}}),define("aloha/editable",["aloha/core","util/class","jquery","aloha/pluginmanager","aloha/selection","aloha/markup","aloha/contenthandlermanager","aloha/console","aloha/block-jump","aloha/ephemera","util/dom2"],function(e,t,n,r,i,s,o,u,a,f,l){var c=window.unescape,h=window.GENTICS,p=!1,d={};e.defaults.contentHandler={},e.defaults.contentHandler.initEditable=["blockelement","sanitize"],e.defaults.contentHandler.getContents=["blockelement","sanitize","basic"],typeof e.settings.contentHandler=="undefined"&&(e.settings.contentHandler={});var v=function(e){return n(e).html()},m=v;e.Editable=t.extend({_constructor:function(t){t.attr("id")||t.attr("id",h.Utils.guid()),this.obj=t,this.originalObj=t,this.ready=!1,this.sccDelimiters=[":",";",".","!","?",",",c("%u0009"),c("%u0020"),c("%u0008"),c("%u007F"),"Enter"],this.sccIdle=5e3,this.sccDelay=500,this.sccTimerIdle=!1,this.sccTimerDelay=!1,this.keyCodeMap={93:"Apps",18:"Alt",20:"CapsLock",17:"Control",40:"Down",35:"End",13:"Enter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",36:"Home",45:"Insert",37:"Left",224:"Meta",34:"PageDown",33:"PageUp",19:"Pause",44:"PrintScreen",39:"Right",145:"Scroll",16:"Shift",38:"Up",91:"Win",92:"Win"},this.placeholderClass="aloha-placeholder",e.registerEditable(this)},init:function(){var t=this;this.settings=e.settings,e.settings&&e.settings.smartContentChange&&(e.settings.smartContentChange.delimiters&&(this.sccDelimiters=e.settings.smartContentChange.delimiters),e.settings.smartContentChange.idle&&(this.sccIdle=e.settings.smartContentChange.idle),e.settings.smartContentChange.delay&&(this.sccDelay=e.settings.smartContentChange.delay));if(!this.check(this.obj)){this.destroy();return}typeof e.settings.contentHandler.getContents=="undefined"&&(e.settings.contentHandler.getContents=e.defaults.contentHandler.getContents),typeof e.settings.contentHandler.initEditable=="undefined"&&(e.settings.contentHandler.initEditable=e.defaults.contentHandler.initEditable);var r=t.obj.html();r=o.handleContent(r,{contenthandler:e.settings.contentHandler.initEditable,command:"initEditable"}),t.obj.html(r),e.bind("aloha-ready",function(){t.obj.addClass("aloha-editable").contentEditable(!0),t.obj.mousedown(function(n){if(!e.eventHandled)return e.eventHandled=!0,t.activate(n)}),t.obj.mouseup(function(t){e.eventHandled=!1}),t.obj.focus(function(e){return t.activate(e)}),t.obj.add(".aloha-block",t.obj).keydown(function(e){var n=s.preProcessKeyStrokes(e);return t.keyCode=e.which,n||t.smartContentChange(e),n}),t.obj.keypress(function(t){e.activeEditable.smartContentChange(t)}),t.obj.keyup(function(t){if(t.keyCode===27)return e.deactivateEditable(),!1}),t.obj.contentEditableSelectionChange(function(e){return i.onChange(t.obj,e),t.obj}),t.setUnmodified(),t.snapshotContent=t.getContents(),n.browser.mozilla&&t.initEmptyEditable(),t.initPlaceholder(),t.ready=!0,window.setTimeout(function(){e.disableObjectResizing()},20),e.trigger("aloha-editable-created",[t])})},isActive:!1,originalContent:null,range:undefined,check:function(){var e=this,t=this.obj,r=t.get(0),i=r.nodeName.toLowerCase(),s=["a","abbr","address","article","aside","b","bdo","blockquote","cite","code","command","del","details","dfn","div","dl","em","footer","h1","h2","h3","h4","h5","h6","header","i","ins","menu","nav","p","pre","q","ruby","section","small","span","strong","sub","sup","var"],o,u;for(o=0;o<s.length;++o)if(i===s[o])return!0;switch(i){case"label":case"button":break;case"textarea":case"input":return u=n('<div id="'+this.getId()+'-aloha" class="aloha-'+i+'" />').insertAfter(t),u.height(t.height()).width(t.width()).html(t.val()),t.hide(),t.parents("form:first").submit(function(){t.val(e.getContents())}),this.obj=u,!0;default:}return!1},initPlaceholder:function(){e.settings.placeholder&&this.isEmpty()&&this.addPlaceholder()},isEmpty:function(){var e=n.trim(this.getContents()),t=e==="<br>"?!0:!1;return e.length===0||t},initEmptyEditable:function(){var e=this.obj;this.empty(this.getContents())&&n(e).prepend('<br class="aloha-cleanme" />')},addPlaceholder:function(){var t=n("<div>"),r=n("<span>"),i,s=this.obj;h.Utils.Dom.allowsNesting(s[0],t[0])?i=t:i=r;if(n("."+this.placeholderClass,s).length!==0)return;n(s).append(i.addClass(this.placeholderClass)),n.each(e.settings.placeholder,function(e,t){s.is(e)&&i.html(t)}),n("br",s).remove()},removePlaceholder:function(e,t){var r=this.placeholderClass,s;if(n("."+this.placeholderClass,e).length===0)return;t===!0?window.setTimeout(function(){s=new i.SelectionRange,s.startContainer=s.endContainer=e.get(0),s.startOffset=s.endOffset=0,n("."+r,e).remove(),s.select()},100):n("."+r,e).remove()},destroy:function(){this===e.getActiveEditable()&&this.blur();switch(this.originalObj.get(0).nodeName.toLowerCase()){case"label":case"button":break;case"textarea":case"input":this.originalObj.val(this.getContents()),this.obj.remove(),this.originalObj.show();break;default:}this.ready=!1,this.removePlaceholder(this.obj),this.obj.removeClass("aloha-editable").contentEditable(!1).unbind("mousedown click dblclick focus keydown keypress keyup"),e.trigger("aloha-editable-destroyed",[this]),e.unregisterEditable(this)},setUnmodified:function(){this.originalContent=this.getContents()},isModified:function(){return this.originalContent!==this.getContents()},toString:function(){return"Aloha.Editable"},isDisabled:function(){return!this.obj.contentEditable()||this.obj.contentEditable()==="false"},disable:function(){return this.isDisabled()||this.obj.contentEditable(!1)},enable:function(){return this.isDisabled()&&this.obj.contentEditable(!0)},activate:function(t){var n=e.getActiveEditable();if(p){p=!1;return}if(t&&t.type==="focus"&&n!==null&&n.obj.parent().get(0)===t.currentTarget)return;if(this.isActive||this.isDisabled())return;this.obj.addClass("aloha-editable-active"),e.activateEditable(this),p=!0,this.removePlaceholder(this.obj,!0),p=!1,this.isActive=!0,e.trigger("aloha-editable-activated",{oldActive:n,editable:this})},blur:function(){this.obj.blur(),this.isActive=!1,this.initPlaceholder(),this.obj.removeClass("aloha-editable-active"),e.trigger("aloha-editable-deactivated",{editable:this}),e.activeEditable.smartContentChange({type:"blur"},null)},empty:function(e){return null===e||n.trim(e)===""||e==="<br/>"},getContents:function(t){var i=this.obj.html(),s=d[this.getId()];if(!s||i!==s.raw){a.removeZeroWidthTextNodeFix();var u=this.obj.clone(!1);this.removePlaceholder(u),u=n(f.prune(u[0])),r.makeClean(u),u=n("<div>"+o.handleContent(u.html(),{contenthandler:e.settings.contentHandler.getContents,command:"getContents"})+"</div>"),s=d[this.getId()]={},s.raw=i,s.element=u}return t?s.element.clone().contents():(null==s.serialized&&(s.serialized=m(s.element[0])),s.serialized)},setContents:function(t,n){var r=null;return e.getActiveEditable()===this&&(e.deactivateEditable(),r=this),this.obj.html(t),null!==r&&r.activate(),this.smartContentChange({type:"set-contents"}),n?this.obj.contents():m(this.obj[0])},getId:function(){return this.obj.attr("id")},smartContentChange:function(t){function f(){return null==a&&(a=r.getSnapshotContent()),a}var r=this,i=null,s,o;if(t&&(t.metaKey||t.crtlKey||t.altKey))return!1;t&&t.originalEvent&&(s=new RegExp("U\\+(\\w{4})"),o=s.exec(t.originalEvent.keyIdentifier),i=this.keyCodeMap[this.keyCode]||String.fromCharCode(t.which)||"unknown");var a=null;n.inArray(i,this.sccDelimiters)>=0?(clearTimeout(this.sccTimerIdle),clearTimeout(this.sccTimerDelay),this.sccTimerDelay=window.setTimeout(function(){e.trigger("aloha-smart-content-changed",{editable:r,keyIdentifier:t.originalEvent.keyIdentifier,keyCode:t.keyCode,"char":i,triggerType:"keypress",getSnapshotContent:f}),u.debug("Aloha.Editable","smartContentChanged: event type keypress triggered")},this.sccDelay)):t&&t.type==="paste"?e.trigger("aloha-smart-content-changed",{editable:r,keyIdentifier:null,keyCode:null,"char":null,triggerType:"paste",getSnapshotContent:f}):t&&t.type==="blur"?e.trigger("aloha-smart-content-changed",{editable:r,keyIdentifier:null,keyCode:null,"char":null,triggerType:"blur",getSnapshotContent:f}):t&&t.type==="block-change"?e.trigger("aloha-smart-content-changed",{editable:r,keyIdentifier:null,keyCode:null,"char":null,triggerType:"block-change",getSnapshotContent:f}):
i!==null&&(clearTimeout(this.sccTimerDelay),clearTimeout(this.sccTimerIdle),this.sccTimerIdle=window.setTimeout(function(){e.trigger("aloha-smart-content-changed",{editable:r,keyIdentifier:null,keyCode:null,"char":null,triggerType:"idle",getSnapshotContent:f})},this.sccIdle))},getSnapshotContent:function(){var e=this.snapshotContent;return this.snapshotContent=this.getContents(),e}}),e.Editable.setContentSerializer=function(e){m=e},e.Editable.getContentSerializer=function(){return m}}),define("aloha/plugin",["aloha/core","jquery","util/class","aloha/pluginmanager","aloha/console"],function(e,t,n,r,i){var s=n.extend({name:null,defaults:{},settings:{},dependencies:[],_constructor:function(e){typeof e!="string"?i.error("Cannot initialise unnamed plugin, skipping"):this.name=e},checkDependencies:function(){var n=!0,r=this;return t.each(this.dependencies,function(){e.isPluginLoaded(this)||(n=!1,i.error("plugin."+r.name,'Required plugin "'+this+'" not found.'))}),n},init:function(){},getEditableConfig:function(e){var n=null,r=!1,i=this;return this.settings.editables&&t.each(this.settings.editables,function(s,o){var u;if(e.is(s)){r=!0;if(o instanceof Array)n=[],n=t.merge(n,o);else if(typeof o=="object"){n={},n["aloha-editable-selector"]=s;for(u in o)o.hasOwnProperty(u)&&(o[u]instanceof Array?n[u]=o[u]:typeof o[u]=="object"?(n[u]={},n[u]=t.extend(!0,n[u],i.config[u],o[u])):n[u]=o[u])}else n=o}}),r||(typeof this.settings.config=="undefined"||!this.settings.config?n=this.config:n=this.settings.config),n},makeClean:function(e){},getUID:function(e){return i.deprecated("plugin","getUID() is deprecated. Use plugin.name instead."),this.name},toString:function(){return this.name},log:function(e,t){i.deprecated("plugin","log() is deprecated. Use Aloha.console instead."),i.log(e,this,t)}});return s.create=function(n,i){var o=new(s.extend(i))(n);return o.settings=t.extendObjects(!0,o.defaults,e.settings[n]),r.register(o),o},s}),define("aloha/command",["aloha/core","aloha/registry","aloha/engine","util/dom","aloha/contenthandlermanager"],function(e,t,n,r,i){var s={execCommand:function(t,s,o,u){var a={commandId:t,preventDefault:!1};e.trigger("aloha-command-will-execute",a);if(a.preventDefault===!0)return;if(!u){if(!e.getSelection().getRangeCount())return;u=e.getSelection().getRangeAt(0)}t.toLowerCase()==="inserthtml"&&(o=i.handleContent(o,{contenthandler:e.settings.contentHandler.insertHtml,command:"insertHtml"})),n.execCommand(t,s,o,u);if(e.getSelection().getRangeCount()){u=e.getSelection().getRangeAt(0);var f=u.commonAncestorContainer;f.parentNode&&(f=f.parentNode);var l=new window.GENTICS.Utils.RangeObject;l.startContainer=u.startContainer,l.startOffset=u.startOffset,l.endContainer=u.endContainer,l.endOffset=u.endOffset,r.doCleanup({merge:!0,removeempty:!1},l,f),l.select()}e.trigger("aloha-command-executed",t)},queryCommandEnabled:function(t,r){if(!r){if(!e.getSelection().getRangeCount())return;r=e.getSelection().getRangeAt(0)}return n.queryCommandEnabled(t,r)},queryCommandIndeterm:function(t,r){if(!r){if(!e.getSelection().getRangeCount())return;r=e.getSelection().getRangeAt(0)}return n.queryCommandIndeterm(t,r)},queryCommandState:function(t,r){if(!r){if(!e.getSelection().getRangeCount())return;r=e.getSelection().getRangeAt(0)}return n.queryCommandState(t,r)},queryCommandSupported:function(e){return n.queryCommandSupported(e)},queryCommandValue:function(t,r){if(!r){if(!e.getSelection().getRangeCount())return;r=e.getSelection().getRangeAt(0)}return n.queryCommandValue(t,r)},querySupportedCommands:function(){var e=[],t;for(t in n.commands)n.commands.hasOwnProperty(t)&&e.push(t);return e}};return s=new(t.extend(s)),e.execCommand=s.execCommand,e.queryCommandEnabled=s.queryCommandEnabled,e.queryCommandIndeterm=s.queryCommandIndeterm,e.queryCommandState=s.queryCommandState,e.queryCommandSupported=s.queryCommandSupported,e.queryCommandValue=s.queryCommandValue,e.querySupportedCommands=s.querySupportedCommands,s}),define("aloha/jquery.aloha",["aloha/core","aloha/selection","jquery","aloha/console"],function(e,t,n,r){function s(e,t,n,r){if(t===r.target||!/textarea|input|select/i.test(r.target.nodeName)&&r.target.type!=="text")return e.apply(t,n);return}function o(e){var t,r,i,o;if(typeof e.data!="string")return;t=e.handler,r=e.data.toLowerCase().split(" "),i={};for(o=0;o<r.length;o++)i[r[o]]=!0;e.handler=function(e){if(this!==e.target)return;var r=e.type!=="keypress"&&n.hotkeys.specialKeys[e.which],o="",u;e.altKey&&r!=="alt"&&(o+="alt+"),e.ctrlKey&&r!=="ctrl"&&(o+="ctrl+"),e.metaKey&&!e.ctrlKey&&r!=="meta"&&(o+="meta+"),e.shiftKey&&r!=="shift"&&(o+="shift+");if(r){if(i[o+r])return s(t,this,arguments,e)}else{u=String.fromCharCode(e.which).toLowerCase();if(i[o+u])return s(t,this,arguments,e);if(i[o+n.hotkeys.shiftNums[u]])return s(t,this,arguments,e);if(o==="shift+"&&i[n.hotkeys.shiftNums[u]])return s(t,this,arguments,e)}}}var i=window.XMLSerializer;n.fn.between=function(e,t){var n,r;this[0].nodeType!==3?(n=this.children().size(),t>n&&(t=n),t<=0?this.prepend(e):this.children().eq(t-1).after(e)):t<=0?this.before(e):t>=this[0].length?this.after(e):(r=this[0].data,this[0].data=r.substring(0,t),this.after(r.substring(t,r.length)),this.after(e))},n.fn.contentEditable=function(e){var t=n(this),i="contenteditable";return n.browser.msie&&parseInt(n.browser.version,10)==7&&(i="contentEditable"),typeof e=="undefined"?typeof t[0]=="undefined"?(r.warn("The jquery object did not contain any valid elements."),undefined):typeof t[0].isContentEditable=="undefined"?(r.warn("Could not determine whether the is editable or not. I assume it is."),!0):t[0].isContentEditable:(e===""?t.removeAttr(i):(e&&e!=="false"?e="true":e="false",t.attr(i,e)),t)},n.fn.aloha=function(){var t=n(this);return e.bind("aloha-ready",function(){t.each(function(){e.isEditable(this)||(new e.Editable(n(this))).init()})}),t},n.fn.mahalo=function(){return this.each(function(){e.isEditable(this)&&e.getEditableById(n(this).attr("id")).destroy()})},n.fn.contentEditableSelectionChange=function(e){var r=this;return this.keyup(function(n){var r=t.getRangeObject();e(n)}),this.dblclick(function(t){e(t)}),this.mousedown(function(e){r.selectionStarted=!0}),n(document).mouseup(function(n){t.eventOriginalTarget=r,r.selectionStarted&&e(n),t.eventOriginalTarget=!1,r.selectionStarted=!1}),this},n.fn.outerHtml=n.fn.outerHtml||function(){var e=n(this),t=e.get(0);if(typeof t.outerHTML!="undefined")return t.outerHTML;try{return(new i).serializeToString(t)}catch(r){try{return t.xml}catch(s){}}},n.fn.zap=function(){return this.each(function(){n(this.childNodes).insertBefore(this)}).remove()},n.fn.textNodes=function(e,t){var r=[],i=function(s){var o,u;if(s.nodeType===3&&n.trim(s.data)&&!t||s.nodeType===3&&t||s.nodeName=="BR"&&!e)r.push(s);else for(o=0,u=s.childNodes.length;o<u;++o)i(s.childNodes[o])};return i(this[0]),n(r)},n.extendObjects=n.fn.extendObjects=function(e,t){var r,i,s,o,u,a,f=1,l=e||{},c=arguments.length,h=!1,p;typeof l=="boolean"&&(h=l,l=t||{},f=2),typeof l!="object"&&!n.isFunction(l)&&(l={}),c===f&&(l=this,--f);for(p=f;p<c;p++)if((r=arguments[p])!=null)for(i in r)if(r.hasOwnProperty(i)){s=l[i],o=r[i];if(l===o)continue;h&&o&&(n.isPlainObject(o)||!0===(u=n.isArray(o)))?(u?(u=!1,a=s&&n.isArray(s)?s:[]):a=s&&n.isPlainObject(s)?s:{},n.isArray(o)?l[i]=o:l[i]=n.extendObjects(h,a,o)):o!==undefined&&(l[i]=o)}return l},n.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",188:",",190:".",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},n.each(["keydown","keyup","keypress"],function(){n.event.special[this]={add:o}})}),define("aloha/sidebar",["aloha/core","jquery","aloha/selection","PubSub"],function(e,t,n,r){var i=+(new Date);t.easing.easeOutExpo||t.extend(t.easing,{easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeOutElastic:function(e,t,n,r,i){var s=Math,o=1.70158,u=0,a=r;return t?(t/=i)==1?n+r:(u||(u=i*.3),a<s.abs(r)?(a=r,o=u/4):o=u/(2*s.PI)*s.asin(r/a),a*s.pow(2,-10*t)*s.sin((t*i-o)*2*s.PI/u)+r+n):n}});var s=function(n){this.id=null,this.folds={},this.button=null,this.title=t('<div class="aloha-sidebar-panel-title"><span class="aloha-sidebar-panel-title-arrow"></span><span class="aloha-sidebar-panel-title-text">Untitled</span></div>'),this.content=t('<div class="aloha-sidebar-panel-content"><div class="aloha-sidebar-panel-content-inner"><div class="aloha-sidebar-panel-content-inner-text"></div></div></div>'),this.element=null,this.effectiveElement=null,this.expanded=!1,this.isActive=!0,this.init(n)},o=function(r){var s=this;this.id="aloha-sidebar-"+ ++i,this.panels={},this.container=t('<div class="aloha-ui aloha-sidebar-bar"><div class="aloha-sidebar-handle"><span class="aloha-sidebar-handle-icon"></span></div><div class="aloha-sidebar-inner"><ul class="aloha-sidebar-panels"></ul></div></div>'),this.width=300,this.opened=!1,this.isOpen=!1,this.isCompletelyOpen=!1,this.settings={rotateIcons:!t.browser.msie,overlayPage:!0},t(function(){(typeof e.settings.sidebar=="undefined"||!e.settings.sidebar.disabled)&&s.init(r)})},u=null,a=null;t.extend(o.prototype,{init:function(e){var n=this,r;typeof e=="object"&&(r=e.panels,delete e.panels),t.extend(this,e),typeof r=="object"&&t.each(r,function(){n.addPanel(this,!0)});var i=this.container;this.position==="right"&&i.addClass("aloha-sidebar-right"),i.hide().appendTo(t("body")).click(function(){n.barClicked.apply(n,arguments)}).find(".aloha-sidebar-panels").width(this.width),i.width(this.width),this.width=i.width(),this.updateHeight(),this.initToggler(),this.container.css(this.position==="right"?"marginRight":"marginLeft",-this.width),this.opened&&this.open(0),this.toggleHandleIcon(this.isOpen),this.subscribeToEvents(),t(window).resize(function(){n.updateHeight(),n.correctHeight()}),this.correctHeight()},show:function(){return this.container.css("display","block"),this},hide:function(){return this.container.css("display","none"),this},checkActivePanels:function(e){var n=[];if(typeof e!="undefined"&&typeof e.markupEffectiveAtStart!="undefined"){var r=e.markupEffectiveAtStart.length,i;for(i=0;i<r;++i)n.push(t(e.markupEffectiveAtStart[i]))}var s=this;t.each(this.panels,function(){s.showActivePanel(this,n)}),this.correctHeight()},subscribeToEvents:function(){var t=this;r.sub("aloha.selection.context-change",function(e){t.isOpen&&t.checkActivePanels(e.range),t.lastRange=e.range}),e.bind("aloha-editable-deactivated",function(e,n){t.isOpen&&t.checkActivePanels(),t.lastRange=null}),this.container.mousedown(function(t){t.originalEvent.stopSelectionUpdate=!0,e.eventHandled=!0}),this.container.mouseup(function(t){t.originalEvent.stopSelectionUpdate=!0,e.eventHandled=!1})},correctHeight:function(){if(!this.isOpen)return;if(!this.isCompletelyOpen){this.correctHeightWhenCompletelyOpen=!0;return}var e=t(window).height(),n=[],r=[],i;for(i in this.panels)this.panels.hasOwnProperty(i)&&this.panels[i].isActive&&(r.push(this.panels[i]),n.push(i));if(0===r.length)return;n=n.sort().join(",");if(a===n&&u===e)return;u=e,a=n;var s=this.container.find(".aloha-sidebar-inner").height(),o=s-(r[0].title.outerHeight()+10)*r.length,f,l,c,h,p,d=0,v=Math,m;while(r.length>0&&o>0){o+=d,d=0,p=[];for(m=r.length-1;m>=0;--m)f=r[m],c=f.content.find(".aloha-sidebar-panel-content-inner"),l=v.min(c.height("auto").height(),v.floor(o/(m+1))),c.height(l),o-=l,h=c.find(".aloha-sidebar-panel-content-inner-text"),h.height()>l?(p.push(f),d+=l,c.css({"overflow-x":"hidden","overflow-y":"scroll"})):c.css("overflow-y","hidden"),f.expanded&&f.expand();r=p}},showActivePanel:function(e,n){n.push(null);var r=e.content.parent("li"),i=e.activeOn,s=t(),o=0,u=n.length,a;for(a=0;a<u;++a)i(n[a])&&(++o,n[a]&&t.merge(s,n[a]));o?e.activate(s):e.deactivate()},initToggler:function(){var n=this,r=this.container,i=r.find(".aloha-sidebar-handle-icon"),s="aloha-sidebar-toggled",o,u=this.position==="right";this.opened&&this.rotateHandleArrow(u?0:180,0),t(function(){typeof e.settings.sidebar!="undefined"&&e.settings.sidebar.handle&&e.settings.sidebar.handle.top&&(t(r.find(".aloha-sidebar-handle"))[0].style.top=e.settings.sidebar.handle.top)}),r.find(".aloha-sidebar-handle").click(function(){o&&clearInterval(o),i.stop().css("marginLeft",4),n.isOpen?(t(this).removeClass(s),n.close(),n.isOpen=!1):(t(this).addClass(s),n.open(),n.isOpen=!0)}).hover(function(){var e=n.isOpen?-1:1;o&&clearInterval(o),i.stop(),t(this).stop().animate(u?{marginLeft:"-="+e*5}:{marginRight:"-="+e*5},200),o=setInterval(function(){e*=-1,i.animate(u?{left:"-="+e*4}:{right:"-="+e*4},300)},300)},function(){o&&clearInterval(o),i.stop().css(u?"left":"right",5),t(this).stop().animate(u?{marginLeft:0}:{marginRight:0},600,"easeOutElastic")})},roundCorners:function(){var e=this.container,t=e.find(".aloha-sidebar-panels>li:not(.aloha-sidebar-deactivated)"),n="aloha-sidebar-panel-top",r="aloha-sidebar-panel-bottom";e.find(".aloha-sidebar-panel-top, .aloha-sidebar-panel-bottom").removeClass(n).removeClass(r),t.first().find(".aloha-sidebar-panel-title").addClass(n),t.last().find(".aloha-sidebar-panel-content").addClass(r)},updateHeight:function(){var e=t(window).height();this.container.height(e).find(".aloha-sidebar-inner").height(e)},barClicked:function(e){this.handleBarclick(t(e.target))},handleBarclick:function(e){e.hasClass("aloha-sidebar-panel-title")?this.togglePanel(e):!e.hasClass("aloha-sidebar-panel-content")&&!e.hasClass("aloha-sidebar-handle")&&!e.hasClass("aloha-sidebar-bar")&&this.handleBarclick(e.parent())},getPanelById:function(e){return this.panels[e]},getPanelByElement:function(e){var t=e[0].tagName==="LI"?e:e.parent("li");return this.getPanelById(t[0].id)},togglePanel:function(e){this.getPanelByElement(e).toggle()},rotateHandleIcon:function(e,t){var n=this.container.find(".aloha-sidebar-handle-icon");n.animate({angle:e},{duration:typeof t=="number"||typeof t=="string"?t:500,easing:"easeOutExpo",step:function(e,t){n.css({"-o-transform":"rotate("+e+"deg)","-webkit-transform":"rotate("+e+"deg)","-moz-transform":"rotate("+e+"deg)","-ms-transform":"rotate("+e+"deg)"})}})},toggleHandleIcon:function(e){var t=this.position==="right"^e;if(this.settings.rotateIcons)this.rotateHandleIcon(t?180:0,0);else{var n=this.container.find(".aloha-sidebar-handle-icon");t?n.addClass("aloha-sidebar-handle-icon-left"):n.removeClass("aloha-sidebar-handle-icon-left")}},open:function(e,n){if(this.isOpen)return this;var r=this.position==="right",i=r?{marginRight:0}:{marginLeft:0},s=this;return this.toggleHandleIcon(!0),this.container.animate(i,typeof e=="number"||typeof e=="string"?e:500,"easeOutExpo"),this.settings.overlayPage||t("body").animate(r?{marginRight:"+="+this.width}:{marginLeft:"+="+this.width},500,"easeOutExpo",function(){s.isCompletelyOpen=!0,s.correctHeightWhenCompletelyOpen&&s.correctHeight()}),this.isOpen=!0,this.correctHeight(),this.lastRange&&this.checkActivePanels(this.lastRange),t("body").trigger("aloha-sidebar-opened",this),this},close:function(e,n){if(!this.isOpen)return this;var r=this.position==="right",i=r?{marginRight:-this.width}:{marginLeft:-this.width};return this.toggleHandleIcon(!1),this.container.animate(i,typeof e=="number"||typeof e=="string"?e:500,"easeOutExpo"),this.settings.overlayPage||t("body").animate(r?{marginRight:"-="+this.width}:{marginLeft:"-="+this.width},500,"easeOutExpo"),this.isOpen=!1,this.isCompletelyOpen=!1,this},activatePanel:function(e,t){return typeof e=="string"&&(e=this.getPanelById(e)),e&&e.activate(t),this.roundCorners(),this},expandPanel:function(e,t){return typeof e=="string"&&(e=this.getPanelById(e)),e&&e.expand(t),this},collapsePanel:function(e,t){return typeof e=="string"&&(e=this.getPanelById(e)),e&&e.collapse(t),this},addPanel:function(e,t){return e instanceof s||(e.width||(e.width=this.width),e.sidebar=this,e=new s(e)),this.panels[e.id]=e,this.container.find(".aloha-sidebar-panels").append(e.element),this.checkActivePanels(n.getRangeObject()),e}}),t.extend(s.prototype,{init:function(e){this.setTitle(e.title).setContent(e.content),delete e.title,delete e.content,t.extend(this,e),this.id||(this.id="aloha-sidebar-"+ ++i);var n=this.element=t('<li id="'+this.id+'">').append(this.title,this.content);this.expanded&&this.content.height("auto"),this.toggleTitleIcon(this.expanded),this.coerceActiveOn(),this.title.attr("unselectable","on").css("-moz-user-select","none").each(function(){this.onselectstart=function(){return!1}}),typeof this.onInit=="function"&&this.onInit.apply(this)},toggleTitleIcon:function(e){if(this.sidebar.settings.rotateIcons)this.rotateTitleIcon(e?90:0);else{var t=this.title.find(".aloha-sidebar-panel-title-arrow");e?t.addClass("aloha-sidebar-panel-title-arrow-down"):t.removeClass("aloha-sidebar-panel-title-arrow-down")}},coerceActiveOn:function(){if(typeof this.activeOn!="function"){var e=this.activeOn;this.activeOn=function(){var t=typeof e,n;return t==="boolean"?n=function(){return e}:t==="undefined"?n=function(){return!0}:t==="string"?n=function(t){return t?t.is(e):!1}:n=function(){return!1},n}()}},activate:function(e){this.isActive=!0,this.content.parent("li").show().removeClass("aloha-sidebar-deactivated"),this.effectiveElement=e,typeof this.onActivate=="function"&&this.onActivate.call(this,e)},deactivate:function(){if(!this.isActive)return;this.isActive=!1,this.content.parent("li").hide().addClass("aloha-sidebar-deactivated"),this.effectiveElement=null},toggle:function(){this.expanded?this.collapse():this.expand()},expand:function(e){var t=this,n=this.content,r=n.height(),i=n.height("auto").height();return n.height(r).stop().animate({height:i},500,"easeOutExpo",function(){typeof e=="function"&&e.call(t)}),this.element.removeClass("collapsed"),this.toggleTitleIcon(!0),this.expanded=!0,this},collapse:function(e,t){var n=this;return this.element.addClass("collapsed"),this.content.stop().animate({height:5},250,"easeOutExpo",function(){typeof t=="function"&&t.call(n)}),this.toggleTitleIcon(!1),this.expanded=!1,this},setTitle:function(e){return this.title.find(".aloha-sidebar-panel-title-text").html(e),this},setContent:function(e){if(!e||e==="")e="&nbsp;";return this.content.find(".aloha-sidebar-panel-content-inner-text").html(e),this},rotateTitleIcon:function(e,t){var n=this.title.find(".aloha-sidebar-panel-title-arrow");n.animate({angle:e},{duration:typeof t=="number"?t:500,easing:"easeOutExpo",step:function(e,t){n.css({"-o-transform":"rotate("+e+"deg)","-webkit-transform":"rotate("+e+"deg)","-moz-transform":"rotate("+e+"deg)","-ms-transform":"rotate("+e+"deg)"})}})},renderEffectiveParents:function(e,n){var r=e.first(),i=[],s=[],o=this.activeOn,u,a;while(r.length>0&&!r.is(".aloha-editable")){if(o(r)){s.push("<span>"+r[0].tagName.toLowerCase()+"</span>"),u=s.length,a=[];while(u--)a.push(s[u]);i.push('<div class="aloha-sidebar-panel-parent"><div class="aloha-sidebar-panel-parent-path">'+a.join("")+"</div>"+'<div class="aloha-sidebar-panel-parent-content'+'aloha-sidebar-opened">'+(typeof n=="function"?n(r):"----")+"</div>"+"</div>")}r=r.parent()}this.setContent(i.join("")),t(".aloha-sidebar-panel-parent-path").click(function(){var e=t(this).parent().find(".aloha-sidebar-panel-parent-content");e.hasClass("aloha-sidebar-opened")?e.hide().removeClass("aloha-sidebar-opened"):e.show().addClass("aloha-sidebar-opened")}),this.content.height("auto").find(".aloha-sidebar-panel-content-inner").height("auto")}});var f=new o({position:"left",width:250}),l=new o({position:"right",width:250});return e.Sidebar={left:f,right:l},e.Sidebar}),window.GENTICS=window.GENTICS||{},window.GENTICS.Utils=window.GENTICS.Utils||{},define("util/position",["jquery"],function(e){var t=e,n=window.GENTICS,r=window.Class,i=window.console;n.Utils.Position={},n.Utils.Position.w=e(window),n.Utils.Position.Scroll={top:0,left:0,isScrolling:!1},n.Utils.Position.ScrollCorrection={top:100,left:50},n.Utils.Position.Mouse={x:0,y:0,oldX:0,oldY:0,isMoving:!1,triggeredMouseStop:!0},n.Utils.Position.mouseStopCallbacks=[],n.Utils.Position.mouseMoveCallbacks=[],n.Utils.Position.update=function(){var e=this.w.scrollTop(),t=this.w.scrollLeft(),n;if(this.Scroll.isScrolling)this.Scroll.top==e&&this.Scroll.left==t&&(this.Scroll.isScrolling=!1);else if(this.Scroll.top!=e||this.Scroll.left!=t)this.Scroll.isScrolling=!0;this.Scroll.top=e,this.Scroll.left=t;if(this.Mouse.x==this.Mouse.oldX&&this.Mouse.y==this.Mouse.oldY){this.Mouse.isMoving=!1;if(!this.Mouse.triggeredMouseStop){this.Mouse.triggeredMouseStop=!0;for(n=0;n<this.mouseStopCallbacks.length;n++)this.mouseStopCallbacks[n].call()}}else{this.Mouse.isMoving=!0,this.Mouse.triggeredMouseStop=!1;for(n=0;n<this.mouseMoveCallbacks.length;n++)this.mouseMoveCallbacks[n].call()}this.Mouse.oldX=this.Mouse.x,this.Mouse.oldY=this.Mouse.y},n.Utils.Position.addMouseStopCallback=function(e){return this.mouseStopCallbacks.push(e),this.mouseStopCallbacks.length-1},n.Utils.Position.addMouseMoveCallback=function(e){return this.mouseMoveCallbacks.push(e),this.mouseMoveCallbacks.length-1},e(function(){window.setInterval(function(){n.Utils.Position.update()},500)}),e("html").mousemove(function(e){n.Utils.Position.Mouse.x=e.pageX,n.Utils.Position.Mouse.y=e.pageY})}),define("aloha/repositorymanager",["aloha/core","util/class","jquery","aloha/console"],function(e,t,n,r){return e.RepositoryManager=t.extend({repositories:[],settings:{},init:function(){var t=this.repositories,r,i=t.length,s;e.settings&&e.settings.repositories&&(this.settings=e.settings.repositories),this.settings.timeout=this.settings.timeout||5e3;for(r=0;r<i;++r)s=t[r],s.settings||(s.settings={}),this.settings[s.repositoryId]&&n.extend(s.settings,this.settings[s.repositoryId]),s.init()},register:function(e){this.getRepository(e.repositoryId)?r.warn(this,"A repository with name { "+e.repositoryId+" } already registerd. Ignoring this."):this.repositories.push(e)},getRepository:function(e){var t=this.repositories,n,r=t.length;for(n=0;n<r;++n)if(t[n].repositoryId===e)return t[n];return null},query:function(e,t){function m(e){return function(){p.apply(e,arguments)}}var i=this,s,o=[],u={numItems:0,hasMoreItems:!1},a=[],f=0,l,c,h,p=function(e,s){if(f===0)return;var a=e?e.length:0;if(a){if(!e[0].repositoryId){var c=this.repositoryId,h;for(h=0;h<a;++h)e[h].repositoryId=c}n.merge(o,e)}s&&u?(n.isNumeric(s.numItems)&&n.isNumeric(u.numItems)?u.numItems+=s.numItems:u.numItems=undefined,typeof s.hasMoreItems=="boolean"&&typeof u.hasMoreItems=="boolean"?u.hasMoreItems=u.hasMoreItems||s.hasMoreItems:u.hasMoreItems=undefined,s.timeout&&(u.timeout=!0)):u=undefined,r.debug(this,"The repository "+this.repositoryId+" returned with "+a+" results."),--f===0&&i.queryCallback(t,o,u,l)},d=parseInt(e.timeout,10)||this.settings.timeout;l=window.setTimeout(function(){f>0&&r.warn(this,f+" repositories did not return before the configured timeout of "+d+"ms."),f=0,u=u||{},u.timeout=!0,i.queryCallback(t,o,u,l)},d),e.repositoryId?a.push(this.getRepository(e.repositoryId)):a=this.repositories,h=a.length;var v=[];for(c=0;c<h;++c)s=a[c],(!e.repositoryId||s.repositoryId===e.repositoryId)&&typeof s.query=="function"&&(++f,v.push(s));h=v.length;for(c=0;c<h;++c)s=v[c],s.query(e,m(s));f===0&&this.queryCallback(t,o,u,l)},queryCallback:function(e,t,n,r){r&&(clearTimeout(r),r=undefined);var i={items:t,results:t.length};n&&(i.numItems=n.numItems,i.hasMoreItems=n.hasMoreItems,i.timeout=n.timeout),e.call(this,i)},getChildren:function(t,r){function m(e){return function(){h.apply(e,arguments)}}var i=this,s,o=[],u=[],a=0,f,l,c,h=function(e){if(a===0)return;o&&e&&n.merge(o,e),--a===0&&i.getChildrenCallback(r,o,f)};if(t.inFolderId==="aloha"){var p=t.repositoryFilter,d=p&&p.length;c=this.repositories.length;for(l=0;l<c;++l)s=this.repositories[l],(!d||n.inArray(s.repositoryId,p)>-1)&&u.push(new e.RepositoryFolder({id:s.repositoryId,name:s.repositoryName,repositoryId:s.repositoryId,type:"repository",hasMoreItems:!0}));i.getChildrenCallback(r,u,null);return}u=this.repositories;var v=parseInt(t.timeout,10)||this.settings.timeout;f=window.setTimeout(function(){a=0,i.getChildrenCallback(r,o,f)},v),c=u.length;for(l=0;l<c;++l)s=u[l],(!t.repositoryId||s.repositoryId===t.repositoryId)&&typeof s.getChildren=="function"&&(++a,s.getChildren(t,m(s)));a===0&&this.getChildrenCallback(r,o,f)},getChildrenCallback:function(e,t,n){n&&(clearTimeout(n),n=undefined),e.call(this,t)},makeClean:function(e){var t=this,n={},i=0,s=t.repositories.length;e.find("[data-gentics-aloha-repository="+this.prefix+"]").each(function(){while(i<s)n.makeClean(e),i+=1;r.debug(t,"Passing contents of HTML Element with id { "+this.attr("id")+" } for cleaning to repository { "+n.repositoryId+" }"),n.makeClean(this)})},markObject:function(e,t){if(!e)return;if(t){var i=this.getRepository(t.repositoryId);i?(n(e).attr({"data-gentics-aloha-repository":t.repositoryId,"data-gentics-aloha-object-id":t.id}),i.markObject(e,t)):r.error(this,"Trying to apply a repository { "+t.name+" } to an object, but item has no repositoryId.")}else n(e).removeAttr("data-gentics-aloha-repository").removeAttr("data-gentics-aloha-object-id")},getObject:function(e,t){var r=this,i=n(e),s=this.getRepository(i.attr("data-gentics-aloha-repository")),o=i.attr("data-gentics-aloha-object-id");s&&o&&(this.itemCache=this.itemCache||[],this.itemCache[s.repositoryId]=this.itemCache[s.repositoryId]||[],this.itemCache[s.repositoryId][o]?t.call(this,[this.itemCache[s.repositoryId][o]]):s.getObjectById(o,function(e){r.itemCache[s.repositoryId][o]=e[0],t.call(this,e)}))},toString:function(){return"repositorymanager"}}),e.RepositoryManager=new e.RepositoryManager,e.RepositoryManager}),define("aloha/repository",["aloha/core","util/class","aloha/repositorymanager"],function(e,t,n){var r=t.extend({_constructor:function(e,t){this.repositoryId=e,this.settings={},this.repositoryName=t||e,n.register(this)},init:function(){},query:null,getChildren:null,makeClean:function(e){},markObject:function(e,t){},setTemplate:function(e){e?this.template=e:this.template=null},hasTemplate:function(){return this.template?!0:!1},getTemplate:function(){return this.template},getObjectById:function(e,t){return!0}});return e.AbstractRepository=r,r}),define("aloha/repositoryobjects",["aloha/core","util/class"],function(e,t){var n=window.GENTICS;e.RepositoryObject=function(){},e.RepositoryDocument=t.extend({_constructor:function(e){var t=e;this.type="document";if(!t.id||!t.name||!t.repositoryId)return;n.Utils.applyProperties(this,e),this.baseType="document"}}),e.RepositoryFolder=t.extend({_constructor:function(e){var t=e;this.type="folder";if(!t.id||!t.name||!t.repositoryId)return;n.Utils.applyProperties(this,e),this.baseType="folder"}})}),function(e){function t(){var e,t,n=Aloha.settings.plugins&&Aloha.settings.plugins.load,r=Aloha.settings.baseUrl,i,s=/\/aloha.js(\?\S*)?$/,o=/\/[^\/]*\.js$/,u;if(!n||!r){e=document.getElementsByTagName("script");for(u=0;u<e.length;u++){t=e[u],i=t.getAttribute("data-aloha-plugins");if(null!=i){n||(n=i),r||(r=t.src.replace(o,""));break}!r&&s.test(t.src)&&(r=t.src.replace(s,""))}}return typeof n=="string"&&n!==""&&(n=n.replace(/\s+/g,"").split(",")),{baseUrl:r,plugins:n||[]}}function n(){var e=document.getElementsByTagName("script");for(var t=0;t<e.length;t++){var n=e[t].getAttribute("data-aloha-defer-init");if("true"===n)return!0}return!1}function r(e,t,n){var r=["nls","css","vendor","res"],i,s;e[n]=t+"/"+n+"/lib";for(s=0;s<r.length;s++){var i=r[s];e[n+"/"+i]=t+"/"+n+"/"+i}}function i(e){var t={},n=[],i=[],s={},o={},u,a,f,l=Aloha.settings.basePath||"",c,h=Aloha.settings.bundles||{},p;for(p=0;p<e.length;p++)u=e[p].split("/"),a=u[0],f=u[1],h[a]?c=l+h[a]:c=l+"../plugins/"+a,r(t,c,f),s[f]=c+"/"+f,n.push(f+"/"+f+"-plugin"),o[f]={jquery:"aloha/jquery"};return{paths:t,entryPoints:n,baseUrlByName:s,names:i,map:o}}function s(){var e={},t=Array.prototype.slice.call(arguments),n,r,i;for(r=0;r<t.length;r++){i=t[r];for(n in i)i.hasOwnProperty(n)&&(e[n]=t[r][n])}return e}function o(e,t){define(e,function(){return t})}function u(){Aloha.defaults={},Aloha.settings=Aloha.settings||{};var e=t(),n=i(e.plugins);Aloha.settings.baseUrl=e.baseUrl,Aloha.settings.loadedPlugins=n.names,Aloha.settings._pluginBaseUrlByName=n.baseUrlByName;var r={aloha:{jquery:"aloha/jquery"},"aloha/jquery":{jquery:"jquery"},jqueryui:{jquery:"aloha/jquery"},vendor:{jquery:"aloha/jquery"},util:{jquery:"aloha/jquery"},RepositoryBrowser:{jquery:"aloha/jquery"},jstree:{jquery:"aloha/jquery"},jqgrid:{jquery:"aloha/jquery"},"jqgrid-locale-en":{jquery:"aloha/jquery"},"jqgrid-locale-de":{jquery:"aloha/jquery"},"jquery-layout":{jquery:"aloha/jquery"}},u=s(r,n.map),a={context:"aloha",locale:Aloha.settings.locale||"en",baseUrl:Aloha.settings.baseUrl,map:u},f={jquery:"vendor/jquery-1.7.2",jqueryui:"vendor/jquery-ui-1.9.0.custom-aloha"},l={PubSub:"vendor/pubsub/js/pubsub-unminified",Class:"vendor/class",RepositoryBrowser:"vendor/repository-browser/js/repository-browser-unminified",jstree:"vendor/jquery.jstree",jqgrid:"vendor/jquery.jqgrid","jquery-layout":"vendor/jquery.layout-1.3.0-rc30.7","jqgrid-locale-en":"vendor/grid.locale.en","jqgrid-locale-de":"vendor/grid.locale.de","repository-browser-i18n-de":"vendor/repository-browser/js/repository-browser-unminified","repository-browser-i18n-en":"vendor/repository-browser/js/repository-browser-unminified"},c=s(a,Aloha.settings.requireConfig);c.paths=s(f,l,n.paths,c.paths);var h=Aloha.settings.predefinedModules||{};Aloha.settings.jQuery&&(h.jquery=Aloha.settings.jQuery);var p;for(p in h)h.hasOwnProperty(p)&&(o(p,h[p]),delete c.paths[p]);var d=require.config(c);Aloha.require=function(e){return 1===arguments.length&&typeof e=="function"?d(["aloha"],e):d.apply(this,arguments)};var v;Aloha.bind=function(e,t){return Aloha.require(["aloha/jquery"],function(n){Aloha.bind=function(e,t){return v=v||n.Deferred(),"aloha-ready"===e?"alohaReady"!==Aloha.stage?v.done(t):t():n(Aloha,"body").bind(e,t),this},Aloha.bind(e,t)}),this},Aloha.trigger=function(e,t){return Aloha.require(["aloha/jquery"],function(n){Aloha.trigger=function(e,t){return v=v||n.Deferred(),"aloha-ready"===e&&n(v.resolve),n(Aloha,"body").trigger(e,t),this},Aloha.trigger(e,t)}),this},Aloha.unbind=function(e){Aloha.require(["aloha/jquery"],function(t){Aloha.unbind=function(e){t(Aloha,"body").unbind(e)},Aloha.unbind(e)})},Aloha.ready=function(e){return this.bind("aloha-ready",e),this};var m=Aloha.settings.jQuery;define("aloha/jquery",["jquery"],function(e){return m||e}),Aloha.jQuery=m,define("aloha",["aloha/jquery","util/json2","aloha/rangy-core","util/class","util/lang","util/range","util/dom","aloha/core","aloha/editable","aloha/console","aloha/markup","aloha/plugin","aloha/selection","aloha/command","aloha/jquery.aloha","aloha/sidebar","util/position","aloha/repositorymanager","aloha/repository","aloha/repositoryobjects","aloha/contenthandlermanager"],function(e){return Aloha.jQuery=e,Aloha.settings=e.extendObjects(!0,{},Aloha.defaults,Aloha.settings),Aloha}),Aloha.stage="loadingAloha",require(c,["aloha","aloha/jquery"],function(e,t){e.stage="loadPlugins",require(c,n.entryPoints,function(){t(function(){window.rangy.init(),e.init()})})})}e.Aloha=e.Aloha||{},e.Aloha.deferInit||n()?e.Aloha.deferInit=u:Aloha._load=u}(window),define("ui/context",["aloha","jquery","util/class"],function(e,t,n){var r="aloha-ui-context",i="#"+r,s;s=t(i),s.length||(s=t("<div>",{"class":"aloha",id:r}),t(function(){s.appendTo("body")}));var o=n.extend({surfaces:[],containers:[]});return t.extend(o,{selector:i,element:s}),o}),define("ui/scopes",["jquery","PubSub"],function(e,t){function o(e,t){if(!n.hasOwnProperty(t))return;var r=n[t];for(var i=0;i<r.length;i++){var s=r[i];e.push(s),o(e,s)}}var n={"Aloha.empty":[],"Aloha.global":["Aloha.empty"],"Aloha.continuoustext":["Aloha.global"]},r=[],i={},s=!1;Aloha.bind("aloha-selection-changed-before",function(){s=!1}),Aloha.bind("aloha-selection-changed-after",function(e,t,n){typeof n!="undefined"&&!s&&u.setScope("Aloha.continuoustext")});var u={enterScope:function(e,n){n=n||"_globalCounter";var r=i[e];r||(r=i[e]={});var s=r[n]||0;s+=1,r[n]=s,s||t.pub("aloha.ui.scope.change")},leaveScope:function(e,n,r){n=n||"_globalCounter";var s=i[e];if(!s)return;var o=s[n];if(!o)return;o-=1,o&&!r?s[n]=o:(delete s[n],t.pub("aloha.ui.scope.change"))},isActiveScope:function(t){if(i[t])return!0;var n=-1!==e.inArray
(t,r);return n?!0:!1},getPrimaryScope:function(){return r[0]},setScope:function(e){s=!0,r[0]!=e&&(r=[e],o(r,e),t.pub("aloha.ui.scope.change"))},createScope:function(e,t){t?typeof t=="string"&&(t=[t]):t=["Aloha.empty"],n[e]=t}};return u}),define("ui/container",["jquery","util/class","ui/scopes"],function(e,t,n){function i(e){return e.showOnId||(e.showOnId=++r),e.showOnId}function s(e,t){var n=t?"show":"hide",r;for(r=0;r<e.length;r++)e[r][n]()}function a(t,r){switch(e.type(r)){case"function":return r;case"object":if(r.scope)return o[r.scope]?o[r.scope]:o[r.scope]=function(){return n.isActiveScope(r.scope)};throw"Invalid showOn configuration";default:return u}}var r=0,o={},u=function(){return!0},f=t.extend({element:null,_constructor:function(e,t){var n=a(this,t.showOn),r=i(n),s=e.containers[r];this.context=e,s||(s=e.containers[r]={shouldShow:n,containers:[]}),s.containers.push(this)},show:function(){},hide:function(){},focus:function(){},foreground:function(){},childVisible:function(e,t){},childFocus:function(e){},childForeground:function(e){}});return e.extend(f,{showContainersForContext:function(e,t){var n,r,i;if(!e.containers)return;i=e.containers;for(r in i)i.hasOwnProperty(r)&&(n=i[r],s(n.containers,n.shouldShow(t)))}}),f}),define("ui/surface",["aloha/core","jquery","util/class","ui/container"],function(e,t,n,r){var i=n.extend({_constructor:function(e){e.surfaces.push(this)},isActive:function(){return!0}});return t.extend(i,{range:null,show:function(e){t.each(e.surfaces,function(e,t){t.show()})},hide:function(e){t.each(e.surfaces,function(e,t){t.hide()})},trackRange:function(t){t.bind("mousedown",function(t){t.originalEvent.stopSelectionUpdate=!0,e.eventHandled=!0,i.suppressHide=!0;if(e.activeEditable){var n=e.getSelection();i.range=0<n.getRangeCount()?n.getRangeAt(0):null}}),t.bind("mouseup",function(t){t.originalEvent.stopSelectionUpdate=!0,e.eventHandled=!1,i.suppressHide=!1})}}),i}),define("ui/component",["aloha/core","jquery","util/class"],function(e,t,n){var r=0,i=n.extend({id:0,isInstance:!0,container:null,type:null,visible:!0,_constructor:function(){this.id=r++,this.init()},adoptParent:function(e){this.container=e},init:function(){},isVisible:function(){return this.visible},show:function(e){if(!1===e){this.hide();return}this.visible||(this.visible=!0,this.element.show(),this.container&&this.container.childVisible(this,!0))},hide:function(){this.visible&&(this.visible=!1,this.element.hide(),this.container&&this.container.childVisible(this,!1))},focus:function(){this.element.focus(),this.container&&this.container.childFocus(this)},foreground:function(){this.container&&this.container.childForeground(this)},enable:function(e){},disable:function(){}});return i}),define("jqueryui",["jquery"],function(jQuery){(function(e,t){function i(t,n){var r,i,o,u=t.nodeName.toLowerCase();return"area"===u?(r=t.parentNode,i=r.name,!t.href||!i||r.nodeName.toLowerCase()!=="map"?!1:(o=e("img[usemap=#"+i+"]")[0],!!o&&s(o))):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&s(t)}function s(t){return!e(t).parents().andSelf().filter(function(){return e.css(this,"visibility")==="hidden"||e.expr.filters.hidden(this)}).length}var n=0,r=/^ui-id-\d+$/;e.ui=e.ui||{};if(e.ui.version)return;e.extend(e.ui,{version:"1.9.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(t,n){return typeof t=="number"?this.each(function(){var r=this;setTimeout(function(){e(r).focus(),n&&n.call(r)},t)}):this._focus.apply(this,arguments)},scrollParent:function(){var t;return e.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?t=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):t=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length){var r=e(this[0]),i,s;while(r.length&&r[0]!==document){i=r.css("position");if(i==="absolute"||i==="relative"||i==="fixed"){s=parseInt(r.css("zIndex"),10);if(!isNaN(s)&&s!==0)return s}r=r.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++n)})},removeUniqueId:function(){return this.each(function(){r.test(this.id)&&e(this).removeAttr("id")})}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function u(t,n,r,s){return e.each(i,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var i=r==="Width"?["Left","Right"]:["Top","Bottom"],s=r.toLowerCase(),o={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?o["inner"+r].call(this):this.each(function(){e(this).css(s,u(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return typeof t!="number"?o["outer"+r].call(this,t):this.each(function(){e(this).css(s,u(this,t,!0,n)+"px")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),r=isNaN(n);return(r||n>=0)&&i(t,!r)}}),e(function(){var t=document.body,n=t.appendChild(n=document.createElement("div"));n.offsetHeight,e.extend(n.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=n.offsetHeight===100,e.support.selectstart="onselectstart"in n,t.removeChild(n).style.display="none"}),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(!i||!e.element[0].parentNode||e.element[0].parentNode.nodeType===11)return;for(r=0;r<i.length;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},contains:e.contains,hasScroll:function(t,n){if(e(t).css("overflow")==="hidden")return!1;var r=n&&n==="left"?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)},isOverAxis:function(e,t,n){return e>t&&e<t+n},isOver:function(t,n,r,i,s,o){return e.ui.isOverAxis(t,r,s)&&e.ui.isOverAxis(n,i,o)}})})(jQuery),function(e,t){var n=0,r=Array.prototype.slice,i=e.cleanData;e.cleanData=function(t){for(var n=0,r;(r=t[n])!=null;n++)try{e(r).triggerHandler("remove")}catch(s){}i(t)},e.widget=function(t,n,r){var i,s,o,u,a=t.split(".")[0];t=t.split(".")[1],i=a+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[a]=e[a]||{},s=e[a][t],o=e[a][t]=function(e,t){if(!this._createWidget)return new o(e,t);arguments.length&&this._createWidget(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,i){e.isFunction(i)&&(r[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t=this._super,n=this._superApply,s;return this._super=e,this._superApply=r,s=i.apply(this,arguments),this._super=t,this._superApply=n,s}}())}),o.prototype=e.widget.extend(u,{widgetEventPrefix:t},r,{constructor:o,namespace:a,widgetName:t,widgetBaseClass:i,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){var i=r.call(arguments,1),s=0,o=i.length,u,a;for(;s<o;s++)for(u in i[s])a=i[s][u],i[s].hasOwnProperty(u)&&a!==t&&(n[u]=e.isPlainObject(a)?e.widget.extend({},n[u],a):a);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName;e.fn[n]=function(o){var u=typeof o=="string",a=r.call(arguments,1),f=this;return o=!u&&a.length?e.widget.extend.apply(null,[o].concat(a)):o,u?this.each(function(){var r,i=e.data(this,s);if(!i)return e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'");if(!e.isFunction(i[o])||o.charAt(0)==="_")return e.error("no such method '"+o+"' for "+n+" widget instance");r=i[o].apply(i,a);if(r!==i&&r!==t)return f=r&&r.jquery?f.pushStack(r.get()):r,!1}):this.each(function(){var t=e.data(this,s);t?t.option(o||{})._init():new i(o,this)}),f}},e.Widget=function(e,t){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetName,this),e.data(r,this.widgetFullName,this),this._on({remove:"destroy"}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i=n,s,o,u;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof n=="string"){i={},s=n.split("."),n=s.shift();if(s.length){o=i[n]=e.widget.extend({},this.options[n]);for(u=0;u<s.length-1;u++)o[s[u]]=o[s[u]]||{},o=o[s[u]];n=s.pop();if(r===t)return o[n]===t?null:o[n];o[n]=r}else{if(r===t)return this.options[n]===t?null:this.options[n];i[n]=r}}return this._setOptions(i),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,e==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n){n?(t=e(t),this.bindings=this.bindings.add(t)):(n=t,t=this.element);var r=this;e.each(n,function(n,i){function s(){if(r.options.disabled===!0||e(this).hasClass("ui-state-disabled"))return;return(typeof i=="string"?r[i]:i).apply(r,arguments)}typeof i!="string"&&(s.guid=i.guid=i.guid||s.guid||e.guid++);var o=n.match(/^(\w+)\s*(.*)$/),u=o[1]+r.eventNamespace,a=o[2];a?r.widget().delegate(a,u,s):t.bind(u,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return(typeof e=="string"?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent;if(s)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){typeof i=="string"&&(i={effect:i});var o,u=i?i===!0||typeof i=="number"?n:i.effect||n:t;i=i||{},typeof i=="number"&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&(e.effects.effect[u]||e.uiBackCompat!==!1&&e.effects[u])?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}}),e.uiBackCompat!==!1&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})}(jQuery),function(e,t){var n=!1;e(document).mouseup(function(e){n=!1}),e.widget("ui.mouse",{version:"1.9.0",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(n)return;this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var r=this,i=t.which===1,s=typeof this.options.cancel=="string"&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;if(!i||s||!this._mouseCapture(t))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)){this._mouseStarted=this._mouseStart(t)!==!1;if(!this._mouseStarted)return t.preventDefault(),!0}return!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),n=!0,!0},_mouseMove:function(t){return!e.browser.msie||document.documentMode>=9||!!t.button?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(e){return this.mouseDelayMet},_mouseStart:function(e){},_mouseDrag:function(e){},_mouseStop:function(e){},_mouseCapture:function(e){return!0}})}(jQuery),function(e,t){function h(e,t,n){return[parseInt(e[0],10)*(l.test(e[0])?t/100:1),parseInt(e[1],10)*(l.test(e[1])?n/100:1)]}function p(t,n){return parseInt(e.css(t,n),10)||0}e.ui=e.ui||{};var n,r=Math.max,i=Math.abs,s=Math.round,o=/left|center|right/,u=/top|center|bottom/,a=/[\+\-]\d+%?/,f=/^\w+/,l=/%$/,c=e.fn.position;e.position={scrollbarWidth:function(){if(n!==t)return n;var r,i,s=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return e("body").append(s),r=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,r===i&&(i=s[0].clientWidth),s.remove(),n=r-i},getScrollInfo:function(t){var n=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),i=n==="scroll"||n==="auto"&&t.width<t.element[0].scrollWidth,s=r==="scroll"||r==="auto"&&t.height<t.element[0].scrollHeight;return{width:i?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var n=e(t||window),r=e.isWindow(n[0]);return{element:n,isWindow:r,offset:n.offset()||{left:0,top:0},scrollLeft:n.scrollLeft(),scrollTop:n.scrollTop(),width:r?n.width():n.outerWidth(),height:r?n.height():n.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);t=e.extend({},t);var n,l,d,v,m,g=e(t.of),y=e.position.getWithinInfo(t.within),b=e.position.getScrollInfo(y),w=g[0],E=(t.collision||"flip").split(" "),S={};return w.nodeType===9?(l=g.width(),d=g.height(),v={top:0,left:0}):e.isWindow(w)?(l=g.width(),d=g.height(),v={top:g.scrollTop(),left:g.scrollLeft()}):w.preventDefault?(t.at="left top",l=d=0,v={top:w.pageY,left:w.pageX}):(l=g.outerWidth(),d=g.outerHeight(),v=g.offset()),m=e.extend({},v),e.each(["my","at"],function(){var e=(t[this]||"").split(" "),n,r;e.length===1&&(e=o.test(e[0])?e.concat(["center"]):u.test(e[0])?["center"].concat(e):["center","center"]),e[0]=o.test(e[0])?e[0]:"center",e[1]=u.test(e[1])?e[1]:"center",n=a.exec(e[0]),r=a.exec(e[1]),S[this]=[n?n[0]:0,r?r[0]:0],t[this]=[f.exec(e[0])[0],f.exec(e[1])[0]]}),E.length===1&&(E[1]=E[0]),t.at[0]==="right"?m.left+=l:t.at[0]==="center"&&(m.left+=l/2),t.at[1]==="bottom"?m.top+=d:t.at[1]==="center"&&(m.top+=d/2),n=h(S.at,l,d),m.left+=n[0],m.top+=n[1],this.each(function(){var o,u,a=e(this),f=a.outerWidth(),c=a.outerHeight(),w=p(this,"marginLeft"),x=p(this,"marginTop"),T=f+w+p(this,"marginRight")+b.width,N=c+x+p(this,"marginBottom")+b.height,C=e.extend({},m),k=h(S.my,a.outerWidth(),a.outerHeight());t.my[0]==="right"?C.left-=f:t.my[0]==="center"&&(C.left-=f/2),t.my[1]==="bottom"?C.top-=c:t.my[1]==="center"&&(C.top-=c/2),C.left+=k[0],C.top+=k[1],e.support.offsetFractions||(C.left=s(C.left),C.top=s(C.top)),o={marginLeft:w,marginTop:x},e.each(["left","top"],function(r,i){e.ui.position[E[r]]&&e.ui.position[E[r]][i](C,{targetWidth:l,targetHeight:d,elemWidth:f,elemHeight:c,collisionPosition:o,collisionWidth:T,collisionHeight:N,offset:[n[0]+k[0],n[1]+k[1]],my:t.my,at:t.at,within:y,elem:a})}),e.fn.bgiframe&&a.bgiframe(),t.using&&(u=function(e){var n=v.left-C.left,s=n+l-f,o=v.top-C.top,u=o+d-c,h={target:{element:g,left:v.left,top:v.top,width:l,height:d},element:{element:a,left:C.left,top:C.top,width:f,height:c},horizontal:s<0?"left":n>0?"right":"center",vertical:u<0?"top":o>0?"bottom":"middle"};l<f&&i(n+s)<l&&(h.horizontal="center"),d<c&&i(o+u)<d&&(h.vertical="middle"),r(i(n),i(s))>r(i(o),i(u))?h.important="horizontal":h.important="vertical",t.using.call(this,e,h)}),a.offset(e.extend(C,{using:u}))})},e.ui.position={fit:{left:function(e,t){var n=t.within,i=n.isWindow?n.scrollLeft:n.offset.left,s=n.width,o=e.left-t.collisionPosition.marginLeft,u=i-o,a=o+t.collisionWidth-s-i,f;t.collisionWidth>s?u>0&&a<=0?(f=e.left+u+t.collisionWidth-s-i,e.left+=u-f):a>0&&u<=0?e.left=i:u>a?e.left=i+s-t.collisionWidth:e.left=i:u>0?e.left+=u:a>0?e.left-=a:e.left=r(e.left-o,e.left)},top:function(e,t){var n=t.within,i=n.isWindow?n.scrollTop:n.offset.top,s=t.within.height,o=e.top-t.collisionPosition.marginTop,u=i-o,a=o+t.collisionHeight-s-i,f;t.collisionHeight>s?u>0&&a<=0?(f=e.top+u+t.collisionHeight-s-i,e.top+=u-f):a>0&&u<=0?e.top=i:u>a?e.top=i+s-t.collisionHeight:e.top=i:u>0?e.top+=u:a>0?e.top-=a:e.top=r(e.top-o,e.top)}},flip:{left:function(e,t){var n=t.within,r=n.offset.left+n.scrollLeft,s=n.width,o=n.isWindow?n.scrollLeft:n.offset.left,u=e.left-t.collisionPosition.marginLeft,a=u-o,f=u+t.collisionWidth-s-o,l=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,c=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,h=-2*t.offset[0],p,d;if(a<0){p=e.left+l+c+h+t.collisionWidth-s-r;if(p<0||p<i(a))e.left+=l+c+h}else if(f>0){d=e.left-t.collisionPosition.marginLeft+l+c+h-o;if(d>0||i(d)<f)e.left+=l+c+h}},top:function(e,t){var n=t.within,r=n.offset.top+n.scrollTop,s=n.height,o=n.isWindow?n.scrollTop:n.offset.top,u=e.top-t.collisionPosition.marginTop,a=u-o,f=u+t.collisionHeight-s-o,l=t.my[1]==="top",c=l?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,h=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,p=-2*t.offset[1],d,v;a<0?(v=e.top+c+h+p+t.collisionHeight-s-r,e.top+c+h+p>a&&(v<0||v<i(a))&&(e.top+=c+h+p)):f>0&&(d=e.top-t.collisionPosition.marginTop+c+h+p-o,e.top+c+h+p>f&&(d>0||i(d)<f)&&(e.top+=c+h+p))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,n,r,i,s,o=document.getElementsByTagName("body")[0],u=document.createElement("div");t=document.createElement(o?"div":"body"),r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(s in r)t.style[s]=r[s];t.appendChild(u),n=o||document.documentElement,n.insertBefore(t,n.firstChild),u.style.cssText="position: absolute; left: 10.7432222px;",i=e(u).offset().left,e.support.offsetFractions=i>10&&i<11,t.innerHTML="",n.removeChild(t)}(),e.uiBackCompat!==!1&&function(e){var n=e.fn.position;e.fn.position=function(r){if(!r||!r.offset)return n.call(this,r);var i=r.offset.split(" "),s=r.at.split(" ");return i.length===1&&(i[1]=i[0]),/^\d/.test(i[0])&&(i[0]="+"+i[0]),/^\d/.test(i[1])&&(i[1]="+"+i[1]),s.length===1&&(/left|center|right/.test(s[0])?s[1]="center":(s[1]=s[0],s[0]="center")),n.call(this,e.extend(r,{at:s[0]+i[0]+" "+s[1]+i[1],offset:t}))}}(jQuery)}(jQuery),function(e,t){e.widget("ui.draggable",e.ui.mouse,{version:"1.9.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),n.containment&&this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute");if(!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";return e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1);var r=this.element[0],i=!1;while(r&&(r=r.parentNode))r==document&&(i=!0);if(!i&&this.options.helper==="original")return!1;if(this.options.revert=="invalid"&&!n||this.options.revert=="valid"&&n||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)){var s=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){s._trigger("stop",t)!==!1&&s._clear()})}else this._trigger("stop",t)!==!1&&this._clear();return!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){var n=!this.options.handle||!e(this.options.handle,this.element).length?!0:!1;return e(this.options.handle,this.element).find("*").andSelf().each(function(){this==t.target&&(n=!0)}),n},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):n.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo(n.appendTo=="parent"?this.element[0].parentNode:n.appendTo),r[0]!=this.element[0]&&!/(fixed|absolute)/.test(r.css("position"))&&r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.browser.msie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;t.containment=="parent"&&(t.containment=this.helper[0].parentNode);if(t.containment=="document"||t.containment=="window")this.containment=[t.containment=="document"?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t.containment=="document"?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(t.containment=="document"?0:e(window).scrollLeft())+e(t.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(t.containment=="document"?0:e(window).scrollTop())+(e(t.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(t.containment)&&t.containment.constructor!=Array){var n=e(t.containment),r=n[0];if(!r)return;var i=n.offset(),s=e(r).css("overflow")!="hidden";this.containment=[(parseInt(e(r).css("borderLeftWidth"),10)||0)+(parseInt(e(r).css("paddingLeft"),10)||0),(parseInt(e(r).css("borderTopWidth"),10)||0)+(parseInt(e(r).css("paddingTop"),10)||0),(s?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(e(r).css("borderLeftWidth"),10)||0)-(parseInt(e(r).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(s?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(e(r).css("borderTopWidth"),10)||0)-(parseInt(e(r).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n}else t.containment.constructor==Array&&(this.containment=t.containment)},_convertPositionTo:function(t,n){n||(n=this.position);var r=t=="absolute"?1:-1,i=this.options,s=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(s[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():o?0:s.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():o?0:s.scrollLeft())*r}},_generatePosition:function(t){var n=this.options,r=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(r[0].tagName),s=t.pageX,o=t.pageY;if(this.originalPosition){var u;if(this.containment){if(this.relative_container){var a=this.relative_container.offset();u=[this.containment[0]+a.left,this.containment[1]+a.top,this.containment[2]+a.left,this.containment[3]+a.top]}else u=this.containment;t.pageX-this.offset.click.left<u[0]&&(s=u[0]+this.offset.click.left),t.pageY-this.offset.click.top<u[1]&&(o=u[1]+this.offset.click.top),t.pageX-this.offset.click.left>u[2]&&(s=u[2]+this.offset.click.left),t.pageY-this.offset.click.top>u[3]&&(o=u[3]+this.offset.click.top)}if(n.grid){var f=n.grid[1]?this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1]:this.originalPageY;o=u?f-this.offset.click.top<u[1]||f-this.offset.click.top>u[3]?f-this.offset.click.top<u[1]?f+n.grid[1]:f-n.grid[1]:f:f;var l=n.grid[0]?this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0]:this.originalPageX;s=u?l-this.offset.click.left<u[0]||l-this.offset.click.left>u[2]?l-this.offset.click.left<u[0]?l+n.grid[0]:l-n.grid[0]:l:l}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():i?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:r.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r]),t=="drag"&&(this.positionAbs=this._convertPositionTo
("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(e){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var r=e(this).data("draggable"),i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e.data(this,"sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n){var r=e(this).data("draggable"),i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,r.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n){var r=e(this).data("draggable"),i=this,s=function(t){var n=this.offset.click.top,r=this.offset.click.left,i=this.positionAbs.top,s=this.positionAbs.left,o=t.height,u=t.width,a=t.top,f=t.left;return e.ui.isOver(i+n,s+r,a,f,o,u)};e.each(r.sortables,function(s){this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n){var r=e("body"),i=e(this).data("draggable").options;r.css("cursor")&&(i._cursor=r.css("cursor")),r.css("cursor",i.cursor)},stop:function(t,n){var r=e(this).data("draggable").options;r._cursor&&e("body").css("cursor",r._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var r=e(n.helper),i=e(this).data("draggable").options;r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(t,n){var r=e(this).data("draggable").options;r._opacity&&e(n.helper).css("opacity",r._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(t,n){var r=e(this).data("draggable");r.scrollParent[0]!=document&&r.scrollParent[0].tagName!="HTML"&&(r.overflowOffset=r.scrollParent.offset())},drag:function(t,n){var r=e(this).data("draggable"),i=r.options,s=!1;if(r.scrollParent[0]!=document&&r.scrollParent[0].tagName!="HTML"){if(!i.axis||i.axis!="x")r.overflowOffset.top+r.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-r.overflowOffset.top<i.scrollSensitivity&&(r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop-i.scrollSpeed);if(!i.axis||i.axis!="y")r.overflowOffset.left+r.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-r.overflowOffset.left<i.scrollSensitivity&&(r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft-i.scrollSpeed)}else{if(!i.axis||i.axis!="x")t.pageY-e(document).scrollTop()<i.scrollSensitivity?s=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(s=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed));if(!i.axis||i.axis!="y")t.pageX-e(document).scrollLeft()<i.scrollSensitivity?s=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(s=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed))}s!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(r,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n){var r=e(this).data("draggable"),i=r.options;r.snapElements=[],e(i.snap.constructor!=String?i.snap.items||":data(draggable)":i.snap).each(function(){var t=e(this),n=t.offset();this!=r.element[0]&&r.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n){var r=e(this).data("draggable"),i=r.options,s=i.snapTolerance,o=n.offset.left,u=o+r.helperProportions.width,a=n.offset.top,f=a+r.helperProportions.height;for(var l=r.snapElements.length-1;l>=0;l--){var c=r.snapElements[l].left,h=c+r.snapElements[l].width,p=r.snapElements[l].top,d=p+r.snapElements[l].height;if(!(c-s<o&&o<h+s&&p-s<a&&a<d+s||c-s<o&&o<h+s&&p-s<f&&f<d+s||c-s<u&&u<h+s&&p-s<a&&a<d+s||c-s<u&&u<h+s&&p-s<f&&f<d+s)){r.snapElements[l].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[l].item})),r.snapElements[l].snapping=!1;continue}if(i.snapMode!="inner"){var v=Math.abs(p-f)<=s,m=Math.abs(d-a)<=s,g=Math.abs(c-u)<=s,y=Math.abs(h-o)<=s;v&&(n.position.top=r._convertPositionTo("relative",{top:p-r.helperProportions.height,left:0}).top-r.margins.top),m&&(n.position.top=r._convertPositionTo("relative",{top:d,left:0}).top-r.margins.top),g&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c-r.helperProportions.width}).left-r.margins.left),y&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h}).left-r.margins.left)}var b=v||m||g||y;if(i.snapMode!="outer"){var v=Math.abs(p-a)<=s,m=Math.abs(d-f)<=s,g=Math.abs(c-o)<=s,y=Math.abs(h-u)<=s;v&&(n.position.top=r._convertPositionTo("relative",{top:p,left:0}).top-r.margins.top),m&&(n.position.top=r._convertPositionTo("relative",{top:d-r.helperProportions.height,left:0}).top-r.margins.top),g&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c}).left-r.margins.left),y&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h-r.helperProportions.width}).left-r.margins.left)}!r.snapElements[l].snapping&&(v||m||g||y||b)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[l].item})),r.snapElements[l].snapping=v||m||g||y||b}}}),e.ui.plugin.add("draggable","stack",{start:function(t,n){var r=e(this).data("draggable").options,i=e.makeArray(e(r.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});if(!i.length)return;var s=parseInt(i[0].style.zIndex)||0;e(i).each(function(e){this.style.zIndex=s+e}),this[0].style.zIndex=s+i.length}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var r=e(n.helper),i=e(this).data("draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(t,n){var r=e(this).data("draggable").options;r._zIndex&&e(n.helper).css("zIndex",r._zIndex)}})}(jQuery),function(e,t){e.widget("ui.droppable",{version:"1.9.0",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var t=this.options,n=t.accept;this.isover=0,this.isout=1,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[t.scope]=e.ui.ddmanager.droppables[t.scope]||[],e.ui.ddmanager.droppables[t.scope].push(this),t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];for(var n=0;n<t.length;n++)t[n]==this&&t.splice(n,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){t=="accept"&&(this.accept=e.isFunction(n)?n:function(e){return e.is(n)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]==this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;if(!n||(n.currentItem||n.element)[0]==this.element[0])return;this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var r=n||e.ui.ddmanager.current;if(!r||(r.currentItem||r.element)[0]==this.element[0])return!1;var i=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var t=e.data(this,"droppable");if(t.options.greedy&&!t.options.disabled&&t.options.scope==r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance))return i=!0,!1}),i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(t,n,r){if(!n.offset)return!1;var i=(t.positionAbs||t.position.absolute).left,s=i+t.helperProportions.width,o=(t.positionAbs||t.position.absolute).top,u=o+t.helperProportions.height,a=n.offset.left,f=a+n.proportions.width,l=n.offset.top,c=l+n.proportions.height;switch(r){case"fit":return a<=i&&s<=f&&l<=o&&u<=c;case"intersect":return a<i+t.helperProportions.width/2&&s-t.helperProportions.width/2<f&&l<o+t.helperProportions.height/2&&u-t.helperProportions.height/2<c;case"pointer":var h=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,p=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,d=e.ui.isOver(p,h,l,a,n.proportions.height,n.proportions.width);return d;case"touch":return(o>=l&&o<=c||u>=l&&u<=c||o<l&&u>c)&&(i>=a&&i<=f||s>=a&&s<=f||i<a&&s>f);default:return!1}},e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var r=e.ui.ddmanager.droppables[t.options.scope]||[],i=n?n.type:null,s=(t.currentItem||t.element).find(":data(droppable)").andSelf();e:for(var o=0;o<r.length;o++){if(r[o].options.disabled||t&&!r[o].accept.call(r[o].element[0],t.currentItem||t.element))continue;for(var u=0;u<s.length;u++)if(s[u]==r[o].element[0]){r[o].proportions.height=0;continue e}r[o].visible=r[o].element.css("display")!="none";if(!r[o].visible)continue;i=="mousedown"&&r[o]._activate.call(r[o],n),r[o].offset=r[o].element.offset(),r[o].proportions={width:r[o].element[0].offsetWidth,height:r[o].element[0].offsetHeight}}},drop:function(t,n){var r=!1;return e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options)return;!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=this._drop.call(this,n)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,n))}),r},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible)return;var r=e.ui.intersect(t,this,this.options.tolerance),i=!r&&this.isover==1?"isout":r&&this.isover==0?"isover":null;if(!i)return;var s;if(this.options.greedy){var o=this.options.scope,u=this.element.parents(":data(droppable)").filter(function(){return e.data(this,"droppable").options.scope===o});u.length&&(s=e.data(u[0],"droppable"),s.greedyChild=i=="isover"?1:0)}s&&i=="isover"&&(s.isover=0,s.isout=1,s._out.call(s,n)),this[i]=1,this[i=="isout"?"isover":"isout"]=0,this[i=="isover"?"_over":"_out"].call(this,n),s&&i=="isout"&&(s.isout=0,s.isover=1,s._over.call(s,n))})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}}(jQuery),function(e,t){e.widget("ui.resizable",e.ui.mouse,{version:"1.9.0",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3},_create:function(){var t=this,n=this.options;this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!n.aspectRatio,aspectRatio:n.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:n.helper||n.ghost||n.animate?n.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=n.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){this.handles=="all"&&(this.handles="n,e,s,w,se,sw,ne,nw");var r=this.handles.split(",");this.handles={};for(var i=0;i<r.length;i++){var s=e.trim(r[i]),o="ui-resizable-"+s,u=e('<div class="ui-resizable-handle '+o+'"></div>');u.css({zIndex:n.zIndex}),"se"==s&&u.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(u)}}this._renderAxis=function(t){t=t||this.element;for(var n in this.handles){this.handles[n].constructor==String&&(this.handles[n]=e(this.handles[n],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var r=e(this.handles[n],this.element),i=0;i=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth();var s=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");t.css(s,i),this._proportionallyResize()}if(!e(this.handles[n]).length)continue}},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!t.resizing){if(this.className)var e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);t.axis=e&&e[1]?e[1]:"se"}}),n.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(n.disabled)return;e(this).removeClass("ui-resizable-autohide"),t._handles.show()}).mouseleave(function(){if(n.disabled)return;t.resizing||(e(this).addClass("ui-resizable-autohide"),t._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){t(this.element);var n=this.element;n.after(this.originalElement.css({position:n.css("position"),width:n.outerWidth(),height:n.outerHeight(),top:n.css("top"),left:n.css("left")})).remove()}return this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_mouseCapture:function(t){var n=!1;for(var r in this.handles)e(this.handles[r])[0]==t.target&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(t){var r=this.options,i=this.element.position(),s=this.element;this.resizing=!0,this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()},(s.is(".ui-draggable")||/absolute/.test(s.css("position")))&&s.css({position:"absolute",top:i.top,left:i.left}),this._renderProxy();var o=n(this.helper.css("left")),u=n(this.helper.css("top"));r.containment&&(o+=e(r.containment).scrollLeft()||0,u+=e(r.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:o,top:u},this.size=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalSize=this._helper?{width:s.outerWidth(),height:s.outerHeight()}:{width:s.width(),height:s.height()},this.originalPosition={left:o,top:u},this.sizeDiff={width:s.outerWidth()-s.width(),height:s.outerHeight()-s.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio=typeof r.aspectRatio=="number"?r.aspectRatio:this.originalSize.width/this.originalSize.height||1;var a=e(".ui-resizable-"+this.axis).css("cursor");return e("body").css("cursor",a=="auto"?this.axis+"-resize":a),s.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(e){var t=this.helper,n=this.options,r={},i=this,s=this.originalMousePosition,o=this.axis,u=e.pageX-s.left||0,a=e.pageY-s.top||0,f=this._change[o];if(!f)return!1;var l=f.apply(this,[e,u,a]);this._updateVirtualBoundaries(e.shiftKey);if(this._aspectRatio||e.shiftKey)l=this._updateRatio(l,e);return l=this._respectSize(l,e),this._propagate("resize",e),t.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(l),this._trigger("resize",e,this.ui()),!1},_mouseStop:function(t){this.resizing=!1;var n=this.options,r=this;if(this._helper){var i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&e.ui.hasScroll(i[0],"left")?0:r.sizeDiff.height,u=s?0:r.sizeDiff.width,a={width:r.helper.width()-u,height:r.helper.height()-o},f=parseInt(r.element.css("left"),10)+(r.position.left-r.originalPosition.left)||null,l=parseInt(r.element.css("top"),10)+(r.position.top-r.originalPosition.top)||null;n.animate||this.element.css(e.extend(a,{top:l,left:f})),r.helper.height(r.size.height),r.helper.width(r.size.width),this._helper&&!n.animate&&this._proportionallyResize()}return e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t=this.options,n,i,s,o,u;u={minWidth:r(t.minWidth)?t.minWidth:0,maxWidth:r(t.maxWidth)?t.maxWidth:Infinity,minHeight:r(t.minHeight)?t.minHeight:0,maxHeight:r(t.maxHeight)?t.maxHeight:Infinity};if(this._aspectRatio||e)n=u.minHeight*this.aspectRatio,s=u.minWidth/this.aspectRatio,i=u.maxHeight*this.aspectRatio,o=u.maxWidth/this.aspectRatio,n>u.minWidth&&(u.minWidth=n),s>u.minHeight&&(u.minHeight=s),i<u.maxWidth&&(u.maxWidth=i),o<u.maxHeight&&(u.maxHeight=o);this._vBoundaries=u},_updateCache:function(e){var t=this.options;this.offset=this.helper.offset(),r(e.left)&&(this.position.left=e.left),r(e.top)&&(this.position.top=e.top),r(e.height)&&(this.size.height=e.height),r(e.width)&&(this.size.width=e.width)},_updateRatio:function(e,t){var n=this.options,i=this.position,s=this.size,o=this.axis;return r(e.height)?e.width=e.height*this.aspectRatio:r(e.width)&&(e.height=e.width/this.aspectRatio),o=="sw"&&(e.left=i.left+(s.width-e.width),e.top=null),o=="nw"&&(e.top=i.top+(s.height-e.height),e.left=i.left+(s.width-e.width)),e},_respectSize:function(e,t){var n=this.helper,i=this._vBoundaries,s=this._aspectRatio||t.shiftKey,o=this.axis,u=r(e.width)&&i.maxWidth&&i.maxWidth<e.width,a=r(e.height)&&i.maxHeight&&i.maxHeight<e.height,f=r(e.width)&&i.minWidth&&i.minWidth>e.width,l=r(e.height)&&i.minHeight&&i.minHeight>e.height;f&&(e.width=i.minWidth),l&&(e.height=i.minHeight),u&&(e.width=i.maxWidth),a&&(e.height=i.maxHeight);var c=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,p=/sw|nw|w/.test(o),d=/nw|ne|n/.test(o);f&&p&&(e.left=c-i.minWidth),u&&p&&(e.left=c-i.maxWidth),l&&d&&(e.top=h-i.minHeight),a&&d&&(e.top=h-i.maxHeight);var v=!e.width&&!e.height;return v&&!e.left&&e.top?e.top=null:v&&!e.top&&e.left&&(e.left=null),e},_proportionallyResize:function(){var t=this.options;if(!this._proportionallyResizeElements.length)return;var n=this.helper||this.element;for(var r=0;r<this._proportionallyResizeElements.length;r++){var i=this._proportionallyResizeElements[r];if(!this.borderDif){var s=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],o=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")];this.borderDif=e.map(s,function(e,t){var n=parseInt(e,10)||0,r=parseInt(o[t],10)||0;return n+r})}i.css({height:n.height()-this.borderDif[0]-this.borderDif[2]||0,width:n.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset();if(this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var r=e.browser.msie&&e.browser.version<7,i=r?1:0,s=r?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+s,height:this.element.outerHeight()+s,position:"absolute",left:this.elementOffset.left-i+"px",top:this.elementOffset.top-i+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(e,t,n){return{width:this.originalSize.width+t}},w:function(e,t,n){var r=this.options,i=this.originalSize,s=this.originalPosition;return{left:s.left+t,width:i.width-t}},n:function(e,t,n){var r=this.options,i=this.originalSize,s=this.originalPosition;return{top:s.top+n,height:i.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),t!="resize"&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","alsoResize",{start:function(t,n){var r=e(this).data("resizable"),i=r.options,s=function(t){e(t).each(function(){var t=e(this);t.data("resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};typeof i.alsoResize=="object"&&!i.alsoResize.parentNode?i.alsoResize.length?(i.alsoResize=i.alsoResize[0],s(i.alsoResize)):e.each(i.alsoResize,function(e){s(e)}):s(i.alsoResize)},resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},a=function(t,r){e(t).each(function(){var t=e(this),i=e(this).data("resizable-alsoresize"),s={},o=r&&r.length?r:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(i[t]||0)+(u[t]||0);n&&n>=0&&(s[t]=n||null)}),t.css(s)})};typeof i.alsoResize=="object"&&!i.alsoResize.nodeType?e.each(i.alsoResize,function(e,t){a(e,t)}):a(i.alsoResize)},stop:function(t,n){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","animate",{stop:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r._proportionallyResizeElements,o=s.length&&/textarea/i.test(s[0].nodeName),u=o&&e.ui.hasScroll(s[0],"left")?0:r.sizeDiff.height,a=o?0:r.sizeDiff.width,f={width:r.size.width-a,height:r.size.height-u},l=parseInt(r.element.css("left"),10)+(r.position.left-r.originalPosition.left)||null,c=parseInt(r.element.css("top"),10)+(r.position.top-r.originalPosition.top)||null;r.element.animate(e.extend(f,c&&l?{top:c,left:l}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var n={width:parseInt(r.element.css("width"),10),height:parseInt(r.element.css("height"),10),top:parseInt(r.element.css("top"),10),left:parseInt(r.element.css("left"),10)};s&&s.length&&e(s[0]).css({width:n.width,height:n.height}),r._updateCache(n),r._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(t,r){var i=e(this).data("resizable"),s=i.options,o=i.element,u=s.containment,a=u instanceof e?u.get(0):/parent/.test(u)?o.parent().get(0):u;if(!a)return;i.containerElement=e(a);if(/document/.test(u)||u==document)i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight};else{var f=e(a),l=[];e(["Top","Right","Left","Bottom"]).each(function(e,t){l[e]=n(f.css("padding"+t))}),i.containerOffset=f.offset(),i.containerPosition=f.position(),i.containerSize={height:f.innerHeight()-l[3],width:f.innerWidth()-l[1]};var c=i.containerOffset,h=i.containerSize.height,p=i.containerSize.width,d=e.ui.hasScroll(a,"left")?a.scrollWidth:p,v=e.ui.hasScroll(a)?a.scrollHeight:h;i.parentData={element:a,left:c.left,top:c.top,width:d,height:v}}},resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.containerSize,o=r.containerOffset,u=r.size,a=r.position,f=r._aspectRatio||t.shiftKey,l={top:0,left:0},c=r.containerElement;c[0]!=document&&/static/.test(c.css("position"))&&(l=o),a.left<(r._helper?o.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-o.left:r.position.left-l.left),f&&(r.size.height=r.size.width/r.aspectRatio),r.position.left=i.helper?o.left:0),a.top<(r._helper?o.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-o.top:r.position.top),f&&(r.size.width=r.size.height*r.aspectRatio),r.position.top=r._helper?o.top:0),r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top;var h=Math.abs((r._helper?r.offset.left-l.left:r.offset.left-l.left)+r.sizeDiff.width),p=Math.abs((r._helper?r.offset.top-l.top:r.offset.top-o.top)+r.sizeDiff.height),d=r.containerElement.get(0)==r.element.parent().get(0),v=/relative|absolute/.test(r.containerElement.css("position"));d&&v&&(h-=r.parentData.left),h+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-h,f&&(r.size.height=r.size.width/r.aspectRatio)),p+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-p,f&&(r.size.width=r.size.height*r.aspectRatio))},stop:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.position,o=r.containerOffset,u=r.containerPosition,a=r.containerElement,f=e(r.helper),l=f.offset(),c=f.outerWidth()-r.sizeDiff.width,h=f.outerHeight()-r.sizeDiff.height;r._helper&&!i.animate&&/relative/.test(a.css("position"))&&e(this).css({left:l.left-u.left-o.left,width:c,height:h}),r._helper&&!i.animate&&/static/.test(a.css("position"))&&e(this).css({left:l.left-u.left-o.left,width:c,height:h})}}),e.ui.plugin.add("resizable","ghost",{start:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.size;r.ghost=r.originalElement.clone(),r.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof i.ghost=="string"?i.ghost:""),r.ghost.appendTo(r.helper)},resize:function(t,n){var r=e(this).data("resizable"),i=r.options;r.ghost&&r.ghost.css({position:"relative",height:r.size.height,width:r.size.width})},stop:function(t,n){var r=e(this).data("resizable"),i=r.options;r.ghost&&r.helper&&r.helper.get(0).removeChild(r.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(t,n){var r=e(this).data("resizable"),i=r.options,s=r.size,o=r.originalSize,u=r.originalPosition,a=r.axis,f=i._aspectRatio||t.shiftKey;i.grid=typeof i.grid=="number"?[i.grid,i.grid]:i.grid;var l=Math.round((s.width-o.width)/(i.grid[0]||1))*(i.grid[0]||1),c=Math.round((s.height-o.height)/(i.grid[1]||1))*(i.grid[1]||1);/^(se|s|e)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c):/^(ne)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c,r.position.top=u.top-c):/^(sw)$/.test(a)?(r.size.width=o.width+l,r.size.height=o.height+c,r.position.left=u.left-l):(r.size.width=o.width+l,r.size.height=o.height+c,r.position.top=u.top-c,r.position.left=u.left-l)}});var n=function(e){return parseInt(e,10)||0},r=function(e){return!isNaN(parseInt(e,10))}}(jQuery),function(e,t){e.widget("ui.selectable",e.ui.mouse,{version:"1.9.0",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var t=this;this.element.addClass("ui-selectable"),this.dragged=!1;var n;this.refresh=function(){n=e(t.options.filter,t.element[0]),n.addClass("ui-selectee"),n.each(function(){var t=e(this),n=t.offset();e.data(this,"selectable-item",{element:this,$element:t,left:n.left,top:n.top,right:n.left+t.outerWidth(),bottom:n.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=n.addClass("ui-selectee"),this._mouseInit(),this.helper=e("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(t){var n=this;this.opos=[t.pageX,t.pageY];if(this.options.disabled)return;var r=this.options;this.selectees=e(r.filter,this.element[0]),this._trigger("start",t),e(r.appendTo).append(this.helper),this.helper.css({left:t.clientX,top:t.clientY,width:0,height:0}),r.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var r=e.data(this,"selectable-item");r.startselected=!0,!t.metaKey&&!t.ctrlKey&&(r.$element.removeClass("ui-selected"),r.selected=!1,r.$element.addClass("ui-unselecting"),r.unselecting=!0,n._trigger("unselecting",t,{unselecting:r.element}))}),e(t.target).parents().andSelf().each(function(){var r=e.data(this,"selectable-item");if(r){var i=!t.metaKey&&!t.ctrlKey||!r.$element.hasClass("ui-selected");return r.$element.removeClass(i?"ui-unselecting":"ui-selected").addClass(i?"ui-selecting":"ui-unselecting"),r.unselecting=!i,r.selecting=i,r.selected=i,i?n._trigger("selecting",t,{selecting:r.element}):n._trigger("unselecting",t,{unselecting:r.element}),!1}})},_mouseDrag:function(t){var n=
this;this.dragged=!0;if(this.options.disabled)return;var r=this.options,i=this.opos[0],s=this.opos[1],o=t.pageX,u=t.pageY;if(i>o){var a=o;o=i,i=a}if(s>u){var a=u;u=s,s=a}return this.helper.css({left:i,top:s,width:o-i,height:u-s}),this.selectees.each(function(){var a=e.data(this,"selectable-item");if(!a||a.element==n.element[0])return;var f=!1;r.tolerance=="touch"?f=!(a.left>o||a.right<i||a.top>u||a.bottom<s):r.tolerance=="fit"&&(f=a.left>i&&a.right<o&&a.top>s&&a.bottom<u),f?(a.selected&&(a.$element.removeClass("ui-selected"),a.selected=!1),a.unselecting&&(a.$element.removeClass("ui-unselecting"),a.unselecting=!1),a.selecting||(a.$element.addClass("ui-selecting"),a.selecting=!0,n._trigger("selecting",t,{selecting:a.element}))):(a.selecting&&((t.metaKey||t.ctrlKey)&&a.startselected?(a.$element.removeClass("ui-selecting"),a.selecting=!1,a.$element.addClass("ui-selected"),a.selected=!0):(a.$element.removeClass("ui-selecting"),a.selecting=!1,a.startselected&&(a.$element.addClass("ui-unselecting"),a.unselecting=!0),n._trigger("unselecting",t,{unselecting:a.element}))),a.selected&&!t.metaKey&&!t.ctrlKey&&!a.startselected&&(a.$element.removeClass("ui-selected"),a.selected=!1,a.$element.addClass("ui-unselecting"),a.unselecting=!0,n._trigger("unselecting",t,{unselecting:a.element})))}),!1},_mouseStop:function(t){var n=this;this.dragged=!1;var r=this.options;return e(".ui-unselecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-unselecting"),r.unselecting=!1,r.startselected=!1,n._trigger("unselected",t,{unselected:r.element})}),e(".ui-selecting",this.element[0]).each(function(){var r=e.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected"),r.selecting=!1,r.selected=!0,r.startselected=!0,n._trigger("selected",t,{selected:r.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function(e,t){e.widget("ui.sortable",e.ui.mouse,{version:"1.9.0",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?e.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,n){t==="disabled"?(this.options[t]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,n){var r=this;if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(t);var i=null,s=e(t.target).parents().each(function(){if(e.data(this,r.widgetName+"-item")==r)return i=e(this),!1});e.data(t.target,r.widgetName+"-item")==r&&(i=e(t.target));if(!i)return!1;if(this.options.handle&&!n){var o=!1;e(this.options.handle,i).find("*").andSelf().each(function(){this==t.target&&(o=!0)});if(!o)return!1}return this.currentItem=i,this._removeCurrentsFromItems(),!0},_mouseStart:function(t,n,r){var i=this.options;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),i.containment&&this._setContainment(),i.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",i.cursor)),i.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",i.opacity)),i.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",i.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!r)for(var s=this.containers.length-1;s>=0;s--)this.containers[s]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var n=this.options,r=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<n.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+n.scrollSpeed:t.pageY-this.overflowOffset.top<n.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-n.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<n.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+n.scrollSpeed:t.pageX-this.overflowOffset.left<n.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-n.scrollSpeed)):(t.pageY-e(document).scrollTop()<n.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<n.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+n.scrollSpeed)),t.pageX-e(document).scrollLeft()<n.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<n.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+n.scrollSpeed))),r!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";for(var i=this.items.length-1;i>=0;i--){var s=this.items[i],o=s.item[0],u=this._intersectsWithPointer(s);if(!u)continue;if(s.instance!==this.currentContainer)continue;if(o!=this.currentItem[0]&&this.placeholder[u==1?"next":"prev"]()[0]!=o&&!e.contains(this.placeholder[0],o)&&(this.options.type=="semi-dynamic"?!e.contains(this.element[0],o):!0)){this.direction=u==1?"down":"up";if(this.options.tolerance!="pointer"&&!this._intersectsWithSides(s))break;this._rearrange(t,s),this._trigger("change",t,this._uiHash());break}}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(!t)return;e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t);if(this.options.revert){var r=this,i=this.placeholder.offset();this.reverting=!0,e(this.helper).animate({left:i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c=r+f>u&&r+f<a&&t+l>s&&t+l<o;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?c:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&u<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<a},_intersectsWithPointer:function(t){var n=this.options.axis==="x"||e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),r=this.options.axis==="y"||e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),i=n&&r,s=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return i?this.floating?o&&o=="right"||s=="down"?2:1:s&&(s=="down"?2:1):!1},_intersectsWithSides:function(t){var n=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),r=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?s=="right"&&r||s=="left"&&!r:i&&(i=="down"&&n||i=="up"&&!n)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return e!=0&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return e!=0&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor==String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var n=[],r=[],i=this._connectWith();if(i&&t)for(var s=i.length-1;s>=0;s--){var o=e(i[s]);for(var u=o.length-1;u>=0;u--){var a=e.data(o[u],this.widgetName);a&&a!=this&&!a.options.disabled&&r.push([e.isFunction(a.options.items)?a.options.items.call(a.element):e(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a])}}r.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var s=r.length-1;s>=0;s--)r[s][0].each(function(){n.push(this)});return e(n)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");for(var t=0;t<this.items.length;t++)for(var n=0;n<e.length;n++)e[n]==this.items[t].item[0]&&this.items.splice(t,1)},_refreshItems:function(t){this.items=[],this.containers=[this];var n=this.items,r=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],i=this._connectWith();if(i&&this.ready)for(var s=i.length-1;s>=0;s--){var o=e(i[s]);for(var u=o.length-1;u>=0;u--){var a=e.data(o[u],this.widgetName);a&&a!=this&&!a.options.disabled&&(r.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],t,{item:this.currentItem}):e(a.options.items,a.element),a]),this.containers.push(a))}}for(var s=r.length-1;s>=0;s--){var f=r[s][1],l=r[s][0];for(var u=0,c=l.length;u<c;u++){var h=e(l[u]);h.data(this.widgetName+"-item",f),n.push({item:h,instance:f,width:0,height:0,left:0,top:0})}}},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var n=this.items.length-1;n>=0;n--){var r=this.items[n];if(r.instance!=this.currentContainer&&this.currentContainer&&r.item[0]!=this.currentItem[0])continue;var i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item;t||(r.width=i.outerWidth(),r.height=i.outerHeight());var s=i.offset();r.left=s.left,r.top=s.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var n=this.containers.length-1;n>=0;n--){var s=this.containers[n].element.offset();this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight()}return this},_createPlaceholder:function(t){t=t||this;var n=t.options;if(!n.placeholder||n.placeholder.constructor==String){var r=n.placeholder;n.placeholder={element:function(){var n=e(document.createElement(t.currentItem[0].nodeName)).addClass(r||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return r||(n.style.visibility="hidden"),n},update:function(e,i){if(r&&!n.forcePlaceholderSize)return;i.height()||i.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10))}}}t.placeholder=e(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var n=null,r=null;for(var i=this.containers.length-1;i>=0;i--){if(e.contains(this.currentItem[0],this.containers[i].element[0]))continue;if(this._intersectsWith(this.containers[i].containerCache)){if(n&&e.contains(this.containers[i].element[0],n.element[0]))continue;n=this.containers[i],r=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0)}if(!n)return;if(this.containers.length===1)this.containers[r]._trigger("over",t,this._uiHash(this)),this.containers[r].containerCache.over=1;else if(this.currentContainer!=this.containers[r]){var s=1e4,o=null,u=this.positionAbs[this.containers[r].floating?"left":"top"];for(var a=this.items.length-1;a>=0;a--){if(!e.contains(this.containers[r].element[0],this.items[a].item[0]))continue;var f=this.containers[r].floating?this.items[a].item.offset().left:this.items[a].item.offset().top;Math.abs(f-u)<s&&(s=Math.abs(f-u),o=this.items[a],this.direction=f-u>0?"down":"up")}if(!o&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[r],o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[r].element,!0),this._trigger("change",t,this._uiHash()),this.containers[r]._trigger("change",t,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[r]._trigger("over",t,this._uiHash(this)),this.containers[r].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):n.helper=="clone"?this.currentItem.clone():this.currentItem;return r.parents("body").length||e(n.appendTo!="parent"?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(r[0].style.width==""||n.forceHelperSize)&&r.width(this.currentItem.width()),(r[0].style.height==""||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.browser.msie)t={top:0,left:0};return{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t=this.options;t.containment=="parent"&&(t.containment=this.helper[0].parentNode);if(t.containment=="document"||t.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(t.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e(t.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(t.containment)){var n=e(t.containment)[0],r=e(t.containment).offset(),i=e(n).css("overflow")!="hidden";this.containment=[r.left+(parseInt(e(n).css("borderLeftWidth"),10)||0)+(parseInt(e(n).css("paddingLeft"),10)||0)-this.margins.left,r.top+(parseInt(e(n).css("borderTopWidth"),10)||0)+(parseInt(e(n).css("paddingTop"),10)||0)-this.margins.top,r.left+(i?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(e(n).css("borderLeftWidth"),10)||0)-(parseInt(e(n).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,r.top+(i?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(e(n).css("borderTopWidth"),10)||0)-(parseInt(e(n).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(t,n){n||(n=this.position);var r=t=="absolute"?1:-1,i=this.options,s=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(s[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():o?0:s.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():o?0:s.scrollLeft())*r}},_generatePosition:function(t){var n=this.options,r=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(r[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var s=t.pageX,o=t.pageY;if(this.originalPosition){this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top));if(n.grid){var u=this.originalPageY+Math.round((o-this.originalPageY)/n.grid[1])*n.grid[1];o=this.containment?u-this.offset.click.top<this.containment[1]||u-this.offset.click.top>this.containment[3]?u-this.offset.click.top<this.containment[1]?u+n.grid[1]:u-n.grid[1]:u:u;var a=this.originalPageX+Math.round((s-this.originalPageX)/n.grid[0])*n.grid[0];s=this.containment?a-this.offset.click.left<this.containment[0]||a-this.offset.click.left>this.containment[2]?a-this.offset.click.left<this.containment[0]?a+n.grid[0]:a-n.grid[0]:a:a}}return{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():i?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:r.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i==this.counter&&this.refreshPositions(!r)})},_clear:function(t,n){this.reverting=!1;var r=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var i in this._storedCSS)if(this._storedCSS[i]=="auto"||this._storedCSS[i]=="static")this._storedCSS[i]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!n&&r.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!n&&r.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(n||(r.push(function(e){this._trigger("remove",e,this._uiHash())}),r.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))));for(var i=this.containers.length-1;i>=0;i--)n||r.push(function(e){return function(t){e._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(r.push(function(e){return function(t){e._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!n){this._trigger("beforeStop",t,this._uiHash());for(var i=0;i<r.length;i++)r[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}n||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!n){for(var i=0;i<r.length;i++)r[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),function(e,t){var n=0,r={},i={};r.height=r.paddingTop=r.paddingBottom=r.borderTopWidth=r.borderBottomWidth="hide",i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="show",e.widget("ui.accordion",{version:"1.9.0",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.accordionId="ui-accordion-"+(this.element.attr("id")||++n),r=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset"),this.headers=this.element.find(r.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this._hoverable(this.headers),this._focusable(this.headers),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide(),!r.collapsible&&r.active===!1&&(r.active=0),r.active<0&&(r.active+=this.headers.length),this.active=this._findActive(r.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top"),this.active.next().addClass("ui-accordion-content-active").show(),this._createIcons(),this.originalHeight=this.element[0].style.height,this.refresh(),this.element.attr("role","tablist"),this.headers.attr("role","tab").each(function(n){var r=e(this),i=r.attr("id"),s=r.next(),o=s.attr("id");i||(i=t+"-header-"+n,r.attr("id",i)),o||(o=t+"-panel-"+n,s.attr("id",o)),r.attr("aria-controls",o),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._on(this.headers,{keydown:"_keydown"}),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._setupEvents(r.event)},_getCreateEventData:function(){return{header:this.active,content:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this.options.heightStyle!=="content"&&(this.element.css("height",this.originalHeight),e.css("height",""))},_setOption:function(e,t){if(e==="active"){this._activate(t);return}e==="event"&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),e==="collapsible"&&!t&&this.options.active===!1&&this._activate(0),e==="icons"&&(this._destroyIcons(),t&&this._createIcons()),e==="disabled"&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)},_keydown:function(t){if(t.altKey||t.ctrlKey)return;var n=e.ui.keyCode,r=this.headers.length,i=this.headers.index(t.target),s=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:s=this.headers[(i+1)%r];break;case n.LEFT:case n.UP:s=this.headers[(i-1+r)%r];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:s=this.headers[0];break;case n.END:s=this.headers[r-1]}s&&(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),s.focus(),t.preventDefault())},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t,n,r=this.options.heightStyle,i=this.element.parent();this.element.css("height",this.originalHeight),r==="fill"?(e.support.minHeight||(n=i.css("overflow"),i.css("overflow","hidden")),t=i.height(),this.element.siblings(":visible").each(function(){var n=e(this),r=n.css("position");if(r==="absolute"||r==="fixed")return;t-=n.outerHeight(!0)}),n&&i.css("overflow",n),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):r==="auto"&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).height("").height())}).height(t)),r!=="content"&&this.element.height(this.element.height())},_activate:function(t){var n=this._findActive(t)[0];if(n===this.active[0])return;n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop})},_findActive:function(t){return typeof t=="number"?this.headers.eq(t):e()},_setupEvents:function(t){var n={};if(!t)return;e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._on(this.headers,n)},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i[0]===r[0],o=s&&n.collapsible,u=o?e():i.next(),a=r.next(),f={oldHeader:r,oldPanel:a,newHeader:o?e():i,newPanel:u};t.preventDefault();if(s&&!n.collapsible||this._trigger("beforeActivate",t,f)===!1)return;n.active=o?!1:this.headers.index(i),this.active=s?e():i,this._toggle(f),r.removeClass("ui-accordion-header-active ui-state-active"),n.icons&&r.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),s||(i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),n.icons&&i.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),i.next().addClass("ui-accordion-content-active"))},_toggle:function(t){var n=t.newPanel,r=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=r,this.options.animate?this._animate(n,r,t):(r.hide(),n.show(),this._toggleComplete(t)),r.attr({"aria-expanded":"false","aria-hidden":"true"}),r.prev().attr("aria-selected","false"),n.length&&r.length?r.prev().attr("tabIndex",-1):n.length&&this.headers.filter(function(){return e(this).attr("tabIndex")===0}).attr("tabIndex",-1),n.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(e,t,n){var s,o,u,a=this,f=0,l=e.length&&(!t.length||e.index()<t.index()),c=this.options.animate||{},h=l&&c.down||c,p=function(){a._toggleComplete(n)};typeof h=="number"&&(u=h),typeof h=="string"&&(o=h),o=o||h.easing||c.easing,u=u||h.duration||c.duration;if(!t.length)return e.animate(i,u,o,p);if(!e.length)return t.animate(r,u,o,p);s=e.show().outerHeight(),t.animate(r,{duration:u,easing:o,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(i,{duration:u,easing:o,complete:p,step:function(e,n){n.now=Math.round
(e),n.prop!=="height"?f+=n.now:a.options.heightStyle!=="content"&&(n.now=Math.round(s-t.outerHeight()-f),f=0)}})},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.uiBackCompat!==!1&&(function(e,t){e.extend(t.options,{navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var n=t._create;t._create=function(){if(this.options.navigation){var t=this,r=this.element.find(this.options.header),i=r.next(),s=r.add(i).find("a").filter(this.options.navigationFilter)[0];s&&r.add(i).each(function(n){if(e.contains(this,s))return t.options.active=Math.floor(n/2),!1})}n.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options,{heightStyle:null,autoHeight:!0,clearStyle:!1,fillSpace:!1});var n=t._create,r=t._setOption;e.extend(t,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle(),n.call(this)},_setOption:function(e,t){if(e==="autoHeight"||e==="clearStyle"||e==="fillSpace")this.options.heightStyle=this._mergeHeightStyle();r.apply(this,arguments)},_mergeHeightStyle:function(){var e=this.options;if(e.fillSpace)return"fill";if(e.clearStyle)return"content";if(e.autoHeight)return"auto"}})}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var n=t._createIcons;t._createIcons=function(){this.options.icons&&(this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected),n.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){t.activate=t._activate;var n=t._findActive;t._findActive=function(e){return e===-1&&(e=!1),e&&typeof e!="number"&&(e=this.headers.index(this.headers.filter(e)),e===-1&&(e=!1)),n.call(this,e)}}(jQuery,jQuery.ui.accordion.prototype),jQuery.ui.accordion.prototype.resize=jQuery.ui.accordion.prototype.refresh,function(e,t){e.extend(t.options,{change:null,changestart:null});var n=t._trigger;t._trigger=function(e,t,r){var i=n.apply(this,arguments);return i?(e==="beforeActivate"?i=n.call(this,"changestart",t,{oldHeader:r.oldHeader,oldContent:r.oldPanel,newHeader:r.newHeader,newContent:r.newPanel}):e==="activate"&&(i=n.call(this,"change",t,{oldHeader:r.oldHeader,oldContent:r.oldPanel,newHeader:r.newHeader,newContent:r.newPanel})),i):!1}}(jQuery,jQuery.ui.accordion.prototype),function(e,t){e.extend(t.options,{animate:null,animated:"slide"});var n=t._create;t._create=function(){var e=this.options;e.animate===null&&(e.animated?e.animated==="slide"?e.animate=300:e.animated==="bounceslide"?e.animate={duration:200,down:{easing:"easeOutBounce",duration:1e3}}:e.animate=e.animated:e.animate=!1),n.call(this)}}(jQuery,jQuery.ui.accordion.prototype))}(jQuery),function(e,t){var n=0;e.widget("ui.autocomplete",{version:"1.9.0",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,n,r;this.isMultiLine=this._isMultiLine(),this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on({keydown:function(i){if(this.element.prop("readOnly")){t=!0,r=!0,n=!0;return}t=!1,r=!1,n=!1;var s=e.ui.keyCode;switch(i.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",i);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",i);break;case s.UP:t=!0,this._keyEvent("previous",i);break;case s.DOWN:t=!0,this._keyEvent("next",i);break;case s.ENTER:case s.NUMPAD_ENTER:this.menu.active&&(t=!0,i.preventDefault(),this.menu.select(i));break;case s.TAB:this.menu.active&&this.menu.select(i);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(i),i.preventDefault());break;default:n=!0,this._searchTimeout(i)}},keypress:function(r){if(t){t=!1,r.preventDefault();return}if(n)return;var i=e.ui.keyCode;switch(r.keyCode){case i.PAGE_UP:this._move("previousPage",r);break;case i.PAGE_DOWN:this._move("nextPage",r);break;case i.UP:this._keyEvent("previous",r);break;case i.DOWN:this._keyEvent("next",r)}},input:function(e){if(r){r=!1,e.preventDefault();return}this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching),this.close(e),this._change(e)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:e(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu"),this._on(this.menu.element,{mousedown:function(t){t.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var n=this.menu.element[0];e(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(r){r.target!==t.element[0]&&r.target!==n&&!e.contains(n,r.target)&&t.close()})})},menufocus:function(t,n){if(this.isNewMenu){this.isNewMenu=!1;if(t.originalEvent&&/^mouse/.test(t.originalEvent.type)){this.menu.blur(),this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});return}}var r=n.item.data("ui-autocomplete-item")||n.item.data("item.autocomplete");!1!==this._trigger("focus",t,{item:r})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(r.value):this.liveRegion.text(r.value)},menuselect:function(e,t){var n=t.item.data("ui-autocomplete-item")||t.item.data("item.autocomplete"),r=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r,this.selectedItem=n})),!1!==this._trigger("select",e,{item:n})&&this._value(n.value),this.term=this._value(),this.close(e),this.selectedItem=n}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),e.fn.bgiframe&&this.menu.element.bgiframe(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),e==="source"&&this._initSource(),e==="appendTo"&&this.menu.element.appendTo(this.document.find(t||"body")[0]),e==="disabled"&&t&&this.xhr&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var t,n,r=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(n,r){r(e.ui.autocomplete.filter(t,n.term))}):typeof this.options.source=="string"?(n=this.options.source,this.source=function(t,i){r.xhr&&r.xhr.abort(),r.xhr=e.ajax({url:n,data:t,dataType:"json",success:function(e,t){i(e)},error:function(){i([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){e=e!=null?e:this._value(),this.term=this._value();if(e.length<this.options.minLength)return this.close(t);if(this._trigger("search",t)===!1)return;return this._search(e)},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=this,t=++n;return function(r){t===n&&e.__response(r),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return typeof t=="string"?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var n=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(n,t),this.menu.refresh(),n.show(),this._resizeMenu(),n.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,n){var r=this;e.each(n,function(e,n){r._renderItemData(t,n)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,n){return e("<li>").append(e("<a>").text(n.label)).appendTo(t)},_move:function(e,t){if(!this.menu.element.is(":visible")){this.search(null,t);return}if(this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)){this._value(this.term),this.menu.blur();return}this.menu[e](t)},widget:function(){return this.menu.element},_value:function(e){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){if(!this.isMultiLine||this.menu.element.is(":visible"))this._move(e,t),t.preventDefault()}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,n){var r=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(e){return r.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var t;this._superApply(arguments);if(this.options.disabled||this.cancelSearch)return;e&&e.length?t=this.options.messages.results(e.length):t=this.options.messages.noResults,this.liveRegion.text(t)}})}(jQuery),function(e,t){var n,r,i,s,o="ui-button ui-widget ui-state-default ui-corner-all",u="ui-state-hover ui-state-active ",a="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",f=function(){var t=e(this).find(":ui-button");setTimeout(function(){t.button("refresh")},1)},l=function(t){var n=t.name,r=t.form,i=e([]);return n&&(r?i=e(r).find("[name='"+n+"']"):i=e("[name='"+n+"']",t.ownerDocument).filter(function(){return!this.form})),i};e.widget("ui.button",{version:"1.9.0",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,f),typeof this.options.disabled!="boolean"?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var t=this,u=this.options,a=this.type==="checkbox"||this.type==="radio",c="ui-state-hover"+(a?"":" ui-state-active"),h="ui-state-focus";u.label===null&&(u.label=this.type==="input"?this.buttonElement.val():this.buttonElement.html()),this.buttonElement.addClass(o).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(u.disabled)return;e(this).addClass("ui-state-hover"),this===n&&e(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){if(u.disabled)return;e(this).removeClass(c)}).bind("click"+this.eventNamespace,function(e){u.disabled&&(e.preventDefault(),e.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){t.buttonElement.addClass(h)}).bind("blur"+this.eventNamespace,function(){t.buttonElement.removeClass(h)}),a&&(this.element.bind("change"+this.eventNamespace,function(){if(s)return;t.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(e){if(u.disabled)return;s=!1,r=e.pageX,i=e.pageY}).bind("mouseup"+this.eventNamespace,function(e){if(u.disabled)return;if(r!==e.pageX||i!==e.pageY)s=!0})),this.type==="checkbox"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(u.disabled||s)return!1;e(this).toggleClass("ui-state-active"),t.buttonElement.attr("aria-pressed",t.element[0].checked)}):this.type==="radio"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(u.disabled||s)return!1;e(this).addClass("ui-state-active"),t.buttonElement.attr("aria-pressed","true");var n=t.element[0];l(n).not(n).map(function(){return e(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(u.disabled)return!1;e(this).addClass("ui-state-active"),n=this,t.document.one("mouseup",function(){n=null})}).bind("mouseup"+this.eventNamespace,function(){if(u.disabled)return!1;e(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){if(u.disabled)return!1;(t.keyCode===e.ui.keyCode.SPACE||t.keyCode===e.ui.keyCode.ENTER)&&e(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace,function(){e(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===e.ui.keyCode.SPACE&&e(this).click()})),this._setOption("disabled",u.disabled),this._resetButton()},_determineButtonType:function(){var e,t,n;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button",this.type==="checkbox"||this.type==="radio"?(e=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=e.find(t),this.buttonElement.length||(e=e.length?e.siblings():this.element.siblings(),this.buttonElement=e.filter(t),this.buttonElement.length||(this.buttonElement=e.find(t))),this.element.addClass("ui-helper-hidden-accessible"),n=this.element.is(":checked"),n&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",n)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(o+" "+u+" "+a).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(e,t){this._super(e,t);if(e==="disabled"){t?this.element.prop("disabled",!0):this.element.prop("disabled",!1);return}this._resetButton()},refresh:function(){var t=this.element.is(":disabled");t!==this.options.disabled&&this._setOption("disabled",t),this.type==="radio"?l(this.element[0]).each(function(){e(this).is(":checked")?e(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var t=this.buttonElement.removeClass(a),n=e("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(),r=this.options.icons,i=r.primary&&r.secondary,s=[];r.primary||r.secondary?(this.options.text&&s.push("ui-button-text-icon"+(i?"s":r.primary?"-primary":"-secondary")),r.primary&&t.prepend("<span class='ui-button-icon-primary ui-icon "+r.primary+"'></span>"),r.secondary&&t.append("<span class='ui-button-icon-secondary ui-icon "+r.secondary+"'></span>"),this.options.text||(s.push(i?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||t.attr("title",e.trim(n)))):s.push("ui-button-text-only"),t.addClass(s.join(" "))}}),e.widget("ui.buttonset",{version:"1.9.0",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(e,t){e==="disabled"&&this.buttons.button("option",e,t),this._super(e,t)},refresh:function(){var t=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return e(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function($,undefined){function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function bindHover(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){$(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!=-1&&$(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!=-1&&$(this).removeClass("ui-datepicker-next-hover")}).delegate(t,"mouseover",function(){$.datepicker._isDisabledDatepicker(instActive.inline?e.parent()[0]:instActive.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!=-1&&$(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!=-1&&$(this).addClass("ui-datepicker-next-hover"))})}function extendRemove(e,t){$.extend(e,t);for(var n in t)if(t[n]==null||t[n]==undefined)e[n]=t[n];return e}$.extend($.ui,{datepicker:{version:"1.9.0"}});var PROP_NAME="datepicker",dpuuid=(new Date).getTime(),instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline=nodeName=="div"||nodeName=="span";target.id||(this.uuid+=1,target.id="dp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),nodeName=="input"?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(e,t){var n=e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:n,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(e,t){var n=$(e);t.append=$([]),t.trigger=$([]);if(n.hasClass(this.markerClassName))return;this._attachments(n,t),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(e,n,r){t.settings[n]=r}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),this._autoSize(t),$.data(e,PROP_NAME,t),t.settings.disabled&&this._disableDatepicker(e)},_attachments:function(e,t){var n=this._get(t,"appendText"),r=this._get(t,"isRTL");t.append&&t.append.remove(),n&&(t.append=$('<span class="'+this._appendClass+'">'+n+"</span>"),e[r?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove();var i=this._get(t,"showOn");(i=="focus"||i=="both")&&e.focus(this._showDatepicker);if(i=="button"||i=="both"){var s=this._get(t,"buttonText"),o=this._get(t,"buttonImage");t.trigger=$(this._get(t,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:o,alt:s,title:s}):$('<button type="button"></button>').addClass(this._triggerClass).html(o==""?s:$("<img/>").attr({src:o,alt:s,title:s}))),e[r?"before":"after"](t.trigger),t.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput==e[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!=e[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(e[0])):$.datepicker._showDatepicker(e[0]),!1})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t=new Date(2009,11,20),n=this._get(e,"dateFormat");if(n.match(/[DM]/)){var r=function(e){var t=0,n=0;for(var r=0;r<e.length;r++)e[r].length>t&&(t=e[r].length,n=r);return n};t.setMonth(r(this._get(e,n.match(/MM/)?"monthNames":"monthNamesShort"))),t.setDate(r(this._get(e,n.match(/DD/)?"dayNames":"dayNamesShort"))+20-t.getDay())}e.input.attr("size",this._formatDate(e,t).length)}},_inlineDatepicker:function(e,t){var n=$(e);if(n.hasClass(this.markerClassName))return;n.addClass(this.markerClassName).append(t.dpDiv).bind("setData.datepicker",function(e,n,r){t.settings[n]=r}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),$.data(e,PROP_NAME,t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block")},_dialogDatepicker:function(e,t,n,r,i){var s=this._dialogInst;if(!s){this.uuid+=1;var o="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+o+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),s=this._dialogInst=this._newInst(this._dialogInput,!1),s.settings={},$.data(this._dialogInput[0],PROP_NAME,s)}extendRemove(s.settings,r||{}),t=t&&t.constructor==Date?this._formatDate(s,t):t,this._dialogInput.val(t),this._pos=i?i.length?i:[i.pageX,i.pageY]:null;if(!this._pos){var u=document.documentElement.clientWidth,a=document.documentElement.clientHeight,f=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[u/2-100+f,a/2-150+l]}return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),s.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,s),this},_destroyDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName))return;var r=e.nodeName.toLowerCase();$.removeData(e,PROP_NAME),r=="input"?(n.append.remove(),n.trigger.remove(),t.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(r=="div"||r=="span")&&t.removeClass(this.markerClassName).empty()},_enableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName))return;var r=e.nodeName.toLowerCase();if(r=="input")e.disabled=!1,n.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if(r=="div"||r=="span"){var i=t.children("."+this._inlineClass);i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t})},_disableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName))return;var r=e.nodeName.toLowerCase();if(r=="input")e.disabled=!0,n.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if(r=="div"||r=="span"){var i=t.children("."+this._inlineClass);i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t}),this._disabledInputs[this._disabledInputs.length]=e},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]==e)return!0;return!1},_getInst:function(e){try{return $.data(e,PROP_NAME)}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,n){var r=this._getInst(e);if(arguments.length==2&&typeof t=="string")return t=="defaults"?$.extend({},$.datepicker._defaults):r?t=="all"?$.extend({},r.settings):this._get(r,t):null;var i=t||{};typeof t=="string"&&(i={},i[t]=n);if(r){this._curInst==r&&this._hideDatepicker();var s=this._getDateDatepicker(e,!0),o=this._getMinMaxDate(r,"min"),u=this._getMinMaxDate(r,"max");extendRemove(r.settings,i),o!==null&&i.dateFormat!==undefined&&i.minDate===undefined&&(r.settings.minDate=this._formatDate(r,o)),u!==null&&i.dateFormat!==undefined&&i.maxDate===undefined&&(r.settings.maxDate=this._formatDate(r,u)),this._attachments($(e),r),this._autoSize(r),this._setDate(r,s),this._updateAlternate(r),this._updateDatepicker(r)}},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(e){var t=$.datepicker._getInst(e.target),n=!0,r=t.dpDiv.is(".ui-datepicker-rtl");t._keyEvent=!0;if($.datepicker._datepickerShowing)switch(e.keyCode){case 9:$.datepicker._hideDatepicker(),n=!1;break;case 13:var i=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",t.dpDiv);i[0]&&$.datepicker._selectDay(e.target,t.selectedMonth,t.selectedYear,i[0]);var s=$.datepicker._get(t,"onSelect");if(s){var o=$.datepicker._formatDate(t);s.apply(t.input?t.input[0]:null,[o,t])}else $.datepicker._hideDatepicker();return!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&$.datepicker._clearDate(e.target),n=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&$.datepicker._gotoToday(e.target),n=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,r?1:-1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,-7,"D"),n=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,r?-1:1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,7,"D"),n=e.ctrlKey||e.metaKey;break;default:n=!1}else e.keyCode==36&&e.ctrlKey?$.datepicker._showDatepicker(this):n=!1;n&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t=$.datepicker._getInst(e.target);if($.datepicker._get(t,"constrainInput")){var n=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),r=String.fromCharCode(e.charCode==undefined?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||r<" "||!n||n.indexOf(r)>-1}},_doKeyUp:function(e){var t=$.datepicker._getInst(e.target);if(t.input.val()!=t.lastVal)try{var n=$.datepicker.parseDate($.datepicker._get(t,"dateFormat"),t.input?t.input.val():null,$.datepicker._getFormatConfig(t));n&&($.datepicker._setDateFromField(t),$.datepicker._updateAlternate(t),$.datepicker._updateDatepicker(t))}catch(r){$.datepicker.log(r)}return!0},_showDatepicker:function(e){e=e.target||e,e.nodeName.toLowerCase()!="input"&&(e=$("input",e.parentNode)[0]);if($.datepicker._isDisabledDatepicker(e)||$.datepicker._lastInput==e)return;var t=$.datepicker._getInst(e);$.datepicker._curInst&&$.datepicker._curInst!=t&&($.datepicker._curInst.dpDiv.stop(!0,!0),t&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0]));var n=$.datepicker._get(t,"beforeShow"),r=n?n.apply(e,[e,t]):{};if(r===!1)return;extendRemove(t.settings,r),t.lastVal=null,$.datepicker._lastInput=e,$.datepicker._setDateFromField(t),$.datepicker._inDialog&&(e.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(e),$.datepicker._pos[1]+=e.offsetHeight);var i=!1;$(e).parents().each(function(){return i|=$(this).css("position")=="fixed",!i});var s={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null,t.dpDiv.empty(),t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(t),s=$.datepicker._checkOffset(t,s,i),t.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":i?"fixed":"absolute",display:"none",left:s.left+"px",top:s.top+"px"});if(!t.inline){var o=$.datepicker._get(t,"showAnim"),u=$.datepicker._get(t,"duration"),a=function(){var e=t.dpDiv.find("iframe.ui-datepicker-cover");if(!!e.length){var n=$.datepicker._getBorders(t.dpDiv);e.css({left:-n[0],top:-n[1],width:t.dpDiv.outerWidth(),height:t.dpDiv.outerHeight()})}};t.dpDiv.zIndex($(e).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&($.effects.effect[o]||$.effects[o])?t.dpDiv.show(o,$.datepicker._get(t,"showOptions"),u,a):t.dpDiv[o||"show"](o?u:null,a),(!o||!u)&&a(),t.input.is(":visible")&&!t.input.is(":disabled")&&t.input.focus(),$.datepicker._curInst=t}},_updateDatepicker:function(e){this.maxRows=4;var t=$.datepicker._getBorders(e.dpDiv);instActive=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var n=e.dpDiv.find("iframe.ui-datepicker-cover"
);!n.length||n.css({left:-t[0],top:-t[1],width:e.dpDiv.outerWidth(),height:e.dpDiv.outerHeight()}),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var r=this._getNumberOfMonths(e),i=r[1],s=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),i>1&&e.dpDiv.addClass("ui-datepicker-multi-"+i).css("width",s*i+"em"),e.dpDiv[(r[0]!=1||r[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e==$.datepicker._curInst&&$.datepicker._datepickerShowing&&e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&e.input[0]!=document.activeElement&&e.input.focus();if(e.yearshtml){var o=e.yearshtml;setTimeout(function(){o===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),o=e.yearshtml=null},0)}},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(e,t,n){var r=e.dpDiv.outerWidth(),i=e.dpDiv.outerHeight(),s=e.input?e.input.outerWidth():0,o=e.input?e.input.outerHeight():0,u=document.documentElement.clientWidth+(n?0:$(document).scrollLeft()),a=document.documentElement.clientHeight+(n?0:$(document).scrollTop());return t.left-=this._get(e,"isRTL")?r-s:0,t.left-=n&&t.left==e.input.offset().left?$(document).scrollLeft():0,t.top-=n&&t.top==e.input.offset().top+o?$(document).scrollTop():0,t.left-=Math.min(t.left,t.left+r>u&&u>r?Math.abs(t.left+r-u):0),t.top-=Math.min(t.top,t.top+i>a&&a>i?Math.abs(i+o):0),t},_findPos:function(e){var t=this._getInst(e),n=this._get(t,"isRTL");while(e&&(e.type=="hidden"||e.nodeType!=1||$.expr.filters.hidden(e)))e=e[n?"previousSibling":"nextSibling"];var r=$(e).offset();return[r.left,r.top]},_hideDatepicker:function(e){var t=this._curInst;if(!t||e&&t!=$.data(e,PROP_NAME))return;if(this._datepickerShowing){var n=this._get(t,"showAnim"),r=this._get(t,"duration"),i=function(){$.datepicker._tidyDialog(t)};$.effects&&($.effects.effect[n]||$.effects[n])?t.dpDiv.hide(n,$.datepicker._get(t,"showOptions"),r,i):t.dpDiv[n=="slideDown"?"slideUp":n=="fadeIn"?"fadeOut":"hide"](n?r:null,i),n||i(),this._datepickerShowing=!1;var s=this._get(t,"onClose");s&&s.apply(t.input?t.input[0]:null,[t.input?t.input.val():"",t]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(!$.datepicker._curInst)return;var t=$(e.target),n=$.datepicker._getInst(t[0]);(t[0].id!=$.datepicker._mainDivId&&t.parents("#"+$.datepicker._mainDivId).length==0&&!t.hasClass($.datepicker.markerClassName)&&!t.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||t.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=n)&&$.datepicker._hideDatepicker()},_adjustDate:function(e,t,n){var r=$(e),i=this._getInst(r[0]);if(this._isDisabledDatepicker(r[0]))return;this._adjustInstDate(i,t+(n=="M"?this._get(i,"showCurrentAtPos"):0),n),this._updateDatepicker(i)},_gotoToday:function(e){var t=$(e),n=this._getInst(t[0]);if(this._get(n,"gotoCurrent")&&n.currentDay)n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear;else{var r=new Date;n.selectedDay=r.getDate(),n.drawMonth=n.selectedMonth=r.getMonth(),n.drawYear=n.selectedYear=r.getFullYear()}this._notifyChange(n),this._adjustDate(t)},_selectMonthYear:function(e,t,n){var r=$(e),i=this._getInst(r[0]);i["selected"+(n=="M"?"Month":"Year")]=i["draw"+(n=="M"?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(i),this._adjustDate(r)},_selectDay:function(e,t,n,r){var i=$(e);if($(r).hasClass(this._unselectableClass)||this._isDisabledDatepicker(i[0]))return;var s=this._getInst(i[0]);s.selectedDay=s.currentDay=$("a",r).html(),s.selectedMonth=s.currentMonth=t,s.selectedYear=s.currentYear=n,this._selectDate(e,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear))},_clearDate:function(e){var t=$(e),n=this._getInst(t[0]);this._selectDate(t,"")},_selectDate:function(e,t){var n=$(e),r=this._getInst(n[0]);t=t!=null?t:this._formatDate(r),r.input&&r.input.val(t),this._updateAlternate(r);var i=this._get(r,"onSelect");i?i.apply(r.input?r.input[0]:null,[t,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],typeof r.input[0]!="object"&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t=this._get(e,"altField");if(t){var n=this._get(e,"altFormat")||this._get(e,"dateFormat"),r=this._getDate(e),i=this.formatDate(n,r,this._getFormatConfig(e));$(t).each(function(){$(this).val(i)})}},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t=new Date(e.getTime());t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/864e5)/7)+1},parseDate:function(e,t,n){if(e==null||t==null)throw"Invalid arguments";t=typeof t=="object"?t.toString():t+"";if(t=="")return null;var r=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff;r=typeof r!="string"?r:(new Date).getFullYear()%100+parseInt(r,10);var i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=-1,f=-1,l=-1,c=-1,h=!1,p=function(t){var n=y+1<e.length&&e.charAt(y+1)==t;return n&&y++,n},d=function(e){var n=p(e),r=e=="@"?14:e=="!"?20:e=="y"&&n?4:e=="o"?3:2,i=new RegExp("^\\d{1,"+r+"}"),s=t.substring(g).match(i);if(!s)throw"Missing number at position "+g;return g+=s[0].length,parseInt(s[0],10)},v=function(e,n,r){var i=$.map(p(e)?r:n,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)}),s=-1;$.each(i,function(e,n){var r=n[1];if(t.substr(g,r.length).toLowerCase()==r.toLowerCase())return s=n[0],g+=r.length,!1});if(s!=-1)return s+1;throw"Unknown name at position "+g},m=function(){if(t.charAt(g)!=e.charAt(y))throw"Unexpected literal at position "+g;g++},g=0;for(var y=0;y<e.length;y++)if(h)e.charAt(y)=="'"&&!p("'")?h=!1:m();else switch(e.charAt(y)){case"d":l=d("d");break;case"D":v("D",i,s);break;case"o":c=d("o");break;case"m":f=d("m");break;case"M":f=v("M",o,u);break;case"y":a=d("y");break;case"@":var b=new Date(d("@"));a=b.getFullYear(),f=b.getMonth()+1,l=b.getDate();break;case"!":var b=new Date((d("!")-this._ticksTo1970)/1e4);a=b.getFullYear(),f=b.getMonth()+1,l=b.getDate();break;case"'":p("'")?m():h=!0;break;default:m()}if(g<t.length){var w=t.substr(g);if(!/^\s+/.test(w))throw"Extra/unparsed characters found in date: "+w}a==-1?a=(new Date).getFullYear():a<100&&(a+=(new Date).getFullYear()-(new Date).getFullYear()%100+(a<=r?0:-100));if(c>-1){f=1,l=c;do{var E=this._getDaysInMonth(a,f-1);if(l<=E)break;f++,l-=E}while(!0)}var b=this._daylightSavingAdjust(new Date(a,f-1,l));if(b.getFullYear()!=a||b.getMonth()+1!=f||b.getDate()!=l)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*1e7,formatDate:function(e,t,n){if(!t)return"";var r=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,i=(n?n.dayNames:null)||this._defaults.dayNames,s=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,o=(n?n.monthNames:null)||this._defaults.monthNames,u=function(t){var n=h+1<e.length&&e.charAt(h+1)==t;return n&&h++,n},a=function(e,t,n){var r=""+t;if(u(e))while(r.length<n)r="0"+r;return r},f=function(e,t,n,r){return u(e)?r[t]:n[t]},l="",c=!1;if(t)for(var h=0;h<e.length;h++)if(c)e.charAt(h)=="'"&&!u("'")?c=!1:l+=e.charAt(h);else switch(e.charAt(h)){case"d":l+=a("d",t.getDate(),2);break;case"D":l+=f("D",t.getDay(),r,i);break;case"o":l+=a("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":l+=a("m",t.getMonth()+1,2);break;case"M":l+=f("M",t.getMonth(),s,o);break;case"y":l+=u("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":l+=t.getTime();break;case"!":l+=t.getTime()*1e4+this._ticksTo1970;break;case"'":u("'")?l+="'":c=!0;break;default:l+=e.charAt(h)}return l},_possibleChars:function(e){var t="",n=!1,r=function(t){var n=i+1<e.length&&e.charAt(i+1)==t;return n&&i++,n};for(var i=0;i<e.length;i++)if(n)e.charAt(i)=="'"&&!r("'")?n=!1:t+=e.charAt(i);else switch(e.charAt(i)){case"d":case"m":case"y":case"@":t+="0123456789";break;case"D":case"M":return null;case"'":r("'")?t+="'":n=!0;break;default:t+=e.charAt(i)}return t},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()==e.lastVal)return;var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i,s;i=s=this._getDefaultDate(e);var o=this._getFormatConfig(e);try{i=this.parseDate(n,r,o)||s}catch(u){this.log(u),r=t?"":r}e.selectedDay=i.getDate(),e.drawMonth=e.selectedMonth=i.getMonth(),e.drawYear=e.selectedYear=i.getFullYear(),e.currentDay=r?i.getDate():0,e.currentMonth=r?i.getMonth():0,e.currentYear=r?i.getFullYear():0,this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(e,t,n){var r=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},i=function(t){try{return $.datepicker.parseDate($.datepicker._get(e,"dateFormat"),t,$.datepicker._getFormatConfig(e))}catch(n){}var r=(t.toLowerCase().match(/^c/)?$.datepicker._getDate(e):null)||new Date,i=r.getFullYear(),s=r.getMonth(),o=r.getDate(),u=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,a=u.exec(t);while(a){switch(a[2]||"d"){case"d":case"D":o+=parseInt(a[1],10);break;case"w":case"W":o+=parseInt(a[1],10)*7;break;case"m":case"M":s+=parseInt(a[1],10),o=Math.min(o,$.datepicker._getDaysInMonth(i,s));break;case"y":case"Y":i+=parseInt(a[1],10),o=Math.min(o,$.datepicker._getDaysInMonth(i,s))}a=u.exec(t)}return new Date(i,s,o)},s=t==null||t===""?n:typeof t=="string"?i(t):typeof t=="number"?isNaN(t)?n:r(t):new Date(t.getTime());return s=s&&s.toString()=="Invalid Date"?n:s,s&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0)),this._daylightSavingAdjust(s)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!=e.selectedMonth||s!=e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()==""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(n,-t,"M")},next:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(n,+t,"M")},hide:function(){window["DP_jQuery_"+dpuuid].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+dpuuid].datepicker._gotoToday(n)},selectDay:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(n,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t=new Date;t=this._daylightSavingAdjust(new Date(t.getFullYear(),t.getMonth(),t.getDate()));var n=this._get(e,"isRTL"),r=this._get(e,"showButtonPanel"),i=this._get(e,"hideIfNoPrevNext"),s=this._get(e,"navigationAsDateFormat"),o=this._getNumberOfMonths(e),u=this._get(e,"showCurrentAtPos"),a=this._get(e,"stepMonths"),f=o[0]!=1||o[1]!=1,l=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),c=this._getMinMaxDate(e,"min"),h=this._getMinMaxDate(e,"max"),p=e.drawMonth-u,d=e.drawYear;p<0&&(p+=12,d--);if(h){var v=this._daylightSavingAdjust(new Date(h.getFullYear(),h.getMonth()-o[0]*o[1]+1,h.getDate()));v=c&&v<c?c:v;while(this._daylightSavingAdjust(new Date(d,p,1))>v)p--,p<0&&(p=11,d--)}e.drawMonth=p,e.drawYear=d;var m=this._get(e,"prevText");m=s?this.formatDate(m,this._daylightSavingAdjust(new Date(d,p-a,1)),this._getFormatConfig(e)):m;var g=this._canAdjustMonth(e,-1,d,p)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>":i?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>",y=this._get(e,"nextText");y=s?this.formatDate(y,this._daylightSavingAdjust(new Date(d,p+a,1)),this._getFormatConfig(e)):y;var b=this._canAdjustMonth(e,1,d,p)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+y+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+y+"</span></a>":i?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+y+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+y+"</span></a>",w=this._get(e,"currentText"),E=this._get(e,"gotoCurrent")&&e.currentDay?l:t;w=s?this.formatDate(w,E,this._getFormatConfig(e)):w;var S=e.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(e,"closeText")+"</button>",x=r?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(n?S:"")+(this._isInRange(e,E)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+w+"</button>":"")+(n?"":S)+"</div>":"",T=parseInt(this._get(e,"firstDay"),10);T=isNaN(T)?0:T;var N=this._get(e,"showWeek"),C=this._get(e,"dayNames"),k=this._get(e,"dayNamesShort"),L=this._get(e,"dayNamesMin"),A=this._get(e,"monthNames"),O=this._get(e,"monthNamesShort"),M=this._get(e,"beforeShowDay"),_=this._get(e,"showOtherMonths"),D=this._get(e,"selectOtherMonths"),P=this._get(e,"calculateWeek")||this.iso8601Week,H=this._getDefaultDate(e),B="";for(var j=0;j<o[0];j++){var F="";this.maxRows=4;for(var I=0;I<o[1];I++){var q=this._daylightSavingAdjust(new Date(d,p,e.selectedDay)),R=" ui-corner-all",U="";if(f){U+='<div class="ui-datepicker-group';if(o[1]>1)switch(I){case 0:U+=" ui-datepicker-group-first",R=" ui-corner-"+(n?"right":"left");break;case o[1]-1:U+=" ui-datepicker-group-last",R=" ui-corner-"+(n?"left":"right");break;default:U+=" ui-datepicker-group-middle",R=""}U+='">'}U+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+R+'">'+(/all|left/.test(R)&&j==0?n?b:g:"")+(/all|right/.test(R)&&j==0?n?g:b:"")+this._generateMonthYearHeader(e,p,d,c,h,j>0||I>0,A,O)+'</div><table class="ui-datepicker-calendar"><thead>'+"<tr>";var z=N?'<th class="ui-datepicker-week-col">'+this._get(e,"weekHeader")+"</th>":"";for(var W=0;W<7;W++){var X=(W+T)%7;z+="<th"+((W+T+6)%7>=5?' class="ui-datepicker-week-end"':"")+">"+'<span title="'+C[X]+'">'+L[X]+"</span></th>"}U+=z+"</tr></thead><tbody>";var V=this._getDaysInMonth(d,p);d==e.selectedYear&&p==e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,V));var J=(this._getFirstDayOfMonth(d,p)-T+7)%7,K=Math.ceil((J+V)/7),Q=f?this.maxRows>K?this.maxRows:K:K;this.maxRows=Q;var G=this._daylightSavingAdjust(new Date(d,p,1-J));for(var Y=0;Y<Q;Y++){U+="<tr>";var Z=N?'<td class="ui-datepicker-week-col">'+this._get(e,"calculateWeek")(G)+"</td>":"";for(var W=0;W<7;W++){var et=M?M.apply(e.input?e.input[0]:null,[G]):[!0,""],tt=G.getMonth()!=p,nt=tt&&!D||!et[0]||c&&G<c||h&&G>h;Z+='<td class="'+((W+T+6)%7>=5?" ui-datepicker-week-end":"")+(tt?" ui-datepicker-other-month":"")+(G.getTime()==q.getTime()&&p==e.selectedMonth&&e._keyEvent||H.getTime()==G.getTime()&&H.getTime()==q.getTime()?" "+this._dayOverClass:"")+(nt?" "+this._unselectableClass+" ui-state-disabled":"")+(tt&&!_?"":" "+et[1]+(G.getTime()==l.getTime()?" "+this._currentClass:"")+(G.getTime()==t.getTime()?" ui-datepicker-today":""))+'"'+((!tt||_)&&et[2]?' title="'+et[2]+'"':"")+(nt?"":' data-handler="selectDay" data-event="click" data-month="'+G.getMonth()+'" data-year="'+G.getFullYear()+'"')+">"+(tt&&!_?"&#xa0;":nt?'<span class="ui-state-default">'+G.getDate()+"</span>":'<a class="ui-state-default'+(G.getTime()==t.getTime()?" ui-state-highlight":"")+(G.getTime()==l.getTime()?" ui-state-active":"")+(tt?" ui-priority-secondary":"")+'" href="#">'+G.getDate()+"</a>")+"</td>",G.setDate(G.getDate()+1),G=this._daylightSavingAdjust(G)}U+=Z+"</tr>"}p++,p>11&&(p=0,d++),U+="</tbody></table>"+(f?"</div>"+(o[0]>0&&I==o[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),F+=U}B+=F}return B+=x+($.browser.msie&&parseInt($.browser.version,10)<7&&!e.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),e._keyEvent=!1,B},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a=this._get(e,"changeMonth"),f=this._get(e,"changeYear"),l=this._get(e,"showMonthAfterYear"),c='<div class="ui-datepicker-title">',h="";if(s||!a)h+='<span class="ui-datepicker-month">'+o[t]+"</span>";else{var p=r&&r.getFullYear()==n,d=i&&i.getFullYear()==n;h+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var v=0;v<12;v++)(!p||v>=r.getMonth())&&(!d||v<=i.getMonth())&&(h+='<option value="'+v+'"'+(v==t?' selected="selected"':"")+">"+u[v]+"</option>");h+="</select>"}l||(c+=h+(s||!a||!f?"&#xa0;":""));if(!e.yearshtml){e.yearshtml="";if(s||!f)c+='<span class="ui-datepicker-year">'+n+"</span>";else{var m=this._get(e,"yearRange").split(":"),g=(new Date).getFullYear(),y=function(e){var t=e.match(/c[+-].*/)?n+parseInt(e.substring(1),10):e.match(/[+-].*/)?g+parseInt(e,10):parseInt(e,10);return isNaN(t)?g:t},b=y(m[0]),w=Math.max(b,y(m[1]||""));b=r?Math.max(b,r.getFullYear()):b,w=i?Math.min(w,i.getFullYear()):w,e.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';for(;b<=w;b++)e.yearshtml+='<option value="'+b+'"'+(b==n?' selected="selected"':"")+">"+b+"</option>";e.yearshtml+="</select>",c+=e.yearshtml,e.yearshtml=null}}return c+=this._get(e,"yearSuffix"),l&&(c+=(s||!a||!f?"&#xa0;":"")+h),c+="</div>",c},_adjustInstDate:function(e,t,n){var r=e.drawYear+(n=="Y"?t:0),i=e.drawMonth+(n=="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+(n=="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(n=="M"||n=="Y")&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&t<n?n:t;return i=r&&i>r?r:i,i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(t<0?t:i[0]*i[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max");return(!n||t.getTime()>=n.getTime())&&(!r||t.getTime()<=r.getTime())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),$.fn.datepicker=function(e){if(!this.length)return this;$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick).find(document.body).append($.datepicker.dpDiv),$.datepicker.initialized=!0);var t=Array.prototype.slice.call(arguments,1);return typeof e!="string"||e!="isDisabled"&&e!="getDate"&&e!="widget"?e=="option"&&arguments.length==2&&typeof arguments[1]=="string"?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t)):this.each(function(){typeof e=="string"?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this].concat(t)):$.datepicker._attachDatepicker(this,e)}):$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.9.0",window["DP_jQuery_"+dpuuid]=$}(jQuery),function(e,t){var n="ui-dialog ui-widget ui-widget-content ui-corner-all ",r={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};e.widget("ui.dialog",{version:"1.9.0",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var n=e(this).css(t).offset().top;n<0&&e(this).css("top",t.top-n)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1e3},_create:function(){this.originalTitle=this.element.attr("title"),typeof this.originalTitle!="string"&&(this.originalTitle=""),this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.options.title=this.options.title||this.originalTitle;var t=this,r=this.options,i=r.title||"&#160;",s=(this.uiDialog=e("<div>")).addClass(n+r.dialogClass).css({display:"none",outline:0,zIndex:r.zIndex}).attr("tabIndex",-1).keydown(function(n){r.closeOnEscape&&!n.isDefaultPrevented()&&n.keyCode&&n.keyCode===e.ui.keyCode.ESCAPE&&(t.close(n),n.preventDefault())}).mousedown(function(e){t.moveToTop(!1,e)}).appendTo("body"),o=this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(s),u=(this.uiDialogTitlebar=e("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").prependTo(s),a=e("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(e){e.preventDefault(),t.close(e)}).appendTo(u),f=(this.uiDialogTitlebarCloseText=e("<span>")).addClass("ui-icon ui-icon-closethick").text(r.closeText).appendTo(a),l=e("<span>").uniqueId().addClass("ui-dialog-title").html(i).prependTo(u),c=(this.uiDialogButtonPane=e("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),h=(this.uiButtonSet=e("<div>")).addClass("ui-dialog-buttonset").appendTo(c);s.attr({role:"dialog","aria-labelledby":l.attr("id")}),u.find("*").add(u).disableSelection(),this._hoverable(a),this._focusable(a),r.draggable&&e.fn.draggable&&this._makeDraggable(),r.resizable&&e.fn.resizable&&this._makeResizable(),this._createButtons(r.buttons),this._isOpen=!1,e.fn.bgiframe&&s.bgiframe(),this._on(s,{keydown:function(t){if(!r.modal||t.keyCode!==e.ui.keyCode.TAB)return;var n=e(":tabbable",s),i=n.filter(":first"),o=n.filter(":last");if(t.target===o[0]&&!t.shiftKey)return i.focus(1),!1;if(t.target===i[0]&&t.shiftKey)return o.focus(1),!1}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var e,t=this.oldPosition;this.overlay&&this.overlay.destroy(),this.uiDialog.hide(),this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),e=t.parent.children().eq(t.index),e.length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},close:function(t){var n=this,r,i;if(!this._isOpen)return;if(!1===this._trigger("beforeClose",t))return;return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this.uiDialog.hide(this.options.hide,function(){n._trigger("close",t)}):(this.uiDialog.hide(),this._trigger("close",t)),e.ui.dialog.overlay.resize(),this.options.modal&&(r=0,e(".ui-dialog").each(function(){this!==n.uiDialog[0]&&(i=e(this).css("z-index"),isNaN(i)||(r=Math.max(r,i)))}),e.ui.dialog.maxZ=r),this},isOpen:function(){return this._isOpen},moveToTop:function(t,n){var r=this.options,i;return r.modal&&!t||!r.stack&&!r.modal?this._trigger("focus",n):(r.zIndex>e.ui.dialog.maxZ&&(e.ui.dialog.maxZ=r.zIndex),this.overlay&&(e.ui.dialog.maxZ+=1,e.ui.dialog.overlay.maxZ=e.ui.dialog.maxZ,this.overlay.$el.css("z-index",e.ui.dialog.overlay.maxZ)),i={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()},e.ui.dialog.maxZ+=1,this.uiDialog.css("z-index",e.ui.dialog.maxZ),this.element.attr(i),this._trigger("focus",n),this)},open:function(){if(this._isOpen)return;var t,n=this.options,r=this.uiDialog;return this._size(),this._position(n.position),r.show(n.show),this.overlay=n.modal?new e.ui.dialog.overlay(this):null,this.moveToTop(!0),t=this.element.find(":tabbable"),t.length||(t=this.uiDialogButtonPane.find(":tabbable"),t.length||(t=r)),t.eq(0).focus(),this._isOpen=!0,this._trigger("open"),this},_createButtons:function(t){var n,r,i=this,s=!1;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),typeof t=="object"&&t!==null&&e.each(t,function(){return!(s=!0)}),s?(e.each(t,function(t,n){n=e.isFunction(n)?{click:n,text:t}:n;var r=e("<button type='button'>").attr(n,!0).unbind("click").click(function(){n.click.apply(i.element[0],arguments)}).appendTo(i.uiButtonSet);e.fn.button&&r.button()}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function r(e){return{position:e.position,offset:e.offset}}var t=this,n=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(n,i){e(this).addClass("ui-dialog-dragging"),t._trigger("dragStart",n,r(i))},drag:function(e,n){t._trigger("drag",e,r(n))},stop:function(i,s){n.position=[s.position.left-t.document.scrollLeft(),s.position.top-t.document.scrollTop()],e(this).removeClass("ui-dialog-dragging"),t._trigger("dragStop",i,r(s)),e.ui.dialog.overlay.resize()}})},_makeResizable:function(n){function u(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}n=n===t?this.options.resizable:n;var r=this,i=this.options,s=this.uiDialog.css("position"),o=typeof n=="string"?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:i.maxWidth,maxHeight:i.maxHeight,minWidth:i.minWidth,minHeight:this._minHeight(),handles:o,start:function(t,n){e(this).addClass("ui-dialog-resizing"),r._trigger("resizeStart",t,u(n))},resize:function(e,t){r._trigger("resize",e,u(t))},stop:function(t,n){e(this).removeClass("ui-dialog-resizing"),i.height=e(this).height(),i.width=e(this).width(),r._trigger("resizeStop",t,u(n)),e.ui.dialog.overlay.resize()}}).css("position",s).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var e=this.options;return e.height==="auto"?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(t){var n=[],r=[0,0],i;if(t){if(typeof t=="string"||typeof t=="object"&&"0"in t)n=t.split?t.split(" "):[t[0],t[1]],n.length===1&&(n[1]=n[0]),e.each(["left","top"],function(e,t){+n[e]===n[e]&&(r[e]=n[e],n[e]=t)}),t={my:n.join(" "),at:n.join(" "),offset:r.join(" ")};t=e.extend({},e.ui.dialog.prototype.options.position,t)}else t=e.ui.dialog.prototype.options.position;i=this.uiDialog.is(":visible"),i||this.uiDialog.show(),this.uiDialog.position(t),i||this.uiDialog.hide()},_setOptions:function(t){var n=this,s={},o=!1;e.each(t,function(e,t){n._setOption(e,t),e in r&&(o=!0),e in i&&(s[e]=t)}),o&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",s)},_setOption:function(t,r){var i,s,o=this.uiDialog;switch(t){case"buttons":this._createButtons(r);break;case"closeText":this.uiDialogTitlebarCloseText.text(""+r);break;case"dialogClass":o.removeClass(this.options.dialogClass).addClass(n+r);break;case"disabled":r?o.addClass("ui-dialog-disabled"):o.removeClass("ui-dialog-disabled");break;case"draggable":i=o.is(":data(draggable)"),i&&!r&&o.draggable("destroy"),!i&&r&&this._makeDraggable();break;case"position":this._position(r);break;case"resizable":s=o.is(":data(resizable)"),s&&!r&&o.resizable("destroy"),s&&typeof r=="string"&&o.resizable("option","handles",r),!s&&r!==!1&&this._makeResizable(r);break;case"title":e(".ui-dialog-title",this.uiDialogTitlebar).html(""+(r||"&#160;"))}this._super(t,r)},_size:function(){var t,n,r,i=this.options,s=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),i.minWidth>i.width&&(i.width=i.minWidth),t=this.uiDialog.css({height:"auto",width:i.width}).outerHeight(),n=Math.max(0,i.minHeight-t),i.height==="auto"?e.support.minHeight?this.element.css({minHeight:n,height:"auto"}):(this.uiDialog.show(),r=this.element.css("height","auto").height(),s||this.uiDialog.hide(),this.element.height(Math.max(r,n))):this.element.height(Math.max(i.height-t,0)),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),e.extend(e.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(e){var t=e.attr("id");return t||(this.uuid+=1,t=this.uuid),"ui-dialog-title-"+t},overlay:function(t){this.$el=e.ui.dialog.overlay.create(t)}}),e.extend(e.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:e.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(e){return e+".dialog-overlay"}).join(" "),create:function(t){this.instances.length===0&&(setTimeout(function(){e.ui.dialog.overlay.instances.length&&e(document).bind(e.ui.dialog.overlay.events,function(t){if(e(t.target).zIndex()<e.ui.dialog.overlay.maxZ)return!1})},1),e(window).bind("resize.dialog-overlay",e.ui.dialog.overlay.resize));var n=this.oldInstances.pop()||e("<div>").addClass("ui-widget-overlay");return e(document).bind("keydown.dialog-overlay",function(r){var i=e.ui.dialog.overlay.instances;i.length!==0&&i[i.length-1]===n&&t.options.closeOnEscape&&!r.isDefaultPrevented()&&r.keyCode&&r.keyCode===e.ui.keyCode.ESCAPE&&(t.close(r),r.preventDefault())}),n.appendTo(document.body).css({width:this.width(),height:this.height()}),e.fn.bgiframe&&n.bgiframe(),this.instances.push(n),n},destroy:function(t){var n=e.inArray(t,this.instances),r=0;n!==-1&&this.oldInstances.push(this.instances.splice(n,1)[0]),this.instances.length===0&&e([document,window]).unbind(".dialog-overlay"),t.height(0).width(0).remove(),e.each(this.instances,function(){r=Math.max(r,this.css("z-index"))}),this.maxZ=r},height:function(){var t,n;return e.browser.msie?(t=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),n=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),t<n?e(window).height()+"px":t+"px"):e(document).height()+"px"},width:function(){var t,n;return e.browser.msie?(t=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),n=Math
.max(document.documentElement.offsetWidth,document.body.offsetWidth),t<n?e(window).width()+"px":t+"px"):e(document).width()+"px"},resize:function(){var t=e([]);e.each(e.ui.dialog.overlay.instances,function(){t=t.add(this)}),t.css({width:0,height:0}).css({width:e.ui.dialog.overlay.width(),height:e.ui.dialog.overlay.height()})}}),e.extend(e.ui.dialog.overlay.prototype,{destroy:function(){e.ui.dialog.overlay.destroy(this.$el)}})}(jQuery),function(e,t){var n=!1;e.widget("ui.menu",{version:"1.9.0",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(e){this.options.disabled&&e.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(e){e.preventDefault()},"click .ui-state-disabled > a":function(e){e.preventDefault()},"click .ui-menu-item:has(a)":function(t){var r=e(t.target).closest(".ui-menu-item");!n&&r.not(".ui-state-disabled").length&&(n=!0,this.select(t),r.has(".ui-menu").length?this.expand(t):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var n=e(t.currentTarget);n.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(t,n)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var n=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(e,n)},blur:function(t){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){e(t.target).closest(".ui-menu").length||this.collapseAll(t),n=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=e(this);t.data("ui-menu-submenu-carat")&&t.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function a(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var n,r,i,s,o,u=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:u=!1,r=this.previousFilter||"",i=String.fromCharCode(t.keyCode),s=!1,clearTimeout(this.filterTimer),i===r?s=!0:i=r+i,o=new RegExp("^"+a(i),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return o.test(e(this).children("a").text())}),n=s&&n.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):n,n.length||(i=String.fromCharCode(t.keyCode),o=new RegExp("^"+a(i),"i"),n=this.activeMenu.children(".ui-menu-item").filter(function(){return o.test(e(this).children("a").text())})),n.length?(this.focus(t,n),n.length>1?(this.previousFilter=i,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}u&&t.preventDefault()},_activate:function(e){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,n=this.options.icons.submenu,r=this.element.find(this.options.menus+":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"});t=r.add(this.element),t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),t.children(":not(.ui-menu-item)").each(function(){var t=e(this);/[^\-—–\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")}),t.children(".ui-state-disabled").attr("aria-disabled","true"),r.each(function(){var t=e(this),r=t.prev("a"),i=e("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);r.attr("aria-haspopup","true").prepend(i),t.attr("aria-labelledby",r.attr("id"))}),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(e,t){var n,r;this.blur(e,e&&e.type==="focus"),this._scrollIntoView(t),this.active=t.first(),r=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",r.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e&&e.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay),n=t.children(".ui-menu"),n.length&&/^mouse/.test(e.type)&&this._startOpening(n),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var n,r,i,s,o,u;this._hasScroll()&&(n=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,i=t.offset().top-this.activeMenu.offset().top-n-r,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),u=t.height(),i<0?this.activeMenu.scrollTop(s+i):i+u>o&&this.activeMenu.scrollTop(s+i-o+u))},blur:function(e,t){t||clearTimeout(this.timer);if(!this.active)return;this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",e,{item:this.active})},_startOpening:function(e){clearTimeout(this.timer);if(e.attr("aria-hidden")!=="true")return;this.timer=this._delay(function(){this._close(),this._open(e)},this.delay)},_open:function(t){var n=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(n)},collapseAll:function(t,n){clearTimeout(this.timer),this.timer=this._delay(function(){var r=n?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));r.length||(r=this.element),this._close(r),this.blur(t),this.activeMenu=r},this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(e,t,n){var r;this.active&&(e==="first"||e==="last"?r=this.active[e==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):r=this.active[e+"All"](".ui-menu-item").eq(0));if(!r||!r.length||!this.active)r=this.activeMenu.children(".ui-menu-item")[t]();this.focus(n,r)},nextPage:function(t){var n,r,i;if(!this.active){this.next(t);return}if(this.isLastItem())return;this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r-i<0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())},previousPage:function(t){var n,r,i;if(!this.active){this.next(t);return}if(this.isFirstItem())return;this._hasScroll()?(r=this.active.offset().top,i=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return n=e(this),n.offset().top-r+i>0}),this.focus(t,n)):this.focus(t,this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var n={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,n)}})}(jQuery),function(e,t){e.widget("ui.progressbar",{version:"1.9.0",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(e){return e===t?this._value():(this._setOption("value",e),this)},_setOption:function(e,t){e==="value"&&(this.options.value=t,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),this._super(e,t)},_value:function(){var e=this.options.value;return typeof e!="number"&&(e=0),Math.min(this.options.max,Math.max(this.min,e))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var e=this.value(),t=this._percentage();this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),this.valueDiv.toggle(e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(t.toFixed(0)+"%"),this.element.attr("aria-valuenow",e)}})}(jQuery),function(e,t){var n=5;e.widget("ui.slider",e.ui.mouse,{version:"1.9.0",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var t,r=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=r.values&&r.values.length||1,u=[];this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"+(r.disabled?" ui-slider-disabled ui-disabled":"")),this.range=e([]),r.range&&(r.range===!0&&(r.values||(r.values=[this._valueMin(),this._valueMin()]),r.values.length&&r.values.length!==2&&(r.values=[r.values[0],r.values[0]])),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(r.range==="min"||r.range==="max"?" ui-slider-range-"+r.range:"")));for(t=i.length;t<o;t++)u.push(s);this.handles=i.add(e(u.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(e){e.preventDefault()}).mouseenter(function(){r.disabled||e(this).addClass("ui-state-hover")}).mouseleave(function(){e(this).removeClass("ui-state-hover")}).focus(function(){r.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)}),this._on(this.handles,{keydown:function(t){var r,i,s,o,u=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:t.preventDefault();if(!this._keySliding){this._keySliding=!0,e(t.target).addClass("ui-state-active"),r=this._start(t,u);if(r===!1)return}}o=this.options.step,this.options.values&&this.options.values.length?i=s=this.values(u):i=s=this.value();switch(t.keyCode){case e.ui.keyCode.HOME:s=this._valueMin();break;case e.ui.keyCode.END:s=this._valueMax();break;case e.ui.keyCode.PAGE_UP:s=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.PAGE_DOWN:s=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/n);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(i===this._valueMax())return;s=this._trimAlignValue(i+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i===this._valueMin())return;s=this._trimAlignValue(i-o)}this._slide(t,u,s)},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,s,o,u,a,f,l=this,c=this.options;return c.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},r=this._normValueFromMouse(n),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(r-l.values(t));i>n&&(i=n,s=e(this),o=t)}),c.range===!0&&this.values(1)===c.min&&(o+=1,s=e(this.handles[o])),u=this._start(t,o),u===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),a=s.offset(),f=!e(t.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=f?{left:0,top:0}:{left:t.pageX-a.left-s.width()/2,top:t.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,r),this._animateOff=!0,!0))},_mouseStart:function(e){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;return this.orientation==="horizontal"?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/t,r>1&&(r=1),r<0&&(r=0),this.orientation==="vertical"&&(r=1-r),i=this._valueMax()-this._valueMin(),s=this._valueMin()+r*i,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;this.options.values&&this.options.values.length?(r=this.values(t?0:1),this.options.values.length===2&&this.options.range===!0&&(t===0&&n>r||t===1&&n<r)&&(n=r),n!==this.values(t)&&(i=this.values(),i[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i}),r=this.values(t?0:1),s!==!1&&this.values(t,n,!0))):n!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:n}),s!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("change",e,n)}},value:function(e){if(arguments.length){this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(t,n){var r,i,s;if(arguments.length>1){this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t);return}if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();r=this.options.values,i=arguments[0];for(s=0;s<r.length;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var r,i=0;e.isArray(this.options.values)&&(i=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments);switch(t){case"disabled":n?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(r=0;r<i;r+=1)this._change(null,r);this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e),e},_values:function(e){var t,n,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t),t;n=this.options.values.slice();for(r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,r=e-n;return Math.abs(n)*2>=t&&(r+=n>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,r,i,s,o=this.options.range,u=this.options,a=this,f=this._animateOff?!1:u.animate,l={};this.options.values&&this.options.values.length?this.handles.each(function(r,i){n=(a.values(r)-a._valueMin())/(a._valueMax()-a._valueMin())*100,l[a.orientation==="horizontal"?"left":"bottom"]=n+"%",e(this).stop(1,1)[f?"animate":"css"](l,u.animate),a.options.range===!0&&(a.orientation==="horizontal"?(r===0&&a.range.stop(1,1)[f?"animate":"css"]({left:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:u.animate})):(r===0&&a.range.stop(1,1)[f?"animate":"css"]({bottom:n+"%"},u.animate),r===1&&a.range[f?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:u.animate}))),t=n}):(r=this.value(),i=this._valueMin(),s=this._valueMax(),n=s!==i?(r-i)/(s-i)*100:0,l[this.orientation==="horizontal"?"left":"bottom"]=n+"%",this.handle.stop(1,1)[f?"animate":"css"](l,u.animate),o==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[f?"animate":"css"]({width:n+"%"},u.animate),o==="max"&&this.orientation==="horizontal"&&this.range[f?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:u.animate}),o==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[f?"animate":"css"]({height:n+"%"},u.animate),o==="max"&&this.orientation==="vertical"&&this.range[f?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:u.animate}))}})}(jQuery),function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e.widget("ui.spinner",{version:"1.9.0",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},n=this.element;return e.each(["min","max","step"],function(e,r){var i=n.attr(r);i!==undefined&&i.length&&(t[r]=i)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.uiSpinner.addClass("ui-state-active"),this.previous=this.element.val()},blur:function(e){if(this.cancelBlur){delete this.cancelBlur;return}this._refresh(),this.uiSpinner.removeClass("ui-state-active"),this.previous!==this.element.val()&&this._trigger("change",e)},mousewheel:function(e,t){if(!t)return;if(!this.spinning&&!this._start(e))return!1;this._spin((t>0?1:-1)*this.options.step,e),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(e)},100),e.preventDefault()},"mousedown .ui-spinner-button":function(t){function r(){var e=this.element[0]===this.document[0].activeElement;e||(this.element.focus(),this.previous=n,this._delay(function(){this.previous=n}))}var n;n=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),r.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,r.call(this)});if(this._start(t)===!1)return;this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(!e(t.currentTarget).hasClass("ui-state-active"))return;if(this._start(t)===!1)return!1;this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var e=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this._hoverable(e),this.element.attr("role","spinbutton"),this.buttons=e.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(e.height()*.5)&&e.height()>0&&e.height(e.height()),this.options.disabled&&this.disable()},_keydown:function(t){var n=this.options,r=e.ui.keyCode;switch(t.keyCode){case r.UP:return this._repeat(null,1,t),!0;case r.DOWN:return this._repeat(null,-1,t),!0;case r.PAGE_UP:return this._repeat(null,n.page,t),!0;case r.PAGE_DOWN:return this._repeat(null,-n.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-state-default ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(e){return!this.spinning&&this._trigger("start",e)===!1?!1:(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(e,t,n){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,n)},e),this._spin(t*this.options.step,n)},_spin:function(e,t){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+e*this._increment(this.counter));if(!this.spinning||this._trigger("spin",t,{value:n})!==!1)this._value(n),this.counter++},_increment:function(t){var n=this.options.incremental;return n?e.isFunction(n)?n(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return this.options.min!==null&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),n=t.indexOf(".");return n===-1?0:t.length-n-1},_adjustValue:function(e){var t,n,r=this.options;return t=r.min!==null?r.min:0,n=e-t,n=Math.round(n/r.step)*r.step,e=t+n,e=parseFloat(e.toFixed(this._precision())),r.max!==null&&e>r.max?r.max:r.min!==null&&e<r.min?r.min:e},_stop:function(e){if(!this.spinning)return;clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e)},_setOption:function(e,t){if(e==="culture"||e==="numberFormat"){var n=this._parse(this.element.val());this.options[e]=t,this.element.val(this._format(n));return}(e==="max"||e==="min"||e==="step")&&typeof t=="string"&&(t=this._parse(t)),this._super(e,t),e==="disabled"&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(e){this._super(e),this._value(this.element.val())}),_parse:function(e){return typeof e=="string"&&e!==""&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),e===""||isNaN(e)?null:e},_format:function(e){return e===""?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(e,t){var n;e!==""&&(n=this._parse(e),n!==null&&(t||(n=this._adjustValue(n)),e=this._format(n))),this.element.val(e),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._spin((e||1)*this.options.step)},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._spin((e||1)*-this.options.step)},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){if(!arguments.length)return this._parse(this.element.val());t(this._value).call(this,e)},widget:function(){return this.uiSpinner}})}(jQuery),function(e,t){function i(){return++n}function s(e){return e=e.cloneNode(!1),e.hash.length>1&&e.href.replace(r,"")===location.href.replace(r,"")}var n=0,r=/#.*$/;e.widget("ui.tabs",{version:"1.9.0",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var t,n=this,r=this.options,i=r.active;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",r.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs();if(i===null){location.hash&&this.anchors.each(function(e,t){if(t.hash===location.hash)return i=e,!1}),i===null&&(i=this.tabs.filter(".ui-tabs-active").index());if(i===null||i===-1)i=this.tabs.length?0:!1}i!==!1&&(i=this.tabs.index(this.tabs.eq(i)),i===-1&&(i=r.collapsible?!1:0)),r.active=i,!r.collapsible&&r.active===!1&&this.anchors.length&&(r.active=0),e.isArray(r.disabled)&&(r.disabled=e.unique(r.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return n.tabs.index(e)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(this.options.active):this.active=e(),this._refresh(),this.active.length&&this.load(r.active)},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var n=e(this.document[0].activeElement).closest("li"),r=this.tabs.index(n),i=!0;if(this._handlePageNav(t))return;switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:r++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:i=!1,r--;break;case e.ui.keyCode.END:r=this.anchors.length-1;break;case e.ui.keyCode.HOME:r=0;break;case e.ui.keyCode.SPACE:t.preventDefault(),clearTimeout(this.activating),this._activate(r);return;case e.ui.keyCode.ENTER:t.preventDefault(),clearTimeout(this.activating),this._activate(r===this.options.active?!1:r);return;default:return}t.preventDefault(),clearTimeout(this.activating),r=this._focusNextTab(r,i),t.ctrlKey||(n.attr("aria-selected","false"),this.tabs.eq(r).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",r)},this.delay))},_panelKeydown:function(t){if(this._handlePageNav(t))return;t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){if(t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP)return this._activate(this._focusNextTab(this.options.active-1,!1)),!0;if(t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN)return this._activate(this._focusNextTab(this.options.active+1,!0)),!0},_findNextTab:function(t,n){function i(){return t>r&&(t=0),t<0&&(t=r),t}var r=this.tabs.length-1;while(e.inArray(i(),this.options.disabled)!==-1)t=n?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).focus(),e},_setOption:function(e,t){if(e==="active"){this._activate(t);return}if(e==="disabled"){this._setupDisabled(t);return}this._super(e,t),e==="collapsible"&&(this.element.toggleClass("ui-tabs-collapsible",t),!t&&this.options.active===!1&&this._activate(0)),e==="event"&&this._setupEvents(t),e==="heightStyle"&&this._setupHeightStyle(t)},_tabId:function(e){return e.attr("aria-controls")||"ui-tabs-"+i()},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t,n=this.options,r=this.tablist.children(":has(a[href])");n.disabled=e.map(r.filter(".ui-state-disabled"),function(e){return r.index(e)}),this._processTabs(),n.active===!1||!this.anchors.length?(n.active=!1,this.active=e()):this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===n.disabled.length?(n.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,n.active-1),!1)):n.active=this.tabs.index(this.active),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=e(),this.anchors.each(function(n,r){var i,o,u,a=e(r).uniqueId().attr("id"),f=e(r).closest("li"),l=f.attr("aria-controls");s(r)?(i=r.hash,o=t.element.find(t._sanitizeSelector(i))):(u=t._tabId(f),i="#"+u,o=t.element.find(i),o.length||(o=t._createPanel(u),o.insertAfter(t.panels[n-1]||t.tablist)),o.attr("aria-live","polite")),o.length&&(t.panels=t.panels.add(o)),l&&f.data("ui-tabs-aria-controls",l),f.attr({"aria-controls":i.substring(1),"aria-labelledby":a}),o.attr("aria-labelledby"
,a)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var n=0,r;r=this.tabs[n];n++)t===!0||e.inArray(n,t)!==-1?e(r).addClass("ui-state-disabled").attr("aria-disabled","true"):e(r).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var n={click:function(e){e.preventDefault()}};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,n),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var n,r,i=this.element.parent();t==="fill"?(e.support.minHeight||(r=i.css("overflow"),i.css("overflow","hidden")),n=i.height(),this.element.siblings(":visible").each(function(){var t=e(this),r=t.css("position");if(r==="absolute"||r==="fixed")return;n-=t.outerHeight(!0)}),r&&i.css("overflow",r),this.element.children().not(this.panels).each(function(){n-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,n-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):t==="auto"&&(n=0,this.panels.each(function(){n=Math.max(n,e(this).height("").height())}).height(n))},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i.closest("li"),o=s[0]===r[0],u=o&&n.collapsible,a=u?e():this._getPanelForTab(s),f=r.length?this._getPanelForTab(r):e(),l={oldTab:r,oldPanel:f,newTab:u?e():s,newPanel:a};t.preventDefault();if(s.hasClass("ui-state-disabled")||s.hasClass("ui-tabs-loading")||this.running||o&&!n.collapsible||this._trigger("beforeActivate",t,l)===!1)return;n.active=u?!1:this.tabs.index(s),this.active=o?e():s,this.xhr&&this.xhr.abort(),!f.length&&!a.length&&e.error("jQuery UI Tabs: Mismatching fragment identifier."),a.length&&this.load(this.tabs.index(s),t),this._toggle(t,l)},_toggle:function(t,n){function o(){r.running=!1,r._trigger("activate",t,n)}function u(){n.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),i.length&&r.options.show?r._show(i,r.options.show,o):(i.show(),o())}var r=this,i=n.newPanel,s=n.oldPanel;this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),u()}):(n.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),s.hide(),u()),s.attr({"aria-expanded":"false","aria-hidden":"true"}),n.oldTab.attr("aria-selected","false"),i.length&&s.length?n.oldTab.attr("tabIndex",-1):i.length&&this.tabs.filter(function(){return e(this).attr("tabIndex")===0}).attr("tabIndex",-1),i.attr({"aria-expanded":"true","aria-hidden":"false"}),n.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var n,r=this._findActive(t);if(r[0]===this.active[0])return;r.length||(r=this.active),n=r.find(".ui-tabs-anchor")[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop})},_findActive:function(t){return t===!1?e():this.tabs.eq(t)},_getIndex:function(e){return typeof e=="string"&&(e=this.anchors.index(this.anchors.filter("[href$='"+e+"']"))),e},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeData("href.tabs").removeData("load.tabs").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var t=e(this),n=t.data("ui-tabs-aria-controls");n?t.attr("aria-controls",n):t.removeAttr("aria-controls")}),this.options.heightStyle!=="content"&&this.panels.css("height","")},enable:function(n){var r=this.options.disabled;if(r===!1)return;n===t?r=!1:(n=this._getIndex(n),e.isArray(r)?r=e.map(r,function(e){return e!==n?e:null}):r=e.map(this.tabs,function(e,t){return t!==n?t:null})),this._setupDisabled(r)},disable:function(n){var r=this.options.disabled;if(r===!0)return;if(n===t)r=!0;else{n=this._getIndex(n);if(e.inArray(n,r)!==-1)return;e.isArray(r)?r=e.merge([n],r).sort():r=[n]}this._setupDisabled(r)},load:function(t,n){t=this._getIndex(t);var r=this,i=this.tabs.eq(t),o=i.find(".ui-tabs-anchor"),u=this._getPanelForTab(i),a={tab:i,panel:u};if(s(o[0]))return;this.xhr=e.ajax(this._ajaxSettings(o,n,a)),this.xhr&&this.xhr.statusText!=="canceled"&&(i.addClass("ui-tabs-loading"),u.attr("aria-busy","true"),this.xhr.success(function(e){setTimeout(function(){u.html(e),r._trigger("load",n,a)},1)}).complete(function(e,t){setTimeout(function(){t==="abort"&&r.panels.stop(!1,!0),i.removeClass("ui-tabs-loading"),u.removeAttr("aria-busy"),e===r.xhr&&delete r.xhr},1)}))},_ajaxSettings:function(t,n,r){var i=this;return{url:t.attr("href"),beforeSend:function(t,s){return i._trigger("beforeLoad",n,e.extend({jqXHR:t,ajaxSettings:s},r))}}},_getPanelForTab:function(t){var n=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+n))}}),e.uiBackCompat!==!1&&(e.ui.tabs.prototype._ui=function(e,t){return{tab:e,panel:t,index:this.anchors.index(e)}},e.widget("ui.tabs",e.ui.tabs,{url:function(e,t){this.anchors.eq(e).attr("href",t)}}),e.widget("ui.tabs",e.ui.tabs,{options:{ajaxOptions:null,cache:!1},_create:function(){this._super();var t=this;this._on({tabsbeforeload:function(n,r){if(e.data(r.tab[0],"cache.tabs")){n.preventDefault();return}r.jqXHR.success(function(){t.options.cache&&e.data(r.tab[0],"cache.tabs",!0)})}})},_ajaxSettings:function(t,n,r){var i=this.options.ajaxOptions;return e.extend({},i,{error:function(e,t,n){try{i.error(e,t,r.tab.closest("li").index(),r.tab[0])}catch(n){}}},this._superApply(arguments))},_setOption:function(e,t){e==="cache"&&t===!1&&this.anchors.removeData("cache.tabs"),this._super(e,t)},_destroy:function(){this.anchors.removeData("cache.tabs"),this._super()},url:function(e,t){this.anchors.eq(e).removeData("cache.tabs"),this._superApply(arguments)}}),e.widget("ui.tabs",e.ui.tabs,{abort:function(){this.xhr&&this.xhr.abort()}}),e.widget("ui.tabs",e.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super(),this._on({tabsbeforeload:function(e,t){if(e.target!==this.element[0]||!this.options.spinner)return;var n=t.tab.find("span"),r=n.html();n.html(this.options.spinner),t.jqXHR.complete(function(){n.html(r)})}})}}),e.widget("ui.tabs",e.ui.tabs,{options:{enable:null,disable:null},enable:function(t){var n=this.options,r;if(t&&n.disabled===!0||e.isArray(n.disabled)&&e.inArray(t,n.disabled)!==-1)r=!0;this._superApply(arguments),r&&this._trigger("enable",null,this._ui(this.anchors[t],this.panels[t]))},disable:function(t){var n=this.options,r;if(t&&n.disabled===!1||e.isArray(n.disabled)&&e.inArray(t,n.disabled)===-1)r=!0;this._superApply(arguments),r&&this._trigger("disable",null,this._ui(this.anchors[t],this.panels[t]))}}),e.widget("ui.tabs",e.ui.tabs,{options:{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},add:function(n,r,i){i===t&&(i=this.anchors.length);var s,o,u=this.options,a=e(u.tabTemplate.replace(/#\{href\}/g,n).replace(/#\{label\}/g,r)),f=n.indexOf("#")?this._tabId(a):n.replace("#","");return a.addClass("ui-state-default ui-corner-top").data("ui-tabs-destroy",!0),a.attr("aria-controls",f),s=i>=this.tabs.length,o=this.element.find("#"+f),o.length||(o=this._createPanel(f),s?i>0?o.insertAfter(this.panels.eq(-1)):o.appendTo(this.element):o.insertBefore(this.panels[i])),o.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide(),s?a.appendTo(this.tablist):a.insertBefore(this.tabs[i]),u.disabled=e.map(u.disabled,function(e){return e>=i?++e:e}),this.refresh(),this.tabs.length===1&&u.active===!1&&this.option("active",0),this._trigger("add",null,this._ui(this.anchors[i],this.panels[i])),this},remove:function(t){t=this._getIndex(t);var n=this.options,r=this.tabs.eq(t).remove(),i=this._getPanelForTab(r).remove();return r.hasClass("ui-tabs-active")&&this.anchors.length>2&&this._activate(t+(t+1<this.anchors.length?1:-1)),n.disabled=e.map(e.grep(n.disabled,function(e){return e!==t}),function(e){return e>=t?--e:e}),this.refresh(),this._trigger("remove",null,this._ui(r.find("a")[0],i[0])),this}}),e.widget("ui.tabs",e.ui.tabs,{length:function(){return this.anchors.length}}),e.widget("ui.tabs",e.ui.tabs,{options:{idPrefix:"ui-tabs-"},_tabId:function(t){var n=t.is("li")?t.find("a[href]"):t;return n=n[0],e(n).closest("li").attr("aria-controls")||n.title&&n.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF\-]/g,"")||this.options.idPrefix+i()}}),e.widget("ui.tabs",e.ui.tabs,{options:{panelTemplate:"<div></div>"},_createPanel:function(t){return e(this.options.panelTemplate).attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)}}),e.widget("ui.tabs",e.ui.tabs,{_create:function(){var e=this.options;e.active===null&&e.selected!==t&&(e.active=e.selected===-1?!1:e.selected),this._super(),e.selected=e.active,e.selected===!1&&(e.selected=-1)},_setOption:function(e,t){if(e!=="selected")return this._super(e,t);var n=this.options;this._super("active",t===-1?!1:t),n.selected=n.active,n.selected===!1&&(n.selected=-1)},_eventHandler:function(e){this._superApply(arguments),this.options.selected=this.options.active,this.options.selected===!1&&(this.options.selected=-1)}}),e.widget("ui.tabs",e.ui.tabs,{options:{show:null,select:null},_create:function(){this._super(),this.options.active!==!1&&this._trigger("show",null,this._ui(this.active.find(".ui-tabs-anchor")[0],this._getPanelForTab(this.active)[0]))},_trigger:function(e,t,n){var r=this._superApply(arguments);return r?(e==="beforeActivate"&&n.newTab.length?r=this._super("select",t,{tab:n.newTab.find(".ui-tabs-anchor")[0],panel:n.newPanel[0],index:n.newTab.closest("li").index()}):e==="activate"&&n.newTab.length&&(r=this._super("show",t,{tab:n.newTab.find(".ui-tabs-anchor")[0],panel:n.newPanel[0],index:n.newTab.closest("li").index()})),r):!1}}),e.widget("ui.tabs",e.ui.tabs,{select:function(e){e=this._getIndex(e);if(e===-1){if(!this.options.collapsible||this.options.selected===-1)return;e=this.options.selected}this.anchors.eq(e).trigger(this.options.event+this.eventNamespace)}}),function(){var t=0;e.widget("ui.tabs",e.ui.tabs,{options:{cookie:null},_create:function(){var e=this.options,t;e.active==null&&e.cookie&&(t=parseInt(this._cookie(),10),t===-1&&(t=!1),e.active=t),this._super()},_cookie:function(n){var r=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++t)];return arguments.length&&(r.push(n===!1?-1:n),r.push(this.options.cookie)),e.cookie.apply(null,r)},_refresh:function(){this._super(),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_eventHandler:function(e){this._superApply(arguments),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super(),this.options.cookie&&this._cookie(null,this.options.cookie)}})}(),e.widget("ui.tabs",e.ui.tabs,{_trigger:function(t,n,r){var i=e.extend({},r);return t==="load"&&(i.panel=i.panel[0],i.tab=i.tab.find(".ui-tabs-anchor")[0]),this._super(t,n,i)}}),e.widget("ui.tabs",e.ui.tabs,{options:{fx:null},_getFx:function(){var t,n,r=this.options.fx;return r&&(e.isArray(r)?(t=r[0],n=r[1]):t=n=r),r?{show:n,hide:t}:null},_toggle:function(e,t){function o(){n.running=!1,n._trigger("activate",e,t)}function u(){t.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),r.length&&s.show?r.animate(s.show,s.show.duration,function(){o()}):(r.show(),o())}var n=this,r=t.newPanel,i=t.oldPanel,s=this._getFx();if(!s)return this._super(e,t);n.running=!0,i.length&&s.hide?i.animate(s.hide,s.hide.duration,function(){t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),u()}):(t.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),i.hide(),u())}}))}(jQuery),function(e){function n(t,n){var r=(t.attr("aria-describedby")||"").split(/\s+/);r.push(n),t.data("ui-tooltip-id",n).attr("aria-describedby",e.trim(r.join(" ")))}function r(t){var n=t.data("ui-tooltip-id"),r=(t.attr("aria-describedby")||"").split(/\s+/),i=e.inArray(n,r);i!==-1&&r.splice(i,1),t.removeData("ui-tooltip-id"),r=e.trim(r.join(" ")),r?t.attr("aria-describedby",r):t.removeAttr("aria-describedby")}var t=0;e.widget("ui.tooltip",{version:"1.9.0",options:{content:function(){return e(this).attr("title")},hide:!0,items:"[title]",position:{my:"left+15 center",at:"right center",collision:"flipfit flipfit"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={}},_setOption:function(t,n){var r=this;if(t==="disabled"){this[n?"_disable":"_enable"](),this.options[t]=n;return}this._super(t,n),t==="content"&&e.each(this.tooltips,function(e,t){r._updateContent(t)})},_disable:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0)}),this.element.find(this.options.items).andSelf().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var n=e(t?t.target:this.element).closest(this.options.items);if(!n.length)return;if(this.options.track&&n.data("ui-tooltip-id")){this._find(n).position(e.extend({of:n},this.options.position)),this._off(this.document,"mousemove");return}n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("tooltip-open",!0),this._updateContent(n,t)},_updateContent:function(e,t){var n,r=this.options.content,i=this;if(typeof r=="string")return this._open(t,e,r);n=r.call(e[0],function(n){if(!e.data("tooltip-open"))return;i._delay(function(){this._open(t,e,n)})}),n&&this._open(t,e,n)},_open:function(t,r,i){function u(e){o.of=e,s.position(o)}var s,o;if(!i)return;s=this._find(r);if(s.length){s.find(".ui-tooltip-content").html(i);return}r.is("[title]")&&(t&&t.type==="mouseover"?r.attr("title",""):r.removeAttr("title")),s=this._tooltip(r),n(r,s.attr("id")),s.find(".ui-tooltip-content").html(i),this.options.track&&t&&/^mouse/.test(t.originalEvent.type)?(o=e.extend({},this.options.position),this._on(this.document,{mousemove:u}),u(t)):s.position(e.extend({of:r},this.options.position)),s.hide(),this._show(s,this.options.show),this._trigger("open",t,{tooltip:s}),this._on(r,{mouseleave:"close",focusout:"close",keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var n=e.Event(t);n.currentTarget=r[0],this.close(n,!0)}}})},close:function(t,n){var i=this,s=e(t?t.currentTarget:this.element),o=this._find(s);if(this.closing)return;if(!n&&t&&t.type!=="focusout"&&this.document[0].activeElement===s[0])return;s.data("ui-tooltip-title")&&s.attr("title",s.data("ui-tooltip-title")),r(s),o.stop(!0),this._hide(o,this.options.hide,function(){e(this).remove(),delete i.tooltips[this.id]}),s.removeData("tooltip-open"),this._off(s,"mouseleave focusout keyup"),this._off(this.document,"mousemove"),this.closing=!0,this._trigger("close",t,{tooltip:o}),this.closing=!1},_tooltip:function(n){var r="ui-tooltip-"+t++,i=e("<div>").attr({id:r,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return e("<div>").addClass("ui-tooltip-content").appendTo(i),i.appendTo(this.document[0].body),e.fn.bgiframe&&i.bgiframe(),this.tooltips[r]=n,i},_find:function(t){var n=t.data("ui-tooltip-id");return n?e("#"+n):e()},_destroy:function(){var t=this;e.each(this.tooltips,function(n,r){var i=e.Event("blur");i.target=i.currentTarget=r[0],t.close(i,!0),e("#"+n).remove(),r.data("ui-tooltip-title")&&(r.attr("title",r.data("ui-tooltip-title")),r.removeData("ui-tooltip-title"))})}})}(jQuery),jQuery.effects||function(e,t){var n=e.uiBackCompat!==!1,r="ui-effects-";e.effects={effect:{}},function(t,n){function p(e,t,n){var r=a[t.type]||{};return e==null?n||!t.def?null:t.def:(e=r.floor?~~e:parseFloat(e),isNaN(e)?t.def:r.mod?(e+r.mod)%r.mod:0>e?0:r.max<e?r.max:e)}function d(e){var n=o(),r=n._rgba=[];return e=e.toLowerCase(),h(s,function(t,i){var s,o=i.re.exec(e),a=o&&i.parse(o),f=i.space||"rgba";if(a)return s=n[f](a),n[u[f].cache]=s[u[f].cache],r=n._rgba=s._rgba,!1}),r.length?(r.join()==="0,0,0,0"&&t.extend(r,c.transparent),n):c[e]}function v(e,t,n){return n=(n+1)%1,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e}var r="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),i=/^([\-+])=\s*(\d+\.?\d*)/,s=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1]*2.55,e[2]*2.55,e[3]*2.55,e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],o=t.Color=function(e,n,r,i){return new t.Color.fn.parse(e,n,r,i)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},a={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},f=o.support={},l=t("<p>")[0],c,h=t.each;l.style.cssText="background-color:rgba(1,1,1,.5)",f.rgba=l.style.backgroundColor.indexOf("rgba")>-1,h(u,function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}}),o.fn=t.extend(o.prototype,{parse:function(r,i,s,a){if(r===n)return this._rgba=[null,null,null,null],this;if(r.jquery||r.nodeType)r=t(r).css(i),i=n;var f=this,l=t.type(r),v=this._rgba=[],m;i!==n&&(r=[r,i,s,a],l="array");if(l==="string")return this.parse(d(r)||c._default);if(l==="array")return h(u.rgba.props,function(e,t){v[t.idx]=p(r[t.idx],t)}),this;if(l==="object")return r instanceof o?h(u,function(e,t){r[t.cache]&&(f[t.cache]=r[t.cache].slice())}):h(u,function(t,n){var i=n.cache;h(n.props,function(e,t){if(!f[i]&&n.to){if(e==="alpha"||r[e]==null)return;f[i]=n.to(f._rgba)}f[i][t.idx]=p(r[e],t,!0)}),f[i]&&e.inArray(null,f[i].slice(0,3))<0&&(f[i][3]=1,n.from&&(f._rgba=n.from(f[i])))}),this},is:function(e){var t=o(e),n=!0,r=this;return h(u,function(e,i){var s,o=t[i.cache];return o&&(s=r[i.cache]||i.to&&i.to(r._rgba)||[],h(i.props,function(e,t){if(o[t.idx]!=null)return n=o[t.idx]===s[t.idx],n})),n}),n},_space:function(){var e=[],t=this;return h(u,function(n,r){t[r.cache]&&e.push(n)}),e.pop()},transition:function(e,t){var n=o(e),r=n._space(),i=u[r],s=this.alpha()===0?o("transparent"):this,f=s[i.cache]||i.to(s._rgba),l=f.slice();return n=n[i.cache],h(i.props,function(e,r){var i=r.idx,s=f[i],o=n[i],u=a[r.type]||{};if(o===null)return;s===null?l[i]=o:(u.mod&&(o-s>u.mod/2?s+=u.mod:s-o>u.mod/2&&(s-=u.mod)),l[i]=p((o-s)*t+s,r))}),this[r](l)},blend:function(e){if(this._rgba[3]===1)return this;var n=this._rgba.slice(),r=n.pop(),i=o(e)._rgba;return o(t.map(n,function(e,t){return(1-r)*i[t]+r*e}))},toRgbaString:function(){var e="rgba(",n=t.map(this._rgba,function(e,t){return e==null?t>2?1:0:e});return n[3]===1&&(n.pop(),e="rgb("),e+n.join()+")"},toHslaString:function(){var e="hsla(",n=t.map(this.hsla(),function(e,t){return e==null&&(e=t>2?1:0),t&&t<3&&(e=Math.round(e*100)+"%"),e});return n[3]===1&&(n.pop(),e="hsl("),e+n.join()+")"},toHexString:function(e){var n=this._rgba.slice(),r=n.pop();return e&&n.push(~~(r*255)),"#"+t.map(n,function(e,t){return e=(e||0).toString(16),e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),o.fn.parse.prototype=o.fn,u.hsla.to=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=e[3],s=Math.max(t,n,r),o=Math.min(t,n,r),u=s-o,a=s+o,f=a*.5,l,c;return o===s?l=0:t===s?l=60*(n-r)/u+360:n===s?l=60*(r-t)/u+120:l=60*(t-n)/u+240,f===0||f===1?c=f:f<=.5?c=u/a:c=u/(2-a),[Math.round(l)%360,c,f,i==null?1:i]},u.hsla.from=function(e){if(e[0]==null||e[1]==null||e[2]==null)return[null,null,null,e[3]];var t=e[0]/360,n=e[1],r=e[2],i=e[3],s=r<=.5?r*(1+n):r+n-r*n,o=2*r-s,u,a,f;return[Math.round(v(o,s,t+1/3)*255),Math.round(v(o,s,t)*255),Math.round(v(o,s,t-1/3)*255),i]},h(u,function(e,r){var s=r.props,u=r.cache,a=r.to,f=r.from;o.fn[e]=function(e){a&&!this[u]&&(this[u]=a(this._rgba));if(e===n)return this[u].slice();var r,i=t.type(e),l=i==="array"||i==="object"?e:arguments,c=this[u].slice();return h(s,function(e,t){var n=l[i==="object"?e:t.idx];n==null&&(n=c[t.idx]),c[t.idx]=p(n,t)}),f?(r=o(f(c)),r[u]=c,r):o(c)},h(s,function(n,r){if(o.fn[n])return;o.fn[n]=function(s){var o=t.type(s),u=n==="alpha"?this._hsla?"hsla":"rgba":e,a=this[u](),f=a[r.idx],l;return o==="undefined"?f:(o==="function"&&(s=s.call(this,f),o=t.type(s)),s==null&&r.empty?this:(o==="string"&&(l=i.exec(s),l&&(s=f+parseFloat(l[2])*(l[1]==="+"?1:-1))),a[r.idx]=s,this[u](a)))}})}),h(r,function(e,n){t.cssHooks[n]={set:function(e,r){var i,s,u="";if(t.type(r)!=="string"||(i=d(r))){r=o(i||r);if(!f.rgba&&r._rgba[3]!==1){s=n==="backgroundColor"?e.parentNode:e;while((u===""||u==="transparent")&&s&&s.style)try{u=t.css(s,"backgroundColor"),s=s.parentNode}catch(a){}r=r.blend(u&&u!=="transparent"?u:"_default")}r=r.toRgbaString()}try{e.style[n]=r}catch(r){}}},t.fx.step[n]=function(e){e.colorInit||(e.start=o(e.elem,n),e.end=o(e.end),e.colorInit=!0),t.cssHooks[n].set(e.elem,e.start.transition(e.end,e.pos))}}),t.cssHooks.borderColor={expand:function(e){var t={};return h(["Top","Right","Bottom","Left"],function(n,r){t["border"+r+"Color"]=e}),t}},c=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(){var t=this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,n={},r,i,s;if(t&&t.length&&t[0]&&t[t[0]]){s=t.length;while(s--)r=t[s],typeof t[r]=="string"&&(n[e.camelCase(r)]=t[r])}else for(r in t)typeof t[r]=="string"&&(n[r]=t[r]);return n}function s(t,n){var i={},s,o;for(s in n)o=n[s],t[s]!==o&&!r[s]&&(e.fx.step[s]||!isNaN(parseFloat(o)))&&(i[s]=o);return i}var n=["add","remove","toggle"],r={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,n){e.fx.step[n]=function(e){if(e.end!=="none"&&!e.setAttr||e.pos===1&&!e.setAttr)jQuery.style(e.elem,n,e.end),e.setAttr=!0}}),e.effects.animateClass=function(t,r,o,u){var a=e.speed(r,o,u);return this.queue(function(){var r=e(this),o=r.attr("class")||"",u,f=a.children?r.find("*").andSelf():r;f=f.map(function(){var t=e(this);return{el:t,start:i.call(this)}}),u=function(){e.each(n,function(e,n){t[n]&&r[n+"Class"](t[n])})},u(),f=f.map(function(){return this.end=i.call(this.el[0]),this.diff=s(this.start,this.end),this}),r.attr("class",o),f=f.map(function(){var t=this,n=e.Deferred(),r=jQuery.extend({},a,{queue:!1,complete:function(){n.resolve(t)}});return this.el.animate(this.diff,r),n.promise()}),e.when.apply(e,f.get()).done(function(){u(),e.each(arguments,function(){var t=this.el;e.each(this.diff,function(e){t.css(e,"")})}),a.complete.call(r[0])})})},e.fn.extend({_addClass:e.fn.addClass,addClass:function(t,n,r,i){return n?e.effects.animateClass.call(this,{add:t},n,r,i):this._addClass(t)},_removeClass:e.fn.removeClass,removeClass:function(t,n,r,i){return n?e.effects.animateClass.call(this,{remove:t},n,r,i):this._removeClass(t)},_toggleClass:e.fn.toggleClass,toggleClass:function(n,r,i,s,o){return typeof r=="boolean"||r===t?i?e.effects.animateClass.call(this,r?{add:n}:{remove:n},i,s,o):this._toggleClass(n,r):e.effects.animateClass.call(this,{toggle:n},r,i,s)},switchClass:function(t,n,r,i,s){return e.effects.animateClass.call(this,{add:n,remove:t},r,i,s)}})}(),function(){function i(n,r,i,s){e.isPlainObject(n)&&(r=n,n=n.effect),n={effect:n},r===t&&(r={}),e.isFunction(r)&&(s=r,i=null,r={});if(typeof r=="number"||e.fx.speeds[r])s=i,i=r,r={};return e.isFunction(i)&&(s=i,i=null),r&&e.extend(n,r),i=i||r.duration,n.duration=e.fx.off?0:typeof i=="number"?i:i in e.fx.speeds?e.fx.speeds[i]:e.fx.speeds._default,n.complete=s||r.complete,n}function s(t){return!t||typeof t=="number"||e.fx.speeds[t]?!0:typeof t=="string"&&!e.effects.effect[t]?n&&e.effects[t]?!1:!0:!1}e.extend(e.effects,{version:"1.9.0",save:function(e,t){for(var n=0;n<t.length;n++)t[n]!==null&&e.data(r+t[n],e[0].style[t[n]])},restore:function(e,n){var i,s;for(s=0;s<n.length;s++)n[s]!==null&&(i=e.data(r+n[s]),i===t&&(i=""),e.css(n[s],i))},setMode:function(e,t){return t==="toggle"&&(t=e.is(":hidden")?"show":"hide"),t},getBaseline:function(e,t){var n,r;switch(e[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=e[0]/t.height}switch(e[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=e[1]/t.width}return{x:r,y:n}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var n={width:t.outerWidth(!0),height:t.outerHeight(!0),"float":t.css("float")},r=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),i={width:t.width(),height:t.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return t.wrap(r),(t[0]===s||e.contains(t[0],s))&&e(s).focus(),r=t.parent(),t.css("position")==="static"?(r.css({position:"relative"}),t.css({position:"relative"})):(e.extend(n,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],function(e,r){n[r]=t.css(r),isNaN(parseInt(n[r],10))&&(n[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(i),r.css(n).show()},removeWrapper:function(t){var n=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===n||e.contains(t[0],n))&&e(n).focus()),t},setTransition:function(t,n,r,i){return i=i||{},e.each(n,function(e,n){var s=t.cssUnit(n);s[0]>0&&(i[n]=s[0]*r+s[1])}),i}}),e.fn.extend({effect:function(t,r,s,o){function h(t){function s(){e.isFunction(r)&&r.call(n[0]),e.isFunction(t)&&t()}var n=e(this),r=u.complete,i=u.mode;(n.is(":hidden")?i==="hide":i==="show")?s():l.call(n[0],u,s)}var u=i.apply(this,arguments),a=u.mode,f=u.queue,l=e.effects.effect[u.effect],c=!l&&n&&e.effects[u.effect];return e.fx.off||!l&&!c?a?this[a](u.duration,u.complete):this.each(function(){u.complete&&u.complete.call(this)}):l?f===!1?this.each(h):this.queue(f||"fx",h):c.call(this,{options:u,duration:u.duration,callback:u.complete,mode:u.mode})},_show:e.fn.show,show:function(e){if(s(e))return this._show.apply(this,arguments);var t=i.apply(this,arguments);return t.mode="show",this.effect.call(this,t)},_hide:e.fn.hide,hide:function(e){if(s(e))return this._hide.apply(this,arguments);var t=i.apply(this,arguments);return t.mode="hide",this.effect.call(this,t)},__toggle:e.fn.toggle,toggle:function(t){if(s(t)||typeof t=="boolean"||e.isFunction(t))return this.__toggle.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)},cssUnit:function(t){var n=this.css(t),r=[];return e.each(["em","px","%","pt"],function(e,t){n.indexOf(t)>0&&(r=[parseFloat(n),t])}),r}})}(),function(){var t={};e.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,n){t[n]=function(t){return Math.pow(t,e+2)}}),e.extend(t,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return e===0||e===1?e:-Math.pow(2,8*(e-1))*Math.sin(((e-1)*80-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){var t,n=4;while(e<((t=Math.pow(2,--n))-1)/11);return 1/Math.pow(4,3-n)-7.5625*Math.pow((t*3-2)/22-e,2)}}),e.each(t,function(t,n){e.easing["easeIn"+t]=n,e.easing["easeOut"+t]=function(e){return 1-n(1-e)},e.easing["easeInOut"+t]=function(e){return e<.5?n(e*2)/2:1-n(e*-2+2)/2}})}()}(jQuery),function(e,t){var n=/up|down|vertical/,r=/up|left|vertical|horizontal/;e.effects.effect.blind=function(t,i){var s=e(this),o=["position","top","bottom","left","right","height","width"],u=e.effects.setMode(s,t.mode||"hide"),a=t.direction||"up",f=n.test(a),l=f?"height":"width",c=f?"top":"left",h=r.test(a),p={},d=u==="show",v,m,g;s.parent().is(".ui-effects-wrapper")?e.effects.save(s.parent(),o):e.effects.save(s,o),s.show(),v=e.effects.createWrapper(s).css({overflow:"hidden"}),m=v[l](),g=parseFloat(v.css(c))||0,p[l]=d?m:0,h||(s.css(f?"bottom":"right",0).css(f?"top":"left","auto").css({position:"absolute"}),p[c]=d?g:m+g),d&&(v.css(l,0),h||v.css(c,g+m)),v.animate(p,{duration:t.duration,easing:t.easing,queue:!1,complete:function(){u==="hide"&&s.hide(),e.effects.restore(s,o),e.effects.removeWrapper(s),i()}})}}(jQuery),function(e,t){e.effects.effect.bounce=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=s==="hide",u=s==="show",a=t.direction||"up",f=t.distance,l=t.times||5,c=l*2+(u||o?1:0),h=t.duration/c,p=t.easing,d=a==="up"||a==="down"?"top":"left",v=a==="up"||a==="left",m,g,y,b=r.queue(),w=b.length;(u||o)&&i.push("opacity"),e.effects.save(r,i),r.show(),e.effects.createWrapper(r),f||(f=r[d==="top"?"outerHeight":"outerWidth"]()/3),u&&(y={opacity:1},y[d]=0,r.css("opacity",0).css(d,v?-f*2:f*2).animate(y,h,p)),o&&(f/=Math.pow(2,l-1)),y={},y[d]=0;for(m=0;m<l;m++)g={},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p).animate(y,h,p),f=o?f*2:f/2;o&&(g={opacity:0},g[d]=(v?"-=":"+=")+f,r.animate(g,h,p)),r.queue(function(){o&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),w>1&&b.splice.apply(b,[1,0].concat(b.splice(w,c+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.clip=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"vertical",a=u==="vertical",f=a?"height":"width",l=a?"top":"left",c={},h,p,d;e.effects.save(r,i),r.show(),h=e.effects.createWrapper(r).css({overflow:"hidden"}),p=r[0].tagName==="IMG"?h:r,d=p[f](),o&&(p.css(f,0),p.css(l,d/2)),c[f]=o?d:0,c[l]=o?0:d/2,p.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){o||r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.drop=function(t,n){var r=e(this),i=["position","top","bottom","left","right","opacity","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left"?"pos":"neg",l={opacity:o?1:0},c;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),c=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0)/2,o&&r.css("opacity",0).css(a,f==="pos"?-c:c),l[a]=(o?f==="pos"?"+=":"-=":f==="pos"?"-=":"+=")+c,r.animate(l,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.explode=function(t,n){function y(){c.push(this),c.length===r*i&&b()}function b(){s.css({visibility:"visible"}),e(c).remove(),u||s.hide(),n()}var r=t.pieces?Math.round(Math.sqrt(t.pieces)):3,i=r,s=e(this),o=e.effects.setMode(s,t.mode||"hide"
),u=o==="show",a=s.show().css("visibility","hidden").offset(),f=Math.ceil(s.outerWidth()/i),l=Math.ceil(s.outerHeight()/r),c=[],h,p,d,v,m,g;for(h=0;h<r;h++){v=a.top+h*l,g=h-(r-1)/2;for(p=0;p<i;p++)d=a.left+p*f,m=p-(i-1)/2,s.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-p*f,top:-h*l}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:f,height:l,left:d+(u?m*f:0),top:v+(u?g*l:0),opacity:u?0:1}).animate({left:d+(u?0:m*f),top:v+(u?0:g*l),opacity:u?1:0},t.duration||500,t.easing,y)}}}(jQuery),function(e,t){e.effects.effect.fade=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"toggle");r.animate({opacity:i},{queue:!1,duration:t.duration,easing:t.easing,complete:n})}}(jQuery),function(e,t){e.effects.effect.fold=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"hide"),o=s==="show",u=s==="hide",a=t.size||15,f=/([0-9]+)%/.exec(a),l=!!t.horizFirst,c=o!==l,h=c?["width","height"]:["height","width"],p=t.duration/2,d,v,m={},g={};e.effects.save(r,i),r.show(),d=e.effects.createWrapper(r).css({overflow:"hidden"}),v=c?[d.width(),d.height()]:[d.height(),d.width()],f&&(a=parseInt(f[1],10)/100*v[u?0:1]),o&&d.css(l?{height:0,width:a}:{height:a,width:0}),m[h[0]]=o?v[0]:a,g[h[1]]=o?v[1]:0,d.animate(m,p,t.easing).animate(g,p,t.easing,function(){u&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()})}}(jQuery),function(e,t){e.effects.effect.highlight=function(t,n){var r=e(this),i=["backgroundImage","backgroundColor","opacity"],s=e.effects.setMode(r,t.mode||"show"),o={backgroundColor:r.css("backgroundColor")};s==="hide"&&(o.opacity=0),e.effects.save(r,i),r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),n()}})}}(jQuery),function(e,t){e.effects.effect.pulsate=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"show"),s=i==="show",o=i==="hide",u=s||i==="hide",a=(t.times||5)*2+(u?1:0),f=t.duration/a,l=0,c=r.queue(),h=c.length,p;if(s||!r.is(":visible"))r.css("opacity",0).show(),l=1;for(p=1;p<a;p++)r.animate({opacity:l},f,t.easing),l=1-l;r.animate({opacity:l},f,t.easing),r.queue(function(){o&&r.hide(),n()}),h>1&&c.splice.apply(c,[1,0].concat(c.splice(h,a+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.puff=function(t,n){var r=e(this),i=e.effects.setMode(r,t.mode||"hide"),s=i==="hide",o=parseInt(t.percent,10)||150,u=o/100,a={height:r.height(),width:r.width()};e.extend(t,{effect:"scale",queue:!1,fade:!0,mode:i,complete:n,percent:s?o:100,from:s?a:{height:a.height*u,width:a.width*u}}),r.effect(t)},e.effects.effect.scale=function(t,n){var r=e(this),i=e.extend(!0,{},t),s=e.effects.setMode(r,t.mode||"effect"),o=parseInt(t.percent,10)||(parseInt(t.percent,10)===0?0:s==="hide"?0:100),u=t.direction||"both",a=t.origin,f={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},l={y:u!=="horizontal"?o/100:1,x:u!=="vertical"?o/100:1};i.effect="size",i.queue=!1,i.complete=n,s!=="effect"&&(i.origin=a||["middle","center"],i.restore=!0),i.from=t.from||(s==="show"?{height:0,width:0}:f),i.to={height:f.height*l.y,width:f.width*l.x,outerHeight:f.outerHeight*l.y,outerWidth:f.outerWidth*l.x},i.fade&&(s==="show"&&(i.from.opacity=0,i.to.opacity=1),s==="hide"&&(i.from.opacity=1,i.to.opacity=0)),r.effect(i)},e.effects.effect.size=function(t,n){var r=e(this),i=["position","top","bottom","left","right","width","height","overflow","opacity"],s=["position","top","bottom","left","right","overflow","opacity"],o=["width","height","overflow"],u=["fontSize"],a=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],f=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],l=e.effects.setMode(r,t.mode||"effect"),c=t.restore||l!=="effect",h=t.scale||"both",p=t.origin||["middle","center"],d,v,m,g=r.css("position");l==="show"&&r.show(),d={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()},r.from=t.from||d,r.to=t.to||d,m={from:{y:r.from.height/d.height,x:r.from.width/d.width},to:{y:r.to.height/d.height,x:r.to.width/d.width}};if(h==="box"||h==="both")m.from.y!==m.to.y&&(i=i.concat(a),r.from=e.effects.setTransition(r,a,m.from.y,r.from),r.to=e.effects.setTransition(r,a,m.to.y,r.to)),m.from.x!==m.to.x&&(i=i.concat(f),r.from=e.effects.setTransition(r,f,m.from.x,r.from),r.to=e.effects.setTransition(r,f,m.to.x,r.to));(h==="content"||h==="both")&&m.from.y!==m.to.y&&(i=i.concat(u),r.from=e.effects.setTransition(r,u,m.from.y,r.from),r.to=e.effects.setTransition(r,u,m.to.y,r.to)),e.effects.save(r,c?i:s),r.show(),e.effects.createWrapper(r),r.css("overflow","hidden").css(r.from),p&&(v=e.effects.getBaseline(p,d),r.from.top=(d.outerHeight-r.outerHeight())*v.y,r.from.left=(d.outerWidth-r.outerWidth())*v.x,r.to.top=(d.outerHeight-r.to.outerHeight)*v.y,r.to.left=(d.outerWidth-r.to.outerWidth)*v.x),r.css(r.from);if(h==="content"||h==="both")a=a.concat(["marginTop","marginBottom"]).concat(u),f=f.concat(["marginLeft","marginRight"]),o=i.concat(a).concat(f),r.find("*[width]").each(function(){var n=e(this),r={height:n.height(),width:n.width()};c&&e.effects.save(n,o),n.from={height:r.height*m.from.y,width:r.width*m.from.x},n.to={height:r.height*m.to.y,width:r.width*m.to.x},m.from.y!==m.to.y&&(n.from=e.effects.setTransition(n,a,m.from.y,n.from),n.to=e.effects.setTransition(n,a,m.to.y,n.to)),m.from.x!==m.to.x&&(n.from=e.effects.setTransition(n,f,m.from.x,n.from),n.to=e.effects.setTransition(n,f,m.to.x,n.to)),n.css(n.from),n.animate(n.to,t.duration,t.easing,function(){c&&e.effects.restore(n,o)})});r.animate(r.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){r.to.opacity===0&&r.css("opacity",r.from.opacity),l==="hide"&&r.hide(),e.effects.restore(r,c?i:s),c||(g==="static"?r.css({position:"relative",top:r.to.top,left:r.to.left}):e.each(["top","left"],function(e,t){r.css(t,function(t,n){var i=parseInt(n,10),s=e?r.to.left:r.to.top;return n==="auto"?s+"px":i+s+"px"})})),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.shake=function(t,n){var r=e(this),i=["position","top","bottom","left","right","height","width"],s=e.effects.setMode(r,t.mode||"effect"),o=t.direction||"left",u=t.distance||20,a=t.times||3,f=a*2+1,l=Math.round(t.duration/f),c=o==="up"||o==="down"?"top":"left",h=o==="up"||o==="left",p={},d={},v={},m,g=r.queue(),y=g.length;e.effects.save(r,i),r.show(),e.effects.createWrapper(r),p[c]=(h?"-=":"+=")+u,d[c]=(h?"+=":"-=")+u*2,v[c]=(h?"-=":"+=")+u*2,r.animate(p,l,t.easing);for(m=1;m<a;m++)r.animate(d,l,t.easing).animate(v,l,t.easing);r.animate(d,l,t.easing).animate(p,l/2,t.easing).queue(function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}),y>1&&g.splice.apply(g,[1,0].concat(g.splice(y,f+1))),r.dequeue()}}(jQuery),function(e,t){e.effects.effect.slide=function(t,n){var r=e(this),i=["position","top","bottom","left","right","width","height"],s=e.effects.setMode(r,t.mode||"show"),o=s==="show",u=t.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left",l,c={};e.effects.save(r,i),r.show(),l=t.distance||r[a==="top"?"outerHeight":"outerWidth"](!0),e.effects.createWrapper(r).css({overflow:"hidden"}),o&&r.css(a,f?isNaN(l)?"-"+l:-l:l),c[a]=(o?f?"+=":"-=":f?"-=":"+=")+l,r.animate(c,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){s==="hide"&&r.hide(),e.effects.restore(r,i),e.effects.removeWrapper(r),n()}})}}(jQuery),function(e,t){e.effects.effect.transfer=function(t,n){var r=e(this),i=e(t.to),s=i.css("position")==="fixed",o=e("body"),u=s?o.scrollTop():0,a=s?o.scrollLeft():0,f=i.offset(),l={top:f.top-u,left:f.left-a,height:i.innerHeight(),width:i.innerWidth()},c=r.offset(),h=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(t.className).css({top:c.top-u,left:c.left-a,height:r.innerHeight(),width:r.innerWidth(),position:s?"fixed":"absolute"}).animate(l,t.duration,t.easing,function(){h.remove(),n()})}}(jQuery)}),define("ui/subguarded",["aloha/core","jquery","PubSub"],function(e,t,n){function o(e){return e.alohaUid||(e.alohaUid=++r),e.alohaUid}function u(e){return s[e]||[]}function a(e){return i[e.alohaUid]||[]}function f(e,t){return i[e.alohaUid]||(i[e.alohaUid]=[]),i[e.alohaUid].push(t),i[e.alohaUid]}function l(e,t){return s[e]||(s[e]=[]),s[e].push(t),s[e]}function c(e){var t=u(e),n;for(n=0;n<t.length;n++)t[n].apply(null,[a(t[n])].concat(arguments))}function h(){var t=Array.prototype.slice.call(arguments),r=t.shift();typeof r=="string"&&(r=[r]);var i=t.shift();o(i),f(i,t);var s,u,a=function(e,t,n){c(u,e,t,n)},h=function(){c(u)};for(s=0;s<r.length;s++)u=r[s],l(u,i),e.bind(u,a),n.sub(u,h)}var r=0,i={},s={};return h}),define("vendor/amplify.store",["util/json2"],function(){var e={};return function(e,t){function i(e,i){n.addType(e,function(s,o,u){var a,f,l,c,h=o,p=(new Date).getTime();if(!s){h={},c=[],l=0;try{s=i.length;while(s=i.key(l++))r.test(s)&&(f=JSON.parse(i.getItem(s)),f.expires&&f.expires<=p?c.push(s):h[s.replace(r,"")]=f.data);while(s=c.pop())i.removeItem(s)}catch(d){}return h}s="__amplify__"+s;if(o===t){a=i.getItem(s),f=a?JSON.parse(a):{expires:-1};if(!(f.expires&&f.expires<=p))return f.data;i.removeItem(s)}else if(o===null)i.removeItem(s);else{f=JSON.stringify({data:o,expires:u.expires?p+u.expires:null});try{i.setItem(s,f)}catch(d){n[e]();try{i.setItem(s,f)}catch(d){throw n.error()}}}return h})}var n=e.store=function(e,t,r,i){var i=n.type;return r&&r.type&&r.type in n.types&&(i=r.type),n.types[i](e,t,r||{})};n.types={},n.type=null,n.addType=function(e,t){n.type||(n.type=e),n.types[e]=t,n[e]=function(t,r,i){return i=i||{},i.type=e,n(t,r,i)}},n.error=function(){return"amplify.store quota exceeded"};var r=/^__amplify__/;for(var s in{localStorage:1,sessionStorage:1})try{window[s].getItem&&i(s,window[s])}catch(o){}if(window.globalStorage)try{i("globalStorage",window.globalStorage[window.location.hostname]),n.type==="sessionStorage"&&(n.type="globalStorage")}catch(o){}(function(){if(n.types.localStorage)return;var e=document.createElement("div"),r="amplify";e.style.display="none",document.getElementsByTagName("head")[0].appendChild(e);try{e.addBehavior("#default#userdata"),e.load(r)}catch(i){e.parentNode.removeChild(e);return}n.addType("userData",function(i,s,o){e.load(r);var u,a,f,l,c,h=s,p=(new Date).getTime();if(!i){h={},c=[],l=0;while(u=e.XMLDocument.documentElement.attributes[l++])a=JSON.parse(u.value),a.expires&&a.expires<=p?c.push(u.name):h[u.name]=a.data;while(i=c.pop())e.removeAttribute(i);return e.save(r),h}i=i.replace(/[^-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u37f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-");if(s===t){u=e.getAttribute(i),a=u?JSON.parse(u):{expires:-1};if(!(a.expires&&a.expires<=p))return a.data;e.removeAttribute(i)}else s===null?e.removeAttribute(i):(f=e.getAttribute(i),a=JSON.stringify({data:s,expires:o.expires?p+o.expires:null}),e.setAttribute(i,a));try{e.save(r)}catch(d){f===null?e.removeAttribute(i):e.setAttribute(i,f),n.userData();try{e.setAttribute(i,a),e.save(r)}catch(d){throw f===null?e.removeAttribute(i):e.setAttribute(i,f),n.error()}}return h})})(),function(){function i(e){return e===t?t:JSON.parse(JSON.stringify(e))}var e={},r={};n.addType("memory",function(n,s,o){return n?s===t?i(e[n]):(r[n]&&(clearTimeout(r[n]),delete r[n]),s===null?(delete e[n],null):(e[n]=s,o.expires&&(r[n]=setTimeout(function(){delete e[n],delete r[n]},o.expires)),s)):i(e)})}()}(e),e}),define("ui/floating",["jquery","aloha/core","ui/surface","ui/subguarded","vendor/amplify.store"],function(e,t,n,r,i){function a(e,t,n,r){e.stop().animate(t,n,function(){r(t)})}function f(e,t,n,r){t.top-=e.height()+s,a(e,t,n,r)}function l(e,t,n,r){t.top+=s,a(e,t,n,r)}function c(e){i.store("Aloha.FloatingMenu.pinned","true"),i.store("Aloha.FloatingMenu.top",e.top),i.store("Aloha.FloatingMenu.left",e.left)}function h(){i.store("Aloha.FloatingMenu.pinned",null),i.store("Aloha.FloatingMenu.top",null),i.store("Aloha.FloatingMenu.left",null)}function p(){var e={};return i.store("Aloha.FloatingMenu.pinned")==="true"?{top:parseInt(i.store("Aloha.FloatingMenu.top"),10),left:parseInt(i.store("Aloha.FloatingMenu.left"),10),isPinned:!0}:{top:null,left:null,isPinned:!1}}function d(e){var t=e.left,n=e.top;return n<0?n=0:n>u.height()&&(n=u.height()/2),t<0?t=0:t>u.width()&&(t=u.width()/2),{top:n,left:t}}function v(t,n,r,i){typeof r!="number"&&(r=o);var a=(parseInt(e("body").css("marginTop"),10)||0)+(parseInt(e("body").css("paddingTop"),10)||0),c=t.$element,h=c.offset(),p=n.obj.offset(),d=u.scrollTop(),v=p.top-d-a,m=p.left,g=m+c.width()-u.width()-s;g>0&&(m-=g),v>=c.height()?(p.top-=d,f(c,p,r,i)):v+c.height()>p.top+n.obj.height()?l(c,{top:p.top+n.obj.height(),left:m},r,i):l(c,{top:a,left:m},r,i)}function m(e,t,n){var r=e.$element;n?(h(),r.find(".aloha-ui-pin").removeClass("aloha-ui-pin-down")):(c(t),r.find(".aloha-ui-pin").addClass("aloha-ui-pin-down")),r.css({position:"fixed",top:t.top})}function g(e,t,n,r,i){var s;for(s=0;s<e.length;s++)e[s][0].isActive()&&e[s][1](n,r,i)}function y(t,n){r(["aloha-selection-changed","aloha.ui.container.selected"],g,t,function(){t._move()});var i=function(){var e=d({top:n.pinTop,left:n.pinLeft});n.setFloatingPosition(e),t.$element.css({top:e.top,left:e.left})};u.scroll(function(){t._move(0)}),u.resize(function(){n.isFloatingMode||i()}),t.addPin();if(e.browser.msie){var s=t.$element.parent();t.$element.appendTo("body"),t.$element.css("position","fixed"),s.length?t.$element.appendTo(s):t.$element.detach()}else t.$element.css("position","fixed");n.isFloatingMode||i(),t.$element.css("z-index",10100).draggable({distance:20,stop:function(e,t){n.setFloatingPosition(t.position),n.isFloatingMode||c(t.position)}})}var s=10,o=500,u=e(window);return{getPinState:p,makeFloating:y,floatSurface:v,togglePinSurface:m}}),function(){function t(e,t,n,r,i,s){t[e]&&(n.push(e),(t[e]===!0||t[e]===1)&&r.push(i+e+"/"+s))}function n(e,t,n,r,i){var s=r+t+"/"+i;require._fileExists(e.toUrl(s))&&n.push(s)}function r(e,t,n){var i;for(i in t)t.hasOwnProperty(i)&&(!e.hasOwnProperty(i)||n)?e[i]=t[i]:typeof t[i]=="object"&&r(e[i],t[i],n)}var e=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(i){var s=i.config();return{version:"2.0.1",load:function(i,o,u,a){a=a||{},a.locale&&(s.locale=a.locale);var f,l=e.exec(i),c=l[1],h=l[4],p=l[5],d=h.split("-"),v=[],m={},g,y,b="";l[5]?(c=l[1],f=c+p):(f=i,p=l[4],h=s.locale,h||(h=s.locale=typeof navigator=="undefined"?"root":(navigator.language||navigator.userLanguage||"root").toLowerCase()),d=h.split("-"));if(a.isBuild){v.push(f),n(o,"root",v,c,p);for(g=0;g<d.length;g++)y=d[g],b+=(b?"-":"")+y,n(o,b,v,c,p);o(v,function(){u()})}else o([f],function(e){var n=[],i;t("root",e,n,v,c,p);for(g=0;g<d.length;g++)i=d[g],b+=(b?"-":"")+i,t(b,e,n,v,c,p);o(v,function(){var t,i,s;for(t=n.length-1;t>-1&&n[t];t--){s=n[t],i=e[s];if(i===!0||i===1)i=o(c+s+"/"+p);r(m,i)}m.t=function(e,t){return this[e]?this[e]:t?t:e},u(m)})})}}})}(),define("ui/nls/i18n",{root:{"button.bold.label":"Bold","button.italic.label":"Italic","button.strikethrough.label":"Strikethrough","button.subscript.label":"Subscript","button.superscript.label":"Superscript","button.underline.label":"Underline","button.p.label":"Paragraph","button.h1.label":"Heading 1","button.h2.label":"Heading 2","button.h3.label":"Heading 3","button.h4.label":"Heading 4","button.h5.label":"Heading 5","button.h6.label":"Heading 6","button.pre.label":"Preformatted text","button.removeFormatting.label":"Remove formatting","button.ol.label":"Insert ordered list","button.ul.label":"Insert unordered list","button.indent.label":"Indent list","button.outdent.label":"Outdent list","button.createLink.label":"Insert link","button.removeLink.label":"Remove link","button.createAbbr.label":"Insert abbreviation","button.characterPicker.label":"Pick special characters","button.justifyLeft.label":"Align to the left","button.justifyRight.label":"Align to the right","button.justifyCenter.label":"Center","button.justifyFull.label":"Justify","button.horizontalRule.label":"Insert horizontal rule","button.createLanguageAnnotation.label":"Insert language annotation","button.metaview.label":"Switch between meta and normal view","button.quote.label":"Format selection as quote","button.blockquote.label":"Format selection as blockquote","tab.format.label":"Format","tab.insert.label":"Insert","tab.abbr.label":"Abbreviation","tab.img.label":"Image","tab.link.label":"Link","tab.list.label":"List","tab.table.label":"Table","tab.col.label":"Table Column","tab.row.label":"Table Row","tab.cell.label":"Table Cell","tab.wai-lang.label":"Language annotation"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("ui/settings",["jquery","util/arrays","util/maps","util/trees"],function(e,t,n,r){function s(r,i,s){function c(t){return"array"===e.type(t)?!t.length:l[t]}var f=n.fillTuples({},t.map(i,function(e){return[e.label,e]})),l=a(r,s);return r=u(r,f,c),i=o(i,l,c),r.concat(i)}function o(t,n,i){var s,o,u=[],a,f;for(s=0;s<t.length;s++)a=t[s],n[a.label]||(f=r.postprune(a.components,i),f&&(o=e.extend({},a),o.components=f,u.push(o)));return u}function u(t,n,i){var s,o,u=[],a,f,l,c;for(s=0;s<t.length;s++)a=t[s],f=a.components||[],l=n[a.label],!a.exclusive&&l&&(c=r.postprune(l.components,i),c&&(f=f.concat(c))),o=e.extend({},l||{},a),o.components=f,u.push(o);return u}function a(e,t){var i,s=n.fillKeys({},t,!0);for(i=0;i<e.length;i++)s[e[i].label]=!0,n.fillKeys(s,r.flatten(e[i].components),!0);return s}var i={tabs:[{label:"tab.format.label",showOn:{scope:"Aloha.continuoustext"},components:[["bold","strong","italic","emphasis","\n","subscript","superscript","strikethrough","quote"],["formatLink","formatAbbr","formatNumeratedHeaders","toggleDragDrop","\n","toggleMetaView","wailang","toggleFormatlessPaste"],["alignLeft","alignCenter","alignRight","alignJustify","\n","orderedList","unorderedList","indentList","outdentList"],["formatBlock"]]},{label:"tab.insert.label",showOn:{scope:"Aloha.continuoustext"},components:[["createTable","characterPicker","insertLink","insertImage","insertAbbr","insertToc","insertHorizontalRule","insertTag"]]},{label:"tab.link.label",showOn:{scope:"link"},components:["editLink","removeLink","linkBrowser"]},{label:"tab.img.label",showOn:{scope:"image"},components:[["imageSource","\n","imageTitle"],["imageResizeWidth","\n","imageResizeHeight"],["imageAlignLeft","imageAlignRight","imageAlignNone","imageIncPadding","\n","imageCropButton","imageCnrReset","imageCnrRatio","imageDecPadding"],["imageBrowser"]]},{label:"tab.abbr.label",showOn:{scope:"abbr"},components:[["abbrText","removeAbbr"]]},{label:"tab.wai-lang.label",showOn:{scope:"wai-lang"},components:[["wailangfield","removewailang"]]},{label:"tab.table.label",showOn:{scope:"table.cell"},components:[["mergecells","splitcells","tableCaption","tableSummary","formatTable"]]},{label:"tab.col.label",showOn:{scope:"table.column"},components:[["addcolumnleft","addcolumnright","deletecolumns","columnheader","mergecellsColumn","splitcellsColumn","formatColumn"]]},{label:"tab.row.label",showOn:{scope:"table.row"},components:[["addrowbefore","addrowafter","deleterows","rowheader","mergecellsRow","splitcellsRow","formatRow"]]},{label:"tab.cell.label",showOn:{scope:"table.cell"},components:[["alignTop","alignMiddle","alignBottom","formatCell"]]}]};return{defaultToolbarSettings:i,combineToolbarSettings:s}}),define("ui/ui-plugin",["jquery","aloha","ui/context","ui/container","ui/surface","ui/toolbar","ui/scopes","ui/settings","PubSub","jqueryui"],function(e,t,n,r,i,s,o,u,a){function c(){var e=t.settings.toolbar,n=u.defaultToolbarSettings;return e?u.combineToolbarSettings(e.tabs||[],n.tabs,e.exclude||[]):n.tabs}function h(){var t=l._tabs,n=o.getPrimaryScope(),r,i;for(i=0;i<t.length;i++){r=t[i].settings;if("object"===e.type(r.showOn)&&r.showOn.scope===n){t[i].tab.foreground();break}}}function p(e,t){return l.adoptInto(e,t)}function d(e){i.show(f),r.showContainersForContext(f,e)}var f=new n,l=new s(f,c());return t.bind("aloha-editable-activated",function(e,t){i.show(f),r.showContainersForContext(f,e)}),t.bind("aloha-editable-deactivated",function(e,t){i.suppressHide||i.hide(f)}),a.sub("aloha.ui.scope.change",function(){r.showContainersForContext(f),h(o.getPrimaryScope())}),{adoptInto:p,showToolbar:d}}),define("ui/ui",["jquery","ui/ui-plugin"],function(e,t){function r(r,i,s){var o,u;return"string"!==e.type(r)?(s=i,i=r,r=s.name):s=e.extend({name:r},s),i.isInstance?u=i:(o=s?i.extend(s):i,u=new o),n[r]=u,t.adoptInto(r,u),u}function i(e){return n[e]||null}var n={};return{adopt:r,getAdoptedComponent:i}}),define("ui/vendor/jquery-ui-autocomplete-html",["jquery","jqueryui"],function(e){(function(e){function r(t,n){var r=new RegExp(e.ui.autocomplete.escapeRegex(n),"i");return e.grep(t,function(t){return r.test(e("<div>").html(t.label||t.value||t).text())})}var t=e.ui.autocomplete.prototype,n=t._initSource;e.extend(t,{_initSource:function(){this.options.html&&e.isArray(this.options.source)?this.source=function(e,t){t(r(this.options.source,e.term))}:n.call(this)},_renderItem:function(t,n){return e("<li></li>").data("item.autocomplete",n).append(e("<a></a>")[this.options.html?"html":"text"](n.label)).appendTo(t)}})})(e)}),define("ui/port-helper-attribute-field",["jquery","ui/ui","ui/component","ui/scopes","ui/context","ui/utils","aloha/repositorymanager","aloha/selection","aloha/console","ui/vendor/jquery-ui-autocomplete-html"],function(e,t,n,r,i,s,o,u,a){var f=function(r){function E(e,t){t.item&&B(t.item.obj),C()}function S(){C()}function x(t,n){if(!e(t.target).is(":visible"))return;k(),P()===c&&H("")}function T(e){(e.keyCode==13||e.keyCode==27)&&e.preventDefault()}function N(e){m&&g!==P()&&(m=null,g=null),m||F(b,P());if(e.keyCode==13||e.keyCode==27)u.getRangeObject().select(),C()}function C(){L();if(!y||w===e(y).attr(b))return;m||o.markObject(y),P()===""&&O()}function k(){if(h)return;L();var t=e(y);t&&t.context&&t.context.style&&t.context.style["background-color"]&&t.attr("data-original-background-color",t.context.style["background-color"]),t.css("background-color","#80B5F2")}function L(){if(h)return;var t=e(y),n=t.attr("data-original-background-color");n?t.css("background-color",n):t.css("background-color",""),t.removeAttr("data-original-background-color")}function A(e,t){return e.replace(/\{([^}]+)\}/g,function(e,n){return n in t?t[n]:""})}function O(){if(null==c)return;p.css("color","#AAA"),p.val(c)}function M(e){v=e}function _(e){l=e}function D(t,n){p.bind(t,e.proxy(n,K))}function P(){return p.val()}function H(e){p.val(e),p.css("color","black")}function B(e){m=e;if(e){var t=e[f];H(t),g=t,F(b,e[a]),o.markObject(y,e)}else g=null}function j(){return m}function F(t,n,r,i){if(y){var s=!0;if(typeof i!="undefined"){var o=new RegExp(r);i.match(o)||(s=!1)}s?e(y).attr(t,n):e(y).removeAttr(t)}}function I(t,n){y=t,b=n,B(null);if(!t||!n){H("");return}w=e(t).attr(n),H(e(y).attr(b)),o.getObject(t,function(e){e&&e.length>0&&B(e[0])})}function q(){return y}function R(){d.focus(),p.focus()}function U(){d.foreground()}function z(){p.show()}function W(){p.hide()}function X(){return p.attr("id")}function V(){return!0}function J(){return p[0]}var a=r.valueField||"id",f=r.displayField||"name",l=r.objectTypeFilter||["all"],c=r.placeholder,h=!!r.noTargetHighlight,p=r.element?e(r.element):e('<input id="aloha-attribute-field-'+r.name+'">'),d,v,m,g,y,b,w;r.cls&&p.addClass(r.cls),r.width&&p.width(r.width),d=t.adopt(r.name,n,{scope:r.scope,init:function(){r.element?this.element=p:r.label?(this.element=s.wrapWithLabel(r.label,p),r.labelClass&&this.element.addClass(r.labelClass)):this.element=e("<span>").append(p),p.autocomplete({html:!0,appendTo:i.selector,source:function(t,n){o.query({queryString:t.term,objectTypeFilter:l},function(t){n(e.map(t.items,function(e){return{label:A(v,e),value:e.name,obj:e}}))})},select:E})}}),p.bind("focus",x).bind("blur",S).bind("keydown",T).bind("keyup",N),O();var K={getInputElem:J,hasInputElem:V,getInputId:X,hide:W,show:z,foreground:U,focus:R,getTargetObject:q,setTargetObject:I,setAttribute:F,getItem:j,setItem:B,setValue:H,getValue:P,addListener:D,setObjectTypeFilter:_,setTemplate:M,setPlaceholder:O};return K};return f}),define("ui/button",["jquery","ui/component","ui/utils","jqueryui"],function(e,t,n){var r=t.extend({init:function(){this._super(),this.createButtonElement(),n.makeButton(this.buttonElement,this).button("widget").tooltip({tooltipClass:"aloha aloha-ui-tooltip",position:{my:"left top",at:"right bottom"}}).click(e.proxy(function(){this.buttonElement.tooltip("close",null,!0),this._onClick()},this))},_onClick:function(){this.click()},click:function(){},createButtonElement:function(){var e=n.makeButtonElement();return this["class"]&&e.addClass(this["class"]),this.element=this.buttonElement=e,e},disable:function(){this.element.button("option","disabled",!1)},enable:function(e){this.element.button("option","disabled",e===!1)}});return r}),define("ui/toggleButton",["jquery","ui/button","jqueryui"],function(e,t){var n=0,r=t.extend({_checked:!1,setState:function(e){if(this._checked===e)return;this._checked=e,e?this.element.addClass("aloha-button-active"):this.element.removeClass("aloha-button-active")},getState:function(){return this._checked},_onClick:function(){this.setState(!this._checked),this.click()}});return r}),define("link/nls/i18n",{root:{"button.addlink.tooltip":"Insert Link","button.removelink.tooltip":"Remove Link","newlink.defaulttext":"New Link","floatingmenu.tab.link":"Link","link.target.self":"Self","link.target.blank":"Blank","link.target.parent":"Parent","link.target.top":"Top","link.target.framename":"Framename","link.target.legend":"Target","link.title.legend":"Title",insertLink:"ctrl+k"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("aloha/nls/i18n",{root:{"plugin.abbr.floatingmenu.tab.abbr":"Abbreviation","floatingmenu.tab.format":"Format","floatingmenu.tab.insert":"Insert",yes:"Yes",no:"No",cancel:"Cancel","repository.no_item_found":"No item found.","repository.loading":"Loading","repository.no_items_found_yet":"No items found yet..."},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("link/link-plugin",["aloha","aloha/plugin","aloha/ephemera","jquery","ui/port-helper-attribute-field","ui/ui","ui/scopes","ui/surface","ui/button","ui/toggleButton","i18n!link/nls/i18n","i18n!aloha/nls/i18n","aloha/console"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){function g(t,n){var i,s=!1;return!t.ignoreNextSelectionChangedEvent&&e.Selection.isSelectionEditable()&&e.activeEditable!=null?(i=t.findLinkMarkup(n),i?(t.toggleLinkScope(!0),t.hrefField.setTargetObject(i,"href"),r("#"+t.hrefField.getInputId()).length==0&&(t.hrefUpdateInt!==null&&clearInterval(t.hrefUpdateInt),t.hrefUpdateInt=setInterval(function(){r("#"+t.hrefField.getInputId()).length>0&&(t.hrefField.setTargetObject(i,"href"),clearInterval(t.hrefUpdateInt))},200)),e.trigger("aloha-link-selected"),s=!0):(t.toggleLinkScope(!1),t.hrefField.setTargetObject(null),e.trigger("aloha-link-unselected"))):t.toggleLinkScope(!1),t.ignoreNextSelectionChangedEvent=!1,s}var p=window.GENTICS,d="aloha-link",v="",m;return n.classes("aloha-link-pointer","aloha-link-text"),t.create("link",{config:["a"],targetregex:"",target:"",cssclassregex:null,cssclass:"",objectTypeFilter:[],onHrefChange:null,ignoreNextSelectionChangedEvent:!1,hrefUpdateInt:null,hotKey:{insertLink:l.t("insertLink","ctrl+k")},hrefValue:"http://",init:function(){var t=this;typeof this.settings.targetregex!="undefined"&&(this.targetregex=this.settings.targetregex),typeof this.settings.target!="undefined"&&(this.target=this.settings.target),typeof this.settings.cssclassregex!="undefined"&&(this.cssclassregex=this.settings.cssclassregex),typeof this.settings.cssclass!="undefined"&&(this.cssclass=this.settings.cssclass),typeof this.settings.objectTypeFilter!="undefined"&&(this.objectTypeFilter=this.settings.objectTypeFilter),typeof this.settings.onHrefChange!="undefined"&&(this.onHrefChange=this.settings.onHrefChange),typeof this.settings.hotKey!="undefined"&&r.extend(!0,this.hotKey,this.settings.hotKey),typeof this.settings.hrefValue!="undefined"&&(this.hrefValue=this.settings.hrefValue),this.createButtons(),this.subscribeEvents(),this.bindInteractions(),e.ready(function(){t.initSidebar(e.Sidebar.right)})},nsSel:function(){var e=[],t=d;return r.each(arguments,function(){e.push("."+(this==""?t:t+"-"+this))}),r.trim(e.join(" "))},nsClass:function(){var e=[],t=d;return r.each(arguments,function(){e.push(this==""?t:t+"-"+this)}),r.trim(e.join(" "))},initSidebar:function(e){var t=this;t.sidebar=e,e.addPanel({id:t.nsClass("sidebar-panel-target"),title:l.t("floatingmenu.tab.link"),content:"",expanded:!0,activeOn:"a, link",onInit:function(){var e=this,n=this.setContent('<div class="'+t.nsClass("target-container")+'"><fieldset><legend>'+l.t("link.target.legend")+'</legend><ul><li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_self" /><span>'+l.t("link.target.self")+"</span></li>"+'<li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_blank" /><span>'+l.t("link.target.blank")+"</span></li>"+'<li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_parent" /><span>'+l.t("link.target.parent")+"</span></li>"+'<li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="_top" /><span>'+l.t("link.target.top")+"</span></li>"+'<li><input type="radio" name="targetGroup" class="'+t.nsClass("radioTarget")+'" value="framename" /><span>'+l.t("link.target.framename")+"</span></li>"+'<li><input type="text" class="'+t.nsClass("framename")+'" /></li></ul></fieldset></div>'+'<div class="'+t.nsClass("title-container")+'" ><fieldset><legend>'+l.t("link.title.legend")+'</legend><input type="text" class="'+t.nsClass("linkTitle")+'" /></fieldset></div>').content;r(t.nsSel("framename")).live("keyup",function(){r(e.effective).attr("target",r(this).val().replace('"',"&quot;").replace("'","&#39;"))}),r(t.nsSel("radioTarget")).live("change",function(){r(this).val()=="framename"?r(t.nsSel("framename")).slideDown():(r(t.nsSel("framename")).slideUp().val(""),r(e.effective).attr("target",r(this).val()))}),r(t.nsSel("linkTitle")).live("keyup",function(){r(e.effective).attr("title",r(this).val().replace('"',"&quot;").replace("'","&#39;"))})},onActivate:function(e){var n=this;n.effective=e;if(r(n.effective).attr("target")!=null){var i=!0;r(t.nsSel("framename")).hide().val(""),r(t.nsSel("radioTarget")).each(function(){r(this).removeAttr("checked"),r(this).val()===r(n.effective).attr("target")&&(i=!1,r(this).attr("checked","checked"))}),i&&(r(t.nsSel('radioTarget[value="framename"]')).attr("checked","checked"),r(t.nsSel("framename")).val(r(n.effective).attr("target")).show())}else r(t.nsSel("radioTarget")).first().attr("checked","checked"),r(n.effective).attr("target",r(t.nsSel("radioTarget")).first().val());var n=this;n.effective=e,r(t.nsSel("linkTitle")).val(r(n.effective).attr("title"))}}),e.show()},subscribeEvents:function(){var t=this,n={};e.bind("aloha-editable-created",function(e,i){var s=t.getEditableConfig(i.obj),o=r.inArray("a",s)!==-1;n[i.getId()]=o;if(!o)return;i.obj.bind("keydown",t.hotKey.insertLink,function(){return t.findLinkMarkup()?(t.hrefField.foreground(),t.hrefField.focus()):t.insertLink(!0),!1}),i.obj.find("a").each(function(){t.addLinkEventHandlers(this)})}),e.bind("aloha-editable-activated",function(){n[e.activeEditable.getId()]?(t._formatLinkButton.show(),t._insertLinkButton.show()):(t._formatLinkButton.hide(),t._insertLinkButton.hide())});var i=!1;e.bind("aloha-selection-changed",function(r,s){var o=!1;e.activeEditable&&n[e.activeEditable.getId()]&&(o=g(t,s),o&&i!==o&&t.hrefField.foreground()),i=o});var s=this;e.bind("aloha-editable-deactivated",function(){i&&(setTimeout(function(){i||s.toggleLinkScope(!1)},100),i=!1)})},toggleLinkScope:function(t){if(this._isScopeActive===t&&e.activeEditable&&this._isScopeActive_editableId===e.activeEditable.getId())return;this._isScopeActive=t,this._isScopeActive_editableId=e.activeEditable&&e.activeEditable.getId(),t?(this.hrefField.show(),this._insertLinkButton.hide(),e.activeEditable&&e.activeEditable.obj[0].nodeName==="A"?this._removeLinkButton.hide():this._removeLinkButton.show(),this._formatLinkButton.setState(!0),o.enterScope(this.name,"link")):(this.hrefField.hide(),this._insertLinkButton.show(),this._removeLinkButton.hide(),this._formatLinkButton.setState(!1),o.leaveScope(this.name,"link",!0))},addLinkEventHandlers:function(t){var n=this;r(t).mouseenter(function(r){e.Log.debug(n,"mouse over link."),n.
mouseOverLink=t,n.updateMousePointer()}),r(t).mouseleave(function(t){e.Log.debug(n,"mouse left link."),n.mouseOverLink=null,n.updateMousePointer()}),r(t).click(function(t){if(t.metaKey)return e.activeEditable.blur(),window.setTimeout(function(){location.href=t.target},0),t.stopPropagation(),!1})},createButtons:function(){var e=this;this._formatLinkButton=s.adopt("formatLink",f,{tooltip:l.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",click:function(){e.formatLink()}}),this._insertLinkButton=s.adopt("insertLink",a,{tooltip:l.t("button.addlink.tooltip"),icon:"aloha-icon aloha-icon-link",scope:"Aloha.continuoustext",click:function(){e.insertLink(!1)}}),this.hrefField=i({name:"editLink",width:320,valueField:"url",cls:"aloha-link-href-field",scope:"Aloha.continuoustext"}),this.hrefField.setTemplate("<span><b>{name}</b><br/>{url}</span>"),this.hrefField.setObjectTypeFilter(this.objectTypeFilter),this._removeLinkButton=s.adopt("removeLink",a,{tooltip:l.t("button.removelink.tooltip"),icon:"aloha-icon aloha-icon-unlink",scope:"Aloha.continuoustext",click:function(){e.removeLink()}})},bindInteractions:function(){var t=this;this.hrefField.addListener("keyup",function(n){if(n.keyCode==27){var i=t.hrefField.getValue();if(!(i[0]=="/"||i[0]=="#"||i.match(/^.*\.([a-z]){2,4}$/i)||i.match(/^([a-z]){3,10}:\/\/.+/i)||i.match(/^(mailto|tel):.+/i))){var s=t.hrefField.getValue();t.hrefField.setValue(s),(s==t.hrefValue||s=="")&&t.removeLink(!1)}}t.hrefChange();if(n.keyCode==13){var u=e.Selection.getRangeObject();t.ignoreNextSelectionChangedEvent=!0,u.startContainer=u.endContainer,u.startOffset=u.endOffset,u.select(),t.ignoreNextSelectionChangedEvent=!0;var s=r(t.hrefField.getInputElem()).attr("value");(s==t.hrefValue||s=="")&&t.removeLink(!1),window.setTimeout(function(){o.setScope("Aloha.continuoustext")},100)}else m=r(t.hrefField.getInputElem()).attr("value"),v!=m&&(v=m)}),r(document).keydown(function(n){e.Log.debug(t,"Meta key down."),t.metaKey=n.metaKey,t.updateMousePointer()}).keyup(function(n){e.Log.debug(t,"Meta key up."),t.metaKey=n.metaKey,t.updateMousePointer()})},updateMousePointer:function(){this.metaKey&&this.mouseOverLink?(e.Log.debug(this,"set pointer"),r(this.mouseOverLink).removeClass("aloha-link-text"),r(this.mouseOverLink).addClass("aloha-link-pointer")):(r(this.mouseOverLink).removeClass("aloha-link-pointer"),r(this.mouseOverLink).addClass("aloha-link-text"))},findLinkMarkup:function(t){typeof t=="undefined"&&(t=e.Selection.getRangeObject());if(e.activeEditable){var n=e.activeEditable.obj;return n[0]&&n[0].nodeName==="A"&&(n=n.parent()),t.findMarkup(function(){return this.nodeName=="A"},n)}return null},formatLink:function(){e.activeEditable&&(this.findLinkMarkup(e.Selection.getRangeObject())?this.removeLink():this.insertLink())},insertLink:function(t){var n=this,i=e.Selection.getRangeObject(),s,o;if(!i.startContainer||!i.endContainer)return;if(this.findLinkMarkup(i))return;this.hrefField.foreground(),i.isCollapsed()&&t!==!1&&p.Utils.Dom.extendToWord(i),i.isCollapsed()?(s=l.t("newlink.defaulttext"),o=r('<a href="'+n.hrefValue+'" class="aloha-new-link">'+s+"</a>"),p.Utils.Dom.insertIntoDOM(o,i,r(e.activeEditable.obj)),i.startContainer=i.endContainer=o.contents().get(0),i.startOffset=0,i.endOffset=s.length):(o=r('<a href="'+n.hrefValue+'" class="aloha-new-link"></a>'),p.Utils.Dom.addMarkup(i,o,!1)),e.activeEditable.obj.find("a.aloha-new-link").each(function(e){n.addLinkEventHandlers(this),r(this).removeClass("aloha-new-link")}),i.select(),this.hrefField.focus(),this.hrefField.hasInputElem()&&r(this.hrefField.getInputElem()).attr("value",n.hrefValue).select(),this.hrefChange()},removeLink:function(t){var n=e.Selection.getRangeObject(),r=this.findLinkMarkup();this.hrefField.setItem(null),r&&(p.Utils.Dom.removeFromDOM(r,n,!0),n.startContainer=n.endContainer,n.startOffset=n.endOffset,n.select(),(typeof t=="undefined"||t===!0)&&o.setScope("Aloha.continuoustext"))},hrefChange:function(){var t=this;this.target!=""&&this.hrefField.setAttribute("target",this.target,this.targetregex,this.hrefField.getValue()),null!=this.cssclassregex&&this.hrefField.setAttribute("class",this.cssclass,this.cssclassregex,this.hrefField.getValue()),e.trigger("aloha-link-href-change",{obj:t.hrefField.getTargetObject(),href:t.hrefField.getValue(),item:t.hrefField.getItem()}),typeof this.onHrefChange=="function"&&this.onHrefChange.call(this,this.hrefField.getTargetObject(),this.hrefField.getValue(),this.hrefField.getItem())}})}),define("ui/port-helper-multi-split",["aloha/core","jquery","ui/ui","ui/multiSplit"],function(e,t,n,r){function i(e){var i;return i=n.adopt(e.name,r,{scope:e.scope,getButtons:function(){var n=[];return t.each(e.items,function(e,t){n.push({tooltip:t.tooltip,text:t.text,name:t.name,icon:t.iconClass,click:t.click,init:function(){t.cls&&this.element.addClass(t.cls),t.init&&t.init.call(this)},wide:t.wide})}),n}}),{pushItem:function(e){i.addButton(e)},showItem:function(e){i.show(e)},hideItem:function(e){i.hide(e)},setActiveItem:function(e){i.setActiveButton(e)}}}return i}),define("format/nls/i18n",{root:{"button.strong.tooltip":"Strong","button.em.tooltip":"Emphasize","button.b.tooltip":"Bold","button.i.tooltip":"Italic","button.u.tooltip":"Underline","button.cite.tooltip":"Cite","button.q.tooltip":"Tooltip","button.code.tooltip":"Code","button.abbr.tooltip":"Abbreviation","button.del.tooltip":"Strikethrough","button.s.tooltip":"Strikethrough","button.sub.tooltip":"Subscript","button.sup.tooltip":"Superscript","button.p.tooltip":"Paragraph","button.h1.tooltip":"Heading 1","button.h2.tooltip":"Heading 2","button.h3.tooltip":"Heading 3","button.h4.tooltip":"Heading 4","button.h5.tooltip":"Heading 5","button.h6.tooltip":"Heading 6","button.pre.tooltip":"Preformatted text","button.title.tooltip":"Title","button.removeFormat.tooltip":"Remove formatting","button.removeFormat.text":"Remove formatting",GENTICS_button_p:"GENTICS_button_p",GENTICS_button_h1:"GENTICS_button_h1",GENTICS_button_h2:"GENTICS_button_h2",GENTICS_button_h3:"GENTICS_button_h3",GENTICS_button_h4:"GENTICS_button_h4",GENTICS_button_h5:"GENTICS_button_h5",GENTICS_button_h6:"GENTICS_button_h6",GENTICS_button_pre:"GENTICS_button_pre",GENTICS_button_title:"GENTICS_button_title",formatBold:"Ctrl+b",formatItalic:"Ctrl+i",formatUnderline:"Ctrl+u",formatParagraph:"Alt+Ctrl+0",formatH1:"Alt+Ctrl+1",formatH2:"Alt+Ctrl+2",formatH3:"Alt+Ctrl+3",formatH4:"Alt+Ctrl+4",formatH5:"Alt+Ctrl+5",formatH6:"Alt+Ctrl+6",formatPre:"Alt+Ctrl+P",formatDel:"Ctrl+\\",formatSub:"Ctrl+,",formatSup:"Ctrl+.","floatingmenu.tab.format":"Format","format.class.legend":"CSS class","format.class.none":"none"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("format/format-plugin",["aloha","aloha/plugin","jquery","ui/ui","ui/toggleButton","ui/port-helper-multi-split","PubSub","i18n!format/nls/i18n","i18n!aloha/nls/i18n","aloha/selection"],function(e,t,n,r,i,s,o,u,a){function v(t,r){var i=!1,s,o,u,a,f;n.each(t.buttons,function(t,n){i=!1;for(u=0;u<r.markupEffectiveAtStart.length;u++)s=r.markupEffectiveAtStart[u],e.Selection.standardTextLevelSemanticsComparator(s,n.markup)&&(n.handle.setState(!0),i=!0);i||n.handle.setState(!1)});if(t.multiSplitItems.length>0){o=!1;for(u=0;u<r.markupEffectiveAtStart.length&&!o;u++){s=r.markupEffectiveAtStart[u];for(a=0;a<t.multiSplitItems.length&&!o;a++){f=t.multiSplitItems[a];if(!f.markup)continue;e.Selection.standardTextLevelSemanticsComparator(s,f.markup)&&(t.multiSplitButton.setActiveItem(f.name),o=!0)}}o||t.multiSplitButton.setActiveItem(null)}}var f=window.GENTICS,l="aloha-format",c={b:"bold",strong:"bold",i:"italic",em:"italic",del:"strikethrough",sub:"subscript",sup:"superscript",u:"underline",s:"strikethrough"},h={strong:"strong",em:"emphasis",s:"strikethrough2"},p={u:!0,em:!0,strong:!0,b:!0,i:!0,cite:!0,q:!0,code:!0,abbr:!0,del:!0,s:!0,sub:!0,sup:!0},d={p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,pre:!0};return t.create("format",{config:["b","i","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","removeFormat"],availableButtons:["u","strong","del","em","b","i","s","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","removeFormat"],hotKey:{formatBold:"ctrl+b",formatItalic:"ctrl+i",formatParagraph:"alt+ctrl+0",formatH1:"alt+ctrl+1",formatH2:"alt+ctrl+2",formatH3:"alt+ctrl+3",formatH4:"alt+ctrl+4",formatH5:"alt+ctrl+5",formatH6:"alt+ctrl+6",formatPre:"ctrl+p",formatDel:"ctrl+d",formatSub:"alt+shift+s",formatSup:"ctrl+shift+s"},init:function(){var t=this;typeof this.settings.hotKey!="undefined"&&n.extend(!0,this.hotKey,this.settings.hotKey),this.initButtons(),e.ready(function(){t.initSidebar(e.Sidebar.right)}),e.bind("aloha-editable-activated",function(e,n){t.applyButtonConfig(n.editable.obj),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatBold,function(){return t.addMarkup("b"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatItalic,function(){return t.addMarkup("i"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatParagraph,function(){return t.changeMarkup("p"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH1,function(){return t.changeMarkup("h1"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH2,function(){return t.changeMarkup("h2"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH3,function(){return t.changeMarkup("h3"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH4,function(){return t.changeMarkup("h4"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH5,function(){return t.changeMarkup("h5"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatH6,function(){return t.changeMarkup("h6"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatPre,function(){return t.changeMarkup("pre"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatDel,function(){return t.addMarkup("del"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatSub,function(){return t.addMarkup("sub"),!1}),n.editable.obj.bind("keydown.aloha.format",t.hotKey.formatSup,function(){return t.addMarkup("sup"),!1})}),e.bind("aloha-editable-deactivated",function(e,t){t.editable.obj.unbind("keydown.aloha.format")})},applyButtonConfig:function(e){var t=this.getEditableConfig(e),r,i,s;if(typeof t=="object"){var o=[];n.each(t,function(e,t){(typeof e!="number"||typeof t!="string")&&o.push(e)}),o.length>0&&(t=o)}this.formatOptions=t;for(r in this.buttons)this.buttons.hasOwnProperty(r)&&(n.inArray(r,t)!==-1?this.buttons[r].handle.show():this.buttons[r].handle.hide());s=this.multiSplitItems.length;for(i=0;i<s;i++)n.inArray(this.multiSplitItems[i].name,t)!==-1?this.multiSplitButton.showItem(this.multiSplitItems[i].name):this.multiSplitButton.hideItem(this.multiSplitItems[i].name)},initButtons:function(){var t="Aloha.continuoustext",a=this;this.buttons={},this.multiSplitItems=[],n.each(this.availableButtons,function(s,o){var f=!1;typeof s!="number"&&typeof o!="string"&&(f=o,o=s);if(p[o]){var l=c[o],v=l;h.hasOwnProperty(o)&&(v=h[o]);var m=r.adopt(v,i,{tooltip:u.t("button."+o+".tooltip"),icon:"aloha-icon aloha-icon-"+v,scope:t,click:function(){var e=n(".aloha-cell-selected");if(e.length>0){var t=0;return e.each(function(){var e=n(this).find("div"),r=e.find(o);r.length>0&&(r.contents().unwrap(),t++),e.contents().wrap("<"+o+"></"+o+">")}),t===e.length&&e.find(o).contents().unwrap(),!1}return a.addMarkup(o),!1}});a.buttons[o]={handle:m,markup:n("<"+o+">",{"class":f||""})}}else d[o]?a.multiSplitItems.push({name:o,tooltip:u.t("button."+o+".tooltip"),iconClass:"aloha-icon "+u.t("aloha-large-icon-"+o),markup:n("<"+o+">"),click:function(){var t=n(".aloha-cell-selected");if(t.length>0){var r=0;return t.each(function(){var e=n(this).find("div"),t=e.find(o);t.length>0&&(t.contents().unwrap(),r++),e.contents().wrap("<"+o+"></"+o+">")}),r===t.length&&t.find(o).contents().unwrap(),!1}a.changeMarkup(o),e.activeEditable&&n.browser.mozilla&&e.activeEditable.obj.focus(),e.activeEditable&&e.trigger("aloha-format-block")}}):"removeFormat"===o?a.multiSplitItems.push({name:o,text:u.t("button."+o+".text"),tooltip:u.t("button."+o+".tooltip"),wide:!0,cls:"aloha-ui-multisplit-fullwidth",click:function(){a.removeFormat()}}):e.log("warn",this,'Button "'+o+'" is not defined')}),this.multiSplitButton=s({name:"formatBlock",items:this.multiSplitItems,hideIfEmpty:!0,scope:t}),o.sub("aloha.selection.context-change",function(e){v(a,e.range)})},initSidebar:function(e){var t=this;t.sidebar=e,e.addPanel({id:t.nsClass("sidebar-panel-class"),title:u.t("floatingmenu.tab.format"),content:"",expanded:!0,activeOn:this.formatOptions||!1,onInit:function(){},onActivate:function(e){var r=this;r.effective=e;if(!e[0])return;r.format=e[0].nodeName.toLowerCase();var i=n("<div>").attr("class",t.nsClass("target-container")),s=n("<fieldset>");s.append(n("<legend>"+r.format+" "+u.t("format.class.legend")).append(n("<select>"))),i.append(s);var o='<div class="'+t.nsClass("target-container")+'"><fieldset><legend>'+u.t("format.class.legend")+'</legend><select name="targetGroup" class="'+t.nsClass("radioTarget")+'">'+'<option value="">'+u.t("format.class.none")+"</option>";t.config[r.format]&&t.config[r.format]["class"]&&n.each(t.config[r.format]["class"],function(e,t){o+='<option value="'+e+'" >'+t+"</option>"}),o+="</select></fieldset></div>";var r=this,a=this.setContent(o).content;n(t.nsSel("framename")).live("keyup",function(){n(r.effective).attr("target",n(this).val().replace('"',"&quot;").replace("'","&#39;"))});var r=this;r.effective=e,n(t.nsSel("linkTitle")).val(n(r.effective).attr("title"))}}),e.show()},nsClass:function(){var e=[],t=l;return n.each(arguments,function(){e.push(this==""?t:t+"-"+this)}),n.trim(e.join(" "))},nsSel:function(){var e=[],t=l;return n.each(arguments,function(){e.push("."+(this==""?t:t+"-"+this))}),n.trim(e.join(" "))},addMarkup:function(t){var r=n("<"+t+">"),i=e.Selection.rangeObject,s;return typeof t=="undefined"||t==""?!1:(s=i.findMarkup(function(){return this.nodeName===r[0].nodeName},e.activeEditable.obj),s?i.isCollapsed()?f.Utils.Dom.removeFromDOM(s,i,!0):f.Utils.Dom.removeMarkup(i,r,e.activeEditable.obj):(i.isCollapsed()&&f.Utils.Dom.extendToWord(i),f.Utils.Dom.addMarkup(i,r)),i.select(),v(this,e.Selection.getRangeObject()),!1)},changeMarkup:function(t){e.Selection.changeMarkupOnSelection(n("<"+t+">"))},removeFormat:function(){var t=["u","strong","em","b","i","q","del","s","code","sub","sup","p","h1","h2","h3","h4","h5","h6","pre","quote","blockquote"],r=e.Selection.rangeObject,i;this.settings.removeFormats&&(t=this.settings.removeFormats);if(r.isCollapsed())return;for(i=0;i<t.length;i++)f.Utils.Dom.removeMarkup(r,n("<"+t[i]+">"),e.activeEditable.obj);r.select()},toString:function(){return"format"}})}),define("list/nls/i18n",{root:{"button.createulist.tooltip":"Insert Unordered List","button.createolist.tooltip":"Insert Ordered List","button.indentlist.tooltip":"Indent List","button.outdentlist.tooltip":"Outdent List","floatingmenu.tab.list":"Lists"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("list/list-plugin",["aloha","jquery","aloha/plugin","ui/ui","ui/scopes","ui/button","ui/toggleButton","i18n!list/nls/i18n","i18n!aloha/nls/i18n","aloha/engine","PubSub"],function(e,t,n,r,s,o,u,a,f,l,c){function p(n,r){t(n).find(n.nodeName).each(function(){d(this)&&e.Markup.transformDomObject(this,r,e.Selection.rangeObject)}),e.Markup.transformDomObject(n,r,e.Selection.rangeObject)}function d(t){var n=e.Selection.getSelectionTree();return v(n,t)}function v(e,n){var r=!1;return t.each(e,function(e,t){if(t.domobj===n&&t.selection!=="none"||v(t.children,n))r=!0}),r}function g(n){if(8!=n.keyCode&&46!=n.keyCode)return!1;var r=e.getSelection().getRangeAt(0),i=r.startContainer,s=t(i).closest("ul, ol");if(!s.length)return!1;var o=s.parent().closest("ul, ol");if(!o.length)return!1;var u=e.getSelection().getAllRanges(),a=!1;o.each(function(){a=a||y(t(this))});if(a){e.getSelection().setRanges(u);for(var f=0;f<u.length;f++)u[f].detach()}return a}function y(n){var r=!1;return n.children("ul, ol").each(function(){e.Log.debug("performing list-nesting cleanup"),t(this).prev("li").append(this).length||t(this).parent().prepend(document.createElement("li")).append(this),r=!0}),r}var h=window.GENTICS,m=n.create("list",{config:["ul","ol"],transformableElements:{p:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,ul:!0,ol:!0},init:function(){var n=this;this._orderedListButton=r.adopt("orderedList",u,{tooltip:a.t("button.createolist.tooltip"),icon:"aloha-icon aloha-icon-orderedlist",scope:"Aloha.continuoustext",click:function(){n.transformList(!0)}}),this._unorderedListButton=r.adopt("unorderedList",u,{tooltip:a.t("button.createulist.tooltip"),icon:"aloha-icon aloha-icon-unorderedlist",scope:"Aloha.continuoustext",click:function(){n.transformList(!1)}}),this._indentListButton=r.adopt("indentList",o,{tooltip:a.t("button.indentlist.tooltip"),icon:"aloha-icon aloha-icon-indent",scope:"Aloha.continuoustext",click:function(){n.indentList()}}),this._outdentListButton=r.adopt("outdentList",o,{tooltip:a.t("button.outdentlist.tooltip"),icon:"aloha-icon aloha-icon-outdent",scope:"Aloha.continuoustext",click:function(){n.outdentList()}}),s.createScope("Aloha.List","Aloha.continuoustext"),c.sub("aloha.selection.context-change",function(r){var i,s,o=r.range;n._outdentListButton.show(!1),n._indentListButton.show(!1),n._unorderedListButton.setState(!1),n._orderedListButton.setState(!1);for(i=0;i<o.markupEffectiveAtStart.length;i++){s=o.markupEffectiveAtStart[i];if(e.Selection.standardTagNameComparator(s,t("<ul></ul>"))){n._unorderedListButton.setState(!0),n._outdentListButton.show(!0),n._indentListButton.show(!0);break}if(e.Selection.standardTagNameComparator(s,t("<ol></ol>"))){n._orderedListButton.setState(!0),n._outdentListButton.show(!0),n._indentListButton.show(!0);break}}e.activeEditable&&n.applyButtonConfig(e.activeEditable.obj)}),e.Markup.addKeyHandler(9,function(e){return n.processTab(e)})},applyButtonConfig:function(n){var r=this.getEditableConfig(n);e.Selection.rangeObject.unmodifiableMarkupAtStart[0]&&(t.inArray("ul",r)!=-1&&e.Selection.canTag1WrapTag2(e.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"ul")!=-1?this._unorderedListButton.show(!0):this._unorderedListButton.show(!1),t.inArray("ol",r)!=-1&&e.Selection.canTag1WrapTag2(e.Selection.rangeObject.unmodifiableMarkupAtStart[0].nodeName,"ol")!=-1?this._orderedListButton.show(!0):this._orderedListButton.show(!1))},processTab:function(e){return e.keyCode===9?e.shiftKey?this.outdentList():this.indentList():!0},getStartingDomObjectToTransform:function(){var t=e.Selection.rangeObject,n,r;for(n=0;n<t.markupEffectiveAtStart.length;n++){r=t.markupEffectiveAtStart[n];if(this.transformableElements[r.nodeName.toLowerCase()])return r}return!1},getNearestSelectedListItem:function(){var t=e.Selection.rangeObject,n,r;for(n=0;n<t.markupEffectiveAtStart.length;n++){r=t.markupEffectiveAtStart[n];if(h.Utils.Dom.isListElement(r))return r}return!1},transformList:function(n){var r=this.getStartingDomObjectToTransform(),i,s,o,u,a,f,c,d,v;this._outdentListButton.show(!0),this._indentListButton.show(!0);if(!r){e.Selection.changeMarkupOnSelection(t("<p></p>")),r=this.getStartingDomObjectToTransform();if(!r){if(e.Selection.rangeObject.startContainer.contentEditable){u=n?t("<ol></ol>"):t("<ul></ul>"),o=t("<li></li>"),u.append(o);var m=o.get(0),g=e.getActiveEditable().obj;m.appendChild(document.createTextNode("")),g.append(u),g.focus();var y=e.createRange(),b=e.getSelection();y.setStart(m.firstChild,0),y.setEnd(m.firstChild,0),b.removeAllRanges(),b.addRange(y),e.Selection.updateSelection();return}e.Log.error(this,"Could not transform selection into a list");return}}v=r.nodeName.toLowerCase();if(v=="ul"&&!n)u=t(r),f=u.parent(),f.length>0&&h.Utils.Dom.isListElement(f.get(0))?f.get(0).nodeName.toLowerCase()==="li"?(f.after(u.children()),u.remove()):u.children().unwrap():(d=t(r),t.each(d.children("li"),function(t,n){c=e.Markup.transformDomObject(n,"p",e.Selection.rangeObject),c.after(c.children("ol,ul")),l.ensureContainerEditable(c.get(0))}),d.children().unwrap());else if(v=="ul"&&n)p(r,"ol"),this.mergeAdjacentLists(t(r));else if(v=="ol"&&!n)p(r,"ul"),this.mergeAdjacentLists(t(r));else if(v=="ol"&&n)u=t(r),f=u.parent(),f.length>0&&h.Utils.Dom.isListElement(f.get(0))?f.get(0).nodeName.toLowerCase()==="li"?(f.after(u.children()),u.remove()):u.children().unwrap():(d=t(r),t.each(d.children("li"),function(t,n){c=e.Markup.transformDomObject(n,"p",e.Selection.rangeObject),c.after(c.children("ol,ul")),l.ensureContainerEditable(c.get(0))}),d.children().unwrap());else{a=e.Selection.rangeObject.getSelectedSiblings(r),u=n?t("<ol></ol>"):t("<ul></ul>"),o=t("<li></li>"),u.append(o),t(r).contents().appendTo(o),t(r).replaceWith(u),e.Selection.rangeObject.startContainer==r&&(e.Selection.rangeObject.startContainer=o.get(0)),e.Selection.rangeObject.endContainer==r&&(e.Selection.rangeObject.endContainer=o.get(0));var w=o;if(a){i=!1;for(s=0;s<a.length;++s)if(h.Utils.Dom.isBlockLevelElement(a[s]))i&&(i=!1),o=e.Markup.transformDomObject(a[s],"li",e.Selection.rangeObject),u.append(o),w=o;else{if(a[s].nodeType==3&&t.trim(a[s].data).length===0)continue;i||(i=t("<li></li>"),u.append(i),w=i),i.append(a[s])}}this.mergeAdjacentLists(u);var m=w.get(0);if(h.Utils.Dom.isEmpty(m)){var y=e.createRange(),b=e.getSelection();m.appendChild(document.createTextNode("")),y.selectNodeContents(m.lastChild),b.removeAllRanges(),b.addRange(y),e.Selection.updateSelection()}}this.refreshSelection()},indentList:function(){var n=this.getNearestSelectedListItem(),r,i,s,o,u;if(n){u=t(n).prev("li");if(u.length===0)return!1;o=t(n).parent(),s=e.Selection.rangeObject.getSelectedSiblings(n),i=t(n).parent().clone(!1).empty(),i.append(n),u.append(i);if(s)for(r=0;r<s.length;++r)i.append(t(s[r]));return this.mergeAdjacentLists(i,!0),this.refreshSelection(),!1}return!0},outdentList:function(){var n=this.getNearestSelectedListItem(),r,i,s,o,u,a,f,l;if(n){s=t(n),o=s.parent(),u=o.parents("ul,ol"),a=o.parent("li");if(u.length>0&&h.Utils.Dom.isListElement(u.get(0))){f=e.Selection.rangeObject.getSelectedSiblings(n),f&&f.length>0?l=t(f[f.length-1]):l=s,l.nextAll("li").length>0&&(i=o.clone(!1).empty(),i.append(l.nextAll()),l.append(i)),a.length>0?a.after(s):o.before(s);if(f&&f.length>0)for(r=f.length-1;r>=0;--r)s.after(t(f[r]));o.contents("li").length===0&&o.remove(),a.length>0&&a.contents().length===0&&a.remove(),this.refreshSelection()}return!1}return!0},refreshSelection:function(){e.Selection.rangeObject.update(),e.Selection.rangeObject.select(),e.Selection.updateSelection()},mergeAdjacentLists:function(e,n){var r=e.get(0),i;while(r.previousSibling&&r.previousSibling.nodeType===1&&this.isMergable(r.previousSibling,r,n))r=r.previousSibling;e=t(r);while(r.nextSibling&&(r.nextSibling.nodeType===1&&this.isMergable(r.nextSibling,r,n)||r.nextSibling.nodeType===3&&t.trim(r.nextSibling.data).length===0))i=t(r.nextSibling),r.nextSibling.nodeType==1&&i.contents().appendTo(e),i.remove()},isMergable:function(e,t,n){return n?e.nodeName.toLowerCase()=="ul"||e.nodeName.toLowerCase()=="ol":e.nodeName==t.nodeName}});return l.commands.insertorderedlist={action:function(t,n){m.transformList(!0),n&&e.Selection.rangeObject&&(n.startContainer=e.Selection.rangeObject.startContainer,n.startOffset=e.Selection.rangeObject.startOffset,n.endContainer=e.Selection.rangeObject.endContainer,n.endOffset=e.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){effectiveMarkup=rangeObject.markupEffectiveAtStart[i];if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<ul></ul>")))return!1;if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<ol></ol>")))return!0}return!1}},l.commands.insertunorderedlist={action:function(t,n){m.transformList(!1),n&&e.Selection.rangeObject&&(n.startContainer=e.Selection.rangeObject.startContainer,n.startOffset=e.Selection.rangeObject.startOffset,n.endContainer=e.Selection.rangeObject.endContainer,n.endOffset=e.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){for(i=0;i<rangeObject.markupEffectiveAtStart.length;i++){effectiveMarkup=rangeObject.markupEffectiveAtStart[i];if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<ul></ul>")))return!0;if(e.Selection.standardTagNameComparator(effectiveMarkup,t("<ol></ol>")))return!1}return!1}},l.commands.indent={action:function(t,n){m.indentList(),n&&e.Selection.rangeObject&&(n.startContainer=e.Selection.rangeObject.startContainer,n.startOffset=e.Selection.rangeObject.startOffset,n.endContainer=e.Selection.rangeObject.endContainer,n.endOffset=e.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){return!1}},l.commands.outdent={action:function(t,n){m.outdentList(),n&&e.Selection.rangeObject&&(n.startContainer=e.Selection.rangeObject.startContainer,n.startOffset=e.Selection.rangeObject.startOffset,n.endContainer=e.Selection.rangeObject.endContainer,n.endOffset=e.Selection.rangeObject.endOffset)},indeterm:function(){},state:function(){return!1}},m}),define("image/nls/i18n",{root:{"size.natural":"Original size","button.addimg.tooltip":"add image ref","floatingmenu.tab.img":"Image","floatingmenu.tab.formatting":"Formatting","floatingmenu.tab.resize":"Resize","floatingmenu.tab.crop":"Crop","button.uploadimg.tooltip":"Upload img","button.uploadimg.label":"Upload","button.img.align.left.tooltip":"Left align","button.img.align.right.tooltip":"Right Align","button.img.align.none.tooltip":"No alignment","field.img.title.label":"Title","field.img.title.tooltip":"Title","field.img.label":"URL","field.img.tooltip":"Source","border ":"Add Border to Image","padding.increase ":"Increase Padding","padding.decrease ":"Decrease Padding","size.increase ":"Increase Size","size.decrease ":"Decrease Size",Resize:"Resize",Crop:"Crop",Reset:"Reset",Accept:"Accept",Cancel:"Cancel",height:"Height",width:"Width","button.toggle.tooltip":"Toggle keep aspect ratio","field.img.src.label":"Source","field.img.src.tooltip":"Source"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("image/image-floatingMenu",["jquery","util/class","i18n!image/nls/i18n","i18n!aloha/nls/i18n","ui/ui","ui/scopes","ui/button","ui/toggleButton","ui/port-helper-attribute-field"],function(e,t,n,r,i,s,o,u,a){var f=e,l=window.GENTICS,c=window.Aloha;return t.extend({_constructor:function(){},init:function(e){e.floatingMenuControl=this,this.plugin=e,s.createScope(e.name,"Aloha.empty"),this._addUIInsertButton(),this._addUIMetaButtons(),this._addUIResetButton(),this._addUIAlignButtons(),this._addUIMarginButtons(),this._addUICropButtons(),this._addUIResizeButtons(),this._addUIAspectRatioToggleButton()},_addUIAspectRatioToggleButton:function(){var e=this.plugin;this._imageCnrRatioButton=i.adopt("imageCnrRatio",u,{tooltip:n.t("button.toggle.tooltip"),icon:"aloha-icon-cnr-ratio",scope:e.name,click:function(){e.toggleKeepAspectRatio()}}),e.settings.fixedAspectRatio!==!1&&(this._imageCnrRatioButton.setState(!0),e.keepAspectRatio=!0)},_addUIResetButton:function(){var e=this.plugin;this._imageCnrResetButton=i.adopt("imageCnrReset",o,{tooltip:n.t("Reset"),icon:"aloha-icon-cnr-reset",scope:e.name,click:function(){e.reset()}})},_addUIInsertButton:function(){var e=this.plugin;this._insertImageButton=i.adopt("insertImage",o,{tooltip:n.t("button.addimg.tooltip"),icon:"aloha-button aloha-image-insert",scope:"Aloha.continuoustext",click:function(){e.insertImg()}})},_addUIMetaButtons:function(){var e=this.plugin;this.imgSrcField=a({label:n.t("field.img.src.label"),labelClass:"aloha-image-input-label",tooltip:n.t("field.img.src.tooltip"),name:"imageSource",scope:e.name}),this.imgSrcField.setTemplate("<span><b>{name}</b><br/>{url}</span>"),this.imgSrcField.setObjectTypeFilter(e.objectTypeFilter),this.imgTitleField=a({label:n.t("field.img.title.label"),labelClass:"aloha-image-input-label",tooltip:n.t("field.img.title.tooltip"),name:"imageTitle",scope:e.name}),this.imgTitleField.setObjectTypeFilter()},_addUIAlignButtons:function(){var t=this.plugin;this._imageAlignLeftButton=i.adopt("imageAlignLeft",o,{tooltip:n.t("button.img.align.left.tooltip"),icon:"aloha-img aloha-image-align-left",scope:t.name,click:function(){var n=e(t.getPluginFocus());n.add(n.parent()).css("float","left")}}),this._imageAlignRightButton=i.adopt("imageAlignRight",o,{tooltip:n.t("button.img.align.right.tooltip"),icon:"aloha-img aloha-image-align-right",scope:t.name,click:function(){var n=e(t.getPluginFocus());n.add(n.parent()).css("float","right")}}),this._imageAlignNoneButton=i.adopt("imageAlignNone",o,{tooltip:n.t("button.img.align.none.tooltip"),icon:"aloha-img aloha-image-align-none",scope:t.name,click:function(){var n=e(t.getPluginFocus());n.add(n.parent()).css({"float":"none",display:"inline-block"})}})},_addUIMarginButtons:function(){var t=this.plugin;this._imageIncPaddingButton=i.adopt("imageIncPadding",o,{tooltip:n.t("padding.increase"),icon:"aloha-img aloha-image-padding-increase",scope:t.name,click:function(){e(t.getPluginFocus()).increase("padding")}}),this._imageDecPaddingButton=i.adopt("imageDecPadding",o,{tooltip:n.t("padding.decrease"),icon:"aloha-img aloha-image-padding-decrease",scope:t.name,click:function(){e(t.getPluginFocus()).decrease("padding")}})},_addUICropButtons:function(){var e=this.plugin;s.createScope("Aloha.img",["Aloha.global"]),this._imageCropButton=i.adopt("imageCropButton",u,{tooltip:n.t("Crop"),icon:"aloha-icon-cnr-crop",scope:e.name,click:function(){this.getState()?e.crop():e.endCrop()}})},_addUIResizeButtons:function(){var e=this.plugin;this.imgResizeHeightField=a({label:n.t("height"),labelClass:"aloha-image-input-label",name:"imageResizeHeight",width:50,scope:e.name}),this.imgResizeHeightField.maxValue=e.settings.maxHeight,this.imgResizeHeightField.minValue=e.settings.minHeight,this.imgResizeWidthField=a({label:n.t("width"),labelClass:"aloha-image-input-label",name:"imageResizeWidth",width:50,scope:e.name}),this.imgResizeWidthField.maxValue=e.settings.maxWidth,this.imgResizeWidthField.minValue=e.settings.minWidth},setScope:function(){s.setScope(this.plugin.name)},doLayout:function(){}})}),define("image/vendor/jcrop/jquery.jcrop.min",["jquery"],function(e){(function(e){e.Jcrop=function(t,n){function B(e){return""+parseInt(e)+"px"}function j(e){return""+parseInt(e)+"%"}function F(e){return s.baseClass+"-"+e}function I(t){var n=e(t).offset();return[n.left,n.top]}function q(e){return[e.pageX-C[0],e.pageY-C[1]]}function R(e){e!=L&&(P.setCursor(e),L=e)}function U(e,t){C=I(u),P.setCursor(e=="move"?e:e+"-resize");if(e=="move")return P.activateHandlers(W(t),Q);var n=_.getFixed(),r=X(e),i=_.getCorner(X(r));_.setPressed(_.getCorner(r)),_.setCurrent(i),P.activateHandlers(z(e,n),Q)}function z(e,t){return function(n){if(!s.aspectRatio)switch(e){case"e":n[1]=t.y2;break;case"w":n[1]=t.y2;break;case"n":n[0]=t.x2;break;case"s":n[0]=t.x2}else switch(e){case"e":n[1]=t.y+1;break;case"w":n[1]=t.y+1;break;case"n":n[0]=t.x+1;break;case"s":n[0]=t.x+1}_.setCurrent(n),D.update()}}function W(e){var t=e;return H.watchKeys(),function(e){_.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,D.update()}}function X(e){switch(e){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function V(e){return function(t){return s.disabled?!1:e=="move"&&!s.allowMove?!1:(k=!0,U(e,q(t)),t.stopPropagation(),t.preventDefault(),!1)}}function J(e,t,n){var r=e.width(),i=e.height();r>t&&t>0&&(r=t,i=t/e.width()*e.height()),i>n&&n>0&&(i=n,r=n/e.height()*e.width()),x=e.width()/r,T=e.height()/i,e.width(r).height(i)}function K(e){return{x:parseInt(e.x*x),y:parseInt(e.y*T),x2:parseInt(e.x2*x),y2:parseInt(e.y2*T),w:parseInt(e.w*x),h:parseInt(e.h*T)}}function Q(e){var t=_.getFixed();t.w>s.minSelect[0]&&t.h>s.minSelect[1]?(D.enableHandles(),D.done()):D.release(),P.setCursor(s.allowSelect?"crosshair":"default")}function G(e){if(s.disabled)return!1;if(!s.allowSelect)return!1;k=!0,C=I(u),D.disableHandles(),R("crosshair");var t=q(e);return _.setPressed(t),P.activateHandlers(Y,Q),H.watchKeys(),D.update(),e.stopPropagation(),e.preventDefault(),!1}function Y(e){_.setCurrent(e),D.update()}function Z(){var t=e("<div></div>").addClass(F("tracker"));return e.browser.msie&&t.css({opacity:0,backgroundColor:"white"}),t}function et(e){function b(){window.setTimeout(y,f)}var t=e[0]/x,n=e[1]/T,r=e[2]/x,i=e[3]/T;if(O)return;var o=_.flipCoords(t,n,r,i),u=_.getFixed(),a=initcr=[u.x,u.y,u.x2,u.y2],f=s.animationDelay,l=a[0],c=a[1],r=a[2],i=a[3],h=o[0]-initcr[0],p=o[1]-initcr[1],d=o[2]-initcr[2],v=o[3]-initcr[3],m=0,g=s.swingSpeed;D.animMode(!0);var y=function(){return function(){m+=(100-m)/g,a[0]=l+m/100*
h,a[1]=c+m/100*p,a[2]=r+m/100*d,a[3]=i+m/100*v,m<100?b():D.done(),m>=99.8&&(m=100),nt(a)}}();b()}function tt(e){nt([e[0]/x,e[1]/T,e[2]/x,e[3]/T])}function nt(e){_.setPressed([e[0],e[1]]),_.setCurrent([e[2],e[3]]),D.update()}function rt(t){typeof t!="object"&&(t={}),s=e.extend(s,t),typeof s.onChange!="function"&&(s.onChange=function(){}),typeof s.onSelect!="function"&&(s.onSelect=function(){})}function it(){return K(_.getFixed())}function st(){return _.getFixed()}function ot(e){rt(e),ct()}function ut(){s.disabled=!0,D.disableHandles(),D.setCursor("default"),P.setCursor("default")}function at(){s.disabled=!1,ct()}function ft(){D.done(),P.activateHandlers(null,null)}function lt(){l.remove(),o.show()}function ct(e){s.allowResize?e?D.enableOnly():D.enableHandles():D.disableHandles(),P.setCursor(s.allowSelect?"crosshair":"default"),D.setCursor(s.allowMove?"move":"default"),l.css("backgroundColor",s.bgColor),"setSelect"in s&&(tt(n.setSelect),D.done(),delete s.setSelect),"trueSize"in s&&(x=s.trueSize[0]/a,T=s.trueSize[1]/f),y=s.maxSize[0]||0,b=s.maxSize[1]||0,E=s.minSize[0]||0,S=s.minSize[1]||0,"outerImage"in s&&(u.attr("src",s.outerImage),delete s.outerImage),D.refresh()}var t=t,n=n;typeof t!="object"&&(t=e(t)[0]),typeof n!="object"&&(n={}),"trackDocument"in n||(n.trackDocument=e.browser.msie?!1:!0,e.browser.msie&&e.browser.version.split(".")[0]=="8"&&(n.trackDocument=!0)),"keySupport"in n||(n.keySupport=e.browser.msie?!1:!0);var r={trackDocument:!1,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,borderOpacity:.4,handleOpacity:.5,handlePad:5,handleSize:9,handleOffset:5,edgeMargin:14,aspectRatio:0,keySupport:!0,cornerHandles:!0,sideHandles:!0,drawBorders:!0,dragEdges:!0,boxWidth:0,boxHeight:0,boundary:8,animationDelay:20,swingSpeed:3,allowSelect:!0,allowMove:!0,allowResize:!0,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){}},s=r;rt(n);var o=e(t),u=o.clone().removeAttr("id").css({position:"absolute"});u.width(o.width()),u.height(o.height()),o.after(u).hide(),J(u,s.boxWidth,s.boxHeight);var a=u.width(),f=u.height(),l=e("<div />").width(a).height(f).addClass(F("holder")).css({position:"relative",backgroundColor:s.bgColor}).insertAfter(o).append(u);s.addClass&&l.addClass(s.addClass);var c=e("<img />").attr("src",u.attr("src")).css("position","absolute").width(a).height(f),p=e("<div />").width(j(100)).height(j(100)).css({zIndex:310,position:"absolute",overflow:"hidden"}).append(c),d=e("<div />").width(j(100)).height(j(100)).css("zIndex",320),v=e("<div />").css({position:"absolute",zIndex:300}).insertBefore(u).append(p,d),m=s.boundary,g=Z().width(a+m*2).height(f+m*2).css({position:"absolute",top:B(-m),left:B(-m),zIndex:290}).mousedown(G),y,b,E,S,x,T,N=!0,C=I(u),k,L,A,O,M,_=function(){function u(i){var i=m(i);n=e=i[0],r=t=i[1]}function l(e){var e=m(e);i=e[0]-n,o=e[1]-r,n=e[0],r=e[1]}function c(){return[i,o]}function p(i){var s=i[0],o=i[1];0>e+s&&(s-=s+e),0>t+o&&(o-=o+t),f<r+o&&(o+=f-(r+o)),a<n+s&&(s+=a-(n+s)),e+=s,n+=s,t+=o,r+=o}function d(e){var t=v();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function v(){if(!s.aspectRatio)return N();var i=s.aspectRatio,o=s.minSize[0]/x,u=s.minSize[1]/T,l=s.maxSize[0]/x,c=s.maxSize[1]/T,p=n-e,d=r-t,v=Math.abs(p),m=Math.abs(d),y=v/m,b,E;return l==0&&(l=a*10),c==0&&(c=f*10),y<i?(E=r,w=m*i,b=p<0?e-w:w+e,b<0?(b=0,h=Math.abs((b-e)/i),E=d<0?t-h:h+t):b>a&&(b=a,h=Math.abs((b-e)/i),E=d<0?t-h:h+t)):(b=n,h=v/i,E=d<0?t-h:t+h,E<0?(E=0,w=Math.abs((E-t)*i),b=p<0?e-w:w+e):E>f&&(E=f,w=Math.abs(E-t)*i,b=p<0?e-w:w+e)),b>e?(b-e<o?b=e+o:b-e>l&&(b=e+l),E>t?E=t+(b-e)/i:E=t-(b-e)/i):b<e&&(e-b<o?b=e-o:e-b>l&&(b=e-l),E>t?E=t+(e-b)/i:E=t-(e-b)/i),b<0?(e-=b,b=0):b>a&&(e-=b-a,b=a),E<0?(t-=E,E=0):E>f&&(t-=E-f,E=f),last=C(g(e,t,b,E))}function m(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>a&&(e[0]=a),e[1]>f&&(e[1]=f),[e[0],e[1]]}function g(e,t,n,r){var i=e,s=n,o=t,u=r;return n<e&&(i=n,s=e),r<t&&(o=r,u=t),[Math.round(i),Math.round(o),Math.round(s),Math.round(u)]}function N(){var i=n-e,s=r-t;y&&Math.abs(i)>y&&(n=i>0?e+y:e-y),b&&Math.abs(s)>b&&(r=s>0?t+b:t-b),S&&Math.abs(s)<S&&(r=s>0?t+S:t-S),E&&Math.abs(i)<E&&(n=i>0?e+E:e-E),e<0&&(n-=e,e-=e),t<0&&(r-=t,t-=t),n<0&&(e-=n,n-=n),r<0&&(t-=r,r-=r);if(n>a){var o=n-a;e-=o,n-=o}if(r>f){var o=r-f;t-=o,r-=o}if(e>a){var o=e-f;r-=o,t-=o}if(t>f){var o=t-f;r-=o,t-=o}return C(g(e,t,n,r))}function C(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var e=0,t=0,n=0,r=0,i,o;return{flipCoords:g,setPressed:u,setCurrent:l,getOffset:c,moveOffset:p,getCorner:d,getFixed:v}}(),D=function(){function g(t){var n=e("<div />").css({position:"absolute",opacity:s.borderOpacity}).addClass(F(t));return p.append(n),n}function y(t,n){var r=e("<div />").mousedown(V(t)).css({cursor:t+"-resize",position:"absolute",zIndex:n});return d.append(r),r}function b(e){return y(e,a++).css({top:B(-m+1),left:B(-m+1),opacity:s.handleOpacity}).addClass(F("handle"))}function w(e){var t=s.handleSize,n=m,r=t,i=t,o=n,u=n;switch(e){case"n":case"s":i=j(100);break;case"e":case"w":r=j(100)}return y(e,a++).width(i).height(r).css({top:B(-o+1),left:B(-u+1)})}function E(e){for(i in e)l[e[i]]=b(e[i])}function S(e){var t=Math.round(e.h/2-m),n=Math.round(e.w/2-m),r=west=-m+1,i=e.w-m,s=e.h-m,o,u;"e"in l&&l.e.css({top:B(t),left:B(i)})&&l.w.css({top:B(t)})&&l.s.css({top:B(s),left:B(n)})&&l.n.css({left:B(n)}),"ne"in l&&l.ne.css({left:B(i)})&&l.se.css({top:B(s),left:B(i)})&&l.sw.css({top:B(s)}),"b"in l&&l.b.css({top:B(s)})&&l.r.css({left:B(i)})}function x(e,t){c.css({top:B(-t),left:B(-e)}),v.css({top:B(t),left:B(e)})}function T(e,t){v.width(e).height(t)}function N(){var e=_.getFixed();_.setPressed([e.x,e.y]),_.setCurrent([e.x2,e.y2]),C()}function C(){if(o)return k()}function k(){var e=_.getFixed();T(e.w,e.h),x(e.x,e.y),s.drawBorders&&f.right.css({left:B(e.w-1)})&&f.bottom.css({top:B(e.h-1)}),h&&S(e),o||L(),s.onChange(K(e))}function L(){v.show(),u.css("opacity",s.bgOpacity),o=!0}function A(){P(),v.hide(),u.css("opacity",1),o=!1}function M(){h&&(S(_.getFixed()),d.show())}function D(){h=!0;if(s.allowResize)return S(_.getFixed()),d.show(),!0}function P(){h=!1,d.hide()}function H(e){(O=e)?P():D()}function I(){H(!1),N()}var t,n,r,o,a=370,f={},l={},h=!1,m=s.handleOffset;s.drawBorders&&(f={top:g("hline").css("top",e.browser.msie?B(-1):B(0)),bottom:g("hline"),left:g("vline"),right:g("vline")}),s.dragEdges&&(l.t=w("n"),l.b=w("s"),l.r=w("e"),l.l=w("w")),s.sideHandles&&E(["n","s","e","w"]),s.cornerHandles&&E(["sw","nw","ne","se"]);var q=Z().mousedown(V("move")).css({cursor:"move",position:"absolute",zIndex:360});return p.append(q),P(),{updateVisible:C,update:k,release:A,refresh:N,setCursor:function(e){q.css("cursor",e)},enableHandles:D,enableOnly:function(){h=!0},showHandles:M,disableHandles:P,animMode:H,done:I}}(),P=function(){function i(){g.css({zIndex:450}),r&&e(document).mousemove(a).mouseup(f)}function o(){g.css({zIndex:290}),r&&e(document).unbind("mousemove",a).unbind("mouseup",f)}function a(e){t(q(e))}function f(e){return e.preventDefault(),e.stopPropagation(),k&&(k=!1,n(q(e)),s.onSelect(K(_.getFixed())),o(),t=function(){},n=function(){}),!1}function l(e,r){return k=!0,t=e,n=r,i(),!1}function c(e){g.css("cursor",e)}var t=function(){},n=function(){},r=s.trackDocument;return r||g.mousemove(a).mouseup(f).mouseout(f),u.before(g),{activateHandlers:l,setCursor:c}}(),H=function(){function r(){s.keySupport&&(t.show(),t.focus())}function i(e){t.hide()}function o(e,t,n){s.allowMove&&(_.moveOffset([t,n]),D.updateVisible()),e.preventDefault(),e.stopPropagation()}function a(e){if(e.ctrlKey)return!0;M=e.shiftKey?!0:!1;var t=M?10:1;switch(e.keyCode){case 37:o(e,-t,0);break;case 39:o(e,t,0);break;case 38:o(e,0,-t);break;case 40:o(e,0,t);break;case 27:D.release();break;case 9:return!0}return nothing(e)}var t=e('<input type="radio" />').css({position:"absolute",left:"-30px"}).keypress(a).blur(i),n=e("<div />").css({position:"absolute",overflow:"hidden"}).append(t);return s.keySupport&&n.insertBefore(u),{watchKeys:r}}();d.hide(),ct(!0);var ht={animateTo:et,setSelect:tt,setOptions:ot,tellSelect:it,tellScaled:st,disable:ut,enable:at,cancel:ft,focus:H.watchKeys,getBounds:function(){return[a*x,f*T]},getWidgetSize:function(){return[a,f]},release:D.release,destroy:lt};return o.data("Jcrop",ht),ht},e.fn.Jcrop=function(t){function n(n){var r=t.useImg||n.src,i=new Image;i.onload=function(){e.Jcrop(n,t)},i.src=r}return typeof t!="object"&&(t={}),this.each(function(){if(e(this).data("Jcrop")){if(t=="api")return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(t)}else n(this)}),this}})(e)}),define("image/vendor/mousewheel/mousewheel",["jquery"],function(e){(function(e){function r(t){var n=t||window.event,r=[].slice.call(arguments,1),i=0,s=!0,o=0,u=0;return t=e.event.fix(n),t.type="mousewheel",n.wheelDelta&&(i=n.wheelDelta/120),n.detail&&(i=-n.detail/3),u=i,n.axis!==undefined&&n.axis===n.HORIZONTAL_AXIS&&(u=0,o=-1*i),n.wheelDeltaY!==undefined&&(u=n.wheelDeltaY/120),n.wheelDeltaX!==undefined&&(o=-1*n.wheelDeltaX/120),r.unshift(t,i,o,u),(e.event.dispatch||e.event.handle).apply(this,r)}var t=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var n=t.length;n;)e.event.fixHooks[t[--n]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=t.length;e;)this.addEventListener(t[--e],r,!1);else this.onmousewheel=r},teardown:function(){if(this.removeEventListener)for(var e=t.length;e;)this.removeEventListener(t[--e],r,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})(e)}),define("image/image-plugin",["jquery","aloha/plugin","image/image-floatingMenu","i18n!aloha/nls/i18n","i18n!image/nls/i18n","jqueryui","image/vendor/jcrop/jquery.jcrop.min","image/vendor/mousewheel/mousewheel"],function(t,n,r,i,s){var o=t,u=t,a=window.GENTICS,f=window.Aloha;return String.prototype.toInteger=String.prototype.toInteger||function(){return parseInt(String(this).replace(/px$/,"")||0,10)},String.prototype.toFloat=String.prototype.toInteger||function(){return parseFloat(String(this).replace(/px$/,"")||0,10)},Number.prototype.toInteger=Number.prototype.toInteger||String.prototype.toInteger,Number.prototype.toFloat=Number.prototype.toFloat||String.prototype.toFloat,o.extend(!0,o.fn,{increase:o.fn.increase||function(e){var t=o(this),n,r;return t.length?(n=t.css(e).toFloat(),r=Math.round((n||1)*1.2),n===r&&r++,t.css(e,r),t):t},decrease:o.fn.decrease||function(e){var t=o(this),n,r;return t.length?(n=t.css(e).toFloat(),r=Math.round((n||0)*.8),n===r&&r>0&&r--,t.css(e,r),t):t}}),n.create("image",{defaultSettings:{maxWidth:1600,minWidth:3,maxHeight:1200,minHeight:3,autoCorrectManualInput:!0,fixedAspectRatio:!1,autoResize:!1,ui:{meta:!0,crop:!0,resizable:!0},handles:"ne, se, sw, nw",onCropped:function(e,t){f.Log.info("Default onCropped invoked",e,t)},onReset:function(e){return f.Log.info("Default onReset invoked",e),!1},onResize:function(e){f.Log.info("Default onResize invoked",e)},onResized:function(e){f.Log.info("Default onResized invoked",e)}},_onCropped:function(e,t){u("#"+this.ui.imgResizeHeightField.getInputId()).val(e.height()),u("#"+this.ui.imgResizeWidthField.getInputId()).val(e.width()),u("body").trigger("aloha-image-cropped",[e,t]),this.onCropped(e,t)},_onReset:function(e){return u("#"+this.ui.imgResizeHeightField.getInputId()).val(e.height()),u("#"+this.ui.imgResizeWidthField.getInputId()).val(e.width()),u("body").trigger("aloha-image-reset",e),this.onReset(e)},_onResize:function(e){u("#"+this.ui.imgResizeHeightField.getInputId()).val(e.height()),u("#"+this.ui.imgResizeWidthField.getInputId()).val(e.width()),u("body").trigger("aloha-image-resize",e),this.onResize(e)},_onResized:function(e){u("#"+this.ui.imgResizeHeightField.getInputId()).val(e.height()),u("#"+this.ui.imgResizeWidthField.getInputId()).val(e.width()),u("body").trigger("aloha-image-resized",e),this.onResized(e)},imageObj:null,jcAPI:null,keepAspectRatio:!1,startAspectRatio:!1,restoreProps:[],objectTypeFilter:[],init:function(){var e=this,t=f.getPluginUrl("image");typeof this.settings.objectTypeFilter!="undefined"&&(this.objectTypeFilter=this.settings.objectTypeFilter),e.startAspectRatio=e.settings.fixedAspectRatio,e.config=e.defaultSettings,e.settings=o.extend(!0,e.defaultSettings,e.settings),e.initializeUI(),e.bindInteractions(),e.subscribeEvents()},initializeUI:function(){var e=this;this.ui=new r,this.ui.init(this)},bindInteractions:function(){var e=this;if(e.settings.ui.resizable)try{document.execCommand("enableObjectResizing",!1,!1)}catch(t){f.Log.info(t,"Could not disable enableObjectResizing")}e.settings.ui.meta&&(e.ui.imgSrcField.addListener("keyup",function(t){e.srcChange()}),e.ui.imgSrcField.addListener("blur",function(t){var n=o(e.ui.imgSrcField.getTargetObject());n.attr("src")===""&&n.remove()})),e.settings.onCropped&&typeof e.settings.onCropped=="function"&&(e.onCropped=e.settings.onCropped),e.settings.onReset&&typeof e.settings.onReset=="function"&&(e.onReset=e.settings.onReset),e.settings.onResized&&typeof e.settings.onResized=="function"&&(e.onResized=e.settings.onResized),e.settings.onResize&&typeof e.settings.onResize=="function"&&(e.onResize=this.settings.onResize)},subscribeEvents:function(){var e=this,t=this.settings,n={};o("img").filter(t.globalselector).unbind(),o("img").filter(t.globalselector).click(function(t){e.clickImage(t)});var r=function(){n[f.activeEditable.getId()]?e.ui._insertImageButton.show():e.ui._insertImageButton.hide()};f.bind("aloha-drop-files-in-editable",function(t,n){var r,i=n.filesObjs.length,s,u;while(--i>=0)s=n.filesObjs[i],s.file.type.match(/image\//)&&(u=e.getEditableConfig(n.editable),r=o("<img/>"),r.css({"max-width":that.maxWidth,"max-height":that.maxHeight}),r.attr("id",s.id),typeof s.src=="undefined"?r.attr("src",s.data):r.attr("src",s.src),a.Utils.Dom.insertIntoDOM(r,n.range,o(f.activeEditable.obj)))}),f.bind("aloha-selection-changed",function(t,n,i){var s,u;i&&i.target&&e.settings.ui.resizable&&!o(i.target).hasClass("ui-resizable-handle")&&(e.endResize(),e.imageObj=null,f.trigger("aloha-image-unselected")),f.activeEditable!==null&&(u=e.findImgMarkup(n),r(),u?(e.ui._insertImageButton.show(),e.ui.setScope(),e.settings.ui.meta&&(e.ui.imgSrcField.setTargetObject(u,"src"),e.ui.imgTitleField.setTargetObject(u,"title")),e.ui.imgSrcField.foreground(),e.ui.imgSrcField.focus()):e.settings.ui.meta&&e.ui.imgSrcField.setTargetObject(null),e.ui.doLayout())}),f.bind("aloha-editable-created",function(t,r){var i=e.getEditableConfig(r.obj),s=o.inArray("img",i)!==-1;n[r.getId()]=s;if(!s)return;try{document.execCommand("enableObjectResizing",!1,!1)}catch(u){f.Log.info(u,"Could not disable enableObjectResizing")}r.obj.delegate("img","mouseup",function(t){e.clickImage(t),t.stopPropagation()})}),f.bind("aloha-editable-activated",function(){r()}),e._subscribeToResizeFieldEvents()},autoResize:function(){var e=this,t=e.imageObj.width(),n=e.imageObj.height(),r=!1;if(t<e.settings.minWidth||t>e.settings.maxWidth||n<e.settings.minHeight||n>e.settings.maxHeight)r=!0;return r&&t>=n?(e._setNormalizedFieldValues("width"),e.setSizeByFieldValue(),!0):r&&t<n?(e._setNormalizedFieldValues("height"),e.setSizeByFieldValue(),!0):!1},toggleKeepAspectRatio:function(){this.keepAspectRatio=!this.keepAspectRatio,this.endResize();if(!this.keepAspectRatio)this.startAspectRatio=!1;else if(typeof this.settings.fixedAspectRatio!="number"){var e=this.imageObj.width()/this.imageObj.height();this.startAspectRatio=e}else this.startAspectRatio=this.settings.fixedAspectRatio;this.startResize()},_subscribeToResizeFieldEvents:function(){function t(t,n,r,i){typeof i=="undefined"&&(i=0),typeof r=="undefined"&&(r=8e3);var s=parseInt(t.val(),10);if(isNaN(s))return t.css("background-color","red"),!1;var o=s+n;return n>=0&&o>r?e.settings.autoCorrectManualInput?(t.val(r),!0):(t.css("background-color","red"),!1):n<=0&&o<i?e.settings.autoCorrectManualInput?(t.val(i),!0):(t.css("background-color","red"),!1):(t.css("background-color",""),t.val(s+n),!0)}function n(n){var r=n.data.minValue,i=n.data.maxValue,s=n.data.fieldName;if(n.keyCode===8||n.keyCode===46)u(this).val()>=r&&(typeof e.jcAPI!="undefined"&&e.jcAPI!==null?e.setCropAreaByFieldValue():(e._setNormalizedFieldValues(s),e.setSizeByFieldValue()));else if(n.keyCode<=57&&n.keyCode>=48||n.keyCode<=105&&n.keyCode>=96)u(this).val()>=r&&(typeof e.jcAPI!="undefined"&&e.jcAPI!==null?e.setCropAreaByFieldValue():(e._setNormalizedFieldValues(s),e.setSizeByFieldValue()));else{var o=0;if(n.keyCode===38||n.keyCode===107)o=1;else if(n.keyCode===40||n.keyCode===109)o=-1;if(n.shiftKey||n.metaKey||n.ctrlKey)o*=10;t(u(this),o,i,r)&&(typeof e.jcAPI!="undefined"&&e.jcAPI!==null?e.setCropAreaByFieldValue():(e._setNormalizedFieldValues(s),e.setSizeByFieldValue()))}return n.preventDefault(),!1}function r(n,r){var i=n.data.minValue,s=n.data.maxValue,o=n.data.fieldName;if(n.shiftKey||n.metaKey||n.ctrlKey)r*=10;return t(u(this),r,s,i)&&(typeof e.jcAPI!="undefined"&&e.jcAPI!==null?e.setCropAreaByFieldValue():(e._setNormalizedFieldValues(o),e.setSizeByFieldValue())),!1}var e=this,i=u("#"+e.ui.imgResizeHeightField.getInputId()),s={fieldName:"height",maxValue:e.ui.imgResizeHeightField.maxValue,minValue:e.ui.imgResizeHeightField.minValue};i.live("keyup",s,n),i.live("mousewheel",s,r);var o=u("#"+e.ui.imgResizeWidthField.getInputId()),a={fieldName:"width",maxValue:e.ui.imgResizeWidthField.maxValue,minValue:e.ui.imgResizeWidthField.minValue};o.live("keyup",a,n),o.live("mousewheel",a,r)},_setNormalizedFieldValues:function(e){var t=this,n=o("#"+t.ui.imgResizeWidthField.getInputId()),r=o("#"+t.ui.imgResizeHeightField.getInputId()),i=n.val(),s=r.val(),u=t._normalizeSize(i,s,e);n.val(u.width),r.val(u.height)},setSize:function(e,t){var n=this;n.imageObj.width(e),n.imageObj.height(t);var r=n.imageObj.closest(".Aloha_Image_Resize");r.height(t),r.width(e),n._onResize(n.imageObj),n._onResized(n.imageObj)},clickImage:function(e){var t=this;t.endResize(),t.imageObj=o(e.target);var n=t.imageObj;if(n.hasClass("aloha-ui"))return;t.ui.setScope();var r=n.closest(".aloha-editable");this.restoreProps.push({obj:e.srcElement,src:t.imageObj.attr("src"),width:t.imageObj.width(),height:t.imageObj.height()}),u("#"+t.ui.imgResizeHeightField.getInputId()).val(t.imageObj.height()),u("#"+t.ui.imgResizeWidthField.getInputId()).val(t.imageObj.width()),t.settings.ui.meta&&(t.ui.imgSrcField.setTargetObject(t.imageObj,"src"),t.ui.imgTitleField.setTargetObject(t.imageObj,"title")),f.Selection.preventSelectionChanged();try{t.ui.imgSrcField.focus()}catch(e){}t.settings.ui.resizable&&t.startResize(),t.settings.autoResize&&t.autoResize(),f.Selection.preventSelectionChangedFlag=!1,f.trigger("aloha-image-selected")},findImgMarkup:function(e){var t=this,n=this.config,r,i;typeof e=="undefined"&&(e=f.Selection.getRangeObject()),i=o(e.startContainer);try{if(f.activeEditable)return typeof e.startContainer!="undefined"&&typeof e.startContainer.childNodes!="undefined"&&typeof e.startOffset!="undefined"&&typeof e.startContainer.childNodes[e.startOffset]!="undefined"&&e.startContainer.childNodes[e.startOffset].nodeName.toLowerCase()==="img"&&e.startOffset+1===e.endOffset||i.hasClass("Aloha_Image_Resize")?(r=i.find("img")[0],r.css||(r.css=""),r.title||(r.title=""),r.src||(r.src=""),r):null}catch(s){f.Log.debug(s,"Error finding img markup.")}return null},getPluginFocus:function(){return this.imageObj},_normalizeSize:function(e,t,n){function i(n){if(t>r.settings.maxHeight){var i={org:t,"new":r.settings.maxHeight};u("body").trigger("aloha-image-resize-outofbounds",["height","max",i]),t=r.settings.maxHeight}else if(t<r.settings.minHeight){var i={org:t,"new":r.settings.minHeight};u("body").trigger("aloha-image-resize-outofbounds",["height","min",i]),t=r.settings.minHeight}r.keepAspectRatio&&(e=t*o,n&&s(!1))}function s(n){if(e>r.settings.maxWidth){var s={org:e,"new":r.settings.maxWidth};u("body").trigger("aloha-image-resize-outofbounds",["width","max",s]),e=r.settings.maxWidth}else if(e<r.settings.minWidth){var s={org:e,"new":r.settings.minWidth};u("body").trigger("aloha-image-resize-outofbounds",["width","min",s]),e=r.settings.minWidth}r.keepAspectRatio&&(t=e/o,n&&i(!1))}var r=this;e=parseInt(e),t=parseInt(t);var o=1.33333;return r.keepAspectRatio&&(o=e/t),typeof r.startAspectRatio=="number"&&(o=r.startAspectRatio),n=="width"&&s(!0),n=="height"&&i(!0),{width:Math.floor(e),height:Math.floor(t)}},setSizeByFieldValue:function(){var e=this,t=u("#"+e.ui.imgResizeWidthField.getInputId()).val(),n=u("#"+e.ui.imgResizeHeightField.getInputId()).val();e.setSize(t,n)},setCropAreaByFieldValue:function(){var e=this,t=e.jcAPI.tellSelect(),n=u("#"+e.ui.imgResizeWidthField.getInputId()).val();n=parseInt(n,10);var r=u("#"+e.ui.imgResizeHeightField.getInputId()).val();r=parseInt(r,10);var i=[t.x,t.y,t.x+n,t.y+r];e.jcAPI.setSelect(i)},insertImg:function(){var e=f.Selection.getRangeObject(),t=this.getEditableConfig(f.activeEditable.obj),n=f.getPluginUrl("image"),r,i,s;e.isCollapsed()?(r="max-width: "+t.maxWidth+"; max-height: "+t.maxHeight,i='<img style="'+r+'" src="'+n+'/img/blank.jpg" title="" />',s=o(i),a.Utils.Dom.insertIntoDOM(s,e,o(f.activeEditable.obj))):f.Log.error("img cannot markup a selection")},srcChange:function(){this.imageObj.attr("src",this.ui.imgSrcField.getValue())},positionCropButtons:function(){var e=o(".jcrop-tracker:first"),t=e.offset(),n=t.top,r=t.left,i=e.height(),s=e.width(),u=0,a=0,f=o("#aloha-CropNResize-btns");n===0&&r===0&&f.hide(),n=parseInt(n+i+3,10),r=parseInt(r+s/2-f.width()/2+10,10),(u!=r||a!=n)&&f.offset({top:n,left:r}),u=r,a=n},initCropButtons:function(){var e=this,t;o("body").append('<div id="aloha-CropNResize-btns" display="none"><button class="cnr-crop-apply" title="'+s.t("Accept")+'"></button>'+'<button class="cnr-crop-cancel" title="'+s.t("Cancel")+'"></button>'+"</div>"),t=o("#aloha-CropNResize-btns"),t.find(".cnr-crop-apply").click(function(){e.acceptCrop()}),t.find(".cnr-crop-cancel").click(function(){e.endCrop()}),this.interval=setInterval(function(){e.positionCropButtons()},10)},destroyCropButtons:function(){o("#aloha-CropNResize-btns").remove(),clearInterval(this.interval)},_disableSelection:function(e){e.find("*").attr("unselectable","on").css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none"})},crop:function(){var e=this,t=this.config;e.initCropButtons(),e.settings.ui.resizable&&e.endResize(),e.jcAPI=o.Jcrop(e.imageObj,{onSelect:function(){e._onCropSelect(),window.setTimeout(function(){e.ui.setScope()},10)}}),e._disableSelection(u(".jcrop-holder")),e._disableSelection(u("#imageContainer")),e._disableSelection(u("#aloha-CropNResize-btns")),u("body").trigger("aloha-image-crop-start",[e.imageObj])},_onCropSelect:function(){var e=this;o("#aloha-CropNResize-btns").fadeIn("slow"),o(".jcrop-handle").mousedown(function(){o("#aloha-CropNResize-btns").hide()}),o(".jcrop-tracker").mousedown(function(){o("#aloha-CropNResize-btns").hide()});if(typeof e.jcAPI!="undefined"&&e.jcAPI!==null){e.positionCropButtons();var t=e.jcAPI.tellSelect(),n=o("#"+e.ui.imgResizeWidthField.getInputId()).val(t.w),r=o("#"+e.ui.imgResizeHeightField.getInputId()).val(t.h)}},endCrop:function(){this.jcAPI&&(this.jcAPI.destroy(),this.jcAPI=null),this.destroyCropButtons(),this.ui._imageCropButton.setState(!1),this.settings.ui.resizable&&this.startResize();if(this.keepAspectRatio){var e=this.imageObj.width()/this.imageObj.height();this.startAspectRatio=e}u("body").trigger("aloha-image-crop-stop",[this.imageObj])},acceptCrop:function(){this._onCropped(this.imageObj,this.jcAPI.tellSelect()),this.endCrop()},startResize:function(){var e=this,t=this.imageObj;t=this.imageObj.css({height:this.imageObj.height(),width:this.imageObj.width(),position:"relative","max-height":"","max-width":""}),t.resizable({maxHeight:e.settings.maxHeight,minHeight:e.settings.minHeight,maxWidth:e.settings.maxWidth,minWidth:e.settings.minWidth,aspectRatio:e.startAspectRatio,handles:e.settings.handles,grid:e.settings.grid,resize:function(t,n){e._onResize(e.imageObj)},stop:function(t,n){e._onResized(e.imageObj),this.enableCrop&&window.setTimeout(function(){e.ui.setScope(),that.done(t)},10)}}),t.css("display","inline-block"),o(".ui-wrapper").attr("contentEditable",!1).addClass("aloha-image-box-active Aloha_Image_Resize aloha").css({position:"relative",display:"inline-block","float":e.imageObj.css("float")}).bind("resizestart",function(e){e.preventDefault()}).bind("mouseup",function(e){e.originalEvent.stopSelectionUpdate=!0})},endResize:function(){if(this.imageObj)var e=this.imageObj.closest(".aloha-editable");this.imageObj&&this.imageObj.is(":ui-resizable")&&this.imageObj.resizable("destroy").css({top:0,left:0})},resetSize:function(){var e=this,t=new Image;t.onload=function(){var n=e.getPluginFocus();e.settings.ui.resizable&&e.endResize(),o(n).add(n.parent()).css({width:t.width+"px",height:t.height+"px","max-width":"","max-height":""}),e.settings.ui.resizable&&e.resize()},t.src=e.getPluginFocus().attr("src")},reset:function(){this.settings.ui.crop&&this.endCrop(),this.settings.ui.resizable&&this.endResize();if(this._onReset(this.imageObj))return;for(var e=0;e<this.restoreProps.length;e++)if(this.imageObj.get(0)===this.restoreProps[e].obj){this.imageObj.attr("src",this.restoreProps[e].src),this.imageObj.width(this.restoreProps[e].width),this.imageObj.height(this.restoreProps[e].height);return}}})}),define("highlighteditables/highlighteditables-plugin",["aloha","jquery","aloha/plugin"],function(e,t,n){var r=window.GENTICS;return n.create("highlighteditables",{config:["highlight"],init:function(){var t=this,n;r.Utils.Position.addMouseMoveCallback(function(){var r,i;for(r=0;r<e.editables.length;r++)i=e.editables[r],n=t.getEditableConfig(i.obj),!e.activeEditable&&!i.isDisabled()&&n=="highlight"&&i.obj.addClass("aloha-editable-highlight")}),r.Utils.Position.addMouseStopCallback(function(){t.fade()}),e.bind("aloha-editable-activated",function(e,n){t.fade()})},fade:function(){var n,r,i=function(){t(this).css("outline","")};for(n=0;n<e.editables.length;n++)r=e.editables[n].obj,r.hasClass("aloha-editable-highlight")&&r.css("outline",r.css("outlineColor")+" "+r.css("outlineStyle")+" 5px").removeClass("aloha-editable-highlight").animate({outlineWidth:"0px"},300,"swing",i)}})}),define("dom-to-xhtml/dom-to-xhtml",["jquery","util/dom2","util/misc","util/browser","aloha/ephemera","aloha/console"],function(e,t,n,r,i,s){function f(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")}function l(e){return f(e).replace(/"/g,"&quot;")}function c(e,n){var s=t.attrs(e),o="",a,f;if(r.ie7)for(var c in u)if(u.hasOwnProperty(c)&&e[c]){for(a=0,f=s.length;a<f;a++)if(c===s[a][0].toLowerCase()){s.splice(a,1);break}s.push([c,c])}for(a=0,f=s.length;a<f;a++){var h=s[a],p=h[0].toLowerCase(),d=h[1];if(n&&i.isAttrEphemeral(e,p,n.attrMap||{},n.attrRxs||{}))continue;var v=u[p];if(!v&&""===d)continue;o+=" "+p+'="'+l(v?p:d)+'"'}return o}function h(e){var t=e.nodeName,n=a[t];if(null!=n)return n;var r="/"+e.nodeName,i=e.nextSibling;n=!1;while(null!=i){if(r==i.nodeName){n=!0;break}i=i.nextSibling}return a[t]=n,n}function p(e,t,n,r,i){while(null!=t){if(1===t.nodeType&&n&&"/"+e.nodeName==t.nodeName){t=t.nextSibling;break}1===t.nodeType&&h(t)?t=d(t,t.nextSibling,!0,r,i):(v(t,r,i),t=t.nextSibling)}return t}function d(e,t,n,r,i){var s=e.nodeName.toLowerCase();return e.scopeName&&"HTML"!=e.scopeName&&-1===s.indexOf(":")&&(s=e.scopeName.toLowerCase()+":"+s),!n&&null==t&&o[s]?i.push("<"+s+c(e,r)+"/>"):(i.push("<"+s+c(e,r)+">"),t=p(e,t,n,r,i),i.push("</"+s+">")),t}function v(e,t,n){var r=e.nodeType;1===r?d(e,e.firstChild,h(e),t,n):3===e.nodeType?n.push(f(e.nodeValue)):8===e.nodeType?n.push("<!--"+e.nodeValue+"-->"):s.warn("Unknown node type encountered during serialization, ignoring it: type="+e.nodeType+" name="+e.nodeName+" value="+e.nodeValue)}var o={area:!0,base:!0,basefont:!0,br:!0,col:!0,frame:!0,hr:!0,img:!0,input:!0,isindex:!0,link:!0,meta:!0,param:!0,embed:!0},u={checked:!0,compact:!0,declare:!0,defer:!0,disabled:!0,ismap:!0,multiple:!0,nohref:!0,noresize:!0,noshade:!0,nowrap:!0,readonly:!0,selected:!0},a={DIV:!1,SPAN:!1,UL:!1,OL:!1,LI:!1,TABLE:!1,TR:!1,TD:!1,TH:!1,I:!1,B:!1,EM:!1,STRONG:!1,A:!1,P:!1};return{contentsToXhtml:function(e,t){var n=[];return p(e,e.firstChild,!1,t,n),n.join("")},nodeToXhtml:function(e,t){var n=[];return v(e,t,n),n.join("")}}}),define("dom-to-xhtml/dom-to-xhtml-plugin",["aloha","jquery","aloha/plugin","aloha/ephemera","dom-to-xhtml/dom-to-xhtml"],function(e,t,n,r,i){return n.create("dom-to-xhtml",{init:function(){var n=this;e.Editable.setContentSerializer(function(e){return!n.settings.editables&&!n.settings.config?i.contentsToXhtml(e):n.settings.editables&&n.settings.editables["#"+t(e).attr("id")]=="dom-to-xhtml"?i.contentsToXhtml(e,r.ephemera()):n.settings.config&&n.settings.config=="dom-to-xhtml"&&!n.settings.editables["#"+t(e).attr("id")]?i.contentsToXhtml(e,r.ephemera()):t(e).html()})}})}),define("contenthandler/wordcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(e,t,n){var r=n.createHandler({handleContent:function(e){return typeof e=="string"?e=t("<div>"+e+"</div>"):e instanceof t&&(e=t("<div>").append(e)),this.detectWordContent(e)&&this.transformWordContent(e),e.html()},detectWordContent:function(e){var n=!1;return e.find("*").each(function(){var e=t(this).attr("style"),r;if(e&&e.toLowerCase().indexOf("mso")>=0)return n=!0,!1;r=t(this).attr("class");if(r&&r.toLowerCase().indexOf("mso")>=0)return n=!0,!1}),n},isOrderedList:function(e){return e.css("fontFamily")=="Wingdings"||e.css("fontFamily")=="Symbol"?!1:e.text().match(/^([0-9]{1,3}\.)|([0-9]{1,3}\)|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\)))$/)?!0:!1},transformListsFromWord:function(e){var n=this,r,i,s,o,u,a;a="aloha-list-element",u="aloha-list-bullet",i="p.MsoListParagraphCxSpFirst,p.MsoListParagraphCxSpMiddle,p.MsoListParagraphCxSpLast,p.MsoListParagraph,p span",o=e.find(i),o.each(function(){var e=t(this),n=e.css("font-family")||"",r=e.css("mso-list")||"",i=e.attr("style")||"";e.hasClass("MsoListParagraphCxSpFirst")||e.hasClass("MsoListParagraph")?e.addClass(a):n.indexOf("Symbol")>=0?e.closest("p").addClass(a):n.indexOf("Wingdings")>=0?e.closest("p").addClass(a):r!==""?e.closest("p").addClass(a):i.indexOf("mso-list")>=0&&e.closest("p").addClass(a)}),i="p span span span",s=e.find(i),s.each(function(){var e=t(this),n=t.trim(e.text()).replace(/&nbsp;/g,""),r;n.length===0&&(r=t.trim(e.parent().parent().text()).replace(/&nbsp;/g,""),r.match(/^([0-9]{1,3}\.)|([0-9]{1,3}\))|([a-zA-Z]{1,5}\.)|([a-zA-Z]{1,5}\))|(.)$/)&&(e.closest("p").addClass(a),e.parent().parent().addClass(u)))}),i="p."+a,r=":not("+i+", font)",o=e.find(i),o.length>0&&o.each(function(){var e=t(this),i,s,o,f,l,c,h,p;e.removeClass(a),e.find("font").each(function(){t(this).contents().unwrap()}),p=[],h=parseFloat(e.css("marginLeft")),isNaN(h)&&(h=0),c=[],l=e.nextUntil(r),f=t(e.find("span."+u)),f.length===0&&(f=e.find("span").eq(0)),o=n.isOrderedList(f),f.remove(),s=t(o?"<ol></ol>":"<ul></ul>"),c.push(s),i=t("<li></li>"),s.append(i),e.contents().appendTo(i),e.replaceWith(s),l.each(function(){var e=t(this),r,a;if(e.is("font"))return;e.find("font").each(function(){t(this).contents().unwrap()}),r=parseFloat(e.css("marginLeft")),isNaN(r)&&(r=0),f=t(e.find("span."+u)),f.length===0&&(f=e.find("span").eq(0)),o=n.isOrderedList(f),f.remove();if(r>h)a=t(o?"<ol></ol>":"<ul></ul>"),s.children(":last").append(a),s=a,c.push(s),p.push(r),h=r;else if(r<h&&p.length>0){while(p.length>0&&p[p.length-1]>r)p.pop(),c.pop();s=c[c.length-1],h=r}i=t("<li></li>"),s.append(i),e.contents().appendTo(i),e.remove()})})},transformTitles:function(n){n.find("p.MsoTitle").each(function(){e.Markup.transformDomObject(t(this),"h1")}),n.find("p.MsoSubtitle").each(function(){e.Markup.transformDomObject(t(this),"h2")})},cleanHtml:function(e){e.find("*").filter(function(){return t.trim(t(this).text())==""&&!t(this).is("td")}).contents().unwrap(),e.find("span").contents().unwrap(),e.find("a").each(function(){t(this).attr("href")&&t.trim(t(this).attr("href")).match(/^#(.*)$/)&&t(this).contents().unwrap()}),e.find("div").contents().unwrap(),e.find("*").filter(function(){return t.trim(t(this).text())==""&&!t(this).is("td")}).remove()},removeParagraphNumbering:function(e){var n="h1,h2,h3,h4,h5,h6",r=e.find(n);r.length>0&&r.each(function(){var e=t(this),n=e.find("span"),r=e.find("a");n.each(function(){t.trim(t(this).text()).match(/^([\.\(]?[\d\D][\.\(]?){1,4}$/)&&t(this).remove()}),r.each(function(){typeof t(this).attr("href")=="undefined"&&t(this).contents().unwrap()})})},transformToc:function(e){var n="[class*=MsoToc]",r=e.find(n
);r.each(function(){var e=t(this),n=e.find("span"),r=e.find("a");n.each(function(){t(this).attr("style")&&t(this).attr("style").search("mso-hide")>-1&&t(this).remove(),t(this).contents().unwrap()}),r.each(function(){t(this).contents().unwrap()})})},transformWordContent:function(e){this.transformToc(e),this.removeParagraphNumbering(e),this.transformListsFromWord(e),this.transformTitles(e),this.cleanHtml(e)}});return r}),define("contenthandler/genericcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(e,t,n){var r=window.GENTICS,i=n.createHandler({handleContent:function(n){if(null==n)return;typeof n=="string"?n=t("<div>"+n+"</div>"):n instanceof t&&(n=t("<div>").append(n));if(n.find(".aloha-block").length>0)return n.html();this.cleanLists(n),this.transformTables(n),this.removeComments(n),this.unwrapTags(n),this.removeStyles(n),this.removeNamespacedElements(n);var r=!0;return e.settings&&e.settings.contentHandler&&e.settings.contentHandler.handler&&e.settings.contentHandler.handler.generic&&typeof e.settings.contentHandler.handler.generic.transformFormattings!="undefinded"&&!e.settings.contentHandler.handler.generic.transformFormattings&&(r=!1),r===!0&&this.transformFormattings(n),n.html()},cleanLists:function(e){e.find("ul,ol").each(function(){var e=t(this);e.contents(":not(li,ul,ol)").each(function(){t(this).remove()})})},transformTables:function(e){e.find("table").each(function(){t(this).removeAttr("border").removeAttr("cellspacing").removeAttr("cellpadding")}),e.find("td").each(function(){t(this).removeAttr("width").removeAttr("height").removeAttr("valign"),this.innerHTML.replace(/[\s\xA0]+/g,"")==="<p><br></p>"&&(this.innerHTML="&nbsp;"),t(this).find("p").length===1&&t(this).find("p").contents().unwrap()}),e.find("tr").each(function(){t(this).removeAttr("width").removeAttr("height").removeAttr("valign")}),e.find("colgroup").remove()},transformFormattings:function(n){n.find("strong,em,s,u,strike").each(function(){this.nodeName==="STRONG"?e.Markup.transformDomObject(t(this),"b"):this.nodeName==="EM"?e.Markup.transformDomObject(t(this),"i"):this.nodeName==="S"||this.nodeName=="STRIKE"?e.Markup.transformDomObject(t(this),"del"):this.nodeName==="U"&&t(this).contents().unwrap()})},transformLinks:function(e){e.find("a").each(function(){typeof t(this).attr("href")=="undefined"&&t(this).contents().unwrap()})},removeComments:function(e){var n=this;e.contents().each(function(){this.nodeType===8?t(this).remove():n.removeComments(t(this))})},unwrapTags:function(n){var r=this;n.find("span,font,div").not(".aloha-wai-lang").each(function(){this.nodeName=="DIV"?this.innerHTML==="<br>"?t(this).contents().unwrap():t(e.Markup.transformDomObject(t(this),"p").append("<br>")).contents().unwrap():t(this).contents().unwrap()})},removeStyles:function(e){var n=this;e.children("style").filter(function(){return this.contentEditable!=="false"}).remove(),e.children().filter(function(){return this.contentEditable!=="false"}).each(function(){t(this).removeAttr("style").removeClass(),n.removeStyles(t(this))})},removeNamespacedElements:function(e){e.find("*").each(function(){var e=this.prefix?this.prefix:this.scopeName?this.scopeName:undefined;if(e&&e!=="HTML"||this.nodeName.indexOf(":")>=0){var n=t(this),r=n.contents();r.length?r.unwrap():n.remove()}})}});return i}),define("contenthandler/oembedcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(e,t,n){function c(e,t){var n=e.apiendpoint,r="",s=e.callbackparameter||"callback",o;n.indexOf("?")<=0?n+="?":n+="&",e.maxWidth!=null&&e.params["maxwidth"]==null&&(e.params.maxwidth=e.maxWidth),e.maxHeight!=null&&e.params["maxheight"]==null&&(e.params.maxheight=e.maxHeight);for(o in e.params){if(o==e.callbackparameter)continue;e.params[o]!=null&&(r+="&"+i(o)+"="+e.params[o])}return n+="format=json&url="+i(t)+r+"&"+s+"=?",n}function h(e,n,r){var i=c(r,n),s=t.extend({url:i,type:"get",dataType:"json",success:function(r){var i=t.extend({},r);switch(i.type){case"photo":i.code=t.fn.oembed.getPhotoCode(n,i);break;case"video":i.code=t.fn.oembed.getVideoCode(n,i);break;case"rich":i.code=t.fn.oembed.getRichCode(n,i);break;default:i.code=t.fn.oembed.getGenericCode(n,i)}f.beforeEmbed.call(e,i),f.onEmbed.call(e,i),f.afterEmbed.call(e,i)},error:f.onError.call(e,n,r)},f.ajaxOptions||{});t.ajax(s)}function p(){l=[];var e,n=[],r,i;if(!v(f.allowedProviders)){for(r=0;r<t.fn.oembed.providers.length;r++)t.inArray(t.fn.oembed.providers[r].name,f.allowedProviders)>=0&&l.push(t.fn.oembed.providers[r]);f.greedy=!1}else l=t.fn.oembed.providers;if(!v(f.disallowedProviders)){for(r=0;r<l.length;r++)t.inArray(l[r].name,f.disallowedProviders)<0&&n.push(l[r]);l=n,f.greedy=!1}v(f.customProviders)||t.each(f.customProviders,function(e,n){n instanceof t.fn.oembed.OEmbedProvider?l.push(i):(i=new t.fn.oembed.OEmbedProvider,i.fromJSON(n)&&l.push(i))}),e=d(f.defaultOEmbedProvider),f.greedy==1&&l.push(e);for(r=0;r<l.length;r++)l[r].apiendpoint==null&&(l[r].apiendpoint=e.apiendpoint)}function d(e){var n="http://oohembed.com/oohembed/";return e=="embed.ly"&&(n="http://api.embed.ly/v1/api/oembed?"),new t.fn.oembed.OEmbedProvider(e,null,null,n,"callback")}function u(e){if(e==null)return null;var t,n={};for(t in e)t!=null&&(n[t.toLowerCase()]=e[t]);return n}function v(e){return typeof e=="undefined"?!0:e==null?!0:t.isArray(e)&&e.length==0?!0:!1}var r=window.GENTICS,i=window.escape,s,o,u,a;t.fn.oembed=function(e,n,r){return f=t.extend(!0,t.fn.oembed.defaults,n),p(),this.each(function(){var n=t(this),i=e!=null?e:n.attr("href"),s;return r?f.onEmbed=r:f.onEmbed=function(e){t.fn.oembed.insertCode(this,f.embedMethod,e)},i!=null&&(s=t.fn.oembed.getOEmbedProvider(i),s!=null?(s.params=u(f[s.name])||{},s.maxWidth=f.maxWidth,s.maxHeight=f.maxHeight,h(n,i,s)):f.onProviderNotFound.call(n,i)),n})};var f,l=[];t.fn.oembed.defaults={maxWidth:null,maxHeight:null,embedMethod:"replace",defaultOEmbedProvider:"oohembed",allowedProviders:null,disallowedProviders:null,customProviders:null,defaultProvider:null,greedy:!0,onProviderNotFound:function(){},beforeEmbed:function(){},afterEmbed:function(){},onEmbed:function(){},onError:function(){},ajaxOptions:{}},t.fn.oembed.embedCode=!1,t.fn.oembed.insertCode=function(e,n,r){if(r==null)return;t.fn.oembed.embedCode=r.code;switch(n){case"auto":e.attr("href")!=null?t.fn.oembed.insertCode(e,"append",r):t.fn.oembed.insertCode(e,"replace",r);break;case"replace":e.replaceWith(r.code);break;case"fill":e.html(r.code);break;case"append":var i=e.next();if(i==null||!i.hasClass("oembed-container"))i=e.after('<div class="oembed-container"></div>').next(".oembed-container"),r!=null&&r.provider_name!=null&&i.toggleClass("oembed-container-"+r.provider_name);i.html(r.code)}},t.fn.oembed.getInsertCode=function(e,t,n){if(n==null)return;return n.code},t.fn.oembed.getPhotoCode=function(e,t){var n,r=t.title?t.title:"";return r+=t.author_name?" - "+t.author_name:"",r+=t.provider_name?" - "+t.provider_name:"",n='<div><a href="'+e+"\" target='_blank'><img src=\""+t.url+'" alt="'+r+'"/></a></div>',t.html&&(n+="<div>"+t.html+"</div>"),n},t.fn.oembed.getVideoCode=function(e,t){var n=t.html;return n},t.fn.oembed.getRichCode=function(e,t){var n=t.html;return n},t.fn.oembed.getGenericCode=function(e,t){var n=t.title!=null?t.title:e,r='<a href="'+e+'">'+n+"</a>";return t.html&&(r+="<div>"+t.html+"</div>"),r},t.fn.oembed.isProviderAvailable=function(e){var t=o(e);return t!=null},t.fn.oembed.getOEmbedProvider=function(e){for(var t=0;t<l.length;t++)if(l[t].matches(e))return l[t];return null},t.fn.oembed.OEmbedProvider=function(e,n,r,i,s){function f(e){return v(e)?["."]:t.isArray(e)?e:e.split(";")}this.name=e,this.type=n,this.urlschemes=f(r),this.apiendpoint=i,this.callbackparameter=s,this.maxWidth=500,this.maxHeight=400;var o,u,a;this.matches=function(e){for(o=0;o<this.urlschemes.length;o++){a=new RegExp(this.urlschemes[o],"i");if(e.match(a)!=null)return!0}return!1},this.fromJSON=function(e){for(u in e)u!="urlschemes"?this[u]=e[u]:this[u]=f(e[u]);return!0}},t.fn.oembed.providers=[new t.fn.oembed.OEmbedProvider("youtube","video",["youtube\\.com/watch.+v=[\\w-]+&?"]),new t.fn.oembed.OEmbedProvider("flickr","photo",["flickr\\.com/photos/[-.\\w@]+/\\d+/?"],"http://flickr.com/services/oembed","jsoncallback"),new t.fn.oembed.OEmbedProvider("viddler","video",["viddler.com"]),new t.fn.oembed.OEmbedProvider("blip","video",["blip\\.tv/.+"],"http://blip.tv/oembed/"),new t.fn.oembed.OEmbedProvider("hulu","video",["hulu\\.com/watch/.*"],"http://www.hulu.com/api/oembed.json"),new t.fn.oembed.OEmbedProvider("vimeo","video",["http://www.vimeo.com/groups/.*/videos/.*","http://www.vimeo.com/.*","http://vimeo.com/groups/.*/videos/.*","http://vimeo.com/.*"],"http://vimeo.com/api/oembed.json"),new t.fn.oembed.OEmbedProvider("dailymotion","video",["dailymotion\\.com/.+"]),new t.fn.oembed.OEmbedProvider("scribd","rich",["scribd\\.com/.+"]),new t.fn.oembed.OEmbedProvider("slideshare","rich",["slideshare.net"],"http://www.slideshare.net/api/oembed/1"),new t.fn.oembed.OEmbedProvider("photobucket","photo",["photobucket\\.com/(albums|groups)/.*"],"http://photobucket.com/oembed/")];var m=n.createHandler({handleContent:function(e){typeof e=="string"?e=t("<div>"+e+"</div>").get(0):e instanceof t&&(e=t("<div>").append(e).get(0)),e=t(e).oembed(t(e).text(),{embedMethod:"replace"});var n=setTimeout(function(){return e=t.fn.oembed.embedCode,t("<div>").append(e).html()},500)},replaceoEmbedContent:function(e){}});return m}),define("contenthandler/sanitizecontenthandler",["aloha/core","jquery","aloha/contenthandlermanager","aloha/plugin","aloha/console","vendor/sanitize"],function(e,t,n,r,i){function o(n){var r=["restricted","basic","relaxed"],i=e.defaults.supports;e.settings.contentHandler.sanitize&&t.inArray(e.settings.contentHandler.sanitize,r)>-1?i=e.defaults.sanitize[e.settings.contentHandler.sanitize]:i=e.defaults.sanitize.relaxed,e.settings.contentHandler.allows&&(i=e.settings.contentHandler.allows),n&&(i=n),i.filters=[function(e){return e.contentEditable!="false"}],s=new Sanitize(i,t)}var s;e.defaults.sanitize||(e.defaults.sanitize={}),e.defaults.sanitize.restricted={elements:["b","em","i","strong","u","del","p","span","div","br"]},e.defaults.sanitize.basic={elements:["a","abbr","b","blockquote","br","cite","code","dd","del","dl","dt","em","i","li","ol","p","pre","q","small","strike","strong","sub","sup","u","ul"],attributes:{a:["href"],blockquote:["cite"],q:["cite"],abbr:["title"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}},e.defaults.sanitize.relaxed={elements:["a","abbr","b","blockquote","br","caption","cite","code","col","colgroup","dd","del","dl","dt","em","h1","h2","h3","h4","h5","h6","i","img","li","ol","p","pre","q","small","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","u","ul","span","hr","object","div"],attributes:{a:["href","title","id","class","target","data-gentics-aloha-repository","data-gentics-aloha-object-id"],div:["id","class","style"],abbr:["title"],blockquote:["cite"],br:["class"],col:["span","width"],colgroup:["span","width"],img:["align","alt","height","src","title","width","class","data-caption","data-align","data-width","data-original-image"],ol:["start","type"],p:["class","style","id"],q:["cite"],table:["summary","width"],td:["abbr","axis","colspan","rowspan","width"],th:["abbr","axis","colspan","rowspan","scope","width"],ul:["type"],span:["class","style","lang","xml:lang","role"]},protocols:{a:{href:["ftp","http","https","mailto","__relative__"]},blockquote:{cite:["http","https","__relative__"]},img:{src:["http","https","__relative__"]},q:{cite:["http","https","__relative__"]}}};var u=n.createHandler({handleContent:function(n){var r,i;if(e.activeEditable&&e.settings.contentHandler&&e.settings.contentHandler.handler&&e.settings.contentHandler.handler.sanitize){e.settings.contentHandler.handler.sanitize&&(i=e.settings.contentHandler.handler.sanitize);var u=i["#"+e.activeEditable.getId()];if(typeof u!="undefined")r=i;else{var a=e.activeEditable.obj.attr("class").split(" ");for(var f=0;f<a.length;f++)typeof i["."+a[f]]!="undefined"&&(r=i["."+a[f]])}}return(typeof s=="undefined"||typeof r!="undefined")&&o(r),typeof n=="string"?n=t("<div>"+n+"</div>").get(0):n instanceof t&&(n=t("<div>").append(n).get(0)),t("<div>").append(s.clean_node(n)).html()}});return u}),define("contenthandler/blockelementcontenthandler",["aloha","jquery","aloha/contenthandlermanager"],function(e,t,n){var r={h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,p:!0,pre:!0,blockquote:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,P:!0,PRE:!0,BLOCKQUOTE:!0},i={br:!0,BR:!0},s=function(e){return r[e.nodeName]&&(!e.lastChild||!i[e.lastChild.nodeName])},o=function(e,n){var r=t(n);r.filter("h1:empty,h2:empty,h3:empty,h4:empty,h5:empty,h6:empty,p:empty,pre:empty,blockquote:empty").remove(),t.browser.msie?r.filter("br.aloha-end-br").remove():r.filter("li").each(function(){s(this)&&t(this).append("<br/>")}),r.children(":not(.aloha-block)").each(o)},u=function(e,n){var r=t(n);r.filter("h1:empty,h2:empty,h3:empty,h4:empty,h5:empty,h6:empty,p:empty,pre:empty,blockquote:empty").append("​"),r.children(":not(.aloha-block)").each(u)},a=function(e,n){var r=t(n);r.filter("p,h1,h2,h3,h4,h5,h6,pre,blockquote").length>0&&s(n)&&t(n).append("<br/>"),r.children(":not(.aloha-block)").each(a)},f=n.createHandler({handleContent:function(e,n){return typeof e=="string"?e=t("<div>"+e+"</div>"):e instanceof t&&(e=t("<div>").append(e)),n=n||{},n.command==="initEditable"?(e.children(":not(.aloha-block)").each(o),t.browser.msie&&t.browser.version<=7&&e.children(":not(.aloha-block)").each(u)):n.command==="getContents"&&(e.children(":not(.aloha-block)").each(a),e.find("li>br:last").remove()),e.html()}});return f}),define("contenthandler/contenthandler-plugin",["aloha","aloha/plugin","jquery","aloha/contenthandlermanager","contenthandler/wordcontenthandler","contenthandler/genericcontenthandler","contenthandler/oembedcontenthandler","contenthandler/sanitizecontenthandler","contenthandler/blockelementcontenthandler"],function(e,t,n,r,i,s,o,u,a){var f=t.create("contenthandler",{settings:{},dependencies:[],init:function(){var e={word:i,generic:s,sanitize:u,blockelement:a},t;for(t in e)e.hasOwnProperty(t)&&r.register(t,e[t])}});return f}),define("commands/inserthtml",["aloha/core","jquery","aloha/command","aloha/selection","util/dom","aloha/contenthandlermanager","aloha/console"],function(e,t,n,r,i,s,o){n.register("inserthtml",{action:function(n,r){function h(e){var n=t(e),s;if(!i.insertIntoDOM(n,r,u,!1)){s=n.contents(),(i.isBlockLevelElement(e)||i.isListElement(e))&&h(t("<br/>").get(0));for(f=s.length-1;f>=0;--f)h(s[f])}}var u=t(i.getEditingHostOf(r.startContainer)),a=r.commonAncestorContainer,f,l,c=[];n=s.handleContent(n,{contenthandler:e.settings.contentHandler.insertHtml});if(typeof n=="string")n=t("<div>"+n+"</div>");else{if(!(n instanceof t))throw"INVALID_VALUE_ERR";n=t("<div>").append(n)}c=n.contents(),i.removeRange(r);for(f=c.length-1;f>=0;--f)h(c[f]);c.length>0?r=i.setCursorAfter(c.get(c.length-1)):r.select(),i.doCleanup({merge:!0,removeempty:!0},r,a);try{r.select()}catch(p){o.warn("Error:",p)}}})}),define("commands/commands-plugin",["aloha/command","./inserthtml"],function(e,t){}),define("block/blockmanager",["aloha","jquery","ui/scopes","aloha/observable","aloha/registry","util/class","util/strings","util/maps"],function(e,t,n,r,i,s,o,u){var a=window.GENTICS,f=new(s.extend(r,{defaults:{"aloha-block-type":"DefaultBlock"},blockTypes:null,blocks:null,_highlightedBlocks:null,_activeBlock:null,_dragdropEnabled:!0,_constructor:function(){n.createScope("Aloha.Block"),this.blockTypes=new i,this.blocks=new i,this._highlightedBlocks={}},registerEventHandlers:function(){var n=this;this._registerEventHandlersForDeactivatingAlohaBlock(),this._registerEventHandlersForDeterminingCurrentlyActiveBlock(),this._registerEventHandlersForBlockDeletion(),this._registerEventHandlersForCutCopyPaste(),e.bind("aloha-selection-changed",function(e,r,i){if(r&&t(r.getCommonAncestorContainer()).parents(".aloha-block").length>0)return;n._deactivateHighlightedBlocks()})},_registerEventHandlersForDeactivatingAlohaBlock:function(){var e=this;t(document).bind("click",function(n){if(u.isEmpty(e._highlightedBlocks))return;if(t(n.target).closest(".aloha-ui,.aloha-block-do-not-deactivate,.aloha-block").length>0)return;e._deactivateHighlightedBlocks()})},_registerEventHandlersForDeterminingCurrentlyActiveBlock:function(){var e=this;this.bind("block-selection-change",function(t){t.length>0?e._activeBlock=t[0]:e._activeBlock=null})},_registerEventHandlersForBlockDeletion:function(){var n=this;e.bind("aloha-command-will-execute",function(r,i){var s=i.commandId,o=e.getSelection().getRangeCount()===0||e.getSelection().getRangeCount()===1&&e.getSelection().getRangeAt(0).endContainer===e.getSelection().getRangeAt(0).startContainer&&e.getSelection().getRangeAt(0).endContainer===t("body")[0]||e.getSelection().getRangeCount()===1&&e.getSelection().getRangeAt(0).endContainer===e.getSelection().getRangeAt(0).startContainer&&e.getSelection().getRangeAt(0).startOffset+1===e.getSelection().getRangeAt(0).endOffset;if(n._activeBlock&&(s==="delete"||s==="forwarddelete")&&o)i.preventDefault=!0,n._activeBlock.destroy();else if(!n._activeBlock&&(s==="delete"||s==="forwarddelete")&&e.getSelection().getRangeCount()===1&&e.getSelection().getRangeAt(0).collapsed===!1){var u;u=function(e){var n;for(var r=0,i=e.length;r<i;r++){n=e[r];if(n.domobj.nodeType===1){var s=t(n.domobj);n.selection==="full"&&s.is(".aloha-block")?s.remove():u(n.children)}}},u(e.Selection.getSelectionTree())}}),t(window.document).keydown(function(e){if(typeof e.srcElement!="undefined"&&typeof e.srcElement.form!="undefined")return!0;if(n._activeBlock&&(e.which===46||e.which===8)&&n._activeBlock._isInsideNestedEditable===!1){if(t.browser.msie&&parseInt(t.browser.version,10)<=8&&n._activeBlock.$element.parents(".aloha-editable,.aloha-block").first().hasClass("aloha-editable"))return n._activeBlock.destroy(),e.preventDefault(),!1;if(n._activeBlock.shouldDestroy())return n._activeBlock.destroy(),e.preventDefault(),!1}})},_registerEventHandlersForCutCopyPaste:function(){var e=this,n=!1,r=!1,i=null;t(window.document).keydown(function(t){e._activeBlock&&(t.ctrlKey||t.metaKey)&&t.which===67&&(n=!0,e._activeBlock.$element.attr("data-aloha-block-copy-only-block","true"),a.Utils.Dom.selectDomNode(e._activeBlock.$element[0])),e._activeBlock&&(t.ctrlKey||t.metaKey)&&t.which===88&&(r=!0,e._activeBlock.$element.attr("data-aloha-block-copy-only-block","true"),a.Utils.Dom.selectDomNode(e._activeBlock.$element[0]))}),t(window.document).keyup(function(t){!r&&n&&(t.which===67||t.which===18||t.which===91)&&(n=!1,e._activeBlock.$element.removeAttr("data-aloha-block-copy-only-block"),i&&(i=null)),r&&(t.which===67||t.which===18||t.which===88)&&(r=!1)})},initializeBlockLevelDragDrop:function(){var n=this;t.each(e.editables,function(e,t){t.obj.data("block-dragdrop",n._dragdropEnabled),n.createBlockLevelSortableForEditableOrBlockCollection(t.obj)}),e.bind("aloha-editable-created",function(e,t){t.obj.data("block-dragdrop",n._dragdropEnabled),n.createBlockLevelSortableForEditableOrBlockCollection(t.obj)})},createBlockLevelSortableForEditableOrBlockCollection:function(e){var n=this;e.hasClass("aloha-block-blocklevel-sortable")||(e.addClass("aloha-block-blocklevel-sortable").sortable({revert:100,handle:".aloha-block-draghandle-blocklevel",connectWith:".aloha-block-blocklevel-sortable.aloha-block-dropzone",disabled:!n._dragdropEnabled,start:function(e,t){t.item.data("block-sort-allowed",t.item.parents(".aloha-block-dropzone").length>0)},change:function(e,t){t.item.data("block-sort-allowed",t.placeholder.parents(".aloha-block-dropzone").length>0)},stop:function(e,n){n.item.data("block-sort-allowed")||t(this).sortable("cancel"),n.item.removeData("block-sort-allowed")}}),e.get(0).ondragstart=function(e,t){if(!t||!t.helper||!t.helper.is(".aloha-block"))return!1})},setDragDropState:function(e){this._dragdropEnabled=e},getDragDropState:function(){return this._dragdropEnabled},registerBlockType:function(e,t){n.createScope("Aloha.Block."+e,"Aloha.Block"),this.blockTypes.register(e,t)},_blockify:function(n,r){var i=this,s=t(n),o=e.require("block/block-plugin"),u=s[0].tagName.toLowerCase(),a,f;if(t.inArray(u,o.settings.rootTags)===-1){e.Log.error("block/blockmanager","Blocks can only be created from ["+o.settings.rootTags.join(", ")+"]"+"] element. You passed "+u+".");return}a=this.getConfig(s,r);if(!this.blockTypes.has(a["aloha-block-type"])){e.Log.error("block/blockmanager","Block Type "+a["aloha-block-type"]+" not found!");return}f=new(this.blockTypes.get(a["aloha-block-type"]))(s,a),f.$element.addClass("aloha-block-"+a["aloha-block-type"]),this.blocks.register(f.getId(),f)},_unblockify:function(e){var t=this.getBlock(e);t&&t.unblock()},getConfig:function(e,n){var r=e.clone(!0),i=r.data(),s={};r.removeData();for(var u in i)i.hasOwnProperty(u)&&(s[o.camelCaseToDashes(u)]=i[u]);return t.extend({},this.defaults,n,s)},getBlock:function(e){var n,r;return typeof e=="object"?(r=t(e),r.hasClass("aloha-block-inner")&&(r=r.parent()),n=r.attr("id")):n=e,this.blocks.get(n)},_unregisterBlock:function(e){var t;typeof e=="object"?t=e.getId():t=e,this.blocks.unregister(t)},_deactivateHighlightedBlocks:function(){t.each(t.extend({},this._highlightedBlocks),function(e){var t=f.getBlock(e);t&&t.deactivate()})},_getHighlightedBlocks:function(){var e={};return t.each(this.blocks.getEntries(),function(t,n){n.isActive()&&(e[t]=n)}),e},_setHighlighted:function(e){this._highlightedBlocks[e.id]=!0},_setUnhighlighted:function(e){delete this._highlightedBlocks[e.id]}}));return e.Block=e.Block||{},e.Block.BlockManager=f,f}),define("block/editormanager",["aloha/registry"],function(e){return new(e.extend({createEditor:function(e){if(!this.has(e.type))throw'Editor for type "'+e.type+'" not found.';var t=this.get(e.type);return new t(e)}}))}),define("block/sidebarattributeeditor",["jquery","block/blockmanager","aloha/sidebar","block/editormanager","util/class"],function(e,t,n,r,i){return new(i.extend({_sidebar:null,init:function(){this._sidebar=n.right.show(),t.bind("block-selection-change",this._onBlockSelectionChange,this)},_onBlockSelectionChange:function(t){var n=this;if(!this._sidebar)return;e.each(t,function(){var t=this.getSchema(),i=this,s=[];if(!t)return;n._sidebar.addPanel({title:i.getTitle(),expanded:!0,onInit:function(){var n=e("<form />");n.submit(function(){return!1}),e.each(t,function(e,t){var o=r.createEditor(t);o.bind("change",function(t){i.attr(e,t)}),i.bind("change",function(){o.setValue(i.attr(e))}),n.append(o.render()),o.setValue(i.attr(e)),s.push(o)}),this.setContent(n)},deactivate:function(){e.each(s,function(e,t){t._deactivate()}),this.isActive=!1,this.effectiveElement=null}})})}}))}),define("block/block",["aloha","jquery","block/blockmanager","aloha/observable","ui/scopes","util/class","PubSub"],function(e,t,n,r,i,s,o){function h(e){var t=e.closest(".aloha-editable");return t.length?!!t.data("block-dragdrop"):!0}var u=window.GENTICS,a=s.extend(r,{title:null,id:null,$element:null,_currentlyRendering:!1,_initialized:!1,_isInsideNestedEditable:!1,_constructor:function(e,n){var r=this;this.$element=e,e.attr("id")?this.id=e.attr("id"):(this.id=u.Utils.guid(),e.attr("id",this.id)),e.contentEditable(!1),e.addClass("aloha-block"),this.isDraggable()&&(e.find("img").attr("draggable","false"),e.find("a").attr("draggable","false")),t.each(n,function(e,t){r._setAttribute(e,t)}),this._onElementClickHandler=function(e){t(e.target).closest(".aloha-block").get(0)===r.$element.get(0)&&(r._fixScrollPositionBugsInIE(),r.activate(e.target,e))},this._connectThisBlockToDomElement(e,function(){o.pub("aloha.block.initialized",{block:r})}),this._initialized=!0},_onElementClickHandler:null,_preventSelectionChangedEventHandler:function(){e.Selection.preventSelectionChanged()},_connectThisBlockToDomElement:function(e,n){var r=this,i=t(e);this._disconnectFromDomElement(),this.$element=i,this.$element.bind("click",this._onElementClickHandler),this.$element.bind("mousedown",this._preventSelectionChangedEventHandler),this.$element.bind("focus",this._preventSelectionChangedEventHandler),this.$element.bind("dblclick",this._preventSelectionChangedEventHandler),this.init(this.$element,function(){window.setTimeout(function(){r._postProcessElementIfNeeded(),n&&n()},5)})},_disconnectFromDomElement:function(){this.$element&&(this.$element.unbind("click",this._onElementClickHandler),this.$element.unbind("mousedown",this._preventSelectionChangedEventHandler),this.$element.unbind("focus",this._preventSelectionChangedEventHandler),this.$element.unbind("dblclick",this._preventSelectionChangedEventHandler))},_fixScrollPositionBugsInIE:function(){var e=t(window).scrollTop();window.setTimeout(function(){t(window).scrollTop()!==e&&t(window).scrollTop(e)},10)},init:function(e,t){t()},shouldDestroy:function(){var e=this.$element.parent().closest(".aloha-block,.aloha-editable,.aloha-block-collection");return e.hasClass("aloha-block-collection")&&this.$element[0].tagName.toLowerCase()==="div"?!0:e.hasClass("aloha-editable")},destroy:function(e){if(!this.shouldDestroy()&&e!==!0)return;var t=this,r=new u.Utils.RangeObject;r.startContainer=r.endContainer=this.$element.parent()[0],r.startOffset=r.endOffset=u.Utils.Dom.getIndexInParent(this.$element[0]),n.trigger("block-delete",this),this.free();var i=this.$element[0].tagName.toLowerCase()==="span";this.$element.fadeOut("fast",function(){t.$element.remove(),n.trigger("block-selection-change",[]),window.setTimeout(function(){i&&r.select()},5)})},unblock:function(){this.deactivate(),this._disconnectFromDomElement(),this.$element.removeClass("aloha-block"),this.$element.children(".aloha-block-handle").remove(),this.free()},free:function(){n._unregisterBlock(this),this.unbindAll()},getId:function(){return this.id},getSchema:function(){return null},getTitle:function(){return this.title},isDraggable:function(){return this.$element[0].tagName.toLowerCase()==="div"&&this.$element.parents(".aloha-editable,.aloha-block,.aloha-block-collection").first().hasClass("aloha-block-collection")?!0:this.$element.parents(".aloha-editable,.aloha-block").first().hasClass("aloha-editable")},activate:function(r,s){var o=[];t.each(n._getHighlightedBlocks(),function(){this.deactivate()}),this.$element.attr("data-block-skip-scope")!=="true"&&i.setScope("Aloha.Block."+this.attr("aloha-block-type")),this.$element.addClass("aloha-block-active"),this._highlight(),o.push(this),this.$element.parents(".aloha-block").each(function(){var e=n.getBlock(this);e&&(e._highlight(),o.push(e))}),t(r).closest(".aloha-editable,.aloha-block,.aloha-table-cell-editable").first().hasClass("aloha-block")?(this._isInsideNestedEditable=!1,e.getSelection().removeAllRanges()):(this._isInsideNestedEditable=!0,s&&e.Selection.updateSelection(s)),n.trigger("block-activate",o),n.trigger("block-selection-change",o)},deactivate:function(){var e=this,t=[this];this._unhighlight(),this.$element.parents(".aloha-block").each(function(){t.push(this),e._unhighlight()}),this.$element.removeClass("aloha-block-active"),n.trigger("block-deactivate",t),n.trigger("block-selection-change",[])},isActive:function(){return this.$element.hasClass("aloha-block-active")},_highlight:function(){this.$element.addClass("aloha-block-highlighted"),n._setHighlighted(this)},_unhighlight:function(){this.$element.removeClass("aloha-block-highlighted"),n._setUnhighlighted(this)},_update:function(){var e=this;if(this._currentlyRendering)return;if(!this._initialized)return;this._currentlyRendering=!0,this.update(this.$element,function(){e._postProcessElementIfNeeded()}),this._currentlyRendering=!1},update:function(e,t){t()},_postProcessElementIfNeeded:function(){this.createEditablesIfNeeded(),this._checkThatNestedBlocksAreStillConsistent(),this._makeNestedBlockCollectionsSortable(),this.renderBlockHandlesIfNeeded(),this.isDraggable()&&this.$element[0].tagName.toLowerCase()==="span"?(this._setupDragDropForInlineElements(),this._disableUglyInternetExplorerDragHandles()):this.isDraggable()&&this.$element[0].tagName.toLowerCase()==="div"&&(this._setupDragDropForBlockElements(),this._disableUglyInternetExplorerDragHandles()),this._hideDragHandlesIfDragDropDisabled(),this._attachDropzoneHighlightEvents()},_checkThatNestedBlocksAreStillConsistent:function(){this.$element.find(".aloha-block").each(function(){var e=n.getBlock(this);e&&e.$element[0]!==this&&e._connectThisBlockToDomElement(this)})},_makeNestedBlockCollectionsSortable:function(){var e=this;this.$element.find(".aloha-block-collection").each(function(){var r=t(this);r.closest(".aloha-block").get(0)===e.$element.get(0)&&n.createBlockLevelSortableForEditableOrBlockCollection(r)})},_disableUglyInternetExplorerDragHandles:function(){t.browser.msie&&(this.$element.get(0).onresizestart=function(e){return!1},this.$element.get(0).oncontrolselect=function(e){return!1},this.$element.get(0).onmovestart=function(e){return!1})},_hideDragHandlesIfDragDropDisabled:function(){this._dd_isDragdropEnabled()||this.$element.find(".aloha-block-draghandle").each(function(){var e=t(this);h(e)||e.removeClass("aloha-block-draghandle")})},_attachDropzoneHighlightEvents:function(){var e=this;this.$element.delegate(".aloha-block-draghandle","mousedown",function(){var n=e.$element.parents(".aloha-editable").first().data("block-dropzones")||[];t.each(n,function(e,n){var r=t(n);t(r).each(function(){t(this).data("block-dragdrop")&&t(this).addClass("aloha-block-dropzone")})}),t(document).one("mouseup.aloha-block-dropzone",function(n){var r=e.$element.parents(".aloha-editable").first().data("block-dropzones")||[];t.each(r,function(e,n){t(n).removeClass("aloha-block-dropzone")})})})},_setupDragDropForInlineElements:function(){var e=this,n=null,r=!1,i=null,s=null,o=function(){if(n){var o=t(n);o.is(".aloha-block-dropInlineElementIntoEmptyBlock")?(o.children().remove(),o.append(i)):o.is(".aloha-block-droppable-right")?(o.html(o.html()+" "),o.after(i)):(o.prev("[data-i]").length>0&&o.prev("[data-i]").html(o.prev("[data-i]").html()+" "),o.html(" "+o.html()),o.before(i)),i.removeClass("ui-draggable").css({left:0,top:0}),e._fixScrollPositionBugsInIE()}t(".aloha-block-dropInlineElementIntoEmptyBlock").removeClass("aloha-block-dropInlineElementIntoEmptyBlock"),s.droppable("destroy"),s=null,r=!0},u=[];this.$element.draggable({handle:".aloha-block-draghandle",scope:"aloha-block-inlinedragdrop",disabled:!this._dd_isDragdropEnabled(),revert:function(){return n===null||!r},revertDuration:250,stop:function(){t.browser.msie&&7===parseInt(t.browser.version,10)&&o(),t.each(u,function(){e._dd_traverseDomTreeAndRemoveSpans(this)}),i=null,u=[]},start:function(){r=!1,u=[],t(".aloha-editable").children("p:empty").html("&nbsp;");var a={tolerance:"pointer",addClasses:!1,scope:"aloha-block-inlinedragdrop",over:function(r,s){t.inArray(this,u)===-1&&u.push(this);var o=1===t(this).contents().length&&1===t(this).children("br").length;i=s.draggable;if(t(this).is(":empty")||o||t(this).html()==="&nbsp;"){t(this).addClass("aloha-block-dropInlineElementIntoEmptyBlock"),n=this;return}e._dd_traverseDomTreeAndWrapCharactersWithSpans(this),t("span[data-i]",this).droppable({tolerance:"pointer",addClasses:!1,scope:"aloha-block-inlinedragdrop",over:function(){n&&t(n).removeClass("aloha-block-droppable"),n=this,t(this).addClass("aloha-block-droppable")},out:function(){t(this).removeClass("aloha-block-droppable"),n===this&&(n=null)}}),t.ui.ddmanager.prepareOffsets(s.draggable.data("draggable"),r)},out:function(){t(this).removeClass("aloha-block-dropInlineElementIntoEmptyBlock")},drop:function(){(!t.browser.msie||7!==parseInt(t.browser.version,10))&&o()}};s=t(".aloha-editable.aloha-block-dropzone").children(":not(.aloha-block)"),s.droppable(a),t(".aloha-table-cell-editable").droppable(a)}})},_dd_traverseDomTreeAndWrapCharactersWithSpans:function(e){var t;for(var n=0,r=e.childNodes.length;n<r;n++){t=e.childNodes[n];if(t.nodeType===1){if(!~t.className.indexOf("aloha-block")&&t.attributes["data-i"]===undefined)this._dd_traverseDomTreeAndWrapCharactersWithSpans(t);else if(t.attributes["data-i"])return}else if(t.nodeType===3){var i=this._dd_insertSpans(t);n+=i,r+=i}}},_dd_splitText:function(e){var t=e.split(/(?=\b)/),n=[],r=!1;for(var i=0,s=t.length;i<s;i++)/[^\t\n\r ]/.test(t[i])?r?(n.push(" "+t[i]),r=!1):n.push(t[i]):r=!0;return r&&(n[n.length-1]+=" "),n},_dd_insertSpans:function(e){var n=e.nodeValue;if(!/[^\t\n\r ]/.test(n))return 0;var r=document.createDocumentFragment(),i=this._dd_splitText(n),s=i.length,o,u,a,f,l=0;for(var c=0;c<s;c++){u=i[c];if(u.length===0)
continue;a=Math.floor(u.length/2);var h=parseInt(t.browser.version,10);t.browser.msie&&(7===h||8===h)&&(a=0),a>0&&(o=document.createElement("span"),o.appendChild(document.createTextNode(u.substr(0,a))),o.setAttribute("data-i",c),r.appendChild(o),l++),o=document.createElement("span"),f=u.substr(a),o.appendChild(document.createTextNode(f)),o.setAttribute("data-i",c),o.setAttribute("class","aloha-block-droppable-right"),r.appendChild(o),l++}return e.parentNode.replaceChild(r,e),l-1},_dd_traverseDomTreeAndRemoveSpans:function(e){var t=[],n;n=function(e){var r=!1,i,s,o;for(var u=0,a=e.childNodes.length;u<a;u++)o=e.childNodes[u],o.nodeType===1&&(o.attributes["data-i"]!==undefined?(r||(r=!0,i="",s=undefined),r&&(i+=o.firstChild.nodeValue,s&&t.push(s),s=o)):(r&&(r=!1,s.parentNode.replaceChild(document.createTextNode(i),s)),~o.className.indexOf("aloha-block")||n(o)));r&&s.parentNode.replaceChild(document.createTextNode(i),s)},n(e);for(var r=0,i=t.length;r<i;r++)t[r].parentNode.removeChild(t[r])},_dd_isDragdropEnabled:function(){return h(this.$element.parent())},_setupDragDropForBlockElements:function(){this.$element.find(".aloha-block-draghandle").addClass("aloha-block-draghandle-blocklevel")},createEditablesIfNeeded:function(){this.$element.find(".aloha-editable").aloha()},renderBlockHandlesIfNeeded:function(){this.isDraggable()&&this.$element.children(".aloha-block-draghandle").length===0&&this.$element.prepend('<span class="aloha-block-handle aloha-block-draghandle"></span>')},attr:function(n,r,i){var s=this,o=!1;if(arguments.length>=2){if(n.substr(0,12)==="aloha-block-"){e.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+n+")");return}this._getAttribute(n)!==r&&(o=!0),this._setAttribute(n,r)}else{if(typeof n!="object")return typeof n=="string"?this._getAttribute(n):this._getAttributes();t.each(n,function(t,n){if(t.substr(0,12)==="aloha-block-"){e.Log.error("block/block","It is not allowed to set internal block attributes (starting with aloha-block-) through Block.attr() (You tried to set "+t+")");return}s._getAttribute(t)!==n&&(o=!0),s._setAttribute(t,n)})}return o&&!i&&(this._update(),this.trigger("change"),e.activeEditable.smartContentChange({type:"block-change"})),null},_setAttribute:function(e,t){this.$element.attr("data-"+e.toLowerCase(),t)},_getAttribute:function(e){return this.$element.attr("data-"+e.toLowerCase())},_getAttributes:function(){var e={};return t.each(this.$element[0].attributes,function(t,n){n.name.substr(0,5)==="data-"&&(e[n.name.substr(5).toLowerCase()]=n.value)}),e}}),f=a.extend({update:function(e,t){t()}}),l=a.extend({title:"Debugging",init:function(e,t){this.update(e,t)},update:function(e,n){e.css({display:"block"});var r='<table class="debug-block">';t.each(this.attr(),function(e,t){r+="<tr><th>"+e+"</th><td>"+t+"</td></tr>"}),r+="</table>",e.html(r),n()}}),c=a.extend({title:"EmptyBlock",init:function(){},activate:function(){},deactivate:function(){},renderBlockHandlesIfNeeded:function(){}});return{AbstractBlock:a,DefaultBlock:f,DebugBlock:l,EmptyBlock:c}}),define("block/blockcontenthandler",["jquery","aloha/contenthandlermanager","block/blockmanager"],function(e,t,n){var r=t.createHandler({handleContent:function(t){return typeof t=="string"?t=e("<div>"+t+"</div>"):t instanceof e&&(t=e("<div>").append(t)),t.find('.aloha-block[data-aloha-block-copy-only-block="true"]').length>0&&(t.find(".aloha-block:not([id])").remove(),t.find(".aloha-block + span:empty").remove(),t.find("div:empty").remove(),t.find("br.Apple-interchange-newline").remove(),t.find(".aloha-block").prev("br").remove(),t.find("div > br:only-child").parent().remove()),t.find(".aloha-block").each(function(){var t=e(this),r={},i={};e.each(t[0].attributes,function(e,t){if(t.nodeName==="id")return;t.nodeName.match(/^data-/)?i[t.nodeName.substr(5)]=t.nodeValue:r[t.nodeName]=t.nodeValue});var s=GENTICS.Utils.guid(),o=e("<"+this.tagName+"/>").attr(r).attr("id",s).removeClass("aloha-block-active").removeClass("aloha-block").html(t.html());t.replaceWith(o),window.setTimeout(function(){n._blockify(e("#"+s),i)},50)}),t.html()}});return r}),define("block/editor",["jquery","aloha/observable","util/class"],function(e,t,n){var r=n.extend(t,{schema:null,_constructor:function(e){this.schema=e},render:function(){},getValue:function(){},setValue:function(e){},destroy:function(){},_deactivate:function(){this.trigger("change",this.getValue()),this.destroy()}}),i=r.extend({formInputElementDefinition:null,_$formInputElement:null,render:function(){var t=e('<div class="aloha-block-editor" />'),n=GENTICS.Utils.guid();return t.append(this.renderLabel().attr("id",n)),t.append(this.renderFormElement().attr("id",n)),t},renderLabel:function(){var t=e("<label />");return t.html(this.schema.label),t},renderFormElement:function(){var t=this;return this._$formInputElement=e(this.formInputElementDefinition),this.afterRenderFormElement(this._$formInputElement),this._$formInputElement.change(function(){t.trigger("change",t.getValue())}),this._$formInputElement},afterRenderFormElement:function(e){},getValue:function(){return this._$formInputElement.val()},setValue:function(e){this._$formInputElement.val(e)},destroy:function(){this._$formInputElement.remove()}}),s=i.extend({formInputElementDefinition:'<input type="text" />'}),o=i.extend({formInputElementDefinition:'<input type="range" />',afterRenderFormElement:function(e){if(!this.schema.range)return;this.schema.range.min&&e.attr("min",this.schema.range.min),this.schema.range.max&&e.attr("max",this.schema.range.max),this.schema.range.step&&e.attr("step",this.schema.range.step)}}),u=i.extend({formInputElementDefinition:'<input type="url" />'}),a=i.extend({formInputElementDefinition:'<input type="email" />'}),f=i.extend({formInputElementDefinition:"<select />",afterRenderFormElement:function(t){e.each(this.schema.values,function(){var n=this;t.append(e("<option />").attr("value",n.key).html(n.label))})}}),l=i.extend({formInputElementDefinition:"<button />",afterRenderFormElement:function(e){var t=this;e.html(this.schema.buttonLabel),e.click(function(){t.schema.callback()})}});return{AbstractEditor:r,AbstractFormElementEditor:i,StringEditor:s,NumberEditor:o,UrlEditor:u,EmailEditor:a,SelectEditor:f,ButtonEditor:l}}),define("block/nls/i18n",{root:{"button.toggledragdrop.tooltip":"Toggle Drag & Drop"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("block/block-plugin",["aloha","aloha/plugin","jquery","aloha/contenthandlermanager","block/blockmanager","block/sidebarattributeeditor","block/block","block/editormanager","block/blockcontenthandler","block/editor","ui/ui","ui/toggleButton","i18n!block/nls/i18n","i18n!aloha/nls/i18n","jqueryui"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){var d=["div","span"],v=t.create("block",{config:[],settings:{},init:function(){var t=this;this.settings.rootTags||(this.settings.rootTags=d),i.registerBlockType("DebugBlock",o.DebugBlock),i.registerBlockType("DefaultBlock",o.DefaultBlock),i.registerBlockType("EmptyBlock",o.EmptyBlock),u.register("string",f.StringEditor),u.register("number",f.NumberEditor),u.register("url",f.UrlEditor),u.register("email",f.EmailEditor),u.register("select",f.SelectEditor),u.register("button",f.ButtonEditor),r.register("block",a),i.setDragDropState(t.isDragDropEnabled()),i.registerEventHandlers(),i.initializeBlockLevelDragDrop(),e.bind("aloha-ready",function(){t._createBlocks(),t.settings.sidebarAttributeEditor!==!1&&s.init()}),this.createButtons(),e.bind("aloha-editable-created",function(e,n){t.setDropzones(n.obj)}),e.bind("aloha-editable-activated",function(e,n){t.applyButtonConfig(n.editable)})},applyButtonConfig:function(e){this._isDragdropToggleEnabled(e)?(this._toggleDragDropButton.show(),this._toggleDragDropButton.setState(this._getDragdropState(e))):this._toggleDragDropButton.hide()},_isDragdropToggleEnabled:function(e){var t=this.getEditableConfig(e.obj),n=function(){return t[0]==="toggleDragdrop"||t.toggleDragdrop==1||t.toggleDragdrop=="true"||t.toggleDragdrop==1||t.toggleDragdrop=="1"},r=this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal||n();return r&&this.isDragDropEnabled()},_getDragdropState:function(e){return this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal?i.getDragDropState():e.obj.data("block-dragdrop")},_toggleDragdropState:function(t){if(this.settings&&this.settings.config&&this.settings.config.toggleDragdropGlobal){var n=!i.getDragDropState();i.setDragDropState(n);for(var r=0;r<e.editables.length;r++){var t=e.editables[r];this._setDragDropStateForEditable(t.obj,n)}}else{var s=!t.obj.data("block-dragdrop");this._setDragDropStateForEditable(t.obj,s)}},createButtons:function(){var t=this;this._toggleDragDropButton=l.adopt("toggleDragDrop",c,{tooltip:h.t("button.toggledragdrop.tooltip"),icon:"aloha-icon aloha-icon-toggledragdrop",scope:"Aloha.continuoustext",click:function(){t._toggleDragdropState(e.activeEditable)}})},setDropzones:function(e){var t=this,n=t.getEditableConfig(e),r=n&&n.dropzones||t.settings.dropzones;r?e.data("block-dropzones",r):e.data("block-dropzones",[".aloha-editable"])},isDragDropEnabled:function(){return this.settings&&typeof this.settings.dragdrop!="undefined"?this.settings.dragdrop===!0||this.settings.dragdrop==="true"||this.settings.dragdrop===1||this.settings.dragdrop==="1":!0},_createBlocks:function(){this.settings.defaults||(this.settings.defaults={}),n.each(this.settings.defaults,function(e,t){n(e).alohaBlock(t)})},_setDragDropStateForEditable:function(e,t){e.data("block-dragdrop",t),e.hasClass("ui-sortable")&&e.sortable("option","disabled",!t),e.find(".aloha-block.ui-draggable").each(function(){n(this).draggable("option","disabled",!t)}),e.find(".aloha-block-handle").each(function(){t?n(this).addClass("aloha-block-draghandle"):n(this).removeClass("aloha-block-draghandle")})}});return n.fn.alohaBlock=function(e){return e=e||{},n(this).each(function(t,n){i._blockify(n,e)}),n(this)},n.fn.mahaloBlock=function(){n(this).each(function(e,t){i._unblockify(t)})},v}),define("align/nls/i18n",{root:{"button.alignright.tooltip":"Align to the right","button.alignleft.tooltip":"Align to the left","button.aligncenter.tooltip":"Center","button.alignjustify.tooltip":"Justify","button.aligntop.tooltip":"Align to the top","button.alignmiddle.tooltip":"Align to the middle","button.alignbottom.tooltip":"Align to the bottom"},ca:!0,de:!0,mk:!0,"pt-br":!0,ru:!0,uk:!0,"zh-hans":!0}),define("align/align-plugin",["aloha","aloha/plugin","ui/ui","ui/toggleButton","i18n!align/nls/i18n","i18n!aloha/nls/i18n","jquery","PubSub"],function(e,t,n,r,i,s,o,u){var a=window.GENTICS;return t.create("align",{_constructor:function(){this._super("align")},config:{alignment:["right","left","center","justify","top","middle","bottom"]},alignment:"",verticalAlignment:"",lastAlignment:"",lastVerticalAlignment:"",init:function(){this.createButtons();var t=this;e.bind("aloha-editable-activated",function(e,n){t.applyButtonConfig(n.editable.obj)}),u.sub("aloha.selection.context-change",function(n){var r=n.range;e.activeEditable&&t.buttonPressed(r)})},buttonPressed:function(e){this.horizontalButtonPressed(e),this.verticalButtonPressed(e)},horizontalButtonPressed:function(t){var n=this;this.lastAlignment=this.alignment,this.alignment="",t.findMarkup(function(){if(this.style.textAlign!=="")return n.alignment=this.style.textAlign,!0;n.alignment=o(this).css("text-align")},e.activeEditable.obj);if(this.alignment!=this.lastAlignment){this._alignRightButton.setState(!1),this._alignLeftButton.setState(!1),this._alignCenterButton.setState(!1),this._alignJustifyButton.setState(!1);switch(this.alignment){case"right":this._alignRightButton.setState(!0);break;case"center":this._alignCenterButton.setState(!0);break;case"justify":this._alignJustifyButton.setState(!0);break;default:this._alignLeftButton.setState(!0),this.alignment="left"}}},verticalButtonPressed:function(t){var n=this;this.lastVerticalAlignment=this.verticalAlignment,this.verticalAlignment="",t.findMarkup(function(){if(this.style.verticalAlign!=="")return n.verticalAlignment=this.style.verticalAlign,!0;n.verticalAlignment=o(this).css("vertical-align")},e.activeEditable.obj);if(this.verticalAlignment!=this.lastVerticalAlignment){this._alignTopButton.setState(!1),this._alignMiddleButton.setState(!1),this._alignBottomButton.setState(!1);switch(this.verticalAlignment){case"top":this._alignTopButton.setState(!0);break;case"middle":this._alignMiddleButton.setState(!0);break;case"bottom":this._alignBottomButton.setState(!0);break;default:this._alignTopButton.setState(!0),this.verticalAlignment="top"}}},applyButtonConfig:function(e){var t=this.getEditableConfig(e);t&&t.alignment&&!this.settings.alignment?t=t:t[0]&&t[0].alignment?t=t[0]:this.settings.alignment&&(t.alignment=this.settings.alignment),typeof t.alignment=="undefined"&&(t=this.config),o.inArray("right",t.alignment)!=-1?this._alignRightButton.show(!0):this._alignRightButton.show(!1),o.inArray("left",t.alignment)!=-1?this._alignLeftButton.show(!0):this._alignLeftButton.show(!1),o.inArray("center",t.alignment)!=-1?this._alignCenterButton.show(!0):this._alignCenterButton.show(!1),o.inArray("justify",t.alignment)!=-1?this._alignJustifyButton.show(!0):this._alignJustifyButton.show(!1),o.inArray("top",t.alignment)!=-1?this._alignTopButton.show(!0):this._alignTopButton.show(!1),o.inArray("middle",t.alignment)!=-1?this._alignMiddleButton.show(!0):this._alignMiddleButton.show(!1),o.inArray("bottom",t.alignment)!=-1?this._alignBottomButton.show(!0):this._alignBottomButton.show(!1)},createButtons:function(){var e=this;this._alignLeftButton=n.adopt("alignLeft",r,{tooltip:i.t("button.alignleft.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-left",scope:"Aloha.continuoustext",click:function(){e.align("left")}}),this._alignCenterButton=n.adopt("alignCenter",r,{tooltip:i.t("button.aligncenter.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-center",scope:"Aloha.continuoustext",click:function(){e.align("center")}}),this._alignRightButton=n.adopt("alignRight",r,{tooltip:i.t("button.alignright.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-right",scope:"Aloha.continuoustext",click:function(){e.align("right")}}),this._alignJustifyButton=n.adopt("alignJustify",r,{tooltip:i.t("button.alignjustify.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-justify",scope:"Aloha.continuoustext",click:function(){e.align("justify")}}),this._alignTopButton=n.adopt("alignTop",r,{tooltip:i.t("button.aligntop.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-top",scope:"table.cell",click:function(){e.verticalAlign("top")}}),this._alignMiddleButton=n.adopt("alignMiddle",r,{tooltip:i.t("button.alignmiddle.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-middle",scope:"table.cell",click:function(){e.verticalAlign("middle")}}),this._alignBottomButton=n.adopt("alignBottom",r,{tooltip:i.t("button.alignbottom.tooltip"),icon:"aloha-icon aloha-icon-align aloha-icon-align-bottom",scope:"table.cell",click:function(){e.verticalAlign("bottom")}})},verticalAlign:function(t){var n=this,r=e.Selection.getRangeObject();this.lastVerticalAlignment=this.verticalAlignment,this.verticalAlignment=t;var i=this.getSelectedCells(r);i&&n.toggleAlign(i,"vertical-align");if(this.verticalAlignment!=this.lastVerticalAlignment)switch(this.lastVerticalAlignment){case"top":this._alignTopButton.setState(!1);break;case"middle":this._alignMiddleButton.setState(!1);break;case"bottom":this._alignBottomButton.setState(!1)}r.select()},align:function(t){var n=this,r=e.Selection.getRangeObject();this.lastAlignment=this.alignment,this.alignment=t;var i=r.getCommonAncestorContainer(),s=this.getSelectedCells(r);if(s)n.toggleAlign(s);else if(!a.Utils.Dom.isEditingHost(i))n.toggleAlign(i);else{var u=[];o.each(e.Selection.getRangeObject().getSelectionTree(),function(){this.selection!=="none"&&this.domobj.nodeType!==3&&u.push(this.domobj)}),n.toggleAlign(u)}if(this.alignment!=this.lastAlignment)switch(this.lastAlignment){case"right":this._alignRightButton.setState(!1);break;case"left":this._alignLeftButton.setState(!1);break;case"center":this._alignCenterButton.setState(!1);break;case"justify":this._alignJustifyButton.setState(!1)}r.select()},getSelectedCells:function(t){var n,r=t.findMarkup(function(){return o(this).is("td,th")&&(n=this),o(this).is("table.aloha-table")},e.activeEditable.obj),i=o(r).find(".aloha-cell-selected");return i.length?i:n},toggleAlign:function(e,t){var n=this;t=t||"text-align";var r=t==="vertical-align"?n.verticalAlignment:n.alignment,i=!0;o(e).each(function(){var e=o(this).css(t);if(e!=r)return i=!1,!1}),o(e).each(function(){var e=o(this).css(t);e==r&&i?o(this).css(t,""):o(this).css(t,r)})}})}),define("paste/paste-plugin",["aloha/core","aloha/plugin","jquery","aloha/command","aloha/console"],function(e,t,n,r,i){function l(){u=e.getSelection().getRangeAt(0),a=e.activeEditable,f.css({top:o.scrollTop(),left:o.scrollLeft()-200}),f.contents().remove(),a&&a.obj.blur(),e.getSelection().removeAllRanges();var t=e.createRange();t.setStart(f.get(0),0),t.setEnd(f.get(0),0),e.getSelection().addRange(t),f.focus()}function c(){var t=this,r;if(u&&a){a.obj.focus(),e.getSelection().removeAllRanges();var s=e.createRange();s.setStart(u.startContainer,u.startOffset),s.setEnd(u.endContainer,u.endOffset),e.getSelection().addRange(s),r=f.html(),n.browser.msie&&/^&nbsp;/.test(r)&&(r=r.substring(6));var o=u.startContainer;o.nodeType==3&&o.parentNode.nodeName=="P"&&o.parentNode.childNodes.length==1&&/^(\s|%A0)$/.test(escape(o.data))&&(o.data="",u.startOffset=0,u.endContainer==o&&(u.endOffset=0)),e.queryCommandSupported("insertHTML")?e.execCommand("insertHTML",!1,r):i.error("Common.Paste",'Command "insertHTML" not available. Enable the plugin "common/commands".')}u=void 0,a=void 0,f.contents().remove()}var s=window.GENTICS,o=n(window),u=null,a=null,f=n('<div id="pasteContainer" style="position:absolute; clip:rect(0px, 0px, 0px, 0px); width: 1px; height: 1px;"></div>').contentEditable(!0);return t.create("paste",{settings:{},init:function(){var t=this;n("body").append(f),e.bind("aloha-editable-created",function(r,i){n.browser.msie?t.settings.noclipboardaccess||!0?i.obj.bind("beforepaste",function(e){l(),e.stopPropagation()}):i.obj.bind("paste",function(t){l();var n=document.selection.createRange();return n.execCommand("paste"),c(),t.metaKey=void 0,e.activeEditable.smartContentChange(t),t.stopPropagation(),!1}):i.obj.bind("paste",function(t){l(),window.setTimeout(function(){c(),e.activeEditable.smartContentChange(t)},10),t.stopPropagation()})}),n.browser.msie&&(t.settings.noclipboardaccess||!0)&&f.bind("paste",function(t){window.setTimeout(function(){c(),e.activeEditable.smartContentChange(t)},10),t.stopPropagation()})},register:function(e){i.deprecated("Plugins.Paste","register() for pasteHandler is deprecated. Use the ContentHandler Plugin instead.")}})}),Aloha._load&&Aloha._load()})();